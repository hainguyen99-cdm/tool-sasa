import{j as v,K as E0,L as qf,t as S0,M as nr,r as D,O as bn,Q as fh,U as da,V as On,X as ua,Y as T0,Z as Kf,_ as A0,u as C0,$ as $a,a0 as os,a1 as Wa,a2 as No,a3 as Zf,a4 as k0,a5 as I0,a6 as R0,a7 as M0,a8 as Fo,a9 as P0,e as ft,g as tt,f as G,T as N0,C as F0,a as D0,G as B0,aa as L0,ab as O0,h as j0,ac as Ze,ad as xe,i as qt,J as Mr,I as Ki,ae as Et,af as V0,ag as U0,ah as Jl,ai as X0,B as St,aj as lt,z as ns,ak as qs,al as Yt,am as mh,F as Ks,an as Lt,ao as $t,ap as Wt,aq as Bi,ar as tc,as as G0,at as Y0,au as Do,av as xi,aw as $0,ax as ea,ay as jn,A as W0,az as za,aA as z0,aB as Qf,aC as Vn,aD as ec,aE as Ha,aF as ur,aG as H0,aH as q0,aI as ph,aJ as Jf,aK as tm,aL as rr,aM as em,aN as kn,aO as K0,aP as Zi,aQ as Z0,aR as Q0,aS as J0,aT as sm,aU as tx,aV as gh,aW as xh,aX as bh,W as nm,o as rm,aY as ke,aZ as ex,a_ as yh,a$ as im,b0 as sx,b1 as nx,b2 as rx,b3 as qa,H as ix,b4 as Qi,D as ax,b5 as gr,p as ox,b6 as lx,q as cx,v as hx,b7 as dx,S as ux,b8 as Ie,b9 as fx,ba as mx,bb as px,bc as gx,bd as xx,be as wa,bf as bx,bg as yx,bh as wx,bi as vx,bj as va,bk as _x,bl as Ex,bm as hl,bn as am,bo as Sx,bp as Tx,bq as Ax,br as Cx,bs as kx,w as Ix,x as Rx,n as Mx,y as Px,bt as om,bu as Nx,bv as Fx,bw as Dx,bx as Jd,by as Bx,bz as lm,bA as Lx,bB as Ox,bC as jx,bD as sc,bE as Vx,bF as Ux,bG as Hr,R as Xx,N as Gx}from"./NotiSSE.logJ_2QI.js";import{g as fa}from"./_commonjsHelpers.BosuxZz1.js";import"./base.CKaqUdIP.js";var Yx=new Set(["dark","light","system"]);function $x(n){let t=n;return Yx.has(t)||(t="light"),t}function Wx(n={}){const{initialColorMode:t="light",type:e="localStorage",storageKey:s="chakra-ui-color-mode"}=n,r=$x(t),i=e==="cookie",o=`(function(){try{var a=function(o){var l="(prefers-color-scheme: dark)",v=window.matchMedia(l).matches?"dark":"light",e=o==="system"?v:o,d=document.documentElement,m=document.body,i="chakra-ui-light",n="chakra-ui-dark",s=e==="dark";return m.classList.add(s?n:i),m.classList.remove(s?i:n),d.style.colorScheme=e,d.dataset.theme=e,e},u=a,h="${r}",r="${s}",t=document.cookie.match(new RegExp("(^| )".concat(r,"=([^;]+)"))),c=t?t[2]:null;c?a(c):document.cookie="".concat(r,"=").concat(a(h),"; max-age=31536000; path=/")}catch(a){}})();
  `,l=`(function(){try{var a=function(c){var v="(prefers-color-scheme: dark)",h=window.matchMedia(v).matches?"dark":"light",r=c==="system"?h:c,o=document.documentElement,s=document.body,l="chakra-ui-light",d="chakra-ui-dark",i=r==="dark";return s.classList.add(i?d:l),s.classList.remove(i?l:d),o.style.colorScheme=r,o.dataset.theme=r,r},n=a,m="${r}",e="${s}",t=localStorage.getItem(e);t?a(t):localStorage.setItem(e,a(m))}catch(a){}})();
  `;return`!${i?o:l}`.trim()}function zx(n={}){const{nonce:t}=n;return v.jsx("script",{id:"chakra-script",nonce:t,dangerouslySetInnerHTML:{__html:Wx(n)}})}var Hx=["borders","breakpoints","colors","components","config","direction","fonts","fontSizes","fontWeights","letterSpacings","lineHeights","radii","shadows","sizes","space","styles","transition","zIndices"];function qx(n){return E0(n)?Hx.every(t=>Object.prototype.hasOwnProperty.call(n,t)):!1}function Li(n){return typeof n=="function"}function Kx(...n){return t=>n.reduce((e,s)=>s(e),t)}var Zx=n=>function(...e){let s=[...e],r=e[e.length-1];return qx(r)&&s.length>1?s=s.slice(0,s.length-1):r=n,Kx(...s.map(i=>o=>Li(i)?i(o):Jx(o,i)))(r)},Qx=Zx(S0);function Jx(...n){return qf({},...n,cm)}function cm(n,t,e,s){if((Li(n)||Li(t))&&Object.prototype.hasOwnProperty.call(s,e))return(...r)=>{const i=Li(n)?n(...r):n,o=Li(t)?t(...r):t;return qf({},i,o,cm)}}function tb(n){const t=parseFloat(n);return typeof t!="number"||Number.isNaN(t)?0:t}function hm(n,t){let e=tb(n);const s=10**(t??10);return e=Math.round(e*s)/s,t?e.toFixed(t):e.toString()}function tu(n){if(!Number.isFinite(n))return 0;let t=1,e=0;for(;Math.round(n*t)/t!==n;)t*=10,e+=1;return e}function eb(n,t,e){return n==null?n:(e<t&&console.warn("clamp: max cannot be less than min"),Math.min(Math.max(n,t),e))}function sb(n={}){const{onChange:t,precision:e,defaultValue:s,value:r,step:i=1,min:o=Number.MIN_SAFE_INTEGER,max:l=Number.MAX_SAFE_INTEGER,keepWithinRange:a=!0}=n,c=nr(t),[h,d]=D.useState(()=>{var A;return s==null?"":(A=dl(s,i,e))!=null?A:""}),u=typeof r<"u",f=u?r:h,m=dm($n(f),i),p=e??m,g=D.useCallback(A=>{A!==f&&(u||d(A.toString()),c==null||c(A.toString(),$n(A)))},[c,u,f]),w=D.useCallback(A=>{let R=A;return a&&(R=eb(R,o,l)),hm(R,p)},[p,a,l,o]),x=D.useCallback((A=i)=>{let R;f===""?R=$n(A):R=$n(f)+A,R=w(R),g(R)},[w,i,g,f]),y=D.useCallback((A=i)=>{let R;f===""?R=$n(-A):R=$n(f)-A,R=w(R),g(R)},[w,i,g,f]),b=D.useCallback(()=>{var A;let R;s==null?R="":R=(A=dl(s,i,e))!=null?A:o,g(R)},[s,e,i,g,o]),_=D.useCallback(A=>{var R;const M=(R=dl(A,i,p))!=null?R:o;g(M)},[p,i,g,o]),E=$n(f);return{isOutOfRange:E>l||E<o,isAtMax:E===l,isAtMin:E===o,precision:p,value:f,valueAsNumber:E,update:g,reset:b,increment:x,decrement:y,clamp:w,cast:_,setValue:d}}function $n(n){return parseFloat(n.toString().replace(/[^\w.-]+/g,""))}function dm(n,t){return Math.max(tu(t),tu(n))}function dl(n,t,e){const s=$n(n);if(Number.isNaN(s))return;const r=dm(s,t);return hm(s,e??r)}function nb(n,t,e,s){const r=nr(e);return D.useEffect(()=>{const i=typeof n=="function"?n():n??document;if(!(!e||!i))return i.addEventListener(t,r,s),()=>{i.removeEventListener(t,r,s)}},[t,n,s,r,e]),()=>{const i=typeof n=="function"?n():n??document;i==null||i.removeEventListener(t,r,s)}}var um={exports:{}},rb="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",ib=rb,ab=ib;function fm(){}function mm(){}mm.resetWarningCache=fm;var ob=function(){function n(s,r,i,o,l,a){if(a!==ab){var c=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw c.name="Invariant Violation",c}}n.isRequired=n;function t(){return n}var e={array:n,bigint:n,bool:n,func:n,number:n,object:n,string:n,symbol:n,any:n,arrayOf:t,element:n,elementType:n,instanceOf:t,node:n,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:mm,resetWarningCache:fm};return e.PropTypes=e,e};um.exports=ob();var lb=um.exports;const Ht=fa(lb);var mn=bn(function(t,e){const s=fh("Link",t),{className:r,isExternal:i,...o}=da(t);return v.jsx(On.a,{target:i?"_blank":void 0,rel:i?"noopener":void 0,ref:e,className:ua("chakra-link",r),...o,__css:s})});mn.displayName="Link";var dn=bn(function(t,e){const s=fh("Text",t),{className:r,align:i,decoration:o,casing:l,...a}=da(t),c=T0({textAlign:t.align,textDecoration:t.decoration,textTransform:t.casing});return v.jsx(On.p,{ref:e,className:ua("chakra-text",t.className),...c,...a,__css:s})});dn.displayName="Text";var cb=n=>v.jsx(Kf,{viewBox:"0 0 24 24",...n,children:v.jsx("path",{fill:"currentColor",d:"M21,5H3C2.621,5,2.275,5.214,2.105,5.553C1.937,5.892,1.973,6.297,2.2,6.6l9,12 c0.188,0.252,0.485,0.4,0.8,0.4s0.611-0.148,0.8-0.4l9-12c0.228-0.303,0.264-0.708,0.095-1.047C21.725,5.214,21.379,5,21,5z"})}),hb=n=>v.jsx(Kf,{viewBox:"0 0 24 24",...n,children:v.jsx("path",{fill:"currentColor",d:"M12.8,5.4c-0.377-0.504-1.223-0.504-1.6,0l-9,12c-0.228,0.303-0.264,0.708-0.095,1.047 C2.275,18.786,2.621,19,3,19h18c0.379,0,0.725-0.214,0.895-0.553c0.169-0.339,0.133-0.744-0.095-1.047L12.8,5.4z"})});function eu(n,t,e,s){D.useEffect(()=>{var r;if(!n.current||!s)return;const i=(r=n.current.ownerDocument.defaultView)!=null?r:window,o=Array.isArray(t)?t:[t],l=new i.MutationObserver(a=>{for(const c of a)c.type==="attributes"&&c.attributeName&&o.includes(c.attributeName)&&e(c)});return l.observe(n.current,{attributes:!0,attributeFilter:o}),()=>l.disconnect()})}function db(n,t){const e=nr(n);D.useEffect(()=>{let s=null;const r=()=>e();return t!==null&&(s=window.setInterval(r,t)),()=>{s&&window.clearInterval(s)}},[t,e])}var ub=50,su=300;function fb(n,t){const[e,s]=D.useState(!1),[r,i]=D.useState(null),[o,l]=D.useState(!0),a=D.useRef(null),c=()=>clearTimeout(a.current);db(()=>{r==="increment"&&n(),r==="decrement"&&t()},e?ub:null);const h=D.useCallback(()=>{o&&n(),a.current=setTimeout(()=>{l(!1),s(!0),i("increment")},su)},[n,o]),d=D.useCallback(()=>{o&&t(),a.current=setTimeout(()=>{l(!1),s(!0),i("decrement")},su)},[t,o]),u=D.useCallback(()=>{l(!0),s(!1),c()},[]);return D.useEffect(()=>()=>c(),[]),{up:h,down:d,stop:u,isSpinning:e}}var mb=/^[Ee0-9+\-.]$/;function pb(n){return mb.test(n)}function gb(n,t){if(n.key==null)return!0;const e=n.ctrlKey||n.altKey||n.metaKey;return!(n.key.length===1)||e?!0:t(n.key)}function xb(n={}){const{focusInputOnChange:t=!0,clampValueOnBlur:e=!0,keepWithinRange:s=!0,min:r=Number.MIN_SAFE_INTEGER,max:i=Number.MAX_SAFE_INTEGER,step:o=1,isReadOnly:l,isDisabled:a,isRequired:c,isInvalid:h,pattern:d="[0-9]*(.[0-9]+)?",inputMode:u="decimal",allowMouseWheel:f,id:m,onChange:p,precision:g,name:w,"aria-describedby":x,"aria-label":y,"aria-labelledby":b,onFocus:_,onBlur:E,onInvalid:S,getAriaValueText:T,isValidCharacter:C,format:A,parse:R,...M}=n,I=nr(_),N=nr(E),F=nr(S),B=nr(C??pb),Y=nr(T),O=sb(n),{update:V,increment:j,decrement:X}=O,[L,U]=D.useState(!1),q=!(l||a),H=D.useRef(null),J=D.useRef(null),Q=D.useRef(null),W=D.useRef(null),K=D.useCallback(ct=>ct.split("").filter(B).join(""),[B]),Z=D.useCallback(ct=>{var Vt;return(Vt=R==null?void 0:R(ct))!=null?Vt:ct},[R]),nt=D.useCallback(ct=>{var Vt;return((Vt=A==null?void 0:A(ct))!=null?Vt:ct).toString()},[A]);A0(()=>{(O.valueAsNumber>i||O.valueAsNumber<r)&&(F==null||F("rangeOverflow",nt(O.value),O.valueAsNumber))},[O.valueAsNumber,O.value,nt,F]),C0(()=>{if(!H.current)return;if(H.current.value!=O.value){const Vt=Z(H.current.value);O.setValue(K(Vt))}},[Z,K]);const gt=D.useCallback((ct=o)=>{q&&j(ct)},[j,q,o]),rt=D.useCallback((ct=o)=>{q&&X(ct)},[X,q,o]),bt=fb(gt,rt);eu(Q,"disabled",bt.stop,bt.isSpinning),eu(W,"disabled",bt.stop,bt.isSpinning);const Ct=D.useCallback(ct=>{if(ct.nativeEvent.isComposing)return;const ae=Z(ct.currentTarget.value);V(K(ae)),J.current={start:ct.currentTarget.selectionStart,end:ct.currentTarget.selectionEnd}},[V,K,Z]),jt=D.useCallback(ct=>{var Vt,ae,Mt;I==null||I(ct),J.current&&(ct.target.selectionStart=(ae=J.current.start)!=null?ae:(Vt=ct.currentTarget.value)==null?void 0:Vt.length,ct.currentTarget.selectionEnd=(Mt=J.current.end)!=null?Mt:ct.currentTarget.selectionStart)},[I]),kt=D.useCallback(ct=>{if(ct.nativeEvent.isComposing)return;gb(ct,B)||ct.preventDefault();const Vt=ee(ct)*o,ae=ct.key,yr={ArrowUp:()=>gt(Vt),ArrowDown:()=>rt(Vt),Home:()=>V(r),End:()=>V(i)}[ae];yr&&(ct.preventDefault(),yr(ct))},[B,o,gt,rt,V,r,i]),ee=ct=>{let Vt=1;return(ct.metaKey||ct.ctrlKey)&&(Vt=.1),ct.shiftKey&&(Vt=10),Vt},se=D.useMemo(()=>{const ct=Y==null?void 0:Y(O.value);if(ct!=null)return ct;const Vt=O.value.toString();return Vt||void 0},[O.value,Y]),ie=D.useCallback(()=>{let ct=O.value;if(O.value==="")return;/^[eE]/.test(O.value.toString())?O.setValue(""):(O.valueAsNumber<r&&(ct=r),O.valueAsNumber>i&&(ct=i),O.cast(ct))},[O,i,r]),Qt=D.useCallback(()=>{U(!1),e&&ie()},[e,U,ie]),Jt=D.useCallback(()=>{t&&requestAnimationFrame(()=>{var ct;(ct=H.current)==null||ct.focus()})},[t]),Ye=D.useCallback(ct=>{ct.preventDefault(),bt.up(),Jt()},[Jt,bt]),Xn=D.useCallback(ct=>{ct.preventDefault(),bt.down(),Jt()},[Jt,bt]);nb(()=>H.current,"wheel",ct=>{var Vt,ae;const yr=((ae=(Vt=H.current)==null?void 0:Vt.ownerDocument)!=null?ae:document).activeElement===H.current;if(!f||!yr)return;ct.preventDefault();const Ii=ee(ct)*o,Qd=Math.sign(ct.deltaY);Qd===-1?gt(Ii):Qd===1&&rt(Ii)},{passive:!1});const Is=D.useCallback((ct={},Vt=null)=>{const ae=a||s&&O.isAtMax;return{...ct,ref:$a(Vt,Q),role:"button",tabIndex:-1,onPointerDown:os(ct.onPointerDown,Mt=>{Mt.button!==0||ae||Ye(Mt)}),onPointerLeave:os(ct.onPointerLeave,bt.stop),onPointerUp:os(ct.onPointerUp,bt.stop),disabled:ae,"aria-disabled":Wa(ae)}},[O.isAtMax,s,Ye,bt.stop,a]),ba=D.useCallback((ct={},Vt=null)=>{const ae=a||s&&O.isAtMin;return{...ct,ref:$a(Vt,W),role:"button",tabIndex:-1,onPointerDown:os(ct.onPointerDown,Mt=>{Mt.button!==0||ae||Xn(Mt)}),onPointerLeave:os(ct.onPointerLeave,bt.stop),onPointerUp:os(ct.onPointerUp,bt.stop),disabled:ae,"aria-disabled":Wa(ae)}},[O.isAtMin,s,Xn,bt.stop,a]),ya=D.useCallback((ct={},Vt=null)=>{var ae,Mt,yr,Ii;return{name:w,inputMode:u,type:"text",pattern:d,"aria-labelledby":b,"aria-label":y,"aria-describedby":x,id:m,disabled:a,...ct,readOnly:(ae=ct.readOnly)!=null?ae:l,"aria-readonly":(Mt=ct.readOnly)!=null?Mt:l,"aria-required":(yr=ct.required)!=null?yr:c,required:(Ii=ct.required)!=null?Ii:c,ref:$a(H,Vt),value:nt(O.value),role:"spinbutton","aria-valuemin":r,"aria-valuemax":i,"aria-valuenow":Number.isNaN(O.valueAsNumber)?void 0:O.valueAsNumber,"aria-invalid":Wa(h??O.isOutOfRange),"aria-valuetext":se,autoComplete:"off",autoCorrect:"off",onChange:os(ct.onChange,Ct),onKeyDown:os(ct.onKeyDown,kt),onFocus:os(ct.onFocus,jt,()=>U(!0)),onBlur:os(ct.onBlur,N,Qt)}},[w,u,d,b,y,nt,x,m,a,c,l,h,O.value,O.valueAsNumber,O.isOutOfRange,r,i,se,Ct,kt,jt,N,Qt]);return{value:nt(O.value),valueAsNumber:O.valueAsNumber,isFocused:L,isDisabled:a,isReadOnly:l,getIncrementButtonProps:Is,getDecrementButtonProps:ba,getInputProps:ya,htmlProps:M}}var[bb,Bo]=No({name:"NumberInputStylesContext",errorMessage:`useNumberInputStyles returned is 'undefined'. Seems you forgot to wrap the components in "<NumberInput />" `}),[yb,wh]=No({name:"NumberInputContext",errorMessage:"useNumberInputContext: `context` is undefined. Seems you forgot to wrap number-input's components within <NumberInput />"}),vh=bn(function(t,e){const s=Zf("NumberInput",t),r=da(t),i=k0(r),{htmlProps:o,...l}=xb(i),a=D.useMemo(()=>l,[l]);return v.jsx(yb,{value:a,children:v.jsx(bb,{value:s,children:v.jsx(On.div,{...o,ref:e,className:ua("chakra-numberinput",t.className),__css:{position:"relative",zIndex:0,...s.root}})})})});vh.displayName="NumberInput";var wb=bn(function(t,e){const s=Bo();return v.jsx(On.div,{"aria-hidden":!0,ref:e,...t,__css:{display:"flex",flexDirection:"column",position:"absolute",top:"0",insetEnd:"0px",margin:"1px",height:"calc(100% - 2px)",zIndex:1,...s.stepperGroup}})});wb.displayName="NumberInputStepper";var _h=bn(function(t,e){const{getInputProps:s}=wh(),r=s(t,e),i=Bo();return v.jsx(On.input,{...r,className:ua("chakra-numberinput__field",t.className),__css:{width:"100%",...i.field}})});_h.displayName="NumberInputField";var pm=On("div",{baseStyle:{display:"flex",justifyContent:"center",alignItems:"center",flex:1,transitionProperty:"common",transitionDuration:"normal",userSelect:"none",cursor:"pointer",lineHeight:"normal"}}),vb=bn(function(t,e){var s;const r=Bo(),{getDecrementButtonProps:i}=wh(),o=i(t,e);return v.jsx(pm,{...o,__css:r.stepper,children:(s=t.children)!=null?s:v.jsx(cb,{})})});vb.displayName="NumberDecrementStepper";var _b=bn(function(t,e){var s;const{getIncrementButtonProps:r}=wh(),i=r(t,e),o=Bo();return v.jsx(pm,{...i,__css:o.stepper,children:(s=t.children)!=null?s:v.jsx(hb,{})})});_b.displayName="NumberIncrementStepper";var[Eb,VA,Sb,Tb]=I0(),[Ab,Cb]=No({name:"PinInputContext",errorMessage:"usePinInputContext: `context` is undefined. Seems you forgot to all pin input fields within `<PinInput />`"}),nu=n=>n==null?void 0:n.split("");function ru(n,t){return(t==="alphanumeric"?/^[a-zA-Z0-9]+$/i:/^[0-9]+$/).test(n)}function kb(n={}){const{autoFocus:t,value:e,defaultValue:s,onChange:r,onComplete:i,placeholder:o="â—‹",manageFocus:l=!0,otp:a=!1,id:c,isDisabled:h,isInvalid:d,type:u="number",mask:f}=n,m=D.useId(),p=c??`pin-input-${m}`,g=Sb(),[w,x]=D.useState(!0),[y,b]=D.useState(-1),[_,E]=R0({defaultValue:nu(s)||[],value:nu(e),onChange:M=>r==null?void 0:r(M.join(""))});D.useEffect(()=>{if(t){const M=g.first();M&&requestAnimationFrame(()=>{M.node.focus()})}},[g]);const S=D.useCallback(M=>{if(!w||!l)return;const I=g.next(M,!1);I&&requestAnimationFrame(()=>{I.node.focus()})},[g,w,l]),T=D.useCallback((M,I,N=!0)=>{const F=[..._];F[I]=M,E(F),M!==""&&F.length===g.count()&&F.every(Y=>Y!=null&&Y!=="")?i==null||i(F.join("")):N&&S(I)},[_,E,S,i,g]),C=D.useCallback(()=>{var M;const I=Array(g.count()).fill("");E(I);const N=g.first();(M=N==null?void 0:N.node)==null||M.focus()},[g,E]),A=D.useCallback((M,I)=>{let N=I;return(M==null?void 0:M.length)>0&&(M[0]===I.charAt(0)?N=I.charAt(1):M[0]===I.charAt(1)&&(N=I.charAt(0))),N},[]);return{getInputProps:D.useCallback(M=>{const{index:I,...N}=M,F=X=>{const L=X.target.value,U=_[I],q=A(U,L);if(q===""){T("",I);return}if(L.length>2){if(ru(L,u)){const H=L.split("").filter((J,Q)=>Q<g.count());E(H),H.length===g.count()&&(i==null||i(H.join("")))}}else ru(q,u)&&T(q,I),x(!0)},B=X=>{var L;if(X.key==="Backspace"&&l)if(X.target.value===""){const U=g.prev(I,!1);U&&(T("",I-1,!1),(L=U.node)==null||L.focus(),x(!0))}else x(!1)},Y=()=>{b(I)},O=()=>{b(-1)},V=y===I;return{"aria-label":"Please enter your pin code",inputMode:u==="number"?"numeric":"text",type:f?"password":u==="number"?"tel":"text",...N,id:`${p}-${I}`,disabled:h,"aria-invalid":Wa(d),onChange:os(N.onChange,F),onKeyDown:os(N.onKeyDown,B),onFocus:os(N.onFocus,Y),onBlur:os(N.onBlur,O),value:_[I]||"",autoComplete:a?"one-time-code":"off",placeholder:V?"":o}},[g,y,A,p,h,f,d,l,i,a,o,T,E,u,_]),id:p,descendants:g,values:_,setValue:T,setValues:E,clear:C}}function Ib(n={},t=null){const{getInputProps:e}=Cb(),{index:s,register:r}=Tb();return e({...n,ref:$a(r,t),index:s})}function gm(n){const t=fh("PinInput",n),{children:e,...s}=da(n),{descendants:r,...i}=kb(s),o=M0(e).map(l=>D.cloneElement(l,{__css:t}));return v.jsx(Eb,{value:r,children:v.jsx(Ab,{value:i,children:o})})}gm.displayName="PinInput";var Oi=bn(function(t,e){const s=Ib(t,e);return v.jsx(On.input,{...s,className:ua("chakra-pin-input",t.className)})});Oi.displayName="PinInputField";function Rb(n,t,e){return(n-t)*100/(e-t)}Fo({"0%":{strokeDasharray:"1, 400",strokeDashoffset:"0"},"50%":{strokeDasharray:"400, 400",strokeDashoffset:"-100"},"100%":{strokeDasharray:"400, 400",strokeDashoffset:"-260"}});Fo({"0%":{transform:"rotate(0deg)"},"100%":{transform:"rotate(360deg)"}});var Mb=Fo({"0%":{left:"-40%"},"100%":{left:"100%"}}),Pb=Fo({from:{backgroundPosition:"1rem 0"},to:{backgroundPosition:"0 0"}});function Nb(n){const{value:t=0,min:e,max:s,valueText:r,getValueText:i,isIndeterminate:o,role:l="progressbar"}=n,a=Rb(t,e,s);return{bind:{"data-indeterminate":o?"":void 0,"aria-valuemax":s,"aria-valuemin":e,"aria-valuenow":o?void 0:t,"aria-valuetext":(()=>{if(t!=null)return typeof i=="function"?i(t,a):r})(),role:l},percent:a,value:t}}var[Fb,Db]=No({name:"ProgressStylesContext",errorMessage:`useProgressStyles returned is 'undefined'. Seems you forgot to wrap the components in "<Progress />" `}),Bb=bn((n,t)=>{const{min:e,max:s,value:r,isIndeterminate:i,role:o,...l}=n,a=Nb({value:r,min:e,max:s,isIndeterminate:i,role:o}),h={height:"100%",...Db().filledTrack};return v.jsx(On.div,{ref:t,style:{width:`${a.percent}%`,...l.style},...a.bind,...l,__css:h})}),xm=bn((n,t)=>{var e;const{value:s,min:r=0,max:i=100,hasStripe:o,isAnimated:l,children:a,borderRadius:c,isIndeterminate:h,"aria-label":d,"aria-labelledby":u,"aria-valuetext":f,title:m,role:p,...g}=da(n),w=Zf("Progress",n),x=c??((e=w.track)==null?void 0:e.borderRadius),y={animation:`${Pb} 1s linear infinite`},E={...!h&&o&&l&&y,...h&&{position:"absolute",willChange:"left",minWidth:"50%",animation:`${Mb} 1s ease infinite normal none running`}},S={overflow:"hidden",position:"relative",...w.track};return v.jsx(On.div,{ref:t,borderRadius:x,__css:S,...g,children:v.jsxs(Fb,{value:w,children:[v.jsx(Bb,{"aria-label":d,"aria-labelledby":u,"aria-valuetext":f,min:r,max:i,value:s,isIndeterminate:h,css:E,borderRadius:x,title:m,role:p}),a]})})});xm.displayName="Progress";var Lb=P0({d:"M12 4l-1.41 1.41L16.17 11H4v2h12.17l-5.58 5.59L12 20l8-8z",displayName:"ArrowForwardIcon"});const Jn=()=>{const{saxTheme:n}=ft(t=>t.displaySasa);return v.jsxs("div",{className:`maintain-container theme-${n}`,children:[v.jsx("img",{className:"img-maintain",src:tt("/img/maintain/maintain.png"),alt:"maintain"}),v.jsx("div",{className:"text-maintain",children:G("maintain_1")}),v.jsx("div",{className:"text-maintain",style:{marginTop:"0"},children:G("maintain_2")})]})},Ob='.menu{display:flex;font-family:Sora,sans-serif;height:100%;position:fixed;top:0;bottom:0;right:0;transition:.2s}@keyframes open{0%{right:-33.0625rem}to{right:0}}@keyframes close{0%{right:0rem}to{right:-33.0625rem}}.menu.close-menu-wrapper{right:-33.0625rem;animation:close .3s linear alternate}@media (max-width: 80rem){.menu.close-menu-wrapper{right:-26.7rem}}.menu.open-menu-wrapper{right:0;animation:open .3s linear alternate}.menu .open-menu-btn{position:absolute;left:-37px;top:80px;width:2.25rem;height:2.25rem;display:flex;justify-content:center;align-items:center;border-radius:50%;border:.0625rem solid}.menu .open-menu-btn img{border-radius:50%;object-fit:contain}.menu .open-menu-btn-game{position:absolute;left:-37px;top:150px;width:2.25rem;height:2.25rem;display:flex;justify-content:center;align-items:center;border-radius:50%;border:.0625rem solid}.menu .open-menu-btn-game img{border-radius:50%;object-fit:contain}.menu .menu-content{height:100%;transition:.2s;padding:0;border-left:1px solid;width:33.0625rem}@media (max-width: 80rem){.menu .menu-content{width:400px}}.menu .menu-content.open-menu .logout{display:flex;padding:0 1.5rem}.menu .menu-content.open-menu .login{display:block}.menu .menu-content.open-menu .login .list-game{padding:20px 20px 10px}.menu .menu-content.open-menu .login .header-tab{padding:10px 20px 24px;border-bottom-width:2px;display:flex;align-items:center;justify-content:space-between;gap:20px;height:120px}@media (max-width: 80rem){.menu .menu-content.open-menu .login .header-tab{height:106px;padding-bottom:16px}}.menu .menu-content.open-menu .login .header-tab .left{display:flex;align-items:flex-start;flex-direction:column;justify-content:space-between;height:100%}.menu .menu-content.open-menu .login .header-tab .left .logo{display:flex;align-items:center;cursor:pointer}.menu .menu-content.open-menu .login .header-tab .left .logo .sasa img{width:32px;height:32px;object-fit:contain;object-position:center}.menu .menu-content.open-menu .login .header-tab .left .logo h1{font-size:14px}.menu .menu-content.open-menu .login .header-tab .left .group-btn{display:flex;align-items:center;justify-content:space-between;gap:20px;border-radius:.625rem;font-size:.875rem;transition:.2s}@media (max-width: 80rem){.menu .menu-content.open-menu .login .header-tab .left .group-btn{gap:10px}}.menu .menu-content.open-menu .login .header-tab .left .group-btn button{background-color:transparent;display:flex;flex-direction:column;height:42px;gap:6px;padding:0}.menu .menu-content.open-menu .login .header-tab .left .group-btn button img{width:24px;min-height:24px;object-fit:contain;object-position:center}@media (max-width: 80rem){.menu .menu-content.open-menu .login .header-tab .left .group-btn button img{width:20px;min-height:20px}}.menu .menu-content.open-menu .login .header-tab .left .group-btn button span{font-size:10px;font-weight:400}@media (max-width: 80rem){.menu .menu-content.open-menu .login .header-tab .left .group-btn button span{font-size:8px}}.menu .menu-content.open-menu .login .header-tab .right .balance{max-width:100%;justify-content:left}.menu .menu-content.open-menu .login .header-tab .right .balance .tooltip{margin:0}.menu .menu-content.open-menu .login .header-tab .sasa img{width:42px;height:40px}.menu .menu-content.open-menu .login .header-tab h1{font-size:20px;font-weight:500}.menu .menu-content.open-menu .login .main-tab .navigation{scrollbar-width:thin}@media (max-width: 120rem){.menu .menu-content.open-menu .login .main-tab .navigation{overflow-y:hidden;overflow-x:auto}}@media (max-width: 80rem){.menu .menu-content.open-menu .login .main-tab .navigation{overflow-y:hidden;overflow-x:auto}}.menu .menu-content.open-menu .login .main-tab.theme-dark .chakra-tabs__tablist .chakra-tabs__tab .wrapper-btn span{color:#fff}.menu .menu-content.open-menu .login .main-tab.theme-dark .chakra-tabs__tablist .chakra-tabs__tab[aria-selected=true]{background-color:#1890ff}.menu .menu-content.open-menu .login .main-tab.theme-dark .chakra-tabs__tablist .chakra-tabs__tab[aria-selected=false]{background-color:#272727}.menu .menu-content.open-menu .login .main-tab.theme-dark .chakra-tabs__tablist .chakra-tabs__tab[aria-selected=false] .wrapper-btn span{color:#fff}.menu .menu-content.open-menu .login .main-tab .chakra-tabs__tab-panels{padding:0 20px}.menu .menu-content.open-menu .login .main-tab .chakra-tabs__tab-panels .tab-panel-home{height:calc(100vh - 200px);overflow-y:auto;scrollbar-width:none}.menu .menu-content.open-menu .login .main-tab .chakra-tabs__tab-panels .tab-game{display:flex;justify-content:center;align-items:center}.menu .menu-content.open-menu .login .main-tab .chakra-tabs__tablist{overflow-x:auto;overflow-y:hidden;padding:20px 20px 4px;gap:0;display:-webkit-box;border:none}@media (max-width: 80rem){.menu .menu-content.open-menu .login .main-tab .chakra-tabs__tablist{padding-top:14px}}.menu .menu-content.open-menu .login .main-tab .chakra-tabs__tablist .chakra-tabs__tab{height:40px;padding:0 10px!important;display:flex;align-items:center;margin-right:12px;border-radius:.625rem;font-weight:500}.menu .menu-content.open-menu .login .main-tab .chakra-tabs__tablist .chakra-tabs__tab[aria-selected=true]{background-color:#1890ff}.menu .menu-content.open-menu .login .main-tab .chakra-tabs__tablist .chakra-tabs__tab[aria-selected=false]{background-color:#eff3f4}.menu .menu-content.open-menu .login .main-tab .chakra-tabs__tablist .chakra-tabs__tab[aria-selected=false] .wrapper-btn span{color:#000}.menu .menu-content.open-menu .login .main-tab .chakra-tabs__tablist .chakra-tabs__tab:last-child{margin-right:0}.menu .menu-content.open-menu .login .main-tab .chakra-tabs__tablist .chakra-tabs__tab .wrapper-btn{font-size:14px;font-weight:500;display:flex;align-items:center;gap:4px}.menu .menu-content.open-menu .login .main-tab .chakra-tabs__tablist .chakra-tabs__tab .wrapper-btn img{display:block}@media (max-width: 80rem){.menu .menu-content.open-menu .login .main-tab .chakra-tabs__tablist .chakra-tabs__tab .wrapper-btn img{width:20px;height:20px}}.menu .menu-content.open-menu .login .main-tab .chakra-tabs__tablist .chakra-tabs__tab .wrapper-btn span{display:block;font-size:14px;font-weight:600;color:#fff}@media (max-width: 80rem){.menu .menu-content.open-menu .login .main-tab .chakra-tabs__tablist .chakra-tabs__tab .wrapper-btn span{font-size:12px}}.menu .menu-content.open-menu .login .main-tab .chakra-tabs__tablist .chakra-tabs__tab:active{background:inherit}.menu .menu-content.open-menu .login .main-tab .chakra-tabs__tablist .chakra-tabs__tab:focus-visible{box-shadow:none}.menu .menu-content.open-menu .login .main-tab .chakra-tabs__tablist .chakra-tabs__tab img{width:1.5rem;height:1.5rem;object-fit:contain}.menu .menu-content.open-menu .login .main-tab .chakra-tabs__tab-panel{padding:0!important}.menu .menu-content.open-menu .login .quest-tab .chakra-tabs__tab-panels{padding:0}.menu .menu-content.open-menu .login .quest-tab .chakra-tabs__tablist{border:none;gap:10px;display:flex;padding:20px 0 5px;justify-content:center}.menu .menu-content.open-menu .login .quest-tab .chakra-tabs__tablist .chakra-tabs__tab{border-radius:10px;border:1px solid;margin-right:0}.menu .menu-content .logout{width:100%;height:100%;display:none;flex-direction:column;justify-content:center;align-items:center;gap:3rem;overflow-y:auto}.menu .menu-content .logout .exten-logo{width:150px;height:90px;object-fit:contain}.menu .menu-content .logout button{width:200px;height:2.75rem;border-radius:.625rem;font-size:1rem;transition:.2s}.menu .menu-content .logout button:hover{opacity:.7;transition:.2s}.menu .menu-content .login{display:none;width:100%;height:100%;color:#fff;overflow:hidden}.menu .menu-content .login .my-stuff{display:flex;justify-content:space-between;align-items:center;margin-top:2.18rem}.menu .menu-content .login .my-stuff .stuff{display:flex;gap:.75rem;align-items:center}.menu .menu-content .login .my-stuff .stuff .whitelist{color:#faad14;font-size:.75rem;font-weight:500;text-decoration-line:underline}.menu .menu-content .login .my-stuff .stuff .my-bag-btn{display:flex;flex-direction:column;align-items:center;transition:.2s}.menu .menu-content .login .my-stuff .stuff .my-bag-btn:hover p{opacity:.9;transition:.2s}.menu .menu-content .login .my-stuff .stuff .my-bag-btn p{font-size:.75rem;font-weight:500;opacity:.5;transition:.2s}.menu .menu-content .login .group-external-link .btn-transfer{display:flex;gap:.3125rem;border:1px solid;border-radius:10px;align-items:center;font-size:.75rem!important;font-weight:400}.menu .menu-content .login .group-external-link .btn-transfer img{width:20px;height:20px}.menu .menu-content .login .group-external-link .btn-transfer.theme-light{border:1px solid rgba(0,0,0,.2)!important}.menu .menu-content .login .enter-code-referral{position:sticky;top:50%;transform:translateY(-50%);display:flex;flex-direction:column;justify-content:center;align-items:center}.menu .menu-content .login .enter-code-referral h1{font-size:20px;font-weight:700;margin-bottom:30px}.menu .menu-content .login .enter-code-referral .chakra-form-control{width:fit-content;margin:0 auto 20px}.menu .menu-content .login .enter-code-referral input{max-width:200px;height:44px;border-radius:10px;border:1px solid rgba(255,255,255,.5);text-align:center}.menu .menu-content .login .enter-code-referral button{width:200px;height:44px;border-radius:10px;background:#faad14;color:#000;font-size:14px;font-weight:600}.tooltip:hover .title{display:block;padding:6px 12px;border:1px solid rgba(255,255,255,.2);border-radius:6px;background:#00000080;color:#fff}.tooltip .title{text-wrap:nowrap;display:none;position:absolute;bottom:-40px;left:50%;transform:translate(-50%);z-index:3;width:fit-content;background:#00000080;color:#fff}.wrapper-balance{display:flex;gap:10px;flex-direction:column}.wrapper-balance .balance{display:flex;gap:12px;align-items:center;max-width:60%;justify-content:flex-end}.wrapper-balance .balance .tooltip{width:90px;margin:unset}@media (max-width: 80rem){.wrapper-balance .balance .tooltip{width:76px}}.wrapper-balance .balance .coins{display:flex;gap:.2rem;align-items:center;border-radius:100px}@media (max-width: 80rem){.wrapper-balance .balance .coins{gap:.1rem}}.wrapper-balance .balance .coins img{width:1.5rem;height:1.5rem;object-fit:contain}@media (max-width: 80rem){.wrapper-balance .balance .coins img{width:1.2rem;height:1.2rem}}.wrapper-balance .balance .coins .img-transfer{width:16px;height:16px;margin-right:4px;cursor:pointer}.wrapper-balance .balance .coins .credit{display:flex;flex-direction:column;gap:.3rem;align-items:center}.wrapper-balance .balance .coins .credit span{font-size:.875rem;font-weight:500;width:44px;text-overflow:ellipsis;white-space:nowrap;overflow:hidden}@media (max-width: 80rem){.wrapper-balance .balance .coins .credit span{font-size:10px;width:40px}}.wrapper-balance .balance .coins .credit span.usd{font-size:.75rem;opacity:.5}canvas{pointer-events:none!important}.home .my-pet{display:flex;gap:.9rem;margin-bottom:1.25rem}.home .my-pet .pet-image{width:11.125rem;height:11.125rem;border:1px solid;border-radius:.625rem}.home .my-pet .copy-wrapper img{width:24px}.home .my-pet .pet-info{flex:1;display:flex;flex-direction:column;gap:4px;align-items:flex-start;width:100%}.home .my-pet .pet-info .text-binding{font-size:12px;cursor:pointer;color:#1890ff;display:flex;justify-content:space-between;align-items:center;width:100%}.home .my-pet .pet-info .text-binding p{max-width:90%}.home .my-pet .pet-info .linked-citizen{display:flex;gap:.3125rem}.home .my-pet .pet-info .level .level-header .current-lv .gold{display:flex;align-items:center;color:#fff;font-size:12px;gap:4px}.tab-tooltip{position:absolute;display:none;width:fit-content;height:fit-content;z-index:10;text-align:center;padding:.5rem;border-radius:.5rem;font-size:12px;font-weight:300;top:100%;left:50%;transform:translate(-50%);white-space:nowrap}.game-tab{max-width:400px;max-height:400px}@media (max-width: 80rem){.game-tab{width:400px}}@media (max-height: 45rem) and (max-width: 80rem){.game-tab{height:calc(100dvh - 15.625rem);width:calc(100dvh - 15.625rem)}}@media (max-width: 80rem){.game-tab canvas{width:400px!important;height:400px!important}}@media (max-height: 45rem) and (max-width: 80rem){.game-tab canvas{max-width:400px!important;height:calc(100dvh - 15.625rem)!important;width:calc(100dvh - 15.625rem)!important}}.footer{position:relative;margin:1.25rem 0}.footer .btn-explore{color:#fff!important;box-shadow:0 0 10px #fff;position:absolute;bottom:2rem;left:50%;transform:translate(-50%);background-color:#1888f0!important;border:1px solid #fff;border-radius:10px}.footer .btn-explore:hover{background-color:#1888f0!important}.tooltip-copy{color:#fff}.referral{display:flex;flex-direction:column;align-items:center;padding-block:1.875rem}.referral .layout-referral{width:100%;position:relative;margin-top:-1.25rem}.referral .layout-referral .item{width:inherit;border:.15rem dashed rgba(0,0,0,.2);border-radius:.625rem;display:flex;flex-direction:column;align-items:center;padding-block:1.125rem;margin-bottom:1.25rem}.referral .layout-referral .item .title{font-size:1rem;font-weight:400;margin-bottom:.5rem}.referral .layout-referral .item .code{display:flex;align-items:center;gap:1.25rem}.referral .layout-referral .item .code p{font-size:1.5rem;font-weight:700;line-height:2rem}.referral .layout-referral .item .code .copy-wrapper{position:relative;width:fit-content;height:fit-content}.referral .layout-referral .item .code .copy-wrapper .copy-tooltip{position:absolute;visibility:hidden;opacity:0;padding:7px;top:-35px;left:50%;transform:translate(-50%);border-radius:7px;font-size:12px;background:#1d293d;transition:opacity .3s ease}.referral .layout-referral .item .code .copy-wrapper .tooltip-show{opacity:1;visibility:visible}.referral .layout-referral .item .code .copy-wrapper .icon-copy{width:1.5rem;height:1.5rem;cursor:pointer}.referral .layout-referral .item .amount-referred{font-size:1.5rem;font-weight:700;line-height:2rem;margin-right:.5rem}.list-store{padding-top:20px;display:flex;flex-wrap:wrap;justify-content:flex-start;gap:.95rem;overflow-y:auto;max-height:80dvh;padding-bottom:50px;scrollbar-width:thin}@media (max-height: 800px){.list-store{max-height:72dvh}}.list-store .store-card{width:9rem;height:9rem;border-radius:.625rem;border:1px solid;position:relative;display:flex;flex-direction:column;justify-content:center;align-items:center;gap:.69rem;cursor:pointer;transition:.4s}@media (max-width: 80rem){.list-store .store-card{width:47%}}.list-store .store-card .item-img{height:5rem;width:auto;border-radius:8px;position:relative;display:flex;justify-content:center;align-items:center}.list-store .store-card .price{display:flex;gap:.3rem;align-items:center}.list-store .store-card .price img{width:1.25rem;height:1.25rem;object-fit:contain}.list-store .store-card .price p{font-size:.875rem;font-weight:500;line-height:1.375rem}.list-store .store-card .tooltip{position:absolute;top:10px;left:10px}.list-store .store-card .tooltip .custom-tooltip .tooltip-content{white-space:pre-wrap}.border-yellow:hover{border:1px solid #e66e00!important;transition:.4s}.border-blue:hover{border:1px solid #1890ff!important;transition:.4s}.quest .list-items{height:calc(100dvh - 210px);overflow-y:auto;width:100%;padding-bottom:40px;scrollbar-width:thin;padding-top:20px}@media (max-width: 80rem){.quest .quest-tab .chakra-tabs__tablist .chakra-tabs__tab{padding:0 12px!important}}.quest .quest-tab .chakra-tabs__tablist .chakra-tabs__tab[aria-selected=true]:after{display:none}@media (max-width: 80rem){.quest .quest-tab .chakra-tabs__tablist button span{font-size:12px!important;white-space:nowrap}}.list-quest{width:100%;max-height:100%}.list-quest .card-container{position:relative;margin-bottom:1.24rem}.list-quest .card-container:last-child{margin-bottom:2rem}.list-quest .card-container .quest-card{width:100%;border-radius:.625rem;border:1px solid rgba(255,255,255,.1);padding:20px 12px;transition:.4s;gap:1rem}.list-quest .card-container .quest-card:hover{border:1px solid rgba(255,255,255,.5)!important;transition:.4s}.list-quest .card-container .quest-card .card-header{display:flex;justify-content:space-between;align-items:center;gap:10px;min-height:35px}.list-quest .card-container .quest-card .card-header a{display:block;text-align:center}.list-quest .card-container .quest-card .card-header .reward{display:flex;align-items:center;flex-shrink:0;gap:4px;width:80px}.list-quest .card-container .quest-card .card-header .reward img{width:35px;height:35px;object-fit:contain}.list-quest .card-container .quest-card .card-header .reward p{font-size:.875rem;font-weight:500;line-height:1.375rem}.list-quest .card-container .quest-card .card-header .quest-name{flex:1;text-align:left!important;overflow:hidden}.list-quest .card-container .quest-card .card-header .quest-name .item-quest-name{display:inline-block;width:calc(100% - 110px)}@media (max-width: 80rem){.list-quest .card-container .quest-card .card-header .quest-name .item-quest-name{font-size:13px}}.list-quest .card-container .quest-card .card-header .button-check-claim{display:flex;justify-content:flex-start;align-items:center;width:126px}.list-quest .card-container .quest-card .card-header .type{font-size:.75rem;font-weight:700;border:1px solid;background-color:transparent;height:1.625rem;border-radius:.375rem;display:flex;justify-content:center;align-items:center;padding:0 .62rem}.list-quest .card-container .quest-card .card-header .type.onetime{color:#52c41a;border-color:#52c41a}.list-quest .card-container .quest-card .card-header .type.daily{color:#eb2f96;border-color:#eb2f96}.list-quest .card-container .quest-card a,.list-quest .card-container .quest-card p{font-size:1rem;font-weight:700;line-height:1.5rem}.list-quest .card-container .quest-card .cancel-binding{opacity:1;font-size:.8rem;font-weight:600;line-height:1.375rem;position:absolute;top:3.1rem;left:.75rem;transition:.2s}.list-quest .card-container .quest-card .cancel-binding:hover{text-decoration:underline;transition:.2s}.list-quest .card-container .quest-card .progress-btn{padding:0 15px;border-radius:.625rem;height:2.25rem;display:flex;justify-content:center;align-items:center;background-color:#1d9bf0;color:#fff}.list-quest .card-container .claim-btn{position:absolute;top:50%;transform:translateY(-50%);right:12px;background-color:#faad14;border-radius:.625rem;height:2.25rem;max-width:7rem;width:100%;font-size:.75rem}@media (max-width: 80rem){.list-quest .card-container .claim-btn{max-width:5.5rem}}.list-quest .card-container .claim-btn.claim-btn-transparent{background-color:transparent!important}.list-quest .card-container .claim-btn a{font-weight:700}.list-quest .card-container .claim-btn span{font-size:14px;font-weight:500}@media (max-width: 80rem){.list-quest .card-container .claim-btn span{font-size:12px}}.list-quest .card-container .claim-btn.claimed{background-color:#3c3f46!important;color:#fff!important;font-weight:700;cursor:auto!important;pointer-events:none!important;opacity:.5}.list-quest .card-container .claim-btn.completed{font-weight:700;cursor:not-allowed!important;opacity:.5;border:1px solid rgb(230,110,0)}.list-quest .card-container .claim-btn.waiting-binding{background:#9d9d9d!important;color:#fff;cursor:auto!important;pointer-events:none!important}.list-quest .description{opacity:.5;font-size:.875rem;font-weight:500}.my-bag{padding:1.45rem 1.25rem;overflow:hidden}.my-bag .back-home{margin-bottom:2.16rem;gap:.31rem;padding:0;background-color:transparent!important;height:auto!important}.my-bag .back-home:hover{background-color:transparent!important}.my-bag .back-home img{width:1.5rem;height:1.5rem;object-fit:contain}.my-bag .back-home p{font-size:.875rem;font-weight:500;line-height:1.375rem}.bag-list{height:72dvh;overflow-y:auto;padding:20px 20px 0}.bag-list .list{display:flex;justify-content:flex-start;row-gap:1.24rem;column-gap:1rem;flex-wrap:wrap}.bag-list .list .bag-card{width:9rem;height:9rem;border-radius:.625rem;border:1px solid;position:relative;display:flex;justify-content:center;flex-direction:column;align-items:center;cursor:pointer;transition:.2s;gap:.5rem}@media (max-width: 80rem){.bag-list .list .bag-card{width:47%}}.bag-list .list .bag-card img{height:5rem;width:auto;border-radius:8px}.bag-list .list .bag-card .tooltip{position:absolute;top:10px;left:10px}.bag-list .list .bag-card .tooltip .custom-tooltip .tooltip-hover img{width:18px;height:18px}.bag-list .list .bag-card p{font-size:.875rem;font-weight:500;line-height:1.375rem}@keyframes customAni{0%{transform:scale(1)}50%{transform:scale(1.1)}to{transform:scale(1)}}.big-quest{border-radius:.825rem;border:1px solid;padding:1.2rem}.big-quest .title{font-size:1.1rem;font-weight:700;line-height:1.5rem;margin-bottom:1rem}.big-quest .title span{margin-left:.4rem;font-weight:500;font-size:1rem}.big-quest .description{font-size:1rem;font-weight:500;line-height:1.5rem;margin-bottom:1rem;opacity:.8}.big-quest img{width:85px;height:auto;display:block;margin:auto;border-radius:.6rem}.big-quest .claim-big-quest{width:130px;height:44px;border-radius:.625rem;font-size:1rem;display:block;margin:auto;margin-top:2rem}.refetch-quest{width:1.5rem;height:1.5rem;cursor:pointer;display:flex;align-items:center;height:2.875rem}.refetch-quest img{width:100%;height:100%;object-fit:contain}.refetch-quest .chakra-spinner{width:1.3rem;height:1.3rem}.popup-buy{position:fixed;top:50%;left:50%;transform:translate(-50%) translateY(-50%);width:26.25rem;padding:1.07rem 1.25rem 1.88rem;border-radius:.625rem;z-index:2;border:1px solid}.popup-buy .popup-header{display:flex;justify-content:space-between;align-items:center;padding-bottom:1.9rem;border-bottom:1px solid}.popup-buy .popup-header .h-title{display:flex;gap:.3rem;align-items:center}.popup-buy .popup-header .h-title p{font-size:.875rem;font-weight:600;margin-top:4px}.popup-buy .popup-header .h-title img{width:1.5rem;object-fit:contain;height:1.5rem}.popup-buy .popup-header .close-popup{width:1.5rem;height:1.5rem;cursor:pointer}.popup-buy .popup-header .close-popup img{width:100%;height:100%;object-fit:contain}.popup-buy .popup-content{display:flex;gap:1.25rem;margin-top:1.45rem}.popup-buy .popup-content .item-img{width:8.75rem;height:8.75rem;border:1.5px solid rgba(0,0,0,.2);border-radius:.625rem;padding:.84rem;position:relative;display:flex;align-items:center;justify-content:center}.popup-buy .popup-content .item-img img{width:100%;height:100%;object-fit:contain}.popup-buy .popup-content .item-img .reward{position:absolute;bottom:4px;right:4px;font-weight:600}.popup-buy .popup-content .item-right{flex:1}.popup-buy .popup-content .item-right.inven{display:flex;flex-direction:column;justify-content:space-between}.popup-buy .popup-content .item-right .item-name{font-size:1.2rem;font-weight:700;margin-bottom:1rem}.popup-buy .popup-content .item-right .item-price{width:100%;display:flex;align-items:center;justify-content:space-between;margin-bottom:.7rem}.popup-buy .popup-content .item-right .item-price p{font-size:.85rem}.popup-buy .popup-content .item-right .item-price img{width:22px;height:22px;object-fit:contain}.popup-buy .popup-content .item-right .item-price div{display:flex;gap:.2rem;align-items:center}.popup-buy .popup-content .item-right .limit{width:100%;display:flex;align-items:center;justify-content:space-between}.popup-buy .popup-content .item-right .limit p{font-size:.85rem}.popup-buy .popup-content .item-right .button-buy{width:100%}.popup-buy .popup-content .item-right .button-buy button{width:100%;border-radius:.625rem;height:44px;font-size:1rem;display:flex;align-items:center;justify-content:center;gap:.2rem}.popup-buy .popup-content .item-right .button-buy button img{width:22px;height:22px;object-fit:contain}.popup-buy .popup-content .quantity{display:flex;justify-content:center;align-items:center;margin-top:.7rem}.popup-buy .popup-content .quantity img{width:1.5rem;height:1.5rem;object-fit:contain}.popup-buy .popup-content .quantity .input-quantity{width:6.3rem;height:1.625rem;display:flex;justify-content:space-between;align-items:center}.popup-buy .popup-content .quantity .input-quantity img{cursor:pointer;width:1rem;height:1rem}.popup-buy .popup-content .quantity .input-quantity input{outline:unset!important;height:1.625rem!important;border:none!important;width:2.875rem;padding:0!important;text-align:center}.popup-buy .popup-content .quantity .max{width:2.875rem;height:1.625rem;font-size:.75rem;font-weight:700;cursor:pointer;display:flex;justify-content:center;align-items:center;border-radius:.375rem}.popup-buy .footer{display:flex;gap:1rem;margin-top:.6rem;justify-content:center}.popup-buy .footer .quantity{width:8.75rem}.popup-buy .footer .button-buy{flex:1}.popup-buy .footer .button-buy button{width:100%;border-radius:.625rem;height:44px;font-size:1rem;display:flex;align-items:center;justify-content:center;gap:.2rem}.popup-buy .footer .button-buy button img{width:22px;height:22px;object-fit:contain}.overlay{position:fixed;width:100dvw;height:100dvh;background-color:#00000080;top:0;left:0;right:0;bottom:0;cursor:auto!important;transition:all .1s linear;z-index:1}.overlay-lv2{z-index:2}.custom-popup{position:fixed;top:50%;left:50%;transform:translate(-50%) translateY(-50%);width:26.25rem;padding:1.07rem 1.25rem 1.88rem;border-radius:.625rem;border:1px solid;z-index:2}.custom-popup .popup-header{display:flex;justify-content:space-between;align-items:center;padding-bottom:1.9rem;border-bottom:1px solid}.custom-popup .popup-header .h-title{display:flex;gap:.3rem;align-items:center}.custom-popup .popup-header .h-title p{font-size:.875rem;font-weight:600;margin-top:4px}.custom-popup .popup-header .h-title img{width:1.5rem;object-fit:contain;height:1.5rem}.custom-popup .popup-header .close-popup{width:1.5rem;height:1.5rem;cursor:pointer}.custom-popup .popup-header .close-popup img{width:100%;height:100%;object-fit:contain}.custom-popup .popup-content{display:flex;gap:1.238rem;margin-top:1.45rem}.custom-popup .popup-content .item-img{width:8.75rem;height:8.75rem;border:1.5px solid;border-radius:.625rem;padding:.84rem}.custom-popup .popup-content .item-img img{width:100%;height:100%;object-fit:contain}.custom-popup .popup-content .tools{flex:1;display:flex;flex-direction:column;justify-content:space-between}.custom-popup .popup-content .tools .name{font-size:1rem;font-weight:700;line-height:1.5rem;margin-bottom:1rem}.custom-popup .popup-content .tools .quantity{display:flex;justify-content:space-between;align-items:center}.custom-popup .popup-content .tools .quantity img{width:1.5rem;height:1.5rem;object-fit:contain}.custom-popup .popup-content .tools .quantity .input-quantity{width:fit-content;height:1.625rem;display:flex;justify-content:space-between;align-items:center;gap:8px}.custom-popup .popup-content .tools .quantity .input-quantity img{cursor:pointer;width:1rem;height:1rem}.custom-popup .popup-content .tools .quantity .input-quantity input{outline:unset!important;height:1.625rem!important;border:none!important;max-width:5rem;width:fit-content;padding:0!important;text-align:center}.custom-popup .popup-content .tools .quantity .max{width:2.875rem;height:1.625rem;font-size:.75rem;font-weight:700;cursor:pointer;display:flex;justify-content:center;align-items:center;border-radius:.375rem}.custom-popup .popup-content .tools .btn{width:100%;border-radius:.625rem;height:44px}.custom-popup .popup-footer{margin-top:29px;display:flex;justify-content:flex-end}.custom-popup .popup-footer .btn{width:100%;border-radius:.625rem;height:44px;width:192.5px}.custom-popup .footer{display:flex;justify-content:center;gap:1rem}.custom-popup .mint-vip-pass{padding:0 1.25rem;height:2.75rem;border-radius:.625rem;font-size:14px;font-weight:700;line-height:1.375rem;display:block;margin:auto}.custom-popup .mint-vip-pass-active{background:#faad14}.custom-popup .mint-vip-pass-active:hover{background:#faad14b3}.custom-popup .mint-vip-pass-disable{cursor:not-allowed;background-color:#e2e8f0;border:1px solid rgba(255,255,255,.2)}.tooltip{position:relative;width:fit-content;margin:auto}.tooltip:hover .title{display:block;padding:6px 12px;border:1px solid rgba(255,255,255,.2);border-radius:6px}.tooltip .title{text-wrap:nowrap;display:none;position:absolute;bottom:-40px;left:50%;transform:translate(-50%);z-index:3;width:fit-content}.wear-popup{position:fixed;top:50%;left:50%;transform:translate(-50%) translateY(-50%);width:40rem;padding:1.07rem 1.25rem 1.55rem;border-radius:.625rem;z-index:2;border:1px solid}.wear-popup .popup-header{display:flex;justify-content:space-between;align-items:center;padding-bottom:1.9rem;border-bottom:1px solid}.wear-popup .popup-header .h-title{display:flex;gap:.3rem;align-items:center}.wear-popup .popup-header .h-title p{font-size:.875rem;font-weight:600;margin-top:4px}.wear-popup .popup-header .h-title img{width:1.5rem;object-fit:contain;height:1.5rem}.wear-popup .popup-header .close-popup{width:1.5rem;height:1.5rem;cursor:pointer}.wear-popup .popup-header .close-popup img{width:100%;height:100%;object-fit:contain}.wear-popup .popup-content{display:flex;gap:1.23rem;margin-top:1.45rem}.wear-popup .popup-content .item-img{width:20rem;height:23.08425rem;border:1.5px solid;border-radius:.625rem;padding:1.1rem}.wear-popup .popup-content .item-img img{width:100%;height:100%;object-fit:contain}.wear-popup .popup-content .tools{flex:1}.wear-popup .popup-content .tools .name{font-size:1rem;font-weight:700;line-height:1.5rem;margin-bottom:1.28rem}.wear-popup .popup-content .tools .list-skin{display:flex;gap:1.25rem;flex-wrap:wrap;margin-bottom:1.28rem}.wear-popup .popup-content .tools .list-skin .skin-item{position:relative;cursor:pointer;width:7.5rem;height:7.5rem;border-radius:.625rem;overflow:hidden;padding:1.7rem;transition:.2s;display:flex;justify-content:center;align-items:center}.wear-popup .popup-content .tools .list-skin .skin-item .image{width:100%!important;height:100%!important;object-fit:contain}.wear-popup .popup-content .tools .list-skin .skin-item .check{opacity:0;position:absolute;width:1.5rem;height:1.5rem;object-fit:contain;top:.6rem;left:.6rem;transition:.2s}.wear-popup .popup-content .tools .list-skin .skin-item.active{border-color:#52c41a!important;box-shadow:unset!important;transition:.2s}.wear-popup .popup-content .tools .list-skin .skin-item.active .check{opacity:1;transition:.2s}.wear-popup .popup-content .tools .btn{width:100%;border-radius:.625rem;height:2.75rem;margin-bottom:1.75rem}.pop-binding.popup-buy .popup-content{flex-direction:column;gap:5px}.pop-binding.popup-buy .popup-content .label{color:#fff;text-align:center;font-size:.875rem;font-weight:500;line-height:1.375rem;margin-bottom:1.2rem}.pop-binding.popup-buy .popup-content .label span{opacity:.7}.pop-binding.popup-buy .popup-content .label .poli{color:#ff1919;font-weight:700;opacity:1!important}.pop-binding.popup-buy .popup-content input{height:2.75rem!important;width:100%;border-radius:.625rem;text-align:center;background-color:transparent!important;border:1px solid}.pop-binding.popup-buy .popup-content .chakra-numberinput{width:100%}.pop-binding.popup-buy .popup-content .chakra-numberinput input{height:2.75rem!important;border-radius:.625rem;text-align:center;background-color:transparent!important}.pop-binding.popup-buy .footer{margin-top:1rem;flex-direction:column;gap:1.23rem;align-items:center}.pop-binding.popup-buy .footer .button-buy{width:100%}.pop-binding.popup-buy .footer .button-buy a:hover{text-decoration:none!important}.pop-binding.popup-buy .footer .button-buy button{font-size:.875rem;font-weight:700;height:2.75rem!important}.pop-binding.popup-buy .footer .sign-up{text-align:center;font-size:.85rem;font-weight:500;line-height:1.125rem}.pop-binding.popup-buy .footer .sign-up a{text-align:center;font-size:.85rem;font-weight:500;line-height:1.125rem;text-decoration:underline}.pop-binding.popup-buy .footer .how-to-get-code{color:#fff;text-align:center;font-size:.75rem;font-weight:500;line-height:1.125rem;text-decoration:underline}.pop-binding.popup-buy .wallet-note{margin-top:1rem}.pop-binding.popup-buy .wallet-note .wallet-warning{font-size:.8rem;font-weight:500;line-height:1.375rem;color:#ff1919}.pop-binding.popup-buy .wallet-note .chakra-checkbox__label p{font-size:.8rem;font-weight:500;line-height:1.1rem}.popup-buy.popup-show-reward{transition:all .3s ease}.popup-buy.popup-show-reward .popup-content{display:flex;flex-direction:column;gap:20px;align-items:center}.popup-buy.popup-show-reward .popup-content .item-img img{border-radius:10px}.popup-buy.popup-show-reward .popup-content .item-right .item-name{font-size:16px;text-align:center}.detail-balance{justify-content:flex-start!important}.detail-balance .btn-claim-disabled{opacity:.5;cursor:not-allowed;pointer-events:none}.modal-deposit .popup-content{margin-top:12px}.modal-deposit .popup-content .list-item{list-style:none;padding-top:0}.menu .menu-content.open-menu .login .wrapper-wallet{max-height:80dvh;overflow-y:auto;padding-bottom:50px}.menu .menu-content.open-menu .login .wrapper-wallet .home-tab{padding:0}.menu .menu-content.open-menu .login .wrapper-wallet .header{display:flex;justify-content:space-between;margin-bottom:28px;align-items:flex-start;gap:20px;padding:24px 20px;border-bottom:1px solid}.menu .menu-content.open-menu .login .wrapper-wallet .header.header-in-wallet{padding:0 20px;margin-top:20px}.menu .menu-content.open-menu .login .wrapper-wallet .header .left{display:flex;align-items:center;gap:5px;cursor:pointer}.menu .menu-content.open-menu .login .wrapper-wallet .header .left h1{text-wrap:nowrap}.menu .menu-content.open-menu .login .wrapper-wallet .header .right .balance{max-width:100%;gap:6px}.menu .menu-content.open-menu .login .wrapper-wallet .list-item{list-style:none!important}.menu .menu-content.open-menu .login .wrapper-wallet .list-item::marker{display:none!important}.menu .menu-content.open-menu .login .wrapper-wallet .extension-x .home-tab .infor-user{margin-top:20px;gap:4rem}.menu .menu-content.open-menu .login .wrapper-wallet .extension-x .chakra-form__error-message{font-size:11px}.menu .menu-content.open-menu .login .wrapper-wallet .extension-x .chakra-tabs .chakra-tabs__tab-panels .chakra-tabs__tab-panel{padding:0 16px!important}.menu .menu-content.open-menu .login .wrapper-wallet .extension-x .chakra-tabs .chakra-tabs__tablist{border:none;justify-content:center;overflow:hidden}.menu .menu-content.open-menu .login .wrapper-wallet .extension-x .chakra-tabs .chakra-tabs__tablist .chakra-tabs__tab{padding:12px 60px!important;font-size:16px;font-weight:600;border:none;margin-right:0}@media (max-width: 80rem){.menu .menu-content.open-menu .login .wrapper-wallet .extension-x .chakra-tabs .chakra-tabs__tablist .chakra-tabs__tab{font-size:.875rem}}.menu .menu-content.open-menu .login .wrapper-wallet .extension-x .import-wallet .import-display .chakra-tabs .chakra-tabs__tab-panels{padding:20px 16px}@media (max-width: 80rem){.menu .menu-content.open-menu .login .wallet-wrapper-fh{max-height:100vh!important}}.menu .menu-content.open-menu .login .wrapper-wallet .no-header .header-tab{display:none}.button-play-now{display:flex;align-items:center;justify-content:center;gap:10px;padding:0 10px;color:#fff;text-shadow:2px 2px rgb(116,116,116);text-transform:uppercase;cursor:pointer;border:solid 2px black;letter-spacing:1px;font-weight:600;font-size:17px;background-color:#fdd835;border-radius:50px;position:relative;overflow:hidden;transition:all .5s ease}.button-play-now:active{transform:scale(.9);transition:all .1s ease}.button-play-now__icon{transition:all .5s ease;z-index:2}.button-play-now__text{transition:all .5s ease;transition-delay:.3s}.button-play-now__text--now{position:absolute;left:0;transform:translate(-100%);transition:all .5s ease;z-index:2}.button-play-now:hover__icon{transform:scale(3) translate(50%)}.button-play-now:hover .button__text--now{transform:translate(10px);transition-delay:.3s}.button-play-now:hover .button__text--play{transform:translate(200%);transition-delay:.3s}.sasa-popup .home-tab{padding:1.25rem 1.25rem 0}.sasa-popup .chakra-tabs{margin-top:1.25rem}.sasa-popup .chakra-tabs .tab_list_popup{justify-content:space-around;border:unset}.sasa-popup .chakra-tabs .tab_list_popup button{width:50%}.sasa-popup .chakra-tabs .token{padding:16px;border-bottom:1px solid rgba(0,0,0,.1)}.sasa-popup .chakra-tabs .token:hover{background:#c8dddd}.sasa-popup .chakra-tabs .token .card-token{display:flex;justify-content:space-between;align-items:center;font-size:.875rem;font-weight:600}.sasa-popup .chakra-tabs .token .card-token .left{display:flex;align-items:center;gap:1rem}.sasa-popup .chakra-tabs .token .card-token .left .symbol,.sasa-popup .chakra-tabs .token .card-token .left .quantity{font-size:.875rem;font-weight:700;color:#000}.sasa-popup .chakra-tabs .token .card-token .right .convert{font-size:.875rem;font-weight:700}.sasa-popup .chakra-tabs .token .card-token .right .quantity{font-size:.875rem;font-weight:700;color:#000}.sasa-popup .chakra-tabs .token .card-token .right .skeleton{width:100px;height:16px;position:relative;background:#dfdfdf;overflow:hidden;border-radius:4px}.sasa-popup .chakra-tabs .token .card-token .right .skeleton:after{content:"";position:absolute;height:100%;width:100px;left:-100px;top:0;background:linear-gradient(to right,transparent,rgba(255,255,255,.4392156863),transparent);animation:reflect .8s ease-out infinite}.sasa-popup .chakra-tabs .token .card-token .right .skeleton.theme-dark{background:#505865}.sasa-popup .chakra-tabs .token .card-token img{width:1.875rem;height:1.875rem;object-fit:contain}.sasa-popup .chakra-tabs .token.theme-dark{border-bottom:1px solid rgba(255,255,255,.2)}.sasa-popup .chakra-tabs .token.theme-dark:hover{background:#2f313a}.sasa-popup .chakra-tabs .token.theme-dark .card-token .left .symbol,.sasa-popup .chakra-tabs .token.theme-dark .card-token .left .quantity,.sasa-popup .chakra-tabs .token.theme-dark .card-token .right .quantity{color:#fff}.sasa-popup .chakra-tabs .token.refresh-balance{border-bottom:none}.sasa-popup .chakra-tabs .token.refresh-balance:hover{background:inherit}.sasa-popup .chakra-tabs .token.refresh-balance .card-token{justify-content:center}.sasa-popup .chakra-tabs .token.refresh-balance .card-token .left{gap:10px}.sasa-popup .chakra-tabs .token.refresh-balance .card-token .left:hover{opacity:.8}@keyframes rotate{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.sasa-popup .chakra-tabs .token.refresh-balance .card-token .left img{width:24px;height:24px;cursor:pointer}.sasa-popup .chakra-tabs .token.refresh-balance .card-token .left img.img-rotate{animation:rotate 1s linear infinite}.sasa-popup .chakra-tabs .setting{padding-top:1px}.sasa-popup .chakra-tabs .setting .about-sasa{padding:0 1rem;margin-top:1rem}.sasa-popup .chakra-tabs .setting .about-sasa h1{font-size:.875rem;font-weight:500;margin-bottom:.375rem}.sasa-popup .chakra-tabs .setting .about-sasa .social{display:flex;justify-content:space-between}.sasa-popup .chakra-tabs .setting .about-sasa .social .item{width:50%;padding:.75rem 0;display:flex;justify-content:center;align-items:center;border-top:.0625rem solid;border-bottom:.0625rem solid;border-color:#0003;font-size:.875rem;cursor:pointer;font-weight:700;transition:.3s}.sasa-popup .chakra-tabs .setting .about-sasa .social .item:first-child{border:.0625rem solid;border-color:#0003;border-top-left-radius:.625rem;border-bottom-left-radius:.625rem}.sasa-popup .chakra-tabs .setting .about-sasa .social .item:last-child{border:.0625rem solid;border-color:#0003;border-top-right-radius:.625rem;border-bottom-right-radius:.625rem;border-left:none}.sasa-popup .chakra-tabs .setting .about-sasa .social .item:hover{background-color:#eff1f1}.sasa-popup .chakra-tabs .setting .actions h1{margin:1rem 0;padding:0 1rem;font-size:.875rem;font-weight:400}.sasa-popup .chakra-tabs .setting .actions .action{display:flex;gap:1rem;font-size:.875rem;font-weight:600;padding:.625rem 1rem;cursor:pointer;transition:.3s;border-bottom:.0625rem solid;align-items:center}.sasa-popup .chakra-tabs .setting .actions .action:hover{background:#c8dddd!important}.sasa-popup .chakra-tabs .setting.setting-dark .about-sasa .social .item{border-color:#ffffff1a!important}.sasa-popup .chakra-tabs .setting.setting-dark .about-sasa .social .item:first-child,.sasa-popup .chakra-tabs .setting.setting-dark .about-sasa .social .item:last-child{border-color:#ffffff1a!important}.sasa-popup .chakra-tabs .setting.setting-dark .about-sasa .social .item:hover,.sasa-popup .chakra-tabs .setting.setting-dark .actions .action:hover{background:#2f313a!important}.sasa-popup .chakra-tabs .chakra-tabs__tablist{border-bottom-width:2px!important;border-color:#0003;font-size:16px!important;overflow:hidden}.sasa-popup .chakra-tabs .chakra-tabs__tablist .chakra-tabs__tab{color:#00000080;position:relative;background-color:transparent}.sasa-popup .chakra-tabs .chakra-tabs__tablist .chakra-tabs__tab:active{background:inherit!important}.sasa-popup .chakra-tabs .chakra-tabs__tablist .chakra-tabs__tab[aria-selected=false]{background-color:transparent!important}.sasa-popup .chakra-tabs .chakra-tabs__tablist .chakra-tabs__tab[aria-selected=true]{color:#1890ff;font-weight:700;background:transparent!important}.sasa-popup .chakra-tabs .chakra-tabs__tablist .chakra-tabs__tab[aria-selected=true]:after{content:"";position:absolute;bottom:0;left:0;width:100%;height:3px;background:#1890ff}.sasa-popup .chakra-tabs.tab-dark .chakra-tabs__tablist{border-bottom-color:#fff3!important}.sasa-popup .chakra-tabs.tab-dark .chakra-tabs__tablist .chakra-tabs__tab{color:#ffffff80!important}.sasa-popup .chakra-tabs.tab-dark .chakra-tabs__tablist .chakra-tabs__tab[aria-selected=false]{background:transparent}.sasa-popup .chakra-tabs.tab-dark .chakra-tabs__tablist .chakra-tabs__tab[aria-selected=true]{color:#faad14!important;background-color:transparent!important}.sasa-popup .chakra-tabs.tab-dark .chakra-tabs__tablist .chakra-tabs__tab[aria-selected=true]:after{content:"";position:absolute;bottom:0;left:0;width:100%;height:3px;background:#faad14!important}.sasa-popup .chakra-tabs__tab-panel{padding:0 16px 16px;background:#13161b;border-top-right-radius:24px;border-top-left-radius:24px;margin-top:24px}.sasa-popup .tab-light .chakra-tabs__tab-panel{box-shadow:0 -1px 12px #00000026;background-color:#eff3f4}.password-empty{display:flex;align-items:center;justify-content:center;height:100%;padding-top:20px}.password-empty.reset-password{padding-top:0}.password-empty.change-password{display:block;padding-top:0!important}.password-empty.change-password .icon-back{cursor:pointer}.password-empty.change-password .container{padding-top:20px}.password-empty.change-password .container .chakra-form__label{font-size:.875rem;font-weight:600;margin-bottom:6px}.password-empty.change-password .container .chakra-form__error-message{font-size:10px;font-weight:500}.password-empty.change-password .container.theme-light .form-change-password{margin-top:20px}.password-empty.change-password .container.theme-light .form-change-password .chakra-input__right-element{height:100%}.password-empty.change-password .container.theme-light .chakra-form__label{color:#000;font-size:.875rem}.password-empty.change-password .container .list-step{margin-top:20px}.password-empty.change-password .container .list-step .item-step{display:flex;gap:.1875rem;font-size:14px}.password-empty .container{width:100%;padding:0 20px}.password-empty .container.theme-light .chakra-form-control .chakra-form__label{color:#000;font-size:.875rem}.password-empty .container .text-privatekey{padding:.75rem;border-radius:.375rem}.password-empty .container .warring{margin:2.5rem 0;display:flex;align-items:start;flex-direction:column;gap:.625rem}.password-empty .container .title{font-size:1.5rem;font-weight:600;margin-bottom:1rem;text-align:center}.password-empty .container .des{font-size:.875rem;font-weight:500;margin-bottom:1.875rem;text-align:center}.password-empty .container .des .warning{color:#d21d21;font-weight:500}.password-empty .container .form-change-password .list-step-create-pass{display:flex;flex-direction:column;gap:.625rem;margin-top:.625rem}.password-empty .container .form-change-password .list-step-create-pass.theme-dark .item span{color:#ffffff80}.password-empty .container .form-change-password .list-step-create-pass.theme-dark .item.success span{color:#fff}.password-empty .container .form-change-password .list-step-create-pass .item-step{display:flex;align-items:center;gap:.3125rem}.password-empty .container .chakra-form-control{margin-bottom:2.2rem}.password-empty .container .chakra-form-control .chakra-form__label{color:#fff;margin-bottom:6px}.password-empty .container .chakra-form-control .chakra-input{height:3.125rem;border-radius:.625rem}.password-empty .container .chakra-form-control .chakra-input[aria-invalid=true]{border-color:#e53e3e!important}.password-empty .container .chakra-form-control .wra-input input{max-width:100%}.password-empty .container .chakra-form-control .wra-input input[aria-invalid=true]{border-color:#e53e3e!important}.password-empty .btn-submit-form.disable{opacity:.5;cursor:not-allowed;pointer-events:none}.password-empty.export-wallet .des-in-x{color:#000;font-size:14px;width:fit-content;margin:10px auto 30px}.sasa-popup{min-height:37.5rem;width:22.5rem;margin:auto}.sasa-popup.extension-x{width:100%!important}.sasa-popup.not-logged{height:37.5rem}.sasa-popup .btn-submit-form{background:#1890ff;color:#fff;margin:auto;display:flex;align-items:center;font-size:.875rem;font-weight:700;padding:.25rem 1.375rem;height:2.75rem;border-radius:.625rem}.sasa-popup .btn-submit-form:hover:disabled{color:#000}.sasa-popup .header{display:flex;align-items:center;justify-content:space-between;padding:1.125rem}.sasa-popup .header .left{display:flex;align-items:center;gap:.625rem}.sasa-popup .header .left span{font-size:.875rem;font-weight:600}.sasa-popup .logo-polygon{width:1.5rem;height:1.5rem;object-fit:contain}.sasa-popup .logo-sasa{max-width:10.25rem}.sasa-popup .button-login{margin-top:1.25rem;padding:.75rem 1.25rem;border-radius:.5rem;font-family:Sora,sans-serif;font-weight:700;font-size:1rem}.sasa-popup .button-login:hover{cursor:pointer;background:gray;color:#fff;opacity:.8}.sasa-popup .no-auth{display:flex;flex-direction:column;justify-content:center;align-items:center;height:100%}.sasa-popup .logo-saw{width:10rem;height:5rem}.sasa-popup .infor-user{display:flex;align-items:center;gap:.625rem;flex-direction:column}.sasa-popup .infor-user .bnb-balance{position:relative;width:192px;height:192px}.sasa-popup .infor-user .bnb-balance.bnb-balance-popup .circle:after{width:calc(100% - 4px);height:calc(100% - 4px)}.sasa-popup .infor-user .bnb-balance.theme-light .circle:after{background:#fff}.sasa-popup .infor-user .bnb-balance.theme-light .circle-1{background:#dde7ff}.sasa-popup .infor-user .bnb-balance.theme-light .circle-1:after{background:#dde7ff}.sasa-popup .infor-user .bnb-balance .circle{position:absolute;border-radius:100%;top:50%;left:50%;transform:translate(-50%,-50%);opacity:.5}.sasa-popup .infor-user .bnb-balance .circle:after{content:"";width:calc(100% - 4px);height:calc(100% - 4px);position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);border-radius:100%;padding:.0625rem;background:#000}.sasa-popup .infor-user .bnb-balance .circle-4{background:linear-gradient(180deg,#5471ad4d,#5471ad);width:192px;height:192px}.sasa-popup .infor-user .bnb-balance .circle-3{width:144px;height:144px;background:linear-gradient(180deg,#5471ad,#5471ad1a 79.25%)}.sasa-popup .infor-user .bnb-balance .circle-2{width:110px;height:110px;background:linear-gradient(180deg,#5471ad4d,#5471ad)}.sasa-popup .infor-user .bnb-balance .circle-1{width:76px;height:76px}.sasa-popup .infor-user .bnb-balance .circle-1:after{background:#60a5fa66}.sasa-popup .infor-user .bnb-balance .balance{position:absolute;border-radius:100%;top:50%;left:50%;transform:translate(-50%,-50%);font-size:1.5rem;font-weight:700;text-wrap:nowrap;max-width:100%}.sasa-popup .infor-user .bnb-balance .balance .inj{display:flex;gap:6px}@keyframes reflect{to{left:calc(100% + 100px)}}.sasa-popup .infor-user .bnb-balance .balance .skeleton{width:100px;height:26px;position:relative;background:#dfdfdf;overflow:hidden;border-radius:4px}.sasa-popup .infor-user .bnb-balance .balance .skeleton:after{content:"";position:absolute;height:100%;width:100px;left:-100px;top:0;background:linear-gradient(to right,transparent,rgba(255,255,255,.4392156863),transparent);animation:reflect .8s ease-out infinite}.sasa-popup .infor-user .bnb-balance .balance .skeleton.theme-dark{background:#505865}.sasa-popup .infor-user .avatar img{width:4.125rem;height:4.125rem;object-fit:contain;border-radius:100%;margin-top:1.25rem}.sasa-popup .infor-user .name{font-size:.875rem;font-weight:700}.sasa-popup .infor-user .address{font-size:.875rem;font-weight:700;display:flex;gap:.375rem;align-items:center}.sasa-popup .infor-user .address img{width:1.5rem;height:1.5rem;object-fit:contain;cursor:pointer}.sasa-popup .infor-user .copy-wrapper{position:relative;width:fit-content;height:fit-content}.sasa-popup .infor-user .copy-tooltip{position:absolute;visibility:hidden;opacity:0;padding:.4375rem;top:-2.1875rem;left:50%;transform:translate(-50%);border-radius:.4375rem;font-size:.75rem;background:#fff;transition:opacity .3s ease;border:.0625rem solid #000}.sasa-popup .infor-user .copy-tooltip.theme-dark{color:#000}.sasa-popup .infor-user .tooltip-show{opacity:1;visibility:visible}.sasa-popup .infor-user .deposit-withdraw{display:flex;gap:2rem;align-items:center}.sasa-popup .infor-user .deposit-withdraw .wrapper-btn{display:flex;flex-direction:column;align-items:center;justify-content:center}.sasa-popup .infor-user .deposit-withdraw .wrapper-btn p{margin-top:.5rem;font-size:1rem;font-weight:500}.sasa-popup .infor-user .deposit-withdraw .btn-transfer{border:none;border-radius:1rem;background-color:#fff;gap:.3125rem;transition:.3s;width:3.5rem;height:3.5rem;display:flex;justify-content:center;align-items:center}.sasa-popup .infor-user .deposit-withdraw .btn-transfer p{font-size:.875rem;font-weight:700;margin:0}.sasa-popup .infor-user .deposit-withdraw .btn-transfer img{width:1.5rem;height:1.5rem;object-fit:contain;object-position:center}.sasa-popup .infor-user .deposit-withdraw .btn-transfer:hover{background:#fff!important}.sasa-popup .infor-user .deposit-withdraw.theme-dark .btn-transfer:hover{background:#434557!important}.sasa-popup .form-control-password{position:relative}.sasa-popup .form-control-password .chakra-form__error-message{font-size:.625rem;position:absolute;font-weight:500}.sasa-popup .form-control-password .chakra-input{padding-right:2.75rem}.sasa-popup .form-control-password .chakra-input__right-element{height:3.125rem;width:3.125rem}.sasa-popup .form-control-password .chakra-input__right-element .chakra-button{background:none}.sasa-popup .form-control-password .list-step{display:flex;flex-direction:column;gap:.625rem;margin-top:.625rem}.sasa-popup .form-control-password .list-step.theme-dark .item span{color:#ffffff80}.sasa-popup .form-control-password .list-step.theme-dark .item.success span{color:#fff}.sasa-popup .form-control-password .list-step .item{display:flex;align-items:center;gap:.3125rem}.modal-password-empty .form-control-password{position:relative}.modal-password-empty .form-control-password .chakra-form__error-message{font-size:.625rem;position:absolute;font-weight:500}.modal-password-empty .form-control-password .chakra-input{padding-right:2.75rem}.modal-password-empty .form-control-password .chakra-input__right-element{height:3.125rem;width:3.125rem}.modal-password-empty .form-control-password .chakra-input__right-element .chakra-button{background:none}.modal-password-empty .form-control-password .list-step{display:flex;flex-direction:column;gap:.625rem;margin-top:.625rem}.modal-password-empty .form-control-password .list-step.theme-dark .item span{color:#ffffff80}.modal-password-empty .form-control-password .list-step.theme-dark .item.success span{color:#fff}.modal-password-empty .form-control-password .list-step .item{display:flex;align-items:center;gap:.3125rem}.custom-modal-sasa{position:fixed;top:50%;left:50%;transform:translate(-50%) translateY(-50%);width:auto;padding:1.07rem 1.25rem 1.88rem;border-radius:.625rem;z-index:2;border:.0625rem solid}.custom-modal-sasa .popup-header{display:flex;justify-content:space-between;align-items:center}.custom-modal-sasa .popup-header .h-title{display:flex;gap:.3rem;align-items:center}.custom-modal-sasa .popup-header .h-title p{font-size:.875rem;font-weight:600;margin-top:.25rem}.custom-modal-sasa .popup-header .h-title img{width:1.5rem;object-fit:contain;height:1.5rem}.custom-modal-sasa .popup-header .close-popup{width:1.5rem;height:1.5rem;cursor:pointer}.custom-modal-sasa .popup-header .close-popup img{width:100%;height:100%;object-fit:contain}.custom-modal-sasa .popup-content{display:flex;gap:1.25rem;margin-top:1.45rem}.custom-modal-sasa .footer{display:flex;gap:1rem;margin-top:.6rem;justify-content:center}.modal-confirm-withdraw-sasa{width:20rem}.modal-confirm-withdraw-sasa .popup-content{margin-top:.625rem}.modal-confirm-withdraw-sasa .popup-content .des{margin:1.25rem 0!important}.modal-deposit{width:26.25rem}.modal-select-type-transfer .custom-modal{flex-direction:column}.modal-select-type-transfer .custom-modal .group-btn{display:flex;justify-content:center;gap:16px}.modal-select-type-transfer .custom-modal .tooltip{margin:unset}.modal-select-type-transfer .custom-modal .tooltip .title{top:-88%;bottom:unset}.tab-transfer .header-tab{padding:.75rem 0rem;position:relative}.tab-transfer .header-tab .icon-back{position:absolute;left:0;top:50%;left:1.25rem;transform:translateY(-50%)}.tab-transfer .transfer-sasa-wallet{padding:0 20px}.tab-transfer .title{text-align:center;font-size:1rem;font-weight:700;margin:0}.tab-transfer .icon-back{cursor:pointer}.tab-transfer .list-item{padding:0 1.25rem;padding-top:24px}.tab-transfer .list-item .sub-title{color:#000;font-size:14px;width:fit-content;margin:10px auto 30px;text-align:center}.tab-transfer .list-item.theme-dark .item .qr{border:none}.tab-transfer .list-item .address .value{width:95%;text-overflow:ellipsis;white-space:nowrap;overflow:hidden}.tab-transfer .list-item .address .copy-wrapper{padding-right:0}.tab-transfer .item{margin-bottom:1.875rem}.tab-transfer .item .label{font-size:.875rem;font-weight:700;margin-bottom:.25rem}.tab-transfer .item .tag{border:.0625rem solid rgb(209,217,221);border-radius:.625rem;display:flex;align-items:center;gap:.75rem;padding:1rem}.tab-transfer .item .tag img{width:1.875rem;height:1.875rem}.tab-transfer .item .tag span{font-size:.875rem;font-weight:700}.tab-transfer .item .address{display:flex;align-items:center;font-size:.875rem;border-radius:.625rem;justify-content:space-between;padding:0 1.125rem;border-width:1px}.tab-transfer .item .address .copy-tooltip{position:absolute;visibility:hidden;opacity:0;padding:.4375rem;top:-2.1875rem;left:44%;transform:translate(-50%);border-radius:.4375rem;font-size:.75rem;background:#fff;transition:opacity .3s ease;border:.0625rem solid #000;color:#000}.tab-transfer .item .address .tooltip-show{opacity:1;visibility:visible}.tab-transfer .item .address .copy-wrapper{width:fit-content;text-align:center;color:#fff;padding:1.125rem 1rem;border-top-right-radius:1rem;border-bottom-right-radius:1rem;font-size:.875rem;font-weight:700;cursor:pointer;position:relative;text-wrap:nowrap}.tab-transfer .item .qr{margin:auto;display:flex;align-items:center;justify-content:center;width:fit-content;border-radius:.875rem;border:.0625rem solid rgb(209,217,221);overflow:hidden}.tab-transfer .item .qr img{width:12.5rem;height:12.5rem}.tab-transfer .item-step{margin-bottom:0}.tab-transfer .form.form-dark .address::placeholder{color:#ffffff80}.tab-transfer .form.form-dark .form-group-amount .amount::placeholder{color:#ffffff80}.tab-transfer .form .address{margin-bottom:1rem;height:3.125rem;border-radius:.625rem}.tab-transfer .form .address::placeholder{color:#00000080}.tab-transfer .form .form-group-amount{display:flex;border-width:.0625rem;border-radius:.375rem;padding-right:.75rem;align-items:center;height:3.125rem;border-radius:.625rem;justify-content:space-between;margin-bottom:1rem}.tab-transfer .form .form-group-amount .amount{width:65%;border:none;box-shadow:none}.tab-transfer .form .form-group-amount .amount::placeholder{color:#00000080}.tab-transfer .form .balance{margin-top:.875rem;text-align:right;font-size:.75rem}.chakra-modal__content-container .custom-modal .chakra-modal__header{font-size:.875rem}.chakra-modal__content-container .custom-modal .des{font-size:.875rem;text-align:center;color:#00000080;margin:40px 0}.chakra-modal__content-container .custom-modal .chakra-modal__footer .chakra-button{font-size:.875rem}.chakra-modal__content-container .custom-modal .footer-notice{justify-content:space-between;gap:1.25rem}.chakra-modal__content-container .custom-modal .footer-notice .btn-submit-form{width:50%}.chakra-modal__content-container .custom-modal.modal-noti-error{background-color:inherit}.chakra-modal__content-container .custom-modal.modal-noti-error .des{color:#e53e3e;font-size:14px}.chakra-modal__content-container .custom-modal.modal-noti-success{width:220px;justify-content:center;background-color:inherit}.chakra-modal__content-container .custom-modal.modal-noti-success .des{color:#0084ff;font-size:14px}.chakra-modal__content-container .custom-modal.modal-loading-tx{width:fit-content}.chakra-modal__content-container .custom-modal.modal-loading-tx .chakra-modal__body{display:flex;justify-content:center;flex-direction:column;align-items:center;gap:1.25rem}.chakra-modal__content-container .custom-modal.modal-loading-tx .chakra-modal__body .des{margin-top:.25rem}.chakra-modal__content-container .custom-modal.modal-transaction-success,.chakra-modal__content-container .custom-modal.modal-transaction-success .chakra-modal__body{display:flex;flex-direction:column;align-items:center}.chakra-modal__content-container .custom-modal.modal-transaction-success .chakra-modal__body .img-transaction{width:7.5rem;height:7.5rem}.chakra-modal__content-container .custom-modal.modal-transaction-success .chakra-modal__body .title{font-size:1.25rem;font-weight:700;margin-bottom:1rem;text-align:center;margin-top:1.25rem;margin-bottom:.375rem}.chakra-modal__content-container .custom-modal.modal-transaction-success .chakra-modal__body .des{font-size:.875rem}.chakra-modal__content-container .custom-modal.modal-transaction-success .chakra-modal__body .hash{color:#fff;padding:.125rem .25rem;display:flex;margin-top:.375rem;align-items:center;gap:.25rem}.chakra-modal__content-container .custom-modal.modal-transaction-success .chakra-modal__body .hash p{font-weight:700;font-size:.875rem;max-width:100%;text-wrap:wrap;text-align:center;display:block;color:#1890ff;text-decoration:underline;cursor:pointer}.chakra-modal__content-container .custom-modal.modal-transaction-success .chakra-modal__body .hash .hash-text{white-space:nowrap}.chakra-modal__content-container .custom-modal.modal-transaction-success .chakra-modal__body .hash .icon-external-link{cursor:pointer}.chakra-modal__content-container .btn-submit-form{padding:.625rem 1.25rem;border-radius:.625rem;background:#1890ff!important;color:#fff;font-weight:700}.chakra-modal__content-container .btn-submit-form:hover{background:#3ea0fc!important}.chakra-modal__content-container .btn-submit-form:focus-visible{box-shadow:none}.chakra-modal__content-container .btn-reject{border:1px solid rgb(24,144,255)!important;background:#fff!important;color:#00000080}.chakra-modal__content-container .btn-reject:hover{background:#ff373766!important;border:1px solid transparent!important}.chakra-modal__content-container .theme-dark{background-color:#000}.chakra-modal__content-container .theme-dark .chakra-modal__header{color:#fff;border-bottom:.0625rem solid rgba(255,255,255,.1)}.chakra-modal__content-container .theme-dark .chakra-modal__body .des{color:#ffffff80}.chakra-modal__content-container .theme-dark.modal-transaction-success .chakra-modal__body .title,.chakra-modal__content-container .theme-dark.modal-transaction-success .chakra-modal__body .des{color:#fff}.chakra-modal__content-container .theme-dark.modal-transaction-success .chakra-modal__body .hash p{color:#faad14}.chakra-modal__content-container .theme-dark .btn-submit-form{background:#faad14;color:#000;font-weight:400}.deposit-withdraw-to-pool .title{color:#141536;margin-bottom:4px;font-weight:700;font-size:16px;text-align:start}.deposit-withdraw-to-pool .sub-title{color:#8c8c8c;margin-bottom:40px;text-align:start;font-size:14px}.deposit-withdraw-to-pool .group-address{border:1px solid;border-color:#d9d9d9;background-color:#fff;padding:4px;border-radius:16px;display:flex;flex-direction:column;gap:4px;position:relative}.deposit-withdraw-to-pool .group-address .group-arrow{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);border:1px solid;border-color:#d9d9d9;background-color:#fff;border-radius:50%;display:flex;justify-content:center;align-items:center;padding:6px}.deposit-withdraw-to-pool .group-address .group-arrow img{width:24px;height:24px}.deposit-withdraw-to-pool .group-address .from-address{background:#f7f9f9;padding:16px 24px;border-radius:14px;height:80px}.deposit-withdraw-to-pool .group-address .from-address:first-child{padding-bottom:30px}.deposit-withdraw-to-pool .group-address .from-address:nth-child(2){padding-top:20px}.deposit-withdraw-to-pool .group-address .from-address .name{color:#595959;font-weight:400;font-size:16px;margin-bottom:4px}.deposit-withdraw-to-pool .group-address .from-address .address{color:#8c8c8c;font-size:14px}.deposit-withdraw-to-pool .form .first-form{margin:12px 0;display:flex;gap:8px;align-items:flex-end}.deposit-withdraw-to-pool .form .first-form .amount{flex-grow:1}.deposit-withdraw-to-pool .form .first-form .amount .label{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px}.deposit-withdraw-to-pool .form .first-form .amount .label h3{font-size:14px;font-weight:700;color:#000}.deposit-withdraw-to-pool .form .first-form .amount .label p{color:#00000073;font-size:12px;font-weight:400}.deposit-withdraw-to-pool .form .first-form .amount .confirm-value{display:flex;gap:8px;align-items:center;border-radius:16px}.deposit-withdraw-to-pool .form .first-form .amount .confirm-value .amount{padding:15px;border-radius:16px;height:56px;font-size:16px;font-weight:400;color:#000;outline:none;box-shadow:none!important}.deposit-withdraw-to-pool .form .first-form .currency .select-currency{border:2px solid #d9d9d9;border-radius:16px;width:130px;height:56px;padding-right:6px}.deposit-withdraw-to-pool .form .first-form .currency .select-currency .react-select__control{height:100%}.deposit-withdraw-to-pool .form .first-form .currency .select-currency .react-select__value-container{padding:0}.deposit-withdraw-to-pool .form .note .chakra-checkbox__control{border-width:1px;border-color:#d9d9d9;border-radius:4px}.deposit-withdraw-to-pool .form .note .chakra-checkbox__label{color:#000000d9;font-size:14px;font-weight:400}.deposit-withdraw-to-pool .form .note .theme-dark svg{color:#000}.deposit-withdraw-to-pool .form .group-btn{display:flex;gap:20px;margin-top:20px}.deposit-withdraw-to-pool .form .group-btn .cancel{border:1px solid}.deposit-withdraw-to-pool .form .group-btn .cancel.theme-light:hover{opacity:.6}.deposit-withdraw-to-pool .form .group-btn .cancel:hover{opacity:.8}.deposit-withdraw-to-pool .form .group-btn .btn-submit-form{font-size:14px;font-weight:500;padding:0 26px;height:44px;border-radius:10px}.deposit-withdraw-to-pool .form .group-btn .btn-submit-form.submit .chakra-button__spinner{display:none}.deposit-withdraw-to-pool.theme-dark .title{color:#fff}.deposit-withdraw-to-pool.theme-dark .sub-title{color:#ffffffb3}.deposit-withdraw-to-pool.theme-dark .group-address{background-color:#000;border-color:#fff3}.deposit-withdraw-to-pool.theme-dark .group-address .from-address{background:#0d0e12}.deposit-withdraw-to-pool.theme-dark .group-address .from-address .name{color:#fff}.deposit-withdraw-to-pool.theme-dark .group-address .from-address .address{color:#ffffffb3}.deposit-withdraw-to-pool.theme-dark .group-address .group-arrow{background-color:#000}.deposit-withdraw-to-pool.theme-dark .form .first-form .amount .label h3{color:#fff}.deposit-withdraw-to-pool.theme-dark .form .first-form .amount .label p{color:#ffffff73}.deposit-withdraw-to-pool.theme-dark .form .currency .select-currency{border:2px solid rgba(255,255,255,.2)}.deposit-withdraw-to-pool.theme-dark .note .chakra-checkbox__control{background-color:#fff}.deposit-withdraw-to-pool.theme-dark .note .chakra-checkbox__label{color:#ffffffd9}.select-currency{flex-shrink:1;flex-grow:1;border:none}.select-currency.select-light .react-select__menu{overflow:hidden;border-color:#d1d9dd}.select-currency.select-dark .react-select__menu{overflow:hidden;border:2px solid;border-color:#fff3}.select-currency .react-select__menu{border:1px solid}.select-currency.select-currency-extension{max-width:122px}.select-currency .react-select-listbox-custom{padding:0;border-radius:.375rem;overflow:hidden}.select-currency .react-select-listbox-custom .react-select-listbox-custom-item{overflow:hidden}.select-currency.select-dark .react-select-listbox-custom-item{background-color:#0d0e12;cursor:pointer}.select-currency.select-dark .react-select-listbox-custom-item[aria-selected=true]{background-color:#383838}.select-currency.select-light .react-select-listbox-custom-item{background-color:#eff1f1;cursor:pointer}.select-currency.select-light .react-select-listbox-custom-item[aria-selected=true]{background-color:#d3d3d3}.select-item{display:flex;align-items:center;gap:.375rem;padding:.5rem .75rem;overflow:hidden;width:93px}.select-item img{width:1.5rem;height:1.5rem}.import-wallet{min-height:37.5rem;display:flex;flex-direction:column;align-items:center;justify-content:center}.import-wallet button:hover{opacity:.8}.import-wallet .import-display{position:absolute;width:100%;height:100%;top:0;transition:.3s linear;background-color:#000}.import-wallet .import-display.theme-dark .chakra-tabs__tablist button[aria-selected=true]{color:#faad14!important}.import-wallet .import-display.theme-dark .chakra-tabs__tablist button[aria-selected=false]{color:#ffffff80!important}.import-wallet .import-display .import-header{display:flex;align-items:center;gap:1rem;padding:1rem}.import-wallet .import-display .import-header .heading{flex:1;width:calc(100% - 40px - 1rem);text-align:center;font-size:1.25rem;font-weight:600;color:#fff}@media (max-width: 400px){.import-wallet .import-display .import-header .heading{font-size:16px}}.import-wallet .import-display .import-header button{border-radius:50%;padding:0}.import-wallet .import-display .import-header button:hover{opacity:.8}.import-wallet .import-display .import-header button .chakra-icon{width:2rem;height:2rem}.import-wallet .import-display .chakra-tabs{padding:0 20px}.import-wallet .import-display .chakra-tabs__tablist{justify-content:center}.import-wallet .import-display .chakra-tabs__tablist button{font-size:14px!important}.import-wallet .import-display .chakra-tabs__tablist button[aria-selected=true]{color:#1890ff!important}.import-wallet .import-display .chakra-tabs__tab-panels{background-color:#13161b;padding:1rem;border-radius:1rem;margin-top:1rem}@media (max-width: 400px){.import-wallet .import-display .chakra-tabs__tab-panels{margin-top:0}}.import-wallet .import-display .chakra-tabs__tab-panels .chakra-tabs__tab-panel{background-color:transparent;margin-top:1rem;padding:0}.import-wallet .import-display .chakra-tabs__tab-panels button.disable{opacity:.5;cursor:not-allowed;pointer-events:none}.import-wallet .import-display .seed-pharse{display:flex;flex-wrap:wrap;width:100%}.import-wallet .import-display .seed-pharse .input-text{display:flex;align-items:center;padding:.5rem;max-width:33.3333333333%;justify-content:space-between}.import-wallet .import-display .seed-pharse .input-text label{text-wrap:nowrap;display:block}.import-wallet .import-display .seed-pharse .input-text input{width:78%;height:3rem;border-radius:.625rem}@media (max-width: 400px){.import-wallet .import-display .seed-pharse .input-text input{height:2.5rem}}.import-wallet .import-display .input-key{height:3.125rem;border-radius:.625rem}.import-wallet .import-display.theme-light .chakra-tabs .chakra-tabs__tab-panels{background:#f7f9f9}.modal-confirm-create-wallet{max-width:360px}.modal-confirm-create-wallet .des{margin:20px 0!important}.modal-confirm-create-wallet .btn-submit-form{display:flex;align-items:center;margin:unset}.maintain-container{width:100%;height:80vh;display:flex;flex-direction:column;justify-content:center;align-items:center}.maintain-container .img-maintain{object-fit:cover}.maintain-container .text-maintain{padding:0 20px;font-size:1.5rem;font-weight:700;text-align:center}.theme-light .text-maintain{color:#000000b3}.theme-dark .text-maintain{color:#fff}.swap-tab .form{position:relative}.swap-tab .form .balance{text-align:left}.swap-tab .form .form-group-amount{height:6rem!important}.swap-tab .form .form-group-amount .amount{text-align:right;width:50%}.swap-tab .form .amount-above{border-radius:.625rem .625rem 0 0;margin-top:4px;border-bottom:none}.swap-tab .form .amount-below{border-radius:0 0 .625rem .625rem}.swap-tab .form .icon-swap{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);border-width:1px;padding:4px;width:40px;height:40px;border-radius:100%;display:flex;justify-content:center;align-items:center;cursor:pointer}.swap-tab .estimate-fee{float:right;margin:12px 0}.swap-tab .your-balance{font-size:12px;opacity:.5;padding:0 12px}.verify-email{position:absolute;top:0;bottom:0;width:100%;height:100vh!important;max-height:unset!important}.verify-email .right{display:none!important}.verify-email img{margin:auto auto 60px}.verify-email .theme-light label,.verify-email .theme-light input{color:#000}.verify-email .theme-dark label,.verify-email .theme-dark input{color:#fff}.verify-email .form-verify-email{padding:0 2.55rem}.verify-email .form-verify-email .label-form{margin-bottom:20px}.verify-email .form-verify-email .label-form label{font-size:14px}.verify-email .form-verify-email input{height:45px;border-radius:10px}.verify-email .form-verify-email button{width:100%;margin-top:30px!important;height:38px;border-radius:10px;background-color:#1890ff!important;color:#fff!important}.verify-email .send-otp .form-verify-email .box-title,.verify-email .send-otp .form-verify-email .box-title-success{text-align:start;margin-bottom:40px;font-size:14px;width:75%}.verify-email .send-otp .form-verify-email .box-title .title,.verify-email .send-otp .form-verify-email .box-title .title-success,.verify-email .send-otp .form-verify-email .box-title-success .title,.verify-email .send-otp .form-verify-email .box-title-success .title-success{font-weight:700;margin-bottom:20px}.verify-email .send-otp .form-verify-email .box-title-success{text-align:center;width:100%}.verify-email .send-otp .form-verify-email .box-title-success .title-success{font-size:20px!important}.verify-email .send-otp .form-verify-email input{width:100px;border-radius:unset;font-weight:700;font-size:16px}.verify-email .send-otp .form-verify-email input.first{border-radius:10px 0 0 10px}.verify-email .send-otp .form-verify-email input.last{border-radius:0 10px 10px 0}.verify-email .send-otp .form-verify-email button{margin-top:0!important}.verify-email .send-otp .form-verify-email .text-resend,.verify-email .send-otp .form-verify-email .text-change-email{color:#1890ff;font-size:14px;cursor:pointer}.verify-email .send-otp .form-verify-email .text-resend{margin:40px 0 20px}.verify-email .send-otp .form-verify-email .text-change-email{margin-top:20px}.verify-email .disable{opacity:.7;cursor:default!important}.home{margin-top:20px;display:flex;flex-direction:column;justify-content:space-between;height:96%}@media (max-height: 800px){.home{max-height:70dvh}}.home .list-card-balance{display:flex;padding-top:20px;gap:22px;justify-content:flex-start;flex-wrap:wrap;margin-bottom:30px;align-items:stretch}@media (max-width: 80rem){.home .list-card-balance{gap:15.2px}}.home .list-card-balance .card-balance{height:11.875rem;width:calc(33.333% - 15px);display:flex;flex-direction:column;align-items:center;justify-content:flex-start;padding:16px 2px;border-radius:10px;text-align:center;border:1px solid}@media (max-width: 80rem){.home .list-card-balance .card-balance{height:11.5rem;width:calc(33.333% - 11px)}}.home .list-card-balance .card-balance.theme-dark .text-transfer{color:#faad14}.home .list-card-balance .card-balance.theme-dark .balance.ap{color:#fff}.home .list-card-balance .card-balance .img-currency{width:auto;height:3.125rem}@media (max-width: 80rem){.home .list-card-balance .card-balance .img-currency{height:2.5rem}}.home .list-card-balance .card-balance .name-balance{font-size:14px;font-weight:500;color:#000000b3;margin-top:10px;margin-bottom:10px}@media (max-width: 80rem){.home .list-card-balance .card-balance .name-balance{font-size:12px}}.home .list-card-balance .card-balance .balance{font-size:24px;font-weight:700;max-width:100%;line-height:32px}@media (max-width: 80rem){.home .list-card-balance .card-balance .balance{font-size:20px}}.home .list-card-balance .card-balance .balance.gold{color:#faad14}.home .list-card-balance .card-balance .balance.snowflake{color:#722ed1}.home .list-card-balance .card-balance .balance.asg{color:#1890ff}.home .list-card-balance .card-balance .balance.sae{color:#eb2f96}.home .list-card-balance .card-balance .balance.usdt{color:#50ac56}.home .list-card-balance .card-balance .balance.ap{color:#000}.home .list-card-balance .card-balance .balance.gem{color:#fa0a0a}.home .list-card-balance .card-balance .text-transfer{color:#1890ff;text-decoration:underline;font-size:14px;font-weight:500;background:none}@media (max-width: 80rem){.home .list-card-balance .card-balance .text-transfer{font-size:12px}}.home .my-pet{display:flex;gap:.9rem;margin-bottom:2.51rem}.home .my-pet .pet-image{width:11.125rem;height:auto;border:1px solid;border-radius:.625rem}@media (max-width: 80rem){.home .my-pet .pet-image{width:8.5rem;height:100%}}.home .my-pet .pet-image img{width:100%;height:100%;object-fit:cover}.home .my-pet .pet-image canvas{pointer-events:none}@media (max-width: 80rem){.home .my-pet .pet-image canvas{width:10.5rem!important;height:12rem!important}}.home .my-pet .copy-wrapper{position:relative;width:fit-content;height:fit-content;cursor:pointer}.home .my-pet .copy-wrapper img{width:20px}.home .my-pet .copy-wrapper .copy-tooltip{position:absolute;visibility:hidden;opacity:0;padding:7px;top:-35px;left:50%;transform:translate(-50%);border-radius:7px;font-size:12px;background:#1d293d;color:#fff;transition:opacity .3s ease}.home .my-pet .copy-wrapper .tooltip-show{opacity:1;visibility:visible}.home .my-pet .pet-info{flex:1;display:flex;flex-direction:column;gap:4px;align-items:flex-start;width:100%;justify-content:space-between}.home .my-pet .pet-info .text-binding{font-size:12px;color:#1890ff;display:flex;justify-content:space-between;align-items:center;width:100%}.home .my-pet .pet-info .text-binding p{cursor:pointer;max-width:90%}.home .my-pet .pet-info .text-binding p:hover{text-decoration:underline}.home .my-pet .pet-info .text-binding .current-level{font-size:14px;font-weight:700;color:#faad14}.home .my-pet .pet-info .linked-citizen{display:flex;gap:.3125rem;font-size:14px;align-items:center}.home .my-pet .pet-info .name{font-size:1.5rem;font-weight:700;display:flex;gap:.62rem}.home .my-pet .pet-info .name .edit-name{cursor:pointer;width:1.5rem;height:1.5rem;object-fit:contain;opacity:.9;transition:.4s}.home .my-pet .pet-info .name .edit-name:hover{opacity:1;transition:.4s}.home .my-pet .pet-info .level{width:100%;margin-top:4px}.home .my-pet .pet-info .level .level-header{margin-bottom:.69rem}.home .my-pet .pet-info .level .level-header .current-level{color:var(--Calendula-Gold-6, #e66e00);font-size:1rem;font-weight:700;line-height:1.5rem}.home .my-pet .pet-info .level .level-header .remaining-to-up{font-size:12px;font-weight:400;line-height:1.375rem;display:flex;gap:2px;align-items:center;margin-top:12px}.home .my-pet .pet-info .level .level-header .remaining-to-up .snowflakes{width:14px;height:14px}.home .my-pet .pet-info .level .level-header .current-lv.theme-light .gold{color:#000}.home .my-pet .pet-info .level .level-header .current-lv .gold{display:flex;align-items:center;color:#fff;font-size:12px;gap:4px;margin-bottom:4px}.home .my-pet .pet-info .level .level-header .current-lv .gold .first{font-weight:700}.home .my-pet .pet-info .level .level-header .current-lv .gold .reward{display:flex;align-items:center;gap:4px}.home .my-pet .pet-info .level .level-header .current-lv .gold .reward img{width:14px;height:14px}.home .my-pet .pet-info .level .level-header .current-lv .gold .why-lv-up{height:15px;display:flex;align-items:center;justify-content:center;margin-left:4px}.home .my-pet .pet-info .level .level-header .current-lv .gold .why-lv-up .gold{margin-bottom:0}.home .my-pet .pet-info .level .level-header .current-lv .gold .why-lv-up .tooltip-content{width:272px;left:-190px;top:22px}.home .my-pet .pet-info .level .level-header .current-lv .gold .why-lv-up .tooltip-hover{margin-bottom:0}.home .my-pet .pet-info .level .level-header .current-lv .gold .why-lv-up .tooltip-hover .img-note{width:14px;height:14px}.home .my-pet .pet-info .level .progress{border-radius:14px}.home .my-pet .pet-info .level .progress div{background-color:#e66e00;border-radius:14px}.home .my-pet .pet-info .action{display:flex;gap:16px;width:100%;margin-top:12px}.home .my-pet .pet-info .action.theme-light .btn-upgrade{border:2px solid #1890ff;color:#1890ff}.home .my-pet .pet-info .action.theme-light button{border-color:#0003}.home .my-pet .pet-info .action .btn-upgrade{border:2px solid #faad14;color:#faad14}.home .my-pet .pet-info .action button{height:2.5rem;border-radius:.625rem;background-color:transparent;padding:0 12px;display:flex;justify-content:center;align-items:center;font-size:.875rem;color:#000;gap:.31rem;border:2px solid rgba(255,255,255,.5);width:fit-content}.home .my-pet .pet-info .action button img{width:1.5rem;height:1.5rem;object-fit:contain}.home .my-pet .pet-info .action .btn-disable{opacity:.5;cursor:not-allowed}.home .description{opacity:.5;font-size:.875rem;font-weight:500;line-height:1.375rem;margin-bottom:1.24rem}.home .mint-banner{width:100%;height:28.75rem;object-fit:cover;border-radius:.625rem;margin-bottom:1.85rem}.home .image-full{width:65%;margin:0 auto 30px;border-radius:8px}.home .resource-wrapper{display:grid;grid-template-columns:repeat(4,minmax(0,1fr));gap:1.4375rem;margin-bottom:1.875rem}.home .resource-wrapper .resource-img{width:100%;height:100%;border-radius:.625rem}.home .resource-wrapper .resource-item{position:relative;overflow:hidden}.home .resource-wrapper .resource-item:hover .extension-tooltip{display:block}.home .extension-tooltip{position:absolute;display:none;background:#15202bb3;white-space:break-spaces;width:100%;height:100%;z-index:10;text-align:left;padding:.5rem;border-radius:.5rem;font-size:12px;font-weight:300;top:0;left:0;animation:anim-tooltip .3s ease-in}@keyframes anim-tooltip{0%{top:100%;opacity:0}to{top:0;opacity:1}}.home .mint-vip-pass{padding:0 1.25rem;height:2.75rem;border-radius:.625rem;font-size:14px;font-weight:700;line-height:1.375rem;display:block;margin:auto}.home .mint-vip-pass-active{opacity:1}.home .mint-vip-pass-disable{opacity:.5;cursor:not-allowed}.home .btn-verify,.home .btn-logOut{width:100%;color:#fff}.home .btn-verify,.home .verified-box{margin-bottom:20px;background-color:#1890ff;border-radius:10px}.home .btn-verify:hover,.home .verified-box:hover{background-color:#1888f0}.home .verified-box{display:flex;font-size:14px;justify-content:space-between;height:42px;padding:0 10px;align-items:center;border-radius:10px}.home .verified-box:hover{background-color:#272727}.home .verified-box .text-des{display:flex;font-size:12px;color:#52c41a;align-items:center;gap:5px}.home .btn-logOut{background-color:#272727;border-radius:10px}.home .btn-logOut:hover{background-color:#383838}.home .btn-logOut img{margin-right:10px}.home .footer{position:relative;margin:1.25rem 0}.home .footer .btn-explore{color:#fff!important;box-shadow:0 0 10px #fff;position:absolute;bottom:2rem;left:50%;transform:translate(-50%);background-color:#1888f0!important;border:1px solid #fff;border-radius:10px}.home .footer .btn-explore:hover{background-color:#1888f0!important}::-webkit-scrollbar{width:.25rem;height:.25rem;border-radius:.25rem}::-webkit-scrollbar-track{background:#141417}::-webkit-scrollbar-thumb{background:#bae7ff;border-radius:.25rem}::-webkit-scrollbar-thumb:hover{background:#bae7ff}:root{--bg: #000}[data-theme=light]{--bg: #fff}.loading{margin-top:100px;display:flex;justify-content:center}.noti{position:fixed!important;bottom:0;right:0;width:33.0625rem!important;z-index:10000}@media (max-width: 80rem){.noti{width:400px!important}}.noti button{position:absolute;right:0!important;top:0!important}.custom-tooltip{position:relative;cursor:pointer}.custom-tooltip:hover .tooltip-content{display:block}.custom-tooltip svg{font-size:15px}.custom-tooltip img.img-note{width:18px;height:18px}.custom-tooltip .tooltip-content{position:absolute;border:1px solid;white-space:break-spaces;width:130px;z-index:1;text-align:left;padding:.5rem;border-radius:.375rem;font-size:.75rem;line-height:1.125rem;font-weight:300;top:10px;left:-5px;display:none}.custom-tooltip .tooltip-hover{font-size:.8rem;font-weight:500;line-height:1.125rem;margin-bottom:1.24rem;display:flex;gap:.31rem;align-items:center}.disabled{opacity:.2;cursor:not-allowed!important}';let ul;function Eh(n){return[...n.v,(n.i?"!":"")+n.n].join(":")}function jb(n,t=","){return n.map(Eh).join(t)}let bm=typeof CSS<"u"&&CSS.escape||(n=>n.replace(/[!"'`*+.,;:\\/<=>?@#$%&^|~()[\]{}]/g,"\\$&").replace(/^\d/,"\\3$& "));function oo(n){for(var t=9,e=n.length;e--;)t=Math.imul(t^n.charCodeAt(e),1597334677);return"#"+((t^t>>>9)>>>0).toString(36)}function Sh(n,t="@media "){return t+ne(n).map(e=>(typeof e=="string"&&(e={min:e}),e.raw||Object.keys(e).map(s=>`(${s}-width:${e[s]})`).join(" and "))).join(",")}function ne(n=[]){return Array.isArray(n)?n:n==null?[]:[n]}function iu(n){return n}function Th(){}let Me={d:0,b:134217728,c:268435456,a:671088640,u:805306368,o:939524096};function ym(n){var t;return((t=n.match(/[-=:;]/g))==null?void 0:t.length)||0}function nc(n){return Math.min(/(?:^|width[^\d]+)(\d+(?:.\d+)?)(p)?/.test(n)?Math.max(0,29.63*(+RegExp.$1/(RegExp.$2?15:1))**.137-43):0,15)<<22|Math.min(ym(n),15)<<18}let Vb=["rst-c","st-ch","h-chi","y-lin","nk","sited","ecked","pty","ad-on","cus-w","ver","cus","cus-v","tive","sable","tiona","quire"];function Ah({n,i:t,v:e=[]},s,r,i){n&&(n=Eh({n,i:t,v:e})),i=[...ne(i)];for(let l of e){let a=s.theme("screens",l);for(let c of ne(a&&Sh(a)||s.v(l))){var o;i.push(c),r|=a?67108864|nc(c):l=="dark"?1073741824:c[0]=="@"?nc(c):(o=c,1<<~(/:([a-z-]+)/.test(o)&&~Vb.indexOf(RegExp.$1.slice(2,7))||-18))}}return{n,p:r,r:i,i:t}}let wm=new Map;function rc(n){if(n.d){let t=[],e=fl(n.r.reduce((s,r)=>r[0]=="@"?(t.push(r),s):r?fl(s,i=>fl(r,o=>{let l=/(:merge\(.+?\))(:[a-z-]+|\\[.+])/.exec(o);if(l){let a=i.indexOf(l[1]);return~a?i.slice(0,a)+l[0]+i.slice(a+l[1].length):ml(i,o)}return ml(o,i)})):s,"&"),s=>ml(s,n.n?"."+bm(n.n):""));return e&&t.push(e.replace(/:merge\((.+?)\)/g,"$1")),t.reduceRight((s,r)=>r+"{"+s+"}",n.d)}}function fl(n,t){return n.replace(/ *((?:\(.+?\)|\[.+?\]|[^,])+) *(,|$)/g,(e,s,r)=>t(s)+r)}function ml(n,t){return n.replace(/&/g,t)}let au=new Intl.Collator("en",{numeric:!0});function vm(n,t){for(var e=0,s=n.length;e<s;){let r=s+e>>1;0>=_m(n[r],t)?e=r+1:s=r}return s}function _m(n,t){let e=n.p&Me.o;return e==(t.p&Me.o)&&(e==Me.b||e==Me.o)?0:n.p-t.p||n.o-t.o||au.compare(ou(n.n),ou(t.n))||au.compare(lu(n.n),lu(t.n))}function ou(n){return(n||"").split(/:/).pop().split("/").pop()||"\0"}function lu(n){return(n||"").replace(/\W/g,t=>String.fromCharCode(127+t.charCodeAt(0)))+"\0"}function pl(n,t){return Math.round(parseInt(n,16)*t)}function ar(n,t={}){if(typeof n=="function")return n(t);let{opacityValue:e="1",opacityVariable:s}=t,r=s?`var(${s})`:e;if(n.includes("<alpha-value>"))return n.replace("<alpha-value>",r);if(n[0]=="#"&&(n.length==4||n.length==7)){let i=(n.length-1)/3,o=[17,1,.062272][i-1];return`rgba(${[pl(n.substr(1,i),o),pl(n.substr(1+i,i),o),pl(n.substr(1+2*i,i),o),r]})`}return r=="1"?n:r=="0"?"#0000":n.replace(/^(rgb|hsl)(\([^)]+)\)$/,`$1a$2,${r})`)}function Em(n,t,e,s,r=[]){return function i(o,{n:l,p:a,r:c=[],i:h},d){let u=[],f="",m=0,p=0;for(let x in o||{}){var g,w;let y=o[x];if(x[0]=="@"){if(!y)continue;if(x[1]=="a"){u.push(...kh(l,a,co(""+y),d,a,c,h,!0));continue}if(x[1]=="l"){for(let b of ne(y))u.push(...i(b,{n:l,p:(g=Me[x[7]],a&~Me.o|g),r:x[7]=="d"?[]:c,i:h},d));continue}if(x[1]=="i"){u.push(...ne(y).map(b=>({p:-1,o:0,r:[],d:x+" "+b})));continue}if(x[1]=="k"){u.push({p:Me.d,o:0,r:[x],d:i(y,{p:Me.d},d).map(rc).join("")});continue}if(x[1]=="f"){u.push(...ne(y).map(b=>({p:Me.d,o:0,r:[x],d:i(b,{p:Me.d},d).map(rc).join("")})));continue}}if(typeof y!="object"||Array.isArray(y))x=="label"&&y?l=y+oo(JSON.stringify([a,h,o])):(y||y===0)&&(x=x.replace(/[A-Z]/g,b=>"-"+b.toLowerCase()),p+=1,m=Math.max(m,(w=x)[0]=="-"?0:ym(w)+(/^(?:(border-(?!w|c|sty)|[tlbr].{2,4}m?$|c.{7,8}$)|([fl].{5}l|g.{8}$|pl))/.test(w)?+!!RegExp.$1||-!!RegExp.$2:0)+1),f+=(f?";":"")+ne(y).map(b=>d.s(x,Ch(""+b,d.theme)+(h?" !important":""))).join(";"));else if(x[0]=="@"||x.includes("&")){let b=a;x[0]=="@"&&(x=x.replace(/\bscreen\(([^)]+)\)/g,(_,E)=>{let S=d.theme("screens",E);return S?(b|=67108864,Sh(S,"")):_}),b|=nc(x)),u.push(...i(y,{n:l,p:b,r:[...c,x],i:h},d))}else u.push(...i(y,{p:a,r:[...c,x]},d))}return u.unshift({n:l,p:a,o:Math.max(0,15-p)+1.5*Math.min(m||15,15),r:c,d:f}),u.sort(_m)}(n,Ah(t,e,s,r),e)}function Ch(n,t){return n.replace(/theme\((["'`])?(.+?)\1(?:\s*,\s*(["'`])?(.+?)\3)?\)/g,(e,s,r,i,o="")=>{let l=t(r,o);return typeof l=="function"&&/color|fill|stroke/i.test(r)?ar(l):""+ne(l).filter(a=>Object(a)!==a)})}function Sm(n,t){let e,s=[];for(let r of n)r.d&&r.n?(e==null?void 0:e.p)==r.p&&""+e.r==""+r.r?(e.c=[e.c,r.c].filter(Boolean).join(" "),e.d=e.d+";"+r.d):s.push(e={...r,n:r.n&&t}):s.push({...r,n:r.n&&t});return s}function lo(n,t,e=Me.u,s,r){let i=[];for(let o of n)for(let l of function(a,c,h,d,u){a={...a,i:a.i||u};let f=function(m,p){let g=wm.get(m.n);return g?g(m,p):p.r(m.n,m.v[0]=="dark")}(a,c);return f?typeof f=="string"?({r:d,p:h}=Ah(a,c,h,d),Sm(lo(co(f),c,h,d,a.i),a.n)):Array.isArray(f)?f.map(m=>{var p,g;return{o:0,...m,r:[...ne(d),...ne(m.r)],p:(p=h,g=m.p??h,p&~Me.o|g)}}):Em(f,a,c,h,d):[{c:Eh(a),p:0,o:0,r:[]}]}(o,t,e,s,r))i.splice(vm(i,l),0,l);return i}function kh(n,t,e,s,r,i,o,l){return Sm((l?e.flatMap(a=>lo([a],s,r,i,o)):lo(e,s,r,i,o)).map(a=>a.p&Me.o&&(a.n||t==Me.b)?{...a,p:a.p&~Me.o|t,o:0}:a),n)}function Ub(n,t,e,s){var r;return r=(i,o)=>{let{n:l,p:a,r:c,i:h}=Ah(i,o,t);return e&&kh(l,t,e,o,a,c,h,s)},wm.set(n,r),n}function gl(n,t,e){if(n[n.length-1]!="("){let s=[],r=!1,i=!1,o="";for(let l of n)if(!(l=="("||/[~@]$/.test(l))){if(l[0]=="!"&&(l=l.slice(1),r=!r),l.endsWith(":")){s[l=="dark:"?"unshift":"push"](l.slice(0,-1));continue}l[0]=="-"&&(l=l.slice(1),i=!i),l.endsWith("-")&&(l=l.slice(0,-1)),l&&l!="&"&&(o+=(o&&"-")+l)}o&&(i&&(o="-"+o),t[0].push({n:o,v:s.filter(Xb),i:r}))}}function Xb(n,t,e){return e.indexOf(n)==t}let cu=new Map;function co(n){let t=cu.get(n);if(!t){let e=[],s=[[]],r=0,i=0,o=null,l=0,a=(c,h=0)=>{r!=l&&(e.push(n.slice(r,l+h)),c&&gl(e,s)),r=l+1};for(;l<n.length;l++){let c=n[l];if(i)n[l-1]!="\\"&&(i+=+(c=="[")||-(c=="]"));else if(c=="[")i+=1;else if(o)n[l-1]!="\\"&&o.test(n.slice(l))&&(o=null,r=l+RegExp.lastMatch.length);else if(c=="/"&&n[l-1]!="\\"&&(n[l+1]=="*"||n[l+1]=="/"))o=n[l+1]=="*"?/^\*\//:/^[\r\n]/;else if(c=="(")a(),e.push(c);else if(c==":")n[l+1]!=":"&&a(!1,1);else if(/[\s,)]/.test(c)){a(!0);let h=e.lastIndexOf("(");if(c==")"){let d=e[h-1];if(/[~@]$/.test(d)){let u=s.shift();e.length=h,gl([...e,"#"],s);let{v:f}=s[0].pop();for(let m of u)m.v.splice(+(m.v[0]=="dark")-+(f[0]=="dark"),f.length);gl([...e,Ub(d.length>1?d.slice(0,-1)+oo(JSON.stringify([d,u])):d+"("+jb(u)+")",Me.a,u,/@$/.test(d))],s)}h=e.lastIndexOf("(",h-1)}e.length=h+1}else/[~@]/.test(c)&&n[l+1]=="("&&s.unshift([])}a(!0),cu.set(n,t=s[0])}return t}function it(n,t,e){return[n,ic(t,e)]}function ic(n,t){return typeof n=="function"?n:typeof n=="string"&&/^[\w-]+$/.test(n)?(e,s)=>({[n]:t?t(e,s):ac(e,1)}):e=>n||{[e[1]]:ac(e,2)}}function ac(n,t,e=n.slice(t).find(Boolean)||n.$$||n.input){return n.input[0]=="-"?`calc(${e} * -1)`:e}function at(n,t,e,s){return[n,Gb(t,e,s)]}function Gb(n,t,e){let s=typeof t=="string"?(r,i)=>({[t]:e?e(r,i):r._}):t||(({1:r,_:i},o,l)=>({[r||l]:i}));return(r,i)=>{let o=Tm(n||r[1]),l=i.theme(o,r.$$)??or(r.$$,o,i);if(l!=null)return r._=ac(r,0,l),s(r,i,o)}}function Fe(n,t={},e){return[n,Yb(t,e)]}function Yb(n={},t){return(e,s)=>{let{section:r=Tm(e[0]).replace("-","")+"Color"}=n,[i,o]=$b(e.$$);if(!i)return;let l=s.theme(r,i)||or(i,r,s);if(!l||typeof l=="object")return;let{opacityVariable:a=`--tw-${e[0].replace(/-$/,"")}-opacity`,opacitySection:c=r.replace("Color","Opacity"),property:h=r,selector:d}=n,u=s.theme(c,o||"DEFAULT")||o&&or(o,c,s),f=t||(({_:p})=>{let g=Ka(h,p);return d?{[d]:g}:g});e._={value:ar(l,{opacityVariable:a||void 0,opacityValue:u||void 0}),color:p=>ar(l,p),opacityVariable:a||void 0,opacityValue:u||void 0};let m=f(e,s);if(!e.dark){let p=s.d(r,i,l);p&&p!==l&&(e._={value:ar(p,{opacityVariable:a||void 0,opacityValue:u||"1"}),color:g=>ar(p,g),opacityVariable:a||void 0,opacityValue:u||void 0},m={"&":m,[s.v("dark")]:f(e,s)})}return m}}function $b(n){return(n.match(/^(\[[^\]]+]|[^/]+?)(?:\/(.+))?$/)||[]).slice(1)}function Ka(n,t){let e={};return typeof t=="string"?e[n]=t:(t.opacityVariable&&t.value.includes(t.opacityVariable)&&(e[t.opacityVariable]=t.opacityValue||"1"),e[n]=t.value),e}function or(n,t,e){if(n[0]=="["&&n.slice(-1)=="]"){if(n=sa(Ch(n.slice(1,-1),e.theme)),!t)return n;if(!(/color|fill|stroke/i.test(t)&&!(/^color:/.test(n)||/^(#|((hsl|rgb)a?|hwb|lab|lch|color)\(|[a-z]+$)/.test(n))||/image/i.test(t)&&!(/^image:/.test(n)||/^[a-z-]+\(/.test(n))||/weight/i.test(t)&&!(/^(number|any):/.test(n)||/^\d+$/.test(n))||/position/i.test(t)&&/^(length|size):/.test(n)))return n.replace(/^[a-z-]+:/,"")}}function Tm(n){return n.replace(/-./g,t=>t[1].toUpperCase())}function sa(n){return n.includes("url(")?n.replace(/(.*?)(url\(.*?\))(.*?)/g,(t,e="",s,r="")=>sa(e)+s+sa(r)):n.replace(/(^|[^\\])_+/g,(t,e)=>e+" ".repeat(t.length-e.length)).replace(/\\_/g,"_").replace(/(calc|min|max|clamp)\(.+\)/g,t=>t.replace(/(-?\d*\.?\d(?!\b-.+[,)](?![^+\-/*])\D)(?:%|[a-z]+)?|\))([+\-/*])/g,"$1 $2 "))}function Am({presets:n=[],...t}){let e={darkMode:void 0,darkColor:void 0,preflight:t.preflight!==!1&&[],theme:{},variants:ne(t.variants),rules:ne(t.rules),ignorelist:ne(t.ignorelist),hash:void 0,stringify:(s,r)=>s+":"+r,finalize:[]};for(let s of ne([...n,{darkMode:t.darkMode,darkColor:t.darkColor,preflight:t.preflight!==!1&&ne(t.preflight),theme:t.theme,hash:t.hash,stringify:t.stringify,finalize:t.finalize}])){let{preflight:r,darkMode:i=e.darkMode,darkColor:o=e.darkColor,theme:l,variants:a,rules:c,ignorelist:h,hash:d=e.hash,stringify:u=e.stringify,finalize:f}=typeof s=="function"?s(e):s;e={preflight:e.preflight!==!1&&r!==!1&&[...e.preflight,...ne(r)],darkMode:i,darkColor:o,theme:{...e.theme,...l,extend:{...e.theme.extend,...l==null?void 0:l.extend}},variants:[...e.variants,...ne(a)],rules:[...e.rules,...ne(c)],ignorelist:[...e.ignorelist,...ne(h)],hash:d,stringify:u,finalize:[...e.finalize,...ne(f)]}}return e}function hu(n,t,e,s,r,i){for(let o of t){let l=e.get(o);l||e.set(o,l=s(o));let a=l(n,r,i);if(a)return a}}function Wb(n){var t;return oc(n[0],typeof(t=n[1])=="function"?t:()=>t)}function zb(n){var t,e;return Array.isArray(n)?oc(n[0],ic(n[1],n[2])):oc(n,ic(t,e))}function oc(n,t){return Cm(n,(e,s,r,i)=>{let o=s.exec(e);if(o)return o.$$=e.slice(o[0].length),o.dark=i,t(o,r)})}function Cm(n,t){let e=ne(n).map(Hb);return(s,r,i)=>{for(let o of e){let l=t(s,o,r,i);if(l)return l}}}function Hb(n){return typeof n=="string"?RegExp("^"+n+(n.includes("$")||n.slice(-1)=="-"?"":"$")):n}function qb(n,t){let e=Am(n),s=function({theme:a,darkMode:c,darkColor:h=Th,variants:d,rules:u,hash:f,stringify:m,ignorelist:p,finalize:g}){let w=new Map,x=new Map,y=new Map,b=new Map,_=Cm(p,(T,C)=>C.test(T));d.push(["dark",Array.isArray(c)||c=="class"?`${ne(c)[1]||".dark"} &`:typeof c=="string"&&c!="media"?c:"@media (prefers-color-scheme:dark)"]);let E=typeof f=="function"?T=>f(T,oo):f?oo:iu;E!==iu&&g.push(T=>{var C;return{...T,n:T.n&&E(T.n),d:(C=T.d)==null?void 0:C.replace(/--(tw(?:-[\w-]+)?)\b/g,(A,R)=>"--"+E(R).replace("#",""))}});let S={theme:function({extend:T={},...C}){let A={},R={get colors(){return M("colors")},theme:M,negative(){return{}},breakpoints(N){let F={};for(let B in N)typeof N[B]=="string"&&(F["screen-"+B]=N[B]);return F}};return M;function M(N,F,B,Y){if(N){if({1:N,2:Y}=/^(\S+?)(?:\s*\/\s*([^/]+))?$/.exec(N)||[,N],/[.[]/.test(N)){let X=[];N.replace(/\[([^\]]+)\]|([^.[]+)/g,(L,U,q=U)=>X.push(q)),N=X.shift(),B=F,F=X.join("-")}let V=A[N]||Object.assign(Object.assign(A[N]={},I(C,N)),I(T,N));if(F==null)return V;F||(F="DEFAULT");let j=V[F]??F.split("-").reduce((X,L)=>X==null?void 0:X[L],V)??B;return Y?ar(j,{opacityValue:Ch(Y,M)}):j}let O={};for(let V of[...Object.keys(C),...Object.keys(T)])O[V]=M(V);return O}function I(N,F){let B=N[F];return typeof B=="function"&&(B=B(R)),B&&/color|fill|stroke/i.test(F)?function Y(O,V=[]){let j={};for(let X in O){let L=O[X],U=[...V,X];j[U.join("-")]=L,X=="DEFAULT"&&(U=V,j[V.join("-")]=L),typeof L=="object"&&Object.assign(j,Y(L,U))}return j}(B):B}}(a),e:bm,h:E,s(T,C){return m(T,C,S)},d(T,C,A){return h(T,C,S,A)},v(T){return w.has(T)||w.set(T,hu(T,d,x,Wb,S)||"&:"+T),w.get(T)},r(T,C){let A=JSON.stringify([T,C]);return y.has(A)||y.set(A,!_(T,S)&&hu(T,u,b,zb,S,C)),y.get(A)},f(T){return g.reduce((C,A)=>A(C,S),T)}};return S}(e),r=new Map,i=[],o=new Set;t.resume(a=>r.set(a,a),(a,c)=>{t.insert(a,i.length,c),i.push(c),o.add(a)});function l(a){let c=s.f(a),h=rc(c);if(h&&!o.has(h)){o.add(h);let d=vm(i,a);t.insert(h,d,a),i.splice(d,0,a)}return c.n}return Object.defineProperties(function(c){if(!r.size)for(let d of ne(e.preflight))typeof d=="function"&&(d=d(s)),d&&(typeof d=="string"?kh("",Me.b,co(d),s,Me.b,[],!1,!0):Em(d,{},s,Me.b)).forEach(l);c=""+c;let h=r.get(c);if(!h){let d=new Set;for(let u of lo(co(c),s))d.add(u.c).add(l(u));h=[...d].filter(Boolean).join(" "),r.set(c,h).set(h,h)}return h},Object.getOwnPropertyDescriptors({get target(){return t.target},theme:s.theme,config:e,snapshot(){let a=t.snapshot(),c=new Set(o),h=new Map(r),d=[...i];return()=>{a(),o=c,r=h,i=d}},clear(){t.clear(),o=new Set,r=new Map,i=[]},destroy(){this.clear(),t.destroy()}}))}function Kb(n,t){return n!=t&&""+n.split(" ").sort()!=""+t.split(" ").sort()}function Zb(n){let t=new MutationObserver(e);return{observe(r){t.observe(r,{attributeFilter:["class"],subtree:!0,childList:!0}),s(r),e([{target:r,type:""}])},disconnect(){t.disconnect()}};function e(r){for(let{type:i,target:o}of r)if(i[0]=="a")s(o);else for(let l of o.querySelectorAll("[class]"))s(l);t.takeRecords()}function s(r){var l;let i,o=(l=r.getAttribute)==null?void 0:l.call(r,"class");o&&Kb(o,i=n(o))&&r.setAttribute("class",i)}}function Qb(n=ey,t=typeof document<"u"&&document.documentElement){if(t){let e=Zb(n);e.observe(t);let{destroy:s}=n;n.destroy=()=>{e.disconnect(),s.call(n)}}return n}function Jb(n){let t=document.querySelector(n||'style[data-twind=""]');return(!t||t.tagName!="STYLE")&&(t=document.createElement("style"),document.head.prepend(t)),t.dataset.twind="claimed",t}function ty(n){let t=n!=null&&n.cssRules?n:(n&&typeof n!="string"?n:Jb(n)).sheet;return{target:t,snapshot(){let e=Array.from(t.cssRules,s=>s.cssText);return()=>{this.clear(),e.forEach(this.insert)}},clear(){for(let e=t.cssRules.length;e--;)t.deleteRule(e)},destroy(){var e;(e=t.ownerNode)==null||e.remove()},insert(e,s){try{t.insertRule(e,s)}catch{t.insertRule(":root{}",s)}},resume:Th}}let ey=new Proxy(Th,{apply(n,t,e){return ul(e[0])},get(n,t){let e=ul[t];return typeof e=="function"?function(){return e.apply(ul,arguments)}:e}});(function(){if(typeof document>"u"||"adoptedStyleSheets"in document)return;var n="ShadyCSS"in window&&!ShadyCSS.nativeShadow,t=document.implementation.createHTMLDocument(""),e=new WeakMap,s=typeof DOMException=="object"?Error:DOMException,r=Object.defineProperty,i=Array.prototype.forEach,o=/@import.+?;?$/gm;function l(W){var K=W.replace(o,"");return K!==W&&console.warn("@import rules are not allowed here. See https://github.com/WICG/construct-stylesheets/issues/119#issuecomment-588352418"),K.trim()}function a(W){return"isConnected"in W?W.isConnected:document.contains(W)}function c(W){return W.filter(function(K,Z){return W.indexOf(K)===Z})}function h(W,K){return W.filter(function(Z){return K.indexOf(Z)===-1})}function d(W){W.parentNode.removeChild(W)}function u(W){return W.shadowRoot||e.get(W)}var f=["addRule","deleteRule","insertRule","removeRule"],m=CSSStyleSheet,p=m.prototype;p.replace=function(){return Promise.reject(new s("Can't call replace on non-constructed CSSStyleSheets."))},p.replaceSync=function(){throw new s("Failed to execute 'replaceSync' on 'CSSStyleSheet': Can't call replaceSync on non-constructed CSSStyleSheets.")};function g(W){return typeof W=="object"?M.isPrototypeOf(W)||p.isPrototypeOf(W):!1}function w(W){return typeof W=="object"?p.isPrototypeOf(W):!1}var x=new WeakMap,y=new WeakMap,b=new WeakMap,_=new WeakMap;function E(W,K){var Z=document.createElement("style");return b.get(W).set(K,Z),y.get(W).push(K),Z}function S(W,K){return b.get(W).get(K)}function T(W,K){b.get(W).delete(K),y.set(W,y.get(W).filter(function(Z){return Z!==K}))}function C(W,K){requestAnimationFrame(function(){K.textContent=x.get(W).textContent,_.get(W).forEach(function(Z){return K.sheet[Z.method].apply(K.sheet,Z.args)})})}function A(W){if(!x.has(W))throw new TypeError("Illegal invocation")}function R(){var W=this,K=document.createElement("style");t.body.appendChild(K),x.set(W,K),y.set(W,[]),b.set(W,new WeakMap),_.set(W,[])}var M=R.prototype;M.replace=function(K){try{return this.replaceSync(K),Promise.resolve(this)}catch(Z){return Promise.reject(Z)}},M.replaceSync=function(K){if(A(this),typeof K=="string"){var Z=this;x.get(Z).textContent=l(K),_.set(Z,[]),y.get(Z).forEach(function(nt){nt.isConnected()&&C(Z,S(Z,nt))})}},r(M,"cssRules",{configurable:!0,enumerable:!0,get:function(){return A(this),x.get(this).sheet.cssRules}}),r(M,"media",{configurable:!0,enumerable:!0,get:function(){return A(this),x.get(this).sheet.media}}),f.forEach(function(W){M[W]=function(){var K=this;A(K);var Z=arguments;_.get(K).push({method:W,args:Z}),y.get(K).forEach(function(gt){if(gt.isConnected()){var rt=S(K,gt).sheet;rt[W].apply(rt,Z)}});var nt=x.get(K).sheet;return nt[W].apply(nt,Z)}}),r(R,Symbol.hasInstance,{configurable:!0,value:g});var I={childList:!0,subtree:!0},N=new WeakMap;function F(W){var K=N.get(W);return K||(K=new q(W),N.set(W,K)),K}function B(W){r(W.prototype,"adoptedStyleSheets",{configurable:!0,enumerable:!0,get:function(){return F(this).sheets},set:function(K){F(this).update(K)}})}function Y(W,K){for(var Z=document.createNodeIterator(W,NodeFilter.SHOW_ELEMENT,function(gt){return u(gt)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_REJECT},null,!1),nt=void 0;nt=Z.nextNode();)K(u(nt))}var O=new WeakMap,V=new WeakMap,j=new WeakMap;function X(W,K){return K instanceof HTMLStyleElement&&V.get(W).some(function(Z){return S(Z,W)})}function L(W){var K=O.get(W);return K instanceof Document?K.body:K}function U(W){var K=document.createDocumentFragment(),Z=V.get(W),nt=j.get(W),gt=L(W);nt.disconnect(),Z.forEach(function(rt){K.appendChild(S(rt,W)||E(rt,W))}),gt.insertBefore(K,null),nt.observe(gt,I),Z.forEach(function(rt){C(rt,S(rt,W))})}function q(W){var K=this;K.sheets=[],O.set(K,W),V.set(K,[]),j.set(K,new MutationObserver(function(Z,nt){if(!document){nt.disconnect();return}Z.forEach(function(gt){n||i.call(gt.addedNodes,function(rt){rt instanceof Element&&Y(rt,function(bt){F(bt).connect()})}),i.call(gt.removedNodes,function(rt){rt instanceof Element&&(X(K,rt)&&U(K),n||Y(rt,function(bt){F(bt).disconnect()}))})})}))}if(q.prototype={isConnected:function(){var W=O.get(this);return W instanceof Document?W.readyState!=="loading":a(W.host)},connect:function(){var W=L(this);j.get(this).observe(W,I),V.get(this).length>0&&U(this),Y(W,function(K){F(K).connect()})},disconnect:function(){j.get(this).disconnect()},update:function(W){var K=this,Z=O.get(K)===document?"Document":"ShadowRoot";if(!Array.isArray(W))throw new TypeError("Failed to set the 'adoptedStyleSheets' property on "+Z+": Iterator getter is not callable.");if(!W.every(g))throw new TypeError("Failed to set the 'adoptedStyleSheets' property on "+Z+": Failed to convert value to 'CSSStyleSheet'");if(W.some(w))throw new TypeError("Failed to set the 'adoptedStyleSheets' property on "+Z+": Can't adopt non-constructed stylesheets");K.sheets=W;var nt=V.get(K),gt=c(W),rt=h(nt,gt);rt.forEach(function(bt){d(S(bt,K)),T(bt,K)}),V.set(K,gt),K.isConnected()&&gt.length>0&&U(K)}},window.CSSStyleSheet=R,B(Document),"ShadowRoot"in window){B(ShadowRoot);var H=Element.prototype,J=H.attachShadow;H.attachShadow=function(K){var Z=J.call(this,K);return K.mode==="closed"&&e.set(this,Z),Z}}var Q=F(document);Q.isConnected()?Q.connect():document.addEventListener("DOMContentLoaded",Q.connect.bind(Q))})();let lc={screens:{sm:"640px",md:"768px",lg:"1024px",xl:"1280px","2xl":"1536px"},columns:{auto:"auto","3xs":"16rem","2xs":"18rem",xs:"20rem",sm:"24rem",md:"28rem",lg:"32rem",xl:"36rem","2xl":"42rem","3xl":"48rem","4xl":"56rem","5xl":"64rem","6xl":"72rem","7xl":"80rem"},spacing:{px:"1px",0:"0px",...us(4,"rem",4,.5,.5),...us(12,"rem",4,5),14:"3.5rem",...us(64,"rem",4,16,4),72:"18rem",80:"20rem",96:"24rem"},durations:{75:"75ms",100:"100ms",150:"150ms",200:"200ms",300:"300ms",500:"500ms",700:"700ms",1e3:"1000ms"},animation:{none:"none",spin:"spin 1s linear infinite",ping:"ping 1s cubic-bezier(0,0,0.2,1) infinite",pulse:"pulse 2s cubic-bezier(0.4,0,0.6,1) infinite",bounce:"bounce 1s infinite"},aspectRatio:{auto:"auto",square:"1/1",video:"16/9"},backdropBlur:Gt("blur"),backdropBrightness:Gt("brightness"),backdropContrast:Gt("contrast"),backdropGrayscale:Gt("grayscale"),backdropHueRotate:Gt("hueRotate"),backdropInvert:Gt("invert"),backdropOpacity:Gt("opacity"),backdropSaturate:Gt("saturate"),backdropSepia:Gt("sepia"),backgroundColor:Gt("colors"),backgroundImage:{none:"none"},backgroundOpacity:Gt("opacity"),backgroundSize:{auto:"auto",cover:"cover",contain:"contain"},blur:{none:"none",0:"0",sm:"4px",DEFAULT:"8px",md:"12px",lg:"16px",xl:"24px","2xl":"40px","3xl":"64px"},brightness:{...us(200,"",100,0,50),...us(110,"",100,90,5),75:"0.75",125:"1.25"},borderColor:({theme:n})=>({DEFAULT:n("colors.gray.200","currentColor"),...n("colors")}),borderOpacity:Gt("opacity"),borderRadius:{none:"0px",sm:"0.125rem",DEFAULT:"0.25rem",md:"0.375rem",lg:"0.5rem",xl:"0.75rem","2xl":"1rem","3xl":"1.5rem","1/2":"50%",full:"9999px"},borderSpacing:Gt("spacing"),borderWidth:{DEFAULT:"1px",...Ss(8,"px")},boxShadow:{sm:"0 1px 2px 0 rgba(0,0,0,0.05)",DEFAULT:"0 1px 3px 0 rgba(0,0,0,0.1), 0 1px 2px -1px rgba(0,0,0,0.1)",md:"0 4px 6px -1px rgba(0,0,0,0.1), 0 2px 4px -2px rgba(0,0,0,0.1)",lg:"0 10px 15px -3px rgba(0,0,0,0.1), 0 4px 6px -4px rgba(0,0,0,0.1)",xl:"0 20px 25px -5px rgba(0,0,0,0.1), 0 8px 10px -6px rgba(0,0,0,0.1)","2xl":"0 25px 50px -12px rgba(0,0,0,0.25)",inner:"inset 0 2px 4px 0 rgba(0,0,0,0.05)",none:"0 0 #0000"},boxShadowColor:Gt("colors"),caretColor:Gt("colors"),accentColor:({theme:n})=>({auto:"auto",...n("colors")}),contrast:{...us(200,"",100,0,50),75:"0.75",125:"1.25"},content:{none:"none"},divideColor:Gt("borderColor"),divideOpacity:Gt("borderOpacity"),divideWidth:Gt("borderWidth"),dropShadow:{sm:"0 1px 1px rgba(0,0,0,0.05)",DEFAULT:["0 1px 2px rgba(0,0,0,0.1)","0 1px 1px rgba(0,0,0,0.06)"],md:["0 4px 3px rgba(0,0,0,0.07)","0 2px 2px rgba(0,0,0,0.06)"],lg:["0 10px 8px rgba(0,0,0,0.04)","0 4px 3px rgba(0,0,0,0.1)"],xl:["0 20px 13px rgba(0,0,0,0.03)","0 8px 5px rgba(0,0,0,0.08)"],"2xl":"0 25px 25px rgba(0,0,0,0.15)",none:"0 0 #0000"},fill:({theme:n})=>({...n("colors"),none:"none"}),grayscale:{DEFAULT:"100%",0:"0"},hueRotate:{0:"0deg",15:"15deg",30:"30deg",60:"60deg",90:"90deg",180:"180deg"},invert:{DEFAULT:"100%",0:"0"},flex:{1:"1 1 0%",auto:"1 1 auto",initial:"0 1 auto",none:"none"},flexBasis:({theme:n})=>({...n("spacing"),...Ri(2,6),...Ri(12,12),auto:"auto",full:"100%"}),flexGrow:{DEFAULT:1,0:0},flexShrink:{DEFAULT:1,0:0},fontFamily:{sans:'ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji"'.split(","),serif:'ui-serif,Georgia,Cambria,"Times New Roman",Times,serif'.split(","),mono:'ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace'.split(",")},fontSize:{xs:["0.75rem","1rem"],sm:["0.875rem","1.25rem"],base:["1rem","1.5rem"],lg:["1.125rem","1.75rem"],xl:["1.25rem","1.75rem"],"2xl":["1.5rem","2rem"],"3xl":["1.875rem","2.25rem"],"4xl":["2.25rem","2.5rem"],"5xl":["3rem","1"],"6xl":["3.75rem","1"],"7xl":["4.5rem","1"],"8xl":["6rem","1"],"9xl":["8rem","1"]},fontWeight:{thin:"100",extralight:"200",light:"300",normal:"400",medium:"500",semibold:"600",bold:"700",extrabold:"800",black:"900"},gap:Gt("spacing"),gradientColorStops:Gt("colors"),gridAutoColumns:{auto:"auto",min:"min-content",max:"max-content",fr:"minmax(0,1fr)"},gridAutoRows:{auto:"auto",min:"min-content",max:"max-content",fr:"minmax(0,1fr)"},gridColumn:{auto:"auto","span-full":"1 / -1"},gridRow:{auto:"auto","span-full":"1 / -1"},gridTemplateColumns:{none:"none"},gridTemplateRows:{none:"none"},height:({theme:n})=>({...n("spacing"),...Ri(2,6),min:"min-content",max:"max-content",fit:"fit-content",auto:"auto",full:"100%",screen:"100vh"}),inset:({theme:n})=>({...n("spacing"),...Ri(2,4),auto:"auto",full:"100%"}),keyframes:{spin:{from:{transform:"rotate(0deg)"},to:{transform:"rotate(360deg)"}},ping:{"0%":{transform:"scale(1)",opacity:"1"},"75%,100%":{transform:"scale(2)",opacity:"0"}},pulse:{"0%,100%":{opacity:"1"},"50%":{opacity:".5"}},bounce:{"0%, 100%":{transform:"translateY(-25%)",animationTimingFunction:"cubic-bezier(0.8,0,1,1)"},"50%":{transform:"none",animationTimingFunction:"cubic-bezier(0,0,0.2,1)"}}},letterSpacing:{tighter:"-0.05em",tight:"-0.025em",normal:"0em",wide:"0.025em",wider:"0.05em",widest:"0.1em"},lineHeight:{...us(10,"rem",4,3),none:"1",tight:"1.25",snug:"1.375",normal:"1.5",relaxed:"1.625",loose:"2"},margin:({theme:n})=>({auto:"auto",...n("spacing")}),maxHeight:({theme:n})=>({full:"100%",min:"min-content",max:"max-content",fit:"fit-content",screen:"100vh",...n("spacing")}),maxWidth:({theme:n,breakpoints:t})=>({...t(n("screens")),none:"none",0:"0rem",xs:"20rem",sm:"24rem",md:"28rem",lg:"32rem",xl:"36rem","2xl":"42rem","3xl":"48rem","4xl":"56rem","5xl":"64rem","6xl":"72rem","7xl":"80rem",full:"100%",min:"min-content",max:"max-content",fit:"fit-content",prose:"65ch"}),minHeight:{0:"0px",full:"100%",min:"min-content",max:"max-content",fit:"fit-content",screen:"100vh"},minWidth:{0:"0px",full:"100%",min:"min-content",max:"max-content",fit:"fit-content"},opacity:{...us(100,"",100,0,10),5:"0.05",25:"0.25",75:"0.75",95:"0.95"},order:{first:"-9999",last:"9999",none:"0"},padding:Gt("spacing"),placeholderColor:Gt("colors"),placeholderOpacity:Gt("opacity"),outlineColor:Gt("colors"),outlineOffset:Ss(8,"px"),outlineWidth:Ss(8,"px"),ringColor:({theme:n})=>({...n("colors"),DEFAULT:"#3b82f6"}),ringOffsetColor:Gt("colors"),ringOffsetWidth:Ss(8,"px"),ringOpacity:({theme:n})=>({...n("opacity"),DEFAULT:"0.5"}),ringWidth:{DEFAULT:"3px",...Ss(8,"px")},rotate:{...Ss(2,"deg"),...Ss(12,"deg",3),...Ss(180,"deg",45)},saturate:us(200,"",100,0,50),scale:{...us(150,"",100,0,50),...us(110,"",100,90,5),75:"0.75",125:"1.25"},scrollMargin:Gt("spacing"),scrollPadding:Gt("spacing"),sepia:{0:"0",DEFAULT:"100%"},skew:{...Ss(2,"deg"),...Ss(12,"deg",3)},space:Gt("spacing"),stroke:({theme:n})=>({...n("colors"),none:"none"}),strokeWidth:us(2),textColor:Gt("colors"),textDecorationColor:Gt("colors"),textDecorationThickness:{"from-font":"from-font",auto:"auto",...Ss(8,"px")},textUnderlineOffset:{auto:"auto",...Ss(8,"px")},textIndent:Gt("spacing"),textOpacity:Gt("opacity"),transitionDuration:({theme:n})=>({...n("durations"),DEFAULT:"150ms"}),transitionDelay:Gt("durations"),transitionProperty:{none:"none",all:"all",DEFAULT:"color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter",colors:"color,background-color,border-color,text-decoration-color,fill,stroke",opacity:"opacity",shadow:"box-shadow",transform:"transform"},transitionTimingFunction:{DEFAULT:"cubic-bezier(0.4,0,0.2,1)",linear:"linear",in:"cubic-bezier(0.4,0,1,1)",out:"cubic-bezier(0,0,0.2,1)","in-out":"cubic-bezier(0.4,0,0.2,1)"},translate:({theme:n})=>({...n("spacing"),...Ri(2,4),full:"100%"}),width:({theme:n})=>({min:"min-content",max:"max-content",fit:"fit-content",screen:"100vw",...n("flexBasis")}),willChange:{scroll:"scroll-position"},zIndex:{...us(50,"",1,0,10),auto:"auto"}};function Ri(n,t){let e={};do for(var s=1;s<n;s++)e[`${s}/${n}`]=Number((s/n*100).toFixed(6))+"%";while(++n<=t);return e}function Ss(n,t,e=0){let s={};for(;e<=n;e=2*e||1)s[e]=e+t;return s}function us(n,t="",e=1,s=0,r=1,i={}){for(;s<=n;s+=r)i[s]=s/e+t;return i}function Gt(n){return({theme:t})=>t(n)}let sy={"*,::before,::after":{boxSizing:"border-box",borderWidth:"0",borderStyle:"solid",borderColor:"theme(borderColor.DEFAULT, currentColor)"},"::before,::after":{"--tw-content":"''"},html:{lineHeight:1.5,WebkitTextSizeAdjust:"100%",MozTabSize:"4",tabSize:4,fontFamily:`theme(fontFamily.sans, ${lc.fontFamily.sans})`,fontFeatureSettings:"theme(fontFamily.sans[1].fontFeatureSettings, normal)"},body:{margin:"0",lineHeight:"inherit"},hr:{height:"0",color:"inherit",borderTopWidth:"1px"},"abbr:where([title])":{textDecoration:"underline dotted"},"h1,h2,h3,h4,h5,h6":{fontSize:"inherit",fontWeight:"inherit"},a:{color:"inherit",textDecoration:"inherit"},"b,strong":{fontWeight:"bolder"},"code,kbd,samp,pre":{fontFamily:`theme(fontFamily.mono, ${lc.fontFamily.mono})`,fontFeatureSettings:"theme(fontFamily.mono[1].fontFeatureSettings, normal)",fontSize:"1em"},small:{fontSize:"80%"},"sub,sup":{fontSize:"75%",lineHeight:0,position:"relative",verticalAlign:"baseline"},sub:{bottom:"-0.25em"},sup:{top:"-0.5em"},table:{textIndent:"0",borderColor:"inherit",borderCollapse:"collapse"},"button,input,optgroup,select,textarea":{fontFamily:"inherit",fontSize:"100%",lineHeight:"inherit",color:"inherit",margin:"0",padding:"0"},"button,select":{textTransform:"none"},"button,[type='button'],[type='reset'],[type='submit']":{WebkitAppearance:"button",backgroundColor:"transparent",backgroundImage:"none"},":-moz-focusring":{outline:"auto"},":-moz-ui-invalid":{boxShadow:"none"},progress:{verticalAlign:"baseline"},"::-webkit-inner-spin-button,::-webkit-outer-spin-button":{height:"auto"},"[type='search']":{WebkitAppearance:"textfield",outlineOffset:"-2px"},"::-webkit-search-decoration":{WebkitAppearance:"none"},"::-webkit-file-upload-button":{WebkitAppearance:"button",font:"inherit"},summary:{display:"list-item"},"blockquote,dl,dd,h1,h2,h3,h4,h5,h6,hr,figure,p,pre":{margin:"0"},fieldset:{margin:"0",padding:"0"},legend:{padding:"0"},"ol,ul,menu":{listStyle:"none",margin:"0",padding:"0"},textarea:{resize:"vertical"},"input::placeholder,textarea::placeholder":{opacity:1,color:"theme(colors.gray.400, #9ca3af)"},'button,[role="button"]':{cursor:"pointer"},":disabled":{cursor:"default"},"img,svg,video,canvas,audio,iframe,embed,object":{display:"block",verticalAlign:"middle"},"img,video":{maxWidth:"100%",height:"auto"},"[hidden]":{display:"none"}},ny=[it("\\[([-\\w]+):(.+)]",({1:n,2:t},e)=>({"@layer overrides":{"&":{[n]:or(`[${t}]`,"",e)}}})),it("(group|peer)([~/][^-[]+)?",({input:n},{h:t})=>[{c:t(n)}]),at("aspect-","aspectRatio"),it("container",(n,{theme:t})=>{let{screens:e=t("screens"),center:s,padding:r}=t("container"),i={width:"100%",marginRight:s&&"auto",marginLeft:s&&"auto",...o("xs")};for(let l in e){let a=e[l];typeof a=="string"&&(i[Sh(a)]={"&":{maxWidth:a,...o(l)}})}return i;function o(l){let a=r&&(typeof r=="string"?r:r[l]||r.DEFAULT);if(a)return{paddingRight:a,paddingLeft:a}}}),at("content-","content",({_:n})=>({"--tw-content":n,content:"var(--tw-content)"})),it("(?:box-)?decoration-(slice|clone)","boxDecorationBreak"),it("box-(border|content)","boxSizing",({1:n})=>n+"-box"),it("hidden",{display:"none"}),it("table-(auto|fixed)","tableLayout"),it(["(block|flex|table|grid|inline|contents|flow-root|list-item)","(inline-(block|flex|table|grid))","(table-(caption|cell|column|row|(column|row|footer|header)-group))"],"display"),"(float)-(left|right|none)","(clear)-(left|right|none|both)","(overflow(?:-[xy])?)-(auto|hidden|clip|visible|scroll)","(isolation)-(auto)",it("isolate","isolation"),it("object-(contain|cover|fill|none|scale-down)","objectFit"),at("object-","objectPosition"),it("object-(top|bottom|center|(left|right)(-(top|bottom))?)","objectPosition",_a),it("overscroll(-[xy])?-(auto|contain|none)",({1:n="",2:t})=>({["overscroll-behavior"+n]:t})),it("(static|fixed|absolute|relative|sticky)","position"),at("-?inset(-[xy])?(?:$|-)","inset",({1:n,_:t})=>({top:n!="-x"&&t,right:n!="-y"&&t,bottom:n!="-x"&&t,left:n!="-y"&&t})),at("-?(top|bottom|left|right)(?:$|-)","inset"),it("(visible|collapse)","visibility"),it("invisible",{visibility:"hidden"}),at("-?z-","zIndex"),it("flex-((row|col)(-reverse)?)","flexDirection",du),it("flex-(wrap|wrap-reverse|nowrap)","flexWrap"),at("(flex-(?:grow|shrink))(?:$|-)"),at("(flex)-"),at("grow(?:$|-)","flexGrow"),at("shrink(?:$|-)","flexShrink"),at("basis-","flexBasis"),at("-?(order)-"),"-?(order)-(\\d+)",at("grid-cols-","gridTemplateColumns"),it("grid-cols-(\\d+)","gridTemplateColumns",pu),at("col-","gridColumn"),it("col-(span)-(\\d+)","gridColumn",mu),at("col-start-","gridColumnStart"),it("col-start-(auto|\\d+)","gridColumnStart"),at("col-end-","gridColumnEnd"),it("col-end-(auto|\\d+)","gridColumnEnd"),at("grid-rows-","gridTemplateRows"),it("grid-rows-(\\d+)","gridTemplateRows",pu),at("row-","gridRow"),it("row-(span)-(\\d+)","gridRow",mu),at("row-start-","gridRowStart"),it("row-start-(auto|\\d+)","gridRowStart"),at("row-end-","gridRowEnd"),it("row-end-(auto|\\d+)","gridRowEnd"),it("grid-flow-((row|col)(-dense)?)","gridAutoFlow",n=>_a(du(n))),it("grid-flow-(dense)","gridAutoFlow"),at("auto-cols-","gridAutoColumns"),at("auto-rows-","gridAutoRows"),at("gap-x(?:$|-)","gap","columnGap"),at("gap-y(?:$|-)","gap","rowGap"),at("gap(?:$|-)","gap"),"(justify-(?:items|self))-",it("justify-","justifyContent",uu),it("(content|items|self)-",n=>({["align-"+n[1]]:uu(n)})),it("(place-(content|items|self))-",({1:n,$$:t})=>({[n]:("wun".includes(t[3])?"space-":"")+t})),at("p([xytrbl])?(?:$|-)","padding",qr("padding")),at("-?m([xytrbl])?(?:$|-)","margin",qr("margin")),at("-?space-(x|y)(?:$|-)","space",({1:n,_:t})=>({"&>:not([hidden])~:not([hidden])":{[`--tw-space-${n}-reverse`]:"0",["margin-"+{y:"top",x:"left"}[n]]:`calc(${t} * calc(1 - var(--tw-space-${n}-reverse)))`,["margin-"+{y:"bottom",x:"right"}[n]]:`calc(${t} * var(--tw-space-${n}-reverse))`}})),it("space-(x|y)-reverse",({1:n})=>({"&>:not([hidden])~:not([hidden])":{[`--tw-space-${n}-reverse`]:"1"}})),at("w-","width"),at("min-w-","minWidth"),at("max-w-","maxWidth"),at("h-","height"),at("min-h-","minHeight"),at("max-h-","maxHeight"),at("font-","fontWeight"),at("font-","fontFamily",({_:n})=>typeof(n=ne(n))[1]=="string"?{fontFamily:Rs(n)}:{fontFamily:Rs(n[0]),...n[1]}),it("antialiased",{WebkitFontSmoothing:"antialiased",MozOsxFontSmoothing:"grayscale"}),it("subpixel-antialiased",{WebkitFontSmoothing:"auto",MozOsxFontSmoothing:"auto"}),it("italic","fontStyle"),it("not-italic",{fontStyle:"normal"}),it("(ordinal|slashed-zero|(normal|lining|oldstyle|proportional|tabular)-nums|(diagonal|stacked)-fractions)",({1:n,2:t="",3:e})=>t=="normal"?{fontVariantNumeric:"normal"}:{["--tw-"+(e?"numeric-fraction":"pt".includes(t[0])?"numeric-spacing":t?"numeric-figure":n)]:n,fontVariantNumeric:"var(--tw-ordinal) var(--tw-slashed-zero) var(--tw-numeric-figure) var(--tw-numeric-spacing) var(--tw-numeric-fraction)",...tr({"--tw-ordinal":"var(--tw-empty,/*!*/ /*!*/)","--tw-slashed-zero":"var(--tw-empty,/*!*/ /*!*/)","--tw-numeric-figure":"var(--tw-empty,/*!*/ /*!*/)","--tw-numeric-spacing":"var(--tw-empty,/*!*/ /*!*/)","--tw-numeric-fraction":"var(--tw-empty,/*!*/ /*!*/)"})}),at("tracking-","letterSpacing"),at("leading-","lineHeight"),it("list-(inside|outside)","listStylePosition"),at("list-","listStyleType"),it("list-","listStyleType"),at("placeholder-opacity-","placeholderOpacity",({_:n})=>({"&::placeholder":{"--tw-placeholder-opacity":n}})),Fe("placeholder-",{property:"color",selector:"&::placeholder"}),it("text-(left|center|right|justify|start|end)","textAlign"),it("text-(ellipsis|clip)","textOverflow"),at("text-opacity-","textOpacity","--tw-text-opacity"),Fe("text-",{property:"color"}),at("text-","fontSize",({_:n})=>typeof n=="string"?{fontSize:n}:{fontSize:n[0],...typeof n[1]=="string"?{lineHeight:n[1]}:n[1]}),at("indent-","textIndent"),it("(overline|underline|line-through)","textDecorationLine"),it("no-underline",{textDecorationLine:"none"}),at("underline-offset-","textUnderlineOffset"),Fe("decoration-",{section:"textDecorationColor",opacityVariable:!1,opacitySection:"opacity"}),at("decoration-","textDecorationThickness"),it("decoration-","textDecorationStyle"),it("(uppercase|lowercase|capitalize)","textTransform"),it("normal-case",{textTransform:"none"}),it("truncate",{overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"}),it("align-","verticalAlign"),it("whitespace-","whiteSpace"),it("break-normal",{wordBreak:"normal",overflowWrap:"normal"}),it("break-words",{overflowWrap:"break-word"}),it("break-all",{wordBreak:"break-all"}),it("break-keep",{wordBreak:"keep-all"}),Fe("caret-",{opacityVariable:!1,opacitySection:"opacity"}),Fe("accent-",{opacityVariable:!1,opacitySection:"opacity"}),it("bg-gradient-to-([trbl]|[tb][rl])","backgroundImage",({1:n})=>`linear-gradient(to ${Pr(n," ")},var(--tw-gradient-stops))`),Fe("from-",{section:"gradientColorStops",opacityVariable:!1,opacitySection:"opacity"},({_:n})=>({"--tw-gradient-from":n.value,"--tw-gradient-to":n.color({opacityValue:"0"}),"--tw-gradient-stops":"var(--tw-gradient-from),var(--tw-gradient-to)"})),Fe("via-",{section:"gradientColorStops",opacityVariable:!1,opacitySection:"opacity"},({_:n})=>({"--tw-gradient-to":n.color({opacityValue:"0"}),"--tw-gradient-stops":`var(--tw-gradient-from),${n.value},var(--tw-gradient-to)`})),Fe("to-",{section:"gradientColorStops",property:"--tw-gradient-to",opacityVariable:!1,opacitySection:"opacity"}),it("bg-(fixed|local|scroll)","backgroundAttachment"),it("bg-origin-(border|padding|content)","backgroundOrigin",({1:n})=>n+"-box"),it(["bg-(no-repeat|repeat(-[xy])?)","bg-repeat-(round|space)"],"backgroundRepeat"),it("bg-blend-","backgroundBlendMode"),it("bg-clip-(border|padding|content|text)","backgroundClip",({1:n})=>n+(n=="text"?"":"-box")),at("bg-opacity-","backgroundOpacity","--tw-bg-opacity"),Fe("bg-",{section:"backgroundColor"}),at("bg-","backgroundImage"),at("bg-","backgroundPosition"),it("bg-(top|bottom|center|(left|right)(-(top|bottom))?)","backgroundPosition",_a),at("bg-","backgroundSize"),at("rounded(?:$|-)","borderRadius"),at("rounded-([trbl]|[tb][rl])(?:$|-)","borderRadius",({1:n,_:t})=>{let e={t:["tl","tr"],r:["tr","br"],b:["bl","br"],l:["bl","tl"]}[n]||[n,n];return{[`border-${Pr(e[0])}-radius`]:t,[`border-${Pr(e[1])}-radius`]:t}}),it("border-(collapse|separate)","borderCollapse"),at("border-opacity(?:$|-)","borderOpacity","--tw-border-opacity"),it("border-(solid|dashed|dotted|double|none)","borderStyle"),at("border-spacing(-[xy])?(?:$|-)","borderSpacing",({1:n,_:t})=>({...tr({"--tw-border-spacing-x":"0","--tw-border-spacing-y":"0"}),["--tw-border-spacing"+(n||"-x")]:t,["--tw-border-spacing"+(n||"-y")]:t,"border-spacing":"var(--tw-border-spacing-x) var(--tw-border-spacing-y)"})),Fe("border-([xytrbl])-",{section:"borderColor"},qr("border","Color")),Fe("border-"),at("border-([xytrbl])(?:$|-)","borderWidth",qr("border","Width")),at("border(?:$|-)","borderWidth"),at("divide-opacity(?:$|-)","divideOpacity",({_:n})=>({"&>:not([hidden])~:not([hidden])":{"--tw-divide-opacity":n}})),it("divide-(solid|dashed|dotted|double|none)",({1:n})=>({"&>:not([hidden])~:not([hidden])":{borderStyle:n}})),it("divide-([xy]-reverse)",({1:n})=>({"&>:not([hidden])~:not([hidden])":{["--tw-divide-"+n]:"1"}})),at("divide-([xy])(?:$|-)","divideWidth",({1:n,_:t})=>{let e={x:"lr",y:"tb"}[n];return{"&>:not([hidden])~:not([hidden])":{[`--tw-divide-${n}-reverse`]:"0",[`border-${Pr(e[0])}Width`]:`calc(${t} * calc(1 - var(--tw-divide-${n}-reverse)))`,[`border-${Pr(e[1])}Width`]:`calc(${t} * var(--tw-divide-${n}-reverse))`}}}),Fe("divide-",{property:"borderColor",selector:"&>:not([hidden])~:not([hidden])"}),at("ring-opacity(?:$|-)","ringOpacity","--tw-ring-opacity"),Fe("ring-offset-",{property:"--tw-ring-offset-color",opacityVariable:!1}),at("ring-offset(?:$|-)","ringOffsetWidth","--tw-ring-offset-width"),it("ring-inset",{"--tw-ring-inset":"inset"}),Fe("ring-",{property:"--tw-ring-color"}),at("ring(?:$|-)","ringWidth",({_:n},{theme:t})=>({...tr({"--tw-ring-offset-shadow":"0 0 #0000","--tw-ring-shadow":"0 0 #0000","--tw-shadow":"0 0 #0000","--tw-shadow-colored":"0 0 #0000","&":{"--tw-ring-inset":"var(--tw-empty,/*!*/ /*!*/)","--tw-ring-offset-width":t("ringOffsetWidth","","0px"),"--tw-ring-offset-color":ar(t("ringOffsetColor","","#fff")),"--tw-ring-color":ar(t("ringColor","","#93c5fd"),{opacityVariable:"--tw-ring-opacity"}),"--tw-ring-opacity":t("ringOpacity","","0.5")}}),"--tw-ring-offset-shadow":"var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color)","--tw-ring-shadow":`var(--tw-ring-inset) 0 0 0 calc(${n} + var(--tw-ring-offset-width)) var(--tw-ring-color)`,boxShadow:"var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow)"})),Fe("shadow-",{section:"boxShadowColor",opacityVariable:!1,opacitySection:"opacity"},({_:n})=>({"--tw-shadow-color":n.value,"--tw-shadow":"var(--tw-shadow-colored)"})),at("shadow(?:$|-)","boxShadow",({_:n})=>({...tr({"--tw-ring-offset-shadow":"0 0 #0000","--tw-ring-shadow":"0 0 #0000","--tw-shadow":"0 0 #0000","--tw-shadow-colored":"0 0 #0000"}),"--tw-shadow":Rs(n),"--tw-shadow-colored":Rs(n).replace(/([^,]\s+)(?:#[a-f\d]+|(?:(?:hsl|rgb)a?|hwb|lab|lch|color|var)\(.+?\)|[a-z]+)(,|$)/g,"$1var(--tw-shadow-color)$2"),boxShadow:"var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow)"})),at("(opacity)-"),it("mix-blend-","mixBlendMode"),...fu(),...fu("backdrop-"),at("transition(?:$|-)","transitionProperty",(n,{theme:t})=>({transitionProperty:Rs(n),transitionTimingFunction:n._=="none"?void 0:Rs(t("transitionTimingFunction","")),transitionDuration:n._=="none"?void 0:Rs(t("transitionDuration",""))})),at("duration(?:$|-)","transitionDuration","transitionDuration",Rs),at("ease(?:$|-)","transitionTimingFunction","transitionTimingFunction",Rs),at("delay(?:$|-)","transitionDelay","transitionDelay",Rs),at("animate(?:$|-)","animation",(n,{theme:t,h:e,e:s})=>{let r=Rs(n),i=r.split(" "),o=t("keyframes",i[0]);return o?{["@keyframes "+(i[0]=s(e(i[0])))]:o,animation:i.join(" ")}:{animation:r}}),"(transform)-(none)",it("transform",cc),it("transform-(cpu|gpu)",({1:n})=>({"--tw-transform":km(n=="gpu")})),at("scale(-[xy])?-","scale",({1:n,_:t})=>({["--tw-scale"+(n||"-x")]:t,["--tw-scale"+(n||"-y")]:t,...cc()})),at("-?(rotate)-","rotate",xl),at("-?(translate-[xy])-","translate",xl),at("-?(skew-[xy])-","skew",xl),it("origin-(center|((top|bottom)(-(left|right))?)|left|right)","transformOrigin",_a),"(appearance)-",at("(columns)-"),"(columns)-(\\d+)","(break-(?:before|after|inside))-",at("(cursor)-"),"(cursor)-",it("snap-(none)","scroll-snap-type"),it("snap-(x|y|both)",({1:n})=>({...tr({"--tw-scroll-snap-strictness":"proximity"}),"scroll-snap-type":n+" var(--tw-scroll-snap-strictness)"})),it("snap-(mandatory|proximity)","--tw-scroll-snap-strictness"),it("snap-(?:(start|end|center)|align-(none))","scroll-snap-align"),it("snap-(normal|always)","scroll-snap-stop"),it("scroll-(auto|smooth)","scroll-behavior"),at("scroll-p([xytrbl])?(?:$|-)","padding",qr("scroll-padding")),at("-?scroll-m([xytrbl])?(?:$|-)","scroll-margin",qr("scroll-margin")),it("touch-(auto|none|manipulation)","touch-action"),it("touch-(pinch-zoom|pan-(?:(x|left|right)|(y|up|down)))",({1:n,2:t,3:e})=>({...tr({"--tw-pan-x":"var(--tw-empty,/*!*/ /*!*/)","--tw-pan-y":"var(--tw-empty,/*!*/ /*!*/)","--tw-pinch-zoom":"var(--tw-empty,/*!*/ /*!*/)","--tw-touch-action":"var(--tw-pan-x) var(--tw-pan-y) var(--tw-pinch-zoom)"}),[`--tw-${t?"pan-x":e?"pan-y":n}`]:n,"touch-action":"var(--tw-touch-action)"})),it("outline-none",{outline:"2px solid transparent","outline-offset":"2px"}),it("outline",{outlineStyle:"solid"}),it("outline-(dashed|dotted|double)","outlineStyle"),at("-?(outline-offset)-"),Fe("outline-",{opacityVariable:!1,opacitySection:"opacity"}),at("outline-","outlineWidth"),"(pointer-events)-",at("(will-change)-"),"(will-change)-",["resize(?:-(none|x|y))?","resize",({1:n})=>({x:"horizontal",y:"vertical"})[n]||n||"both"],it("select-(none|text|all|auto)","userSelect"),Fe("fill-",{section:"fill",opacityVariable:!1,opacitySection:"opacity"}),Fe("stroke-",{section:"stroke",opacityVariable:!1,opacitySection:"opacity"}),at("stroke-","strokeWidth"),it("sr-only",{position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",whiteSpace:"nowrap",clip:"rect(0,0,0,0)",borderWidth:"0"}),it("not-sr-only",{position:"static",width:"auto",height:"auto",padding:"0",margin:"0",overflow:"visible",whiteSpace:"normal",clip:"auto"})];function _a(n){return(typeof n=="string"?n:n[1]).replace(/-/g," ").trim()}function du(n){return(typeof n=="string"?n:n[1]).replace("col","column")}function Pr(n,t="-"){let e=[];for(let s of n)e.push({t:"top",r:"right",b:"bottom",l:"left"}[s]);return e.join(t)}function Rs(n){return n&&""+(n._||n)}function uu({$$:n}){return({r:"flex-","":"flex-",w:"space-",u:"space-",n:"space-"}[n[3]||""]||"")+n}function qr(n,t=""){return({1:e,_:s})=>{let r={x:"lr",y:"tb"}[e]||e+e;return r?{...Ka(n+"-"+Pr(r[0])+t,s),...Ka(n+"-"+Pr(r[1])+t,s)}:Ka(n+t,s)}}function fu(n=""){let t=["blur","brightness","contrast","grayscale","hue-rotate","invert",n&&"opacity","saturate","sepia",!n&&"drop-shadow"].filter(Boolean),e={};for(let s of t)e[`--tw-${n}${s}`]="var(--tw-empty,/*!*/ /*!*/)";return e={...tr(e),[`${n}filter`]:t.map(s=>`var(--tw-${n}${s})`).join(" ")},[`(${n}filter)-(none)`,it(`${n}filter`,e),...t.map(s=>at(`${s[0]=="h"?"-?":""}(${n}${s})(?:$|-)`,s,({1:r,_:i})=>({[`--tw-${r}`]:ne(i).map(o=>`${s}(${o})`).join(" "),...e})))]}function xl({1:n,_:t}){return{["--tw-"+n]:t,...cc()}}function cc(){return{...tr({"--tw-translate-x":"0","--tw-translate-y":"0","--tw-rotate":"0","--tw-skew-x":"0","--tw-skew-y":"0","--tw-scale-x":"1","--tw-scale-y":"1","--tw-transform":km()}),transform:"var(--tw-transform)"}}function km(n){return[n?"translate3d(var(--tw-translate-x),var(--tw-translate-y),0)":"translateX(var(--tw-translate-x)) translateY(var(--tw-translate-y))","rotate(var(--tw-rotate))","skewX(var(--tw-skew-x))","skewY(var(--tw-skew-y))","scaleX(var(--tw-scale-x))","scaleY(var(--tw-scale-y))"].join(" ")}function mu({1:n,2:t}){return`${n} ${t} / ${n} ${t}`}function pu({1:n}){return`repeat(${n},minmax(0,1fr))`}function tr(n){return{"@layer defaults":{"*,::before,::after":n,"::backdrop":n}}}let ry=[["sticky","@supports ((position: -webkit-sticky) or (position:sticky))"],["motion-reduce","@media (prefers-reduced-motion:reduce)"],["motion-safe","@media (prefers-reduced-motion:no-preference)"],["print","@media print"],["(portrait|landscape)",({1:n})=>`@media (orientation:${n})`],["contrast-(more|less)",({1:n})=>`@media (prefers-contrast:${n})`],["(first-(letter|line)|placeholder|backdrop|before|after)",({1:n})=>`&::${n}`],["(marker|selection)",({1:n})=>`& *::${n},&::${n}`],["file","&::file-selector-button"],["(first|last|only)",({1:n})=>`&:${n}-child`],["even","&:nth-child(2n)"],["odd","&:nth-child(odd)"],["open","&[open]"],["(aria|data)-",({1:n,$$:t},e)=>t&&`&[${n}-${e.theme(n,t)||or(t,"",e)||`${t}="true"`}]`],["((group|peer)(~[^-[]+)?)(-\\[(.+)]|[-[].+?)(\\/.+)?",({2:n,3:t="",4:e,5:s="",6:r=t},{e:i,h:o,v:l})=>{let a=sa(s)||(e[0]=="["?e:l(e.slice(1)));return`${(a.includes("&")?a:"&"+a).replace(/&/g,`:merge(.${i(o(n+r))})`)}${n[0]=="p"?"~":" "}&`}],["(ltr|rtl)",({1:n})=>`[dir="${n}"] &`],["supports-",({$$:n},t)=>{if(n&&(n=t.theme("supports",n)||or(n,"",t)),n)return n.includes(":")||(n+=":var(--tw)"),/^\w*\s*\(/.test(n)||(n=`(${n})`),`@supports ${n.replace(/\b(and|or|not)\b/g," $1 ").trim()}`}],["max-",({$$:n},t)=>{if(n&&(n=t.theme("screens",n)||or(n,"",t)),typeof n=="string")return`@media not all and (min-width:${n})`}],["min-",({$$:n},t)=>(n&&(n=or(n,"",t)),n&&`@media (min-width:${n})`)],[/^\[(.+)]$/,({1:n})=>/[&@]/.test(n)&&sa(n).replace(/[}]+$/,"").split("{")]];function iy({colors:n,disablePreflight:t}={}){return{preflight:t?void 0:sy,theme:{...lc,colors:{inherit:"inherit",current:"currentColor",transparent:"transparent",black:"#000",white:"#fff",...n}},variants:ry,rules:ny,finalize(e){return e.n&&e.d&&e.r.some(s=>/^&::(before|after)$/.test(s))&&!/(^|;)content:/.test(e.d)?{...e,d:"content:var(--tw-content);"+e.d}:e}}}let ay={50:"#f8fafc",100:"#f1f5f9",200:"#e2e8f0",300:"#cbd5e1",400:"#94a3b8",500:"#64748b",600:"#475569",700:"#334155",800:"#1e293b",900:"#0f172a"},oy={50:"#f9fafb",100:"#f3f4f6",200:"#e5e7eb",300:"#d1d5db",400:"#9ca3af",500:"#6b7280",600:"#4b5563",700:"#374151",800:"#1f2937",900:"#111827"},ly={50:"#fafafa",100:"#f4f4f5",200:"#e4e4e7",300:"#d4d4d8",400:"#a1a1aa",500:"#71717a",600:"#52525b",700:"#3f3f46",800:"#27272a",900:"#18181b"},cy={50:"#fafafa",100:"#f5f5f5",200:"#e5e5e5",300:"#d4d4d4",400:"#a3a3a3",500:"#737373",600:"#525252",700:"#404040",800:"#262626",900:"#171717"},hy={50:"#fafaf9",100:"#f5f5f4",200:"#e7e5e4",300:"#d6d3d1",400:"#a8a29e",500:"#78716c",600:"#57534e",700:"#44403c",800:"#292524",900:"#1c1917"},dy={50:"#fef2f2",100:"#fee2e2",200:"#fecaca",300:"#fca5a5",400:"#f87171",500:"#ef4444",600:"#dc2626",700:"#b91c1c",800:"#991b1b",900:"#7f1d1d"},uy={50:"#fff7ed",100:"#ffedd5",200:"#fed7aa",300:"#fdba74",400:"#fb923c",500:"#f97316",600:"#ea580c",700:"#c2410c",800:"#9a3412",900:"#7c2d12"},fy={50:"#fffbeb",100:"#fef3c7",200:"#fde68a",300:"#fcd34d",400:"#fbbf24",500:"#f59e0b",600:"#d97706",700:"#b45309",800:"#92400e",900:"#78350f"},my={50:"#fefce8",100:"#fef9c3",200:"#fef08a",300:"#fde047",400:"#facc15",500:"#eab308",600:"#ca8a04",700:"#a16207",800:"#854d0e",900:"#713f12"},py={50:"#f7fee7",100:"#ecfccb",200:"#d9f99d",300:"#bef264",400:"#a3e635",500:"#84cc16",600:"#65a30d",700:"#4d7c0f",800:"#3f6212",900:"#365314"},gy={50:"#f0fdf4",100:"#dcfce7",200:"#bbf7d0",300:"#86efac",400:"#4ade80",500:"#22c55e",600:"#16a34a",700:"#15803d",800:"#166534",900:"#14532d"},xy={50:"#ecfdf5",100:"#d1fae5",200:"#a7f3d0",300:"#6ee7b7",400:"#34d399",500:"#10b981",600:"#059669",700:"#047857",800:"#065f46",900:"#064e3b"},by={50:"#f0fdfa",100:"#ccfbf1",200:"#99f6e4",300:"#5eead4",400:"#2dd4bf",500:"#14b8a6",600:"#0d9488",700:"#0f766e",800:"#115e59",900:"#134e4a"},yy={50:"#ecfeff",100:"#cffafe",200:"#a5f3fc",300:"#67e8f9",400:"#22d3ee",500:"#06b6d4",600:"#0891b2",700:"#0e7490",800:"#155e75",900:"#164e63"},wy={50:"#f0f9ff",100:"#e0f2fe",200:"#bae6fd",300:"#7dd3fc",400:"#38bdf8",500:"#0ea5e9",600:"#0284c7",700:"#0369a1",800:"#075985",900:"#0c4a6e"},vy={50:"#eff6ff",100:"#dbeafe",200:"#bfdbfe",300:"#93c5fd",400:"#60a5fa",500:"#3b82f6",600:"#2563eb",700:"#1d4ed8",800:"#1e40af",900:"#1e3a8a"},_y={50:"#eef2ff",100:"#e0e7ff",200:"#c7d2fe",300:"#a5b4fc",400:"#818cf8",500:"#6366f1",600:"#4f46e5",700:"#4338ca",800:"#3730a3",900:"#312e81"},Ey={50:"#f5f3ff",100:"#ede9fe",200:"#ddd6fe",300:"#c4b5fd",400:"#a78bfa",500:"#8b5cf6",600:"#7c3aed",700:"#6d28d9",800:"#5b21b6",900:"#4c1d95"},Sy={50:"#faf5ff",100:"#f3e8ff",200:"#e9d5ff",300:"#d8b4fe",400:"#c084fc",500:"#a855f7",600:"#9333ea",700:"#7e22ce",800:"#6b21a8",900:"#581c87"},Ty={50:"#fdf4ff",100:"#fae8ff",200:"#f5d0fe",300:"#f0abfc",400:"#e879f9",500:"#d946ef",600:"#c026d3",700:"#a21caf",800:"#86198f",900:"#701a75"},Ay={50:"#fdf2f8",100:"#fce7f3",200:"#fbcfe8",300:"#f9a8d4",400:"#f472b6",500:"#ec4899",600:"#db2777",700:"#be185d",800:"#9d174d",900:"#831843"},Cy={50:"#fff1f2",100:"#ffe4e6",200:"#fecdd3",300:"#fda4af",400:"#fb7185",500:"#f43f5e",600:"#e11d48",700:"#be123c",800:"#9f1239",900:"#881337"},ky={__proto__:null,slate:ay,gray:oy,zinc:ly,neutral:cy,stone:hy,red:dy,orange:uy,amber:fy,yellow:my,lime:py,green:gy,emerald:xy,teal:by,cyan:yy,sky:wy,blue:vy,indigo:_y,violet:Ey,purple:Sy,fuchsia:Ty,pink:Ay,rose:Cy};function Iy({disablePreflight:n}={}){return iy({colors:ky,disablePreflight:n})}var Ry=new Map([["align-self","-ms-grid-row-align"],["color-adjust","-webkit-print-color-adjust"],["column-gap","grid-column-gap"],["forced-color-adjust","-ms-high-contrast-adjust"],["gap","grid-gap"],["grid-template-columns","-ms-grid-columns"],["grid-template-rows","-ms-grid-rows"],["justify-self","-ms-grid-column-align"],["margin-inline-end","-webkit-margin-end"],["margin-inline-start","-webkit-margin-start"],["mask-border","-webkit-mask-box-image"],["mask-border-outset","-webkit-mask-box-image-outset"],["mask-border-slice","-webkit-mask-box-image-slice"],["mask-border-source","-webkit-mask-box-image-source"],["mask-border-repeat","-webkit-mask-box-image-repeat"],["mask-border-width","-webkit-mask-box-image-width"],["overflow-wrap","word-wrap"],["padding-inline-end","-webkit-padding-end"],["padding-inline-start","-webkit-padding-start"],["print-color-adjust","color-adjust"],["row-gap","grid-row-gap"],["scroll-margin-bottom","scroll-snap-margin-bottom"],["scroll-margin-left","scroll-snap-margin-left"],["scroll-margin-right","scroll-snap-margin-right"],["scroll-margin-top","scroll-snap-margin-top"],["scroll-margin","scroll-snap-margin"],["text-combine-upright","-ms-text-combine-horizontal"]]);function My(n){return Ry.get(n)}function Py(n){var t=/^(?:(text-(?:decoration$|e|or|si)|back(?:ground-cl|d|f)|box-d|mask(?:$|-[ispro]|-cl)|pr|hyphena|flex-d)|(tab-|column(?!-s)|text-align-l)|(ap)|u|hy)/i.exec(n);return t?t[1]?1:t[2]?2:t[3]?3:5:0}function Ny(n,t){var e=/^(?:(pos)|(cli)|(background-i)|(flex(?:$|-b)|(?:max-|min-)?(?:block-s|inl|he|widt))|dis)/i.exec(n);return e?e[1]?/^sti/i.test(t)?1:0:e[2]?/^pat/i.test(t)?1:0:e[3]?/^image-/i.test(t)?1:0:e[4]?t[3]==="-"?2:0:/^(?:inline-)?grid$/i.test(t)?4:0:0}let Fy=[["-webkit-",1],["-moz-",2],["-ms-",4]];function Dy(){return({stringify:n})=>({stringify(t,e,s){let r="",i=My(t);i&&(r+=n(i,e,s)+";");let o=Py(t),l=Ny(t,e);for(let a of Fy)o&a[1]&&(r+=n(a[0]+t,e,s)+";"),l&a[1]&&(r+=n(t,a[0]+e,s)+";");return r+n(t,e,s)}})}const By=Am({presets:[Dy(),Iy()]});function Ly(n,t){const e=ty(new CSSStyleSheet),s=qb(By,e);Qb(s,n),t.adoptedStyleSheets=[e.target]}const Oy=Qx(),jy=()=>window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light";function Vy({children:n,shadowRootId:t}){const[e,s]=D.useState(jy());D.useEffect(()=>{const i=window.matchMedia("(prefers-color-scheme: dark)"),o=l=>{const a=l.matches;s(a?"dark":"light")};return i.addEventListener("change",o),()=>{i.removeEventListener("change",o)}},[]);const r=D.useCallback(()=>{s(i=>i==="dark"?"light":"dark")},[]);return v.jsxs(N0,{theme:Oy,cssVarsRoot:`#${t}`,children:[v.jsx(zx,{initialColorMode:"system"}),v.jsxs(F0.Provider,{value:{colorMode:e,setColorMode:s,toggleColorMode:r},children:[v.jsx(D0,{}),v.jsx(B0,{}),n]})]})}function Uy({children:n,rootId:t}){const[e,s]=D.useState(null);return D.useEffect(()=>{function r(o){s(O0({key:t,container:o}))}const i=document.getElementById(t);i&&i.shadowRoot&&r(i.shadowRoot)},[]),e?v.jsx(L0,{value:e,children:n}):null}const Im=async()=>{var t;const n=await j0();(n==null?void 0:n.status)===200&&window.location.replace((t=n==null?void 0:n.data)==null?void 0:t.redirectUrl)};var Yr=(n=>(n[n.WEBGL_LEGACY=0]="WEBGL_LEGACY",n[n.WEBGL=1]="WEBGL",n[n.WEBGL2=2]="WEBGL2",n))(Yr||{}),Rm=(n=>(n[n.UNKNOWN=0]="UNKNOWN",n[n.WEBGL=1]="WEBGL",n[n.CANVAS=2]="CANVAS",n))(Rm||{}),hc=(n=>(n[n.COLOR=16384]="COLOR",n[n.DEPTH=256]="DEPTH",n[n.STENCIL=1024]="STENCIL",n))(hc||{}),dt=(n=>(n[n.NORMAL=0]="NORMAL",n[n.ADD=1]="ADD",n[n.MULTIPLY=2]="MULTIPLY",n[n.SCREEN=3]="SCREEN",n[n.OVERLAY=4]="OVERLAY",n[n.DARKEN=5]="DARKEN",n[n.LIGHTEN=6]="LIGHTEN",n[n.COLOR_DODGE=7]="COLOR_DODGE",n[n.COLOR_BURN=8]="COLOR_BURN",n[n.HARD_LIGHT=9]="HARD_LIGHT",n[n.SOFT_LIGHT=10]="SOFT_LIGHT",n[n.DIFFERENCE=11]="DIFFERENCE",n[n.EXCLUSION=12]="EXCLUSION",n[n.HUE=13]="HUE",n[n.SATURATION=14]="SATURATION",n[n.COLOR=15]="COLOR",n[n.LUMINOSITY=16]="LUMINOSITY",n[n.NORMAL_NPM=17]="NORMAL_NPM",n[n.ADD_NPM=18]="ADD_NPM",n[n.SCREEN_NPM=19]="SCREEN_NPM",n[n.NONE=20]="NONE",n[n.SRC_OVER=0]="SRC_OVER",n[n.SRC_IN=21]="SRC_IN",n[n.SRC_OUT=22]="SRC_OUT",n[n.SRC_ATOP=23]="SRC_ATOP",n[n.DST_OVER=24]="DST_OVER",n[n.DST_IN=25]="DST_IN",n[n.DST_OUT=26]="DST_OUT",n[n.DST_ATOP=27]="DST_ATOP",n[n.ERASE=26]="ERASE",n[n.SUBTRACT=28]="SUBTRACT",n[n.XOR=29]="XOR",n))(dt||{}),Ws=(n=>(n[n.POINTS=0]="POINTS",n[n.LINES=1]="LINES",n[n.LINE_LOOP=2]="LINE_LOOP",n[n.LINE_STRIP=3]="LINE_STRIP",n[n.TRIANGLES=4]="TRIANGLES",n[n.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",n[n.TRIANGLE_FAN=6]="TRIANGLE_FAN",n))(Ws||{}),st=(n=>(n[n.RGBA=6408]="RGBA",n[n.RGB=6407]="RGB",n[n.RG=33319]="RG",n[n.RED=6403]="RED",n[n.RGBA_INTEGER=36249]="RGBA_INTEGER",n[n.RGB_INTEGER=36248]="RGB_INTEGER",n[n.RG_INTEGER=33320]="RG_INTEGER",n[n.RED_INTEGER=36244]="RED_INTEGER",n[n.ALPHA=6406]="ALPHA",n[n.LUMINANCE=6409]="LUMINANCE",n[n.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",n[n.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",n[n.DEPTH_STENCIL=34041]="DEPTH_STENCIL",n))(st||{}),hi=(n=>(n[n.TEXTURE_2D=3553]="TEXTURE_2D",n[n.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",n[n.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",n[n.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",n[n.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",n[n.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",n[n.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",n[n.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",n[n.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",n))(hi||{}),yt=(n=>(n[n.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",n[n.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",n[n.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",n[n.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",n[n.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",n[n.UNSIGNED_INT=5125]="UNSIGNED_INT",n[n.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",n[n.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",n[n.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",n[n.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",n[n.BYTE=5120]="BYTE",n[n.SHORT=5122]="SHORT",n[n.INT=5124]="INT",n[n.FLOAT=5126]="FLOAT",n[n.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",n[n.HALF_FLOAT=36193]="HALF_FLOAT",n))(yt||{}),ut=(n=>(n[n.FLOAT=0]="FLOAT",n[n.INT=1]="INT",n[n.UINT=2]="UINT",n))(ut||{}),ps=(n=>(n[n.NEAREST=0]="NEAREST",n[n.LINEAR=1]="LINEAR",n))(ps||{}),hr=(n=>(n[n.CLAMP=33071]="CLAMP",n[n.REPEAT=10497]="REPEAT",n[n.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",n))(hr||{}),Zs=(n=>(n[n.OFF=0]="OFF",n[n.POW2=1]="POW2",n[n.ON=2]="ON",n[n.ON_MANUAL=3]="ON_MANUAL",n))(Zs||{}),Qe=(n=>(n[n.NPM=0]="NPM",n[n.UNPACK=1]="UNPACK",n[n.PMA=2]="PMA",n[n.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",n[n.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",n[n.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA",n))(Qe||{}),fn=(n=>(n[n.NO=0]="NO",n[n.YES=1]="YES",n[n.AUTO=2]="AUTO",n[n.BLEND=0]="BLEND",n[n.CLEAR=1]="CLEAR",n[n.BLIT=2]="BLIT",n))(fn||{}),Ih=(n=>(n[n.AUTO=0]="AUTO",n[n.MANUAL=1]="MANUAL",n))(Ih||{}),As=(n=>(n.LOW="lowp",n.MEDIUM="mediump",n.HIGH="highp",n))(As||{}),Ce=(n=>(n[n.NONE=0]="NONE",n[n.SCISSOR=1]="SCISSOR",n[n.STENCIL=2]="STENCIL",n[n.SPRITE=3]="SPRITE",n[n.COLOR=4]="COLOR",n))(Ce||{}),Ae=(n=>(n[n.NONE=0]="NONE",n[n.LOW=2]="LOW",n[n.MEDIUM=4]="MEDIUM",n[n.HIGH=8]="HIGH",n))(Ae||{}),pn=(n=>(n[n.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",n[n.ARRAY_BUFFER=34962]="ARRAY_BUFFER",n[n.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",n))(pn||{});const Xy={createCanvas:(n,t)=>{const e=document.createElement("canvas");return e.width=n,e.height=t,e},getCanvasRenderingContext2D:()=>CanvasRenderingContext2D,getWebGLRenderingContext:()=>WebGLRenderingContext,getNavigator:()=>navigator,getBaseUrl:()=>document.baseURI??window.location.href,getFontFaceSet:()=>document.fonts,fetch:(n,t)=>fetch(n,t),parseXML:n=>new DOMParser().parseFromString(n,"text/xml")},ht={ADAPTER:Xy,RESOLUTION:1,CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1};var bl=/iPhone/i,gu=/iPod/i,xu=/iPad/i,bu=/\biOS-universal(?:.+)Mac\b/i,yl=/\bAndroid(?:.+)Mobile\b/i,yu=/Android/i,Kr=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,Ea=/Silk/i,vn=/Windows Phone/i,wu=/\bWindows(?:.+)ARM\b/i,vu=/BlackBerry/i,_u=/BB10/i,Eu=/Opera Mini/i,Su=/\b(CriOS|Chrome)(?:.+)Mobile/i,Tu=/Mobile(?:.+)Firefox\b/i,Au=function(n){return typeof n<"u"&&n.platform==="MacIntel"&&typeof n.maxTouchPoints=="number"&&n.maxTouchPoints>1&&typeof MSStream>"u"};function Gy(n){return function(t){return t.test(n)}}function Cu(n){var t={userAgent:"",platform:"",maxTouchPoints:0};!n&&typeof navigator<"u"?t={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0}:typeof n=="string"?t.userAgent=n:n&&n.userAgent&&(t={userAgent:n.userAgent,platform:n.platform,maxTouchPoints:n.maxTouchPoints||0});var e=t.userAgent,s=e.split("[FBAN");typeof s[1]<"u"&&(e=s[0]),s=e.split("Twitter"),typeof s[1]<"u"&&(e=s[0]);var r=Gy(e),i={apple:{phone:r(bl)&&!r(vn),ipod:r(gu),tablet:!r(bl)&&(r(xu)||Au(t))&&!r(vn),universal:r(bu),device:(r(bl)||r(gu)||r(xu)||r(bu)||Au(t))&&!r(vn)},amazon:{phone:r(Kr),tablet:!r(Kr)&&r(Ea),device:r(Kr)||r(Ea)},android:{phone:!r(vn)&&r(Kr)||!r(vn)&&r(yl),tablet:!r(vn)&&!r(Kr)&&!r(yl)&&(r(Ea)||r(yu)),device:!r(vn)&&(r(Kr)||r(Ea)||r(yl)||r(yu))||r(/\bokhttp\b/i)},windows:{phone:r(vn),tablet:r(wu),device:r(vn)||r(wu)},other:{blackberry:r(vu),blackberry10:r(_u),opera:r(Eu),firefox:r(Tu),chrome:r(Su),device:r(vu)||r(_u)||r(Eu)||r(Tu)||r(Su)},any:!1,phone:!1,tablet:!1};return i.any=i.apple.device||i.android.device||i.windows.device||i.other.device,i.phone=i.apple.phone||i.android.phone||i.windows.phone,i.tablet=i.apple.tablet||i.android.tablet||i.windows.tablet,i}const Yy=Cu.default??Cu,Rn=Yy(globalThis.navigator);ht.RETINA_PREFIX=/@([0-9\.]+)x/;ht.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!1;var Mm={exports:{}};(function(n){var t=Object.prototype.hasOwnProperty,e="~";function s(){}Object.create&&(s.prototype=Object.create(null),new s().__proto__||(e=!1));function r(a,c,h){this.fn=a,this.context=c,this.once=h||!1}function i(a,c,h,d,u){if(typeof h!="function")throw new TypeError("The listener must be a function");var f=new r(h,d||a,u),m=e?e+c:c;return a._events[m]?a._events[m].fn?a._events[m]=[a._events[m],f]:a._events[m].push(f):(a._events[m]=f,a._eventsCount++),a}function o(a,c){--a._eventsCount===0?a._events=new s:delete a._events[c]}function l(){this._events=new s,this._eventsCount=0}l.prototype.eventNames=function(){var c=[],h,d;if(this._eventsCount===0)return c;for(d in h=this._events)t.call(h,d)&&c.push(e?d.slice(1):d);return Object.getOwnPropertySymbols?c.concat(Object.getOwnPropertySymbols(h)):c},l.prototype.listeners=function(c){var h=e?e+c:c,d=this._events[h];if(!d)return[];if(d.fn)return[d.fn];for(var u=0,f=d.length,m=new Array(f);u<f;u++)m[u]=d[u].fn;return m},l.prototype.listenerCount=function(c){var h=e?e+c:c,d=this._events[h];return d?d.fn?1:d.length:0},l.prototype.emit=function(c,h,d,u,f,m){var p=e?e+c:c;if(!this._events[p])return!1;var g=this._events[p],w=arguments.length,x,y;if(g.fn){switch(g.once&&this.removeListener(c,g.fn,void 0,!0),w){case 1:return g.fn.call(g.context),!0;case 2:return g.fn.call(g.context,h),!0;case 3:return g.fn.call(g.context,h,d),!0;case 4:return g.fn.call(g.context,h,d,u),!0;case 5:return g.fn.call(g.context,h,d,u,f),!0;case 6:return g.fn.call(g.context,h,d,u,f,m),!0}for(y=1,x=new Array(w-1);y<w;y++)x[y-1]=arguments[y];g.fn.apply(g.context,x)}else{var b=g.length,_;for(y=0;y<b;y++)switch(g[y].once&&this.removeListener(c,g[y].fn,void 0,!0),w){case 1:g[y].fn.call(g[y].context);break;case 2:g[y].fn.call(g[y].context,h);break;case 3:g[y].fn.call(g[y].context,h,d);break;case 4:g[y].fn.call(g[y].context,h,d,u);break;default:if(!x)for(_=1,x=new Array(w-1);_<w;_++)x[_-1]=arguments[_];g[y].fn.apply(g[y].context,x)}}return!0},l.prototype.on=function(c,h,d){return i(this,c,h,d,!1)},l.prototype.once=function(c,h,d){return i(this,c,h,d,!0)},l.prototype.removeListener=function(c,h,d,u){var f=e?e+c:c;if(!this._events[f])return this;if(!h)return o(this,f),this;var m=this._events[f];if(m.fn)m.fn===h&&(!u||m.once)&&(!d||m.context===d)&&o(this,f);else{for(var p=0,g=[],w=m.length;p<w;p++)(m[p].fn!==h||u&&!m[p].once||d&&m[p].context!==d)&&g.push(m[p]);g.length?this._events[f]=g.length===1?g[0]:g:o(this,f)}return this},l.prototype.removeAllListeners=function(c){var h;return c?(h=e?e+c:c,this._events[h]&&o(this,h)):(this._events=new s,this._eventsCount=0),this},l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prefixed=e,l.EventEmitter=l,n.exports=l})(Mm);var $y=Mm.exports;const ma=fa($y);var Rh={exports:{}};Rh.exports=Lo;Rh.exports.default=Lo;function Lo(n,t,e){e=e||2;var s=t&&t.length,r=s?t[0]*e:n.length,i=Pm(n,0,r,e,!0),o=[];if(!i||i.next===i.prev)return o;var l,a,c,h,d,u,f;if(s&&(i=Ky(n,t,i,e)),n.length>80*e){l=c=n[0],a=h=n[1];for(var m=e;m<r;m+=e)d=n[m],u=n[m+1],d<l&&(l=d),u<a&&(a=u),d>c&&(c=d),u>h&&(h=u);f=Math.max(c-l,h-a),f=f!==0?32767/f:0}return na(i,o,e,l,a,f,0),o}function Pm(n,t,e,s,r){var i,o;if(r===fc(n,t,e,s)>0)for(i=t;i<e;i+=s)o=ku(i,n[i],n[i+1],o);else for(i=e-s;i>=t;i-=s)o=ku(i,n[i],n[i+1],o);return o&&Oo(o,o.next)&&(ia(o),o=o.next),o}function jr(n,t){if(!n)return n;t||(t=n);var e=n,s;do if(s=!1,!e.steiner&&(Oo(e,e.next)||fe(e.prev,e,e.next)===0)){if(ia(e),e=t=e.prev,e===e.next)break;s=!0}else e=e.next;while(s||e!==t);return t}function na(n,t,e,s,r,i,o){if(n){!o&&i&&e1(n,s,r,i);for(var l=n,a,c;n.prev!==n.next;){if(a=n.prev,c=n.next,i?zy(n,s,r,i):Wy(n)){t.push(a.i/e|0),t.push(n.i/e|0),t.push(c.i/e|0),ia(n),n=c.next,l=c.next;continue}if(n=c,n===l){o?o===1?(n=Hy(jr(n),t,e),na(n,t,e,s,r,i,2)):o===2&&qy(n,t,e,s,r,i):na(jr(n),t,e,s,r,i,1);break}}}}function Wy(n){var t=n.prev,e=n,s=n.next;if(fe(t,e,s)>=0)return!1;for(var r=t.x,i=e.x,o=s.x,l=t.y,a=e.y,c=s.y,h=r<i?r<o?r:o:i<o?i:o,d=l<a?l<c?l:c:a<c?a:c,u=r>i?r>o?r:o:i>o?i:o,f=l>a?l>c?l:c:a>c?a:c,m=s.next;m!==t;){if(m.x>=h&&m.x<=u&&m.y>=d&&m.y<=f&&li(r,l,i,a,o,c,m.x,m.y)&&fe(m.prev,m,m.next)>=0)return!1;m=m.next}return!0}function zy(n,t,e,s){var r=n.prev,i=n,o=n.next;if(fe(r,i,o)>=0)return!1;for(var l=r.x,a=i.x,c=o.x,h=r.y,d=i.y,u=o.y,f=l<a?l<c?l:c:a<c?a:c,m=h<d?h<u?h:u:d<u?d:u,p=l>a?l>c?l:c:a>c?a:c,g=h>d?h>u?h:u:d>u?d:u,w=dc(f,m,t,e,s),x=dc(p,g,t,e,s),y=n.prevZ,b=n.nextZ;y&&y.z>=w&&b&&b.z<=x;){if(y.x>=f&&y.x<=p&&y.y>=m&&y.y<=g&&y!==r&&y!==o&&li(l,h,a,d,c,u,y.x,y.y)&&fe(y.prev,y,y.next)>=0||(y=y.prevZ,b.x>=f&&b.x<=p&&b.y>=m&&b.y<=g&&b!==r&&b!==o&&li(l,h,a,d,c,u,b.x,b.y)&&fe(b.prev,b,b.next)>=0))return!1;b=b.nextZ}for(;y&&y.z>=w;){if(y.x>=f&&y.x<=p&&y.y>=m&&y.y<=g&&y!==r&&y!==o&&li(l,h,a,d,c,u,y.x,y.y)&&fe(y.prev,y,y.next)>=0)return!1;y=y.prevZ}for(;b&&b.z<=x;){if(b.x>=f&&b.x<=p&&b.y>=m&&b.y<=g&&b!==r&&b!==o&&li(l,h,a,d,c,u,b.x,b.y)&&fe(b.prev,b,b.next)>=0)return!1;b=b.nextZ}return!0}function Hy(n,t,e){var s=n;do{var r=s.prev,i=s.next.next;!Oo(r,i)&&Nm(r,s,s.next,i)&&ra(r,i)&&ra(i,r)&&(t.push(r.i/e|0),t.push(s.i/e|0),t.push(i.i/e|0),ia(s),ia(s.next),s=n=i),s=s.next}while(s!==n);return jr(s)}function qy(n,t,e,s,r,i){var o=n;do{for(var l=o.next.next;l!==o.prev;){if(o.i!==l.i&&r1(o,l)){var a=Fm(o,l);o=jr(o,o.next),a=jr(a,a.next),na(o,t,e,s,r,i,0),na(a,t,e,s,r,i,0);return}l=l.next}o=o.next}while(o!==n)}function Ky(n,t,e,s){var r=[],i,o,l,a,c;for(i=0,o=t.length;i<o;i++)l=t[i]*s,a=i<o-1?t[i+1]*s:n.length,c=Pm(n,l,a,s,!1),c===c.next&&(c.steiner=!0),r.push(n1(c));for(r.sort(Zy),i=0;i<r.length;i++)e=Qy(r[i],e);return e}function Zy(n,t){return n.x-t.x}function Qy(n,t){var e=Jy(n,t);if(!e)return t;var s=Fm(e,n);return jr(s,s.next),jr(e,e.next)}function Jy(n,t){var e=t,s=n.x,r=n.y,i=-1/0,o;do{if(r<=e.y&&r>=e.next.y&&e.next.y!==e.y){var l=e.x+(r-e.y)*(e.next.x-e.x)/(e.next.y-e.y);if(l<=s&&l>i&&(i=l,o=e.x<e.next.x?e:e.next,l===s))return o}e=e.next}while(e!==t);if(!o)return null;var a=o,c=o.x,h=o.y,d=1/0,u;e=o;do s>=e.x&&e.x>=c&&s!==e.x&&li(r<h?s:i,r,c,h,r<h?i:s,r,e.x,e.y)&&(u=Math.abs(r-e.y)/(s-e.x),ra(e,n)&&(u<d||u===d&&(e.x>o.x||e.x===o.x&&t1(o,e)))&&(o=e,d=u)),e=e.next;while(e!==a);return o}function t1(n,t){return fe(n.prev,n,t.prev)<0&&fe(t.next,n,n.next)<0}function e1(n,t,e,s){var r=n;do r.z===0&&(r.z=dc(r.x,r.y,t,e,s)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next;while(r!==n);r.prevZ.nextZ=null,r.prevZ=null,s1(r)}function s1(n){var t,e,s,r,i,o,l,a,c=1;do{for(e=n,n=null,i=null,o=0;e;){for(o++,s=e,l=0,t=0;t<c&&(l++,s=s.nextZ,!!s);t++);for(a=c;l>0||a>0&&s;)l!==0&&(a===0||!s||e.z<=s.z)?(r=e,e=e.nextZ,l--):(r=s,s=s.nextZ,a--),i?i.nextZ=r:n=r,r.prevZ=i,i=r;e=s}i.nextZ=null,c*=2}while(o>1);return n}function dc(n,t,e,s,r){return n=(n-e)*r|0,t=(t-s)*r|0,n=(n|n<<8)&16711935,n=(n|n<<4)&252645135,n=(n|n<<2)&858993459,n=(n|n<<1)&1431655765,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,n|t<<1}function n1(n){var t=n,e=n;do(t.x<e.x||t.x===e.x&&t.y<e.y)&&(e=t),t=t.next;while(t!==n);return e}function li(n,t,e,s,r,i,o,l){return(r-o)*(t-l)>=(n-o)*(i-l)&&(n-o)*(s-l)>=(e-o)*(t-l)&&(e-o)*(i-l)>=(r-o)*(s-l)}function r1(n,t){return n.next.i!==t.i&&n.prev.i!==t.i&&!i1(n,t)&&(ra(n,t)&&ra(t,n)&&a1(n,t)&&(fe(n.prev,n,t.prev)||fe(n,t.prev,t))||Oo(n,t)&&fe(n.prev,n,n.next)>0&&fe(t.prev,t,t.next)>0)}function fe(n,t,e){return(t.y-n.y)*(e.x-t.x)-(t.x-n.x)*(e.y-t.y)}function Oo(n,t){return n.x===t.x&&n.y===t.y}function Nm(n,t,e,s){var r=Ta(fe(n,t,e)),i=Ta(fe(n,t,s)),o=Ta(fe(e,s,n)),l=Ta(fe(e,s,t));return!!(r!==i&&o!==l||r===0&&Sa(n,e,t)||i===0&&Sa(n,s,t)||o===0&&Sa(e,n,s)||l===0&&Sa(e,t,s))}function Sa(n,t,e){return t.x<=Math.max(n.x,e.x)&&t.x>=Math.min(n.x,e.x)&&t.y<=Math.max(n.y,e.y)&&t.y>=Math.min(n.y,e.y)}function Ta(n){return n>0?1:n<0?-1:0}function i1(n,t){var e=n;do{if(e.i!==n.i&&e.next.i!==n.i&&e.i!==t.i&&e.next.i!==t.i&&Nm(e,e.next,n,t))return!0;e=e.next}while(e!==n);return!1}function ra(n,t){return fe(n.prev,n,n.next)<0?fe(n,t,n.next)>=0&&fe(n,n.prev,t)>=0:fe(n,t,n.prev)<0||fe(n,n.next,t)<0}function a1(n,t){var e=n,s=!1,r=(n.x+t.x)/2,i=(n.y+t.y)/2;do e.y>i!=e.next.y>i&&e.next.y!==e.y&&r<(e.next.x-e.x)*(i-e.y)/(e.next.y-e.y)+e.x&&(s=!s),e=e.next;while(e!==n);return s}function Fm(n,t){var e=new uc(n.i,n.x,n.y),s=new uc(t.i,t.x,t.y),r=n.next,i=t.prev;return n.next=t,t.prev=n,e.next=r,r.prev=e,s.next=e,e.prev=s,i.next=s,s.prev=i,s}function ku(n,t,e,s){var r=new uc(n,t,e);return s?(r.next=s.next,r.prev=s,s.next.prev=r,s.next=r):(r.prev=r,r.next=r),r}function ia(n){n.next.prev=n.prev,n.prev.next=n.next,n.prevZ&&(n.prevZ.nextZ=n.nextZ),n.nextZ&&(n.nextZ.prevZ=n.prevZ)}function uc(n,t,e){this.i=n,this.x=t,this.y=e,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}Lo.deviation=function(n,t,e,s){var r=t&&t.length,i=r?t[0]*e:n.length,o=Math.abs(fc(n,0,i,e));if(r)for(var l=0,a=t.length;l<a;l++){var c=t[l]*e,h=l<a-1?t[l+1]*e:n.length;o-=Math.abs(fc(n,c,h,e))}var d=0;for(l=0;l<s.length;l+=3){var u=s[l]*e,f=s[l+1]*e,m=s[l+2]*e;d+=Math.abs((n[u]-n[m])*(n[f+1]-n[u+1])-(n[u]-n[f])*(n[m+1]-n[u+1]))}return o===0&&d===0?0:Math.abs((d-o)/o)};function fc(n,t,e,s){for(var r=0,i=t,o=e-s;i<e;i+=s)r+=(n[o]-n[i])*(n[i+1]+n[o+1]),o=i;return r}Lo.flatten=function(n){for(var t=n[0][0].length,e={vertices:[],holes:[],dimensions:t},s=0,r=0;r<n.length;r++){for(var i=0;i<n[r].length;i++)for(var o=0;o<t;o++)e.vertices.push(n[r][i][o]);r>0&&(s+=n[r-1].length,e.holes.push(s))}return e};var o1=Rh.exports;const l1=fa(o1),Iu={};function Pt(n,t,e=3){if(Iu[t])return;let s=new Error().stack;typeof s>"u"?console.warn("PixiJS Deprecation Warning: ",`${t}
Deprecated since v${n}`):(s=s.split(`
`).splice(e).join(`
`),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",`${t}
Deprecated since v${n}`),console.warn(s),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",`${t}
Deprecated since v${n}`),console.warn(s))),Iu[t]=!0}function Ms(n){if(typeof n!="string")throw new TypeError(`Path must be a string. Received ${JSON.stringify(n)}`)}function Mi(n){return n.split("?")[0].split("#")[0]}function c1(n){return n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function h1(n,t,e){return n.replace(new RegExp(c1(t),"g"),e)}function d1(n,t){let e="",s=0,r=-1,i=0,o=-1;for(let l=0;l<=n.length;++l){if(l<n.length)o=n.charCodeAt(l);else{if(o===47)break;o=47}if(o===47){if(!(r===l-1||i===1))if(r!==l-1&&i===2){if(e.length<2||s!==2||e.charCodeAt(e.length-1)!==46||e.charCodeAt(e.length-2)!==46){if(e.length>2){const a=e.lastIndexOf("/");if(a!==e.length-1){a===-1?(e="",s=0):(e=e.slice(0,a),s=e.length-1-e.lastIndexOf("/")),r=l,i=0;continue}}else if(e.length===2||e.length===1){e="",s=0,r=l,i=0;continue}}t&&(e.length>0?e+="/..":e="..",s=2)}else e.length>0?e+=`/${n.slice(r+1,l)}`:e=n.slice(r+1,l),s=l-r-1;r=l,i=0}else o===46&&i!==-1?++i:i=-1}return e}const re={toPosix(n){return h1(n,"\\","/")},isUrl(n){return/^https?:/.test(this.toPosix(n))},isDataUrl(n){return/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test(n)},isBlobUrl(n){return n.startsWith("blob:")},hasProtocol(n){return/^[^/:]+:/.test(this.toPosix(n))},getProtocol(n){Ms(n),n=this.toPosix(n);const t=/^file:\/\/\//.exec(n);if(t)return t[0];const e=/^[^/:]+:\/{0,2}/.exec(n);return e?e[0]:""},toAbsolute(n,t,e){if(Ms(n),this.isDataUrl(n)||this.isBlobUrl(n))return n;const s=Mi(this.toPosix(t??ht.ADAPTER.getBaseUrl())),r=Mi(this.toPosix(e??this.rootname(s)));return n=this.toPosix(n),n.startsWith("/")?re.join(r,n.slice(1)):this.isAbsolute(n)?n:this.join(s,n)},normalize(n){if(Ms(n),n.length===0)return".";if(this.isDataUrl(n)||this.isBlobUrl(n))return n;n=this.toPosix(n);let t="";const e=n.startsWith("/");this.hasProtocol(n)&&(t=this.rootname(n),n=n.slice(t.length));const s=n.endsWith("/");return n=d1(n,!1),n.length>0&&s&&(n+="/"),e?`/${n}`:t+n},isAbsolute(n){return Ms(n),n=this.toPosix(n),this.hasProtocol(n)?!0:n.startsWith("/")},join(...n){if(n.length===0)return".";let t;for(let e=0;e<n.length;++e){const s=n[e];if(Ms(s),s.length>0)if(t===void 0)t=s;else{const r=n[e-1]??"";this.joinExtensions.includes(this.extname(r).toLowerCase())?t+=`/../${s}`:t+=`/${s}`}}return t===void 0?".":this.normalize(t)},dirname(n){if(Ms(n),n.length===0)return".";n=this.toPosix(n);let t=n.charCodeAt(0);const e=t===47;let s=-1,r=!0;const i=this.getProtocol(n),o=n;n=n.slice(i.length);for(let l=n.length-1;l>=1;--l)if(t=n.charCodeAt(l),t===47){if(!r){s=l;break}}else r=!1;return s===-1?e?"/":this.isUrl(o)?i+n:i:e&&s===1?"//":i+n.slice(0,s)},rootname(n){Ms(n),n=this.toPosix(n);let t="";if(n.startsWith("/")?t="/":t=this.getProtocol(n),this.isUrl(n)){const e=n.indexOf("/",t.length);e!==-1?t=n.slice(0,e):t=n,t.endsWith("/")||(t+="/")}return t},basename(n,t){Ms(n),t&&Ms(t),n=Mi(this.toPosix(n));let e=0,s=-1,r=!0,i;if(t!==void 0&&t.length>0&&t.length<=n.length){if(t.length===n.length&&t===n)return"";let o=t.length-1,l=-1;for(i=n.length-1;i>=0;--i){const a=n.charCodeAt(i);if(a===47){if(!r){e=i+1;break}}else l===-1&&(r=!1,l=i+1),o>=0&&(a===t.charCodeAt(o)?--o===-1&&(s=i):(o=-1,s=l))}return e===s?s=l:s===-1&&(s=n.length),n.slice(e,s)}for(i=n.length-1;i>=0;--i)if(n.charCodeAt(i)===47){if(!r){e=i+1;break}}else s===-1&&(r=!1,s=i+1);return s===-1?"":n.slice(e,s)},extname(n){Ms(n),n=Mi(this.toPosix(n));let t=-1,e=0,s=-1,r=!0,i=0;for(let o=n.length-1;o>=0;--o){const l=n.charCodeAt(o);if(l===47){if(!r){e=o+1;break}continue}s===-1&&(r=!1,s=o+1),l===46?t===-1?t=o:i!==1&&(i=1):t!==-1&&(i=-1)}return t===-1||s===-1||i===0||i===1&&t===s-1&&t===e+1?"":n.slice(t,s)},parse(n){Ms(n);const t={root:"",dir:"",base:"",ext:"",name:""};if(n.length===0)return t;n=Mi(this.toPosix(n));let e=n.charCodeAt(0);const s=this.isAbsolute(n);let r;t.root=this.rootname(n),s||this.hasProtocol(n)?r=1:r=0;let i=-1,o=0,l=-1,a=!0,c=n.length-1,h=0;for(;c>=r;--c){if(e=n.charCodeAt(c),e===47){if(!a){o=c+1;break}continue}l===-1&&(a=!1,l=c+1),e===46?i===-1?i=c:h!==1&&(h=1):i!==-1&&(h=-1)}return i===-1||l===-1||h===0||h===1&&i===l-1&&i===o+1?l!==-1&&(o===0&&s?t.base=t.name=n.slice(1,l):t.base=t.name=n.slice(o,l)):(o===0&&s?(t.name=n.slice(1,i),t.base=n.slice(1,l)):(t.name=n.slice(o,i),t.base=n.slice(o,l)),t.ext=n.slice(i,l)),t.dir=this.dirname(n),t},sep:"/",delimiter:":",joinExtensions:[".html"]};let wl;async function u1(){return wl??(wl=(async()=>{var i;const n=document.createElement("canvas").getContext("webgl");if(!n)return Qe.UNPACK;const t=await new Promise(o=>{const l=document.createElement("video");l.onloadeddata=()=>o(l),l.onerror=()=>o(null),l.autoplay=!1,l.crossOrigin="anonymous",l.preload="auto",l.src="data:video/webm;base64,GkXfo59ChoEBQveBAULygQRC84EIQoKEd2VibUKHgQJChYECGFOAZwEAAAAAAAHTEU2bdLpNu4tTq4QVSalmU6yBoU27i1OrhBZUrmtTrIHGTbuMU6uEElTDZ1OsggEXTbuMU6uEHFO7a1OsggG97AEAAAAAAABZAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVSalmoCrXsYMPQkBNgIRMYXZmV0GETGF2ZkSJiEBEAAAAAAAAFlSua8yuAQAAAAAAAEPXgQFzxYgAAAAAAAAAAZyBACK1nIN1bmSIgQCGhVZfVlA5g4EBI+ODhAJiWgDglLCBArqBApqBAlPAgQFVsIRVuYEBElTDZ9Vzc9JjwItjxYgAAAAAAAAAAWfInEWjh0VOQ09ERVJEh49MYXZjIGxpYnZweC12cDlnyKJFo4hEVVJBVElPTkSHlDAwOjAwOjAwLjA0MDAwMDAwMAAAH0O2dcfngQCgwqGggQAAAIJJg0IAABAAFgA4JBwYSgAAICAAEb///4r+AAB1oZ2mm+6BAaWWgkmDQgAAEAAWADgkHBhKAAAgIABIQBxTu2uRu4+zgQC3iveBAfGCAXHwgQM=",l.load()});if(!t)return Qe.UNPACK;const e=n.createTexture();n.bindTexture(n.TEXTURE_2D,e);const s=n.createFramebuffer();n.bindFramebuffer(n.FRAMEBUFFER,s),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,e,0),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,n.NONE),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,t);const r=new Uint8Array(4);return n.readPixels(0,0,1,1,n.RGBA,n.UNSIGNED_BYTE,r),n.deleteFramebuffer(s),n.deleteTexture(e),(i=n.getExtension("WEBGL_lose_context"))==null||i.loseContext(),r[0]<=r[3]?Qe.PMA:Qe.UNPACK})()),wl}let vl;function f1(){return typeof vl>"u"&&(vl=function(){var t;const n={stencil:!0,failIfMajorPerformanceCaveat:ht.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT};try{if(!ht.ADAPTER.getWebGLRenderingContext())return!1;const e=ht.ADAPTER.createCanvas();let s=e.getContext("webgl",n)||e.getContext("experimental-webgl",n);const r=!!((t=s==null?void 0:s.getContextAttributes())!=null&&t.stencil);if(s){const i=s.getExtension("WEBGL_lose_context");i&&i.loseContext()}return s=null,r}catch{return!1}}()),vl}var m1={grad:.9,turn:360,rad:360/(2*Math.PI)},_n=function(n){return typeof n=="string"?n.length>0:typeof n=="number"},Le=function(n,t,e){return t===void 0&&(t=0),e===void 0&&(e=Math.pow(10,t)),Math.round(e*n)/e+0},Cs=function(n,t,e){return t===void 0&&(t=0),e===void 0&&(e=1),n>e?e:n>t?n:t},Dm=function(n){return(n=isFinite(n)?n%360:0)>0?n:n+360},Ru=function(n){return{r:Cs(n.r,0,255),g:Cs(n.g,0,255),b:Cs(n.b,0,255),a:Cs(n.a)}},_l=function(n){return{r:Le(n.r),g:Le(n.g),b:Le(n.b),a:Le(n.a,3)}},p1=/^#([0-9a-f]{3,8})$/i,Aa=function(n){var t=n.toString(16);return t.length<2?"0"+t:t},Bm=function(n){var t=n.r,e=n.g,s=n.b,r=n.a,i=Math.max(t,e,s),o=i-Math.min(t,e,s),l=o?i===t?(e-s)/o:i===e?2+(s-t)/o:4+(t-e)/o:0;return{h:60*(l<0?l+6:l),s:i?o/i*100:0,v:i/255*100,a:r}},Lm=function(n){var t=n.h,e=n.s,s=n.v,r=n.a;t=t/360*6,e/=100,s/=100;var i=Math.floor(t),o=s*(1-e),l=s*(1-(t-i)*e),a=s*(1-(1-t+i)*e),c=i%6;return{r:255*[s,l,o,o,a,s][c],g:255*[a,s,s,l,o,o][c],b:255*[o,o,a,s,s,l][c],a:r}},Mu=function(n){return{h:Dm(n.h),s:Cs(n.s,0,100),l:Cs(n.l,0,100),a:Cs(n.a)}},Pu=function(n){return{h:Le(n.h),s:Le(n.s),l:Le(n.l),a:Le(n.a,3)}},Nu=function(n){return Lm((e=(t=n).s,{h:t.h,s:(e*=((s=t.l)<50?s:100-s)/100)>0?2*e/(s+e)*100:0,v:s+e,a:t.a}));var t,e,s},Ji=function(n){return{h:(t=Bm(n)).h,s:(r=(200-(e=t.s))*(s=t.v)/100)>0&&r<200?e*s/100/(r<=100?r:200-r)*100:0,l:r/2,a:t.a};var t,e,s,r},g1=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,x1=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,b1=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,y1=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,mc={string:[[function(n){var t=p1.exec(n);return t?(n=t[1]).length<=4?{r:parseInt(n[0]+n[0],16),g:parseInt(n[1]+n[1],16),b:parseInt(n[2]+n[2],16),a:n.length===4?Le(parseInt(n[3]+n[3],16)/255,2):1}:n.length===6||n.length===8?{r:parseInt(n.substr(0,2),16),g:parseInt(n.substr(2,2),16),b:parseInt(n.substr(4,2),16),a:n.length===8?Le(parseInt(n.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(n){var t=b1.exec(n)||y1.exec(n);return t?t[2]!==t[4]||t[4]!==t[6]?null:Ru({r:Number(t[1])/(t[2]?100/255:1),g:Number(t[3])/(t[4]?100/255:1),b:Number(t[5])/(t[6]?100/255:1),a:t[7]===void 0?1:Number(t[7])/(t[8]?100:1)}):null},"rgb"],[function(n){var t=g1.exec(n)||x1.exec(n);if(!t)return null;var e,s,r=Mu({h:(e=t[1],s=t[2],s===void 0&&(s="deg"),Number(e)*(m1[s]||1)),s:Number(t[3]),l:Number(t[4]),a:t[5]===void 0?1:Number(t[5])/(t[6]?100:1)});return Nu(r)},"hsl"]],object:[[function(n){var t=n.r,e=n.g,s=n.b,r=n.a,i=r===void 0?1:r;return _n(t)&&_n(e)&&_n(s)?Ru({r:Number(t),g:Number(e),b:Number(s),a:Number(i)}):null},"rgb"],[function(n){var t=n.h,e=n.s,s=n.l,r=n.a,i=r===void 0?1:r;if(!_n(t)||!_n(e)||!_n(s))return null;var o=Mu({h:Number(t),s:Number(e),l:Number(s),a:Number(i)});return Nu(o)},"hsl"],[function(n){var t=n.h,e=n.s,s=n.v,r=n.a,i=r===void 0?1:r;if(!_n(t)||!_n(e)||!_n(s))return null;var o=function(l){return{h:Dm(l.h),s:Cs(l.s,0,100),v:Cs(l.v,0,100),a:Cs(l.a)}}({h:Number(t),s:Number(e),v:Number(s),a:Number(i)});return Lm(o)},"hsv"]]},Fu=function(n,t){for(var e=0;e<t.length;e++){var s=t[e][0](n);if(s)return[s,t[e][1]]}return[null,void 0]},w1=function(n){return typeof n=="string"?Fu(n.trim(),mc.string):typeof n=="object"&&n!==null?Fu(n,mc.object):[null,void 0]},El=function(n,t){var e=Ji(n);return{h:e.h,s:Cs(e.s+100*t,0,100),l:e.l,a:e.a}},Sl=function(n){return(299*n.r+587*n.g+114*n.b)/1e3/255},Du=function(n,t){var e=Ji(n);return{h:e.h,s:e.s,l:Cs(e.l+100*t,0,100),a:e.a}},pc=function(){function n(t){this.parsed=w1(t)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return n.prototype.isValid=function(){return this.parsed!==null},n.prototype.brightness=function(){return Le(Sl(this.rgba),2)},n.prototype.isDark=function(){return Sl(this.rgba)<.5},n.prototype.isLight=function(){return Sl(this.rgba)>=.5},n.prototype.toHex=function(){return t=_l(this.rgba),e=t.r,s=t.g,r=t.b,o=(i=t.a)<1?Aa(Le(255*i)):"","#"+Aa(e)+Aa(s)+Aa(r)+o;var t,e,s,r,i,o},n.prototype.toRgb=function(){return _l(this.rgba)},n.prototype.toRgbString=function(){return t=_l(this.rgba),e=t.r,s=t.g,r=t.b,(i=t.a)<1?"rgba("+e+", "+s+", "+r+", "+i+")":"rgb("+e+", "+s+", "+r+")";var t,e,s,r,i},n.prototype.toHsl=function(){return Pu(Ji(this.rgba))},n.prototype.toHslString=function(){return t=Pu(Ji(this.rgba)),e=t.h,s=t.s,r=t.l,(i=t.a)<1?"hsla("+e+", "+s+"%, "+r+"%, "+i+")":"hsl("+e+", "+s+"%, "+r+"%)";var t,e,s,r,i},n.prototype.toHsv=function(){return t=Bm(this.rgba),{h:Le(t.h),s:Le(t.s),v:Le(t.v),a:Le(t.a,3)};var t},n.prototype.invert=function(){return rn({r:255-(t=this.rgba).r,g:255-t.g,b:255-t.b,a:t.a});var t},n.prototype.saturate=function(t){return t===void 0&&(t=.1),rn(El(this.rgba,t))},n.prototype.desaturate=function(t){return t===void 0&&(t=.1),rn(El(this.rgba,-t))},n.prototype.grayscale=function(){return rn(El(this.rgba,-1))},n.prototype.lighten=function(t){return t===void 0&&(t=.1),rn(Du(this.rgba,t))},n.prototype.darken=function(t){return t===void 0&&(t=.1),rn(Du(this.rgba,-t))},n.prototype.rotate=function(t){return t===void 0&&(t=15),this.hue(this.hue()+t)},n.prototype.alpha=function(t){return typeof t=="number"?rn({r:(e=this.rgba).r,g:e.g,b:e.b,a:t}):Le(this.rgba.a,3);var e},n.prototype.hue=function(t){var e=Ji(this.rgba);return typeof t=="number"?rn({h:t,s:e.s,l:e.l,a:e.a}):Le(e.h)},n.prototype.isEqual=function(t){return this.toHex()===rn(t).toHex()},n}(),rn=function(n){return n instanceof pc?n:new pc(n)},Bu=[],v1=function(n){n.forEach(function(t){Bu.indexOf(t)<0&&(t(pc,mc),Bu.push(t))})};function _1(n,t){var e={white:"#ffffff",bisque:"#ffe4c4",blue:"#0000ff",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",antiquewhite:"#faebd7",aqua:"#00ffff",azure:"#f0ffff",whitesmoke:"#f5f5f5",papayawhip:"#ffefd5",plum:"#dda0dd",blanchedalmond:"#ffebcd",black:"#000000",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",cornsilk:"#fff8dc",cornflowerblue:"#6495ed",burlywood:"#deb887",aquamarine:"#7fffd4",beige:"#f5f5dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkkhaki:"#bdb76b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",peachpuff:"#ffdab9",darkmagenta:"#8b008b",darkred:"#8b0000",darkorchid:"#9932cc",darkorange:"#ff8c00",darkslateblue:"#483d8b",gray:"#808080",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",deeppink:"#ff1493",deepskyblue:"#00bfff",wheat:"#f5deb3",firebrick:"#b22222",floralwhite:"#fffaf0",ghostwhite:"#f8f8ff",darkviolet:"#9400d3",magenta:"#ff00ff",green:"#008000",dodgerblue:"#1e90ff",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",blueviolet:"#8a2be2",forestgreen:"#228b22",lawngreen:"#7cfc00",indianred:"#cd5c5c",indigo:"#4b0082",fuchsia:"#ff00ff",brown:"#a52a2a",maroon:"#800000",mediumblue:"#0000cd",lightcoral:"#f08080",darkturquoise:"#00ced1",lightcyan:"#e0ffff",ivory:"#fffff0",lightyellow:"#ffffe0",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",linen:"#faf0e6",mediumaquamarine:"#66cdaa",lemonchiffon:"#fffacd",lime:"#00ff00",khaki:"#f0e68c",mediumseagreen:"#3cb371",limegreen:"#32cd32",mediumspringgreen:"#00fa9a",lightskyblue:"#87cefa",lightblue:"#add8e6",midnightblue:"#191970",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",mintcream:"#f5fffa",lightslategray:"#778899",lightslategrey:"#778899",navajowhite:"#ffdead",navy:"#000080",mediumvioletred:"#c71585",powderblue:"#b0e0e6",palegoldenrod:"#eee8aa",oldlace:"#fdf5e6",paleturquoise:"#afeeee",mediumturquoise:"#48d1cc",mediumorchid:"#ba55d3",rebeccapurple:"#663399",lightsteelblue:"#b0c4de",mediumslateblue:"#7b68ee",thistle:"#d8bfd8",tan:"#d2b48c",orchid:"#da70d6",mediumpurple:"#9370db",purple:"#800080",pink:"#ffc0cb",skyblue:"#87ceeb",springgreen:"#00ff7f",palegreen:"#98fb98",red:"#ff0000",yellow:"#ffff00",slateblue:"#6a5acd",lavenderblush:"#fff0f5",peru:"#cd853f",palevioletred:"#db7093",violet:"#ee82ee",teal:"#008080",slategray:"#708090",slategrey:"#708090",aliceblue:"#f0f8ff",darkseagreen:"#8fbc8f",darkolivegreen:"#556b2f",greenyellow:"#adff2f",seagreen:"#2e8b57",seashell:"#fff5ee",tomato:"#ff6347",silver:"#c0c0c0",sienna:"#a0522d",lavender:"#e6e6fa",lightgreen:"#90ee90",orange:"#ffa500",orangered:"#ff4500",steelblue:"#4682b4",royalblue:"#4169e1",turquoise:"#40e0d0",yellowgreen:"#9acd32",salmon:"#fa8072",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",darksalmon:"#e9967a",lightgoldenrodyellow:"#fafad2",snow:"#fffafa",lightgrey:"#d3d3d3",lightgray:"#d3d3d3",dimgray:"#696969",dimgrey:"#696969",olivedrab:"#6b8e23",olive:"#808000"},s={};for(var r in e)s[e[r]]=r;var i={};n.prototype.toName=function(o){if(!(this.rgba.a||this.rgba.r||this.rgba.g||this.rgba.b))return"transparent";var l,a,c=s[this.toHex()];if(c)return c;if(o!=null&&o.closest){var h=this.toRgb(),d=1/0,u="black";if(!i.length)for(var f in e)i[f]=new n(e[f]).toRgb();for(var m in e){var p=(l=h,a=i[m],Math.pow(l.r-a.r,2)+Math.pow(l.g-a.g,2)+Math.pow(l.b-a.b,2));p<d&&(d=p,u=m)}return u}},t.string.push([function(o){var l=o.toLowerCase(),a=l==="transparent"?"#0000":e[l];return a?new n(a).toRgb():null},"name"])}v1([_1]);const Jr=class Za{constructor(t=16777215){this._value=null,this._components=new Float32Array(4),this._components.fill(1),this._int=16777215,this.value=t}get red(){return this._components[0]}get green(){return this._components[1]}get blue(){return this._components[2]}get alpha(){return this._components[3]}setValue(t){return this.value=t,this}set value(t){if(t instanceof Za)this._value=this.cloneSource(t._value),this._int=t._int,this._components.set(t._components);else{if(t===null)throw new Error("Cannot set PIXI.Color#value to null");(this._value===null||!this.isSourceEqual(this._value,t))&&(this.normalize(t),this._value=this.cloneSource(t))}}get value(){return this._value}cloneSource(t){return typeof t=="string"||typeof t=="number"||t instanceof Number||t===null?t:Array.isArray(t)||ArrayBuffer.isView(t)?t.slice(0):typeof t=="object"&&t!==null?{...t}:t}isSourceEqual(t,e){const s=typeof t;if(s!==typeof e)return!1;if(s==="number"||s==="string"||t instanceof Number)return t===e;if(Array.isArray(t)&&Array.isArray(e)||ArrayBuffer.isView(t)&&ArrayBuffer.isView(e))return t.length!==e.length?!1:t.every((r,i)=>r===e[i]);if(t!==null&&e!==null){const r=Object.keys(t),i=Object.keys(e);return r.length!==i.length?!1:r.every(o=>t[o]===e[o])}return t===e}toRgba(){const[t,e,s,r]=this._components;return{r:t,g:e,b:s,a:r}}toRgb(){const[t,e,s]=this._components;return{r:t,g:e,b:s}}toRgbaString(){const[t,e,s]=this.toUint8RgbArray();return`rgba(${t},${e},${s},${this.alpha})`}toUint8RgbArray(t){const[e,s,r]=this._components;return t=t??[],t[0]=Math.round(e*255),t[1]=Math.round(s*255),t[2]=Math.round(r*255),t}toRgbArray(t){t=t??[];const[e,s,r]=this._components;return t[0]=e,t[1]=s,t[2]=r,t}toNumber(){return this._int}toLittleEndianNumber(){const t=this._int;return(t>>16)+(t&65280)+((t&255)<<16)}multiply(t){const[e,s,r,i]=Za.temp.setValue(t)._components;return this._components[0]*=e,this._components[1]*=s,this._components[2]*=r,this._components[3]*=i,this.refreshInt(),this._value=null,this}premultiply(t,e=!0){return e&&(this._components[0]*=t,this._components[1]*=t,this._components[2]*=t),this._components[3]=t,this.refreshInt(),this._value=null,this}toPremultiplied(t,e=!0){if(t===1)return(255<<24)+this._int;if(t===0)return e?0:this._int;let s=this._int>>16&255,r=this._int>>8&255,i=this._int&255;return e&&(s=s*t+.5|0,r=r*t+.5|0,i=i*t+.5|0),(t*255<<24)+(s<<16)+(r<<8)+i}toHex(){const t=this._int.toString(16);return`#${"000000".substring(0,6-t.length)+t}`}toHexa(){const t=Math.round(this._components[3]*255).toString(16);return this.toHex()+"00".substring(0,2-t.length)+t}setAlpha(t){return this._components[3]=this._clamp(t),this}round(t){const[e,s,r]=this._components;return this._components[0]=Math.round(e*t)/t,this._components[1]=Math.round(s*t)/t,this._components[2]=Math.round(r*t)/t,this.refreshInt(),this._value=null,this}toArray(t){t=t??[];const[e,s,r,i]=this._components;return t[0]=e,t[1]=s,t[2]=r,t[3]=i,t}normalize(t){let e,s,r,i;if((typeof t=="number"||t instanceof Number)&&t>=0&&t<=16777215){const o=t;e=(o>>16&255)/255,s=(o>>8&255)/255,r=(o&255)/255,i=1}else if((Array.isArray(t)||t instanceof Float32Array)&&t.length>=3&&t.length<=4)t=this._clamp(t),[e,s,r,i=1]=t;else if((t instanceof Uint8Array||t instanceof Uint8ClampedArray)&&t.length>=3&&t.length<=4)t=this._clamp(t,0,255),[e,s,r,i=255]=t,e/=255,s/=255,r/=255,i/=255;else if(typeof t=="string"||typeof t=="object"){if(typeof t=="string"){const l=Za.HEX_PATTERN.exec(t);l&&(t=`#${l[2]}`)}const o=rn(t);o.isValid()&&({r:e,g:s,b:r,a:i}=o.rgba,e/=255,s/=255,r/=255)}if(e!==void 0)this._components[0]=e,this._components[1]=s,this._components[2]=r,this._components[3]=i,this.refreshInt();else throw new Error(`Unable to convert color ${t}`)}refreshInt(){this._clamp(this._components);const[t,e,s]=this._components;this._int=(t*255<<16)+(e*255<<8)+(s*255|0)}_clamp(t,e=0,s=1){return typeof t=="number"?Math.min(Math.max(t,e),s):(t.forEach((r,i)=>{t[i]=Math.min(Math.max(r,e),s)}),t)}};Jr.shared=new Jr,Jr.temp=new Jr,Jr.HEX_PATTERN=/^(#|0x)?(([a-f0-9]{3}){1,2}([a-f0-9]{2})?)$/i;let te=Jr;function E1(n,t=[]){return Pt("7.2.0","utils.hex2rgb is deprecated, use Color#toRgbArray instead"),te.shared.setValue(n).toRgbArray(t)}function S1(n){return Pt("7.2.0","utils.hex2string is deprecated, use Color#toHex instead"),te.shared.setValue(n).toHex()}function Qa(n){return Pt("7.2.0","utils.rgb2hex is deprecated, use Color#toNumber instead"),te.shared.setValue(n).toNumber()}function T1(){const n=[],t=[];for(let s=0;s<32;s++)n[s]=s,t[s]=s;n[dt.NORMAL_NPM]=dt.NORMAL,n[dt.ADD_NPM]=dt.ADD,n[dt.SCREEN_NPM]=dt.SCREEN,t[dt.NORMAL]=dt.NORMAL_NPM,t[dt.ADD]=dt.ADD_NPM,t[dt.SCREEN]=dt.SCREEN_NPM;const e=[];return e.push(t),e.push(n),e}const Om=T1();function jm(n,t){return Om[t?1:0][n]}function A1(n,t=null){const e=n*6;if(t=t||new Uint16Array(e),t.length!==e)throw new Error(`Out buffer length is incorrect, got ${t.length} and expected ${e}`);for(let s=0,r=0;s<e;s+=6,r+=4)t[s+0]=r+0,t[s+1]=r+1,t[s+2]=r+2,t[s+3]=r+0,t[s+4]=r+2,t[s+5]=r+3;return t}function Vm(n){if(n.BYTES_PER_ELEMENT===4)return n instanceof Float32Array?"Float32Array":n instanceof Uint32Array?"Uint32Array":"Int32Array";if(n.BYTES_PER_ELEMENT===2){if(n instanceof Uint16Array)return"Uint16Array"}else if(n.BYTES_PER_ELEMENT===1&&n instanceof Uint8Array)return"Uint8Array";return null}function ho(n){return n+=n===0?1:0,--n,n|=n>>>1,n|=n>>>2,n|=n>>>4,n|=n>>>8,n|=n>>>16,n+1}function Lu(n){return!(n&n-1)&&!!n}function Ou(n){let t=(n>65535?1:0)<<4;n>>>=t;let e=(n>255?1:0)<<3;return n>>>=e,t|=e,e=(n>15?1:0)<<2,n>>>=e,t|=e,e=(n>3?1:0)<<1,n>>>=e,t|=e,t|n>>1}function di(n,t,e){const s=n.length;let r;if(t>=s||e===0)return;e=t+e>s?s-t:e;const i=s-e;for(r=t;r<i;++r)n[r]=n[r+e];n.length=i}function lr(n){return n===0?0:n<0?-1:1}let C1=0;function Vr(){return++C1}const gc=class{constructor(n,t,e,s){this.left=n,this.top=t,this.right=e,this.bottom=s}get width(){return this.right-this.left}get height(){return this.bottom-this.top}isEmpty(){return this.left===this.right||this.top===this.bottom}};gc.EMPTY=new gc(0,0,0,0);let ju=gc;const Vu={},an=Object.create(null),Gn=Object.create(null);class k1{constructor(t,e,s){this._canvas=ht.ADAPTER.createCanvas(),this._context=this._canvas.getContext("2d"),this.resolution=s||ht.RESOLUTION,this.resize(t,e)}clear(){this._checkDestroyed(),this._context.setTransform(1,0,0,1,0,0),this._context.clearRect(0,0,this._canvas.width,this._canvas.height)}resize(t,e){this._checkDestroyed(),this._canvas.width=Math.round(t*this.resolution),this._canvas.height=Math.round(e*this.resolution)}destroy(){this._context=null,this._canvas=null}get width(){return this._checkDestroyed(),this._canvas.width}set width(t){this._checkDestroyed(),this._canvas.width=Math.round(t)}get height(){return this._checkDestroyed(),this._canvas.height}set height(t){this._checkDestroyed(),this._canvas.height=Math.round(t)}get canvas(){return this._checkDestroyed(),this._canvas}get context(){return this._checkDestroyed(),this._context}_checkDestroyed(){if(this._canvas===null)throw new TypeError("The CanvasRenderTarget has already been destroyed")}}function Uu(n,t,e){for(let s=0,r=4*e*t;s<t;++s,r+=4)if(n[r+3]!==0)return!1;return!0}function Xu(n,t,e,s,r){const i=4*t;for(let o=s,l=s*i+4*e;o<=r;++o,l+=i)if(n[l+3]!==0)return!1;return!0}function I1(n){const{width:t,height:e}=n,s=n.getContext("2d",{willReadFrequently:!0});if(s===null)throw new TypeError("Failed to get canvas 2D context");const r=s.getImageData(0,0,t,e).data;let i=0,o=0,l=t-1,a=e-1;for(;o<e&&Uu(r,t,o);)++o;if(o===e)return ju.EMPTY;for(;Uu(r,t,a);)--a;for(;Xu(r,t,i,o,a);)++i;for(;Xu(r,t,l,o,a);)--l;return++l,++a,new ju(i,o,l,a)}function R1(n){const t=I1(n),{width:e,height:s}=t;let r=null;if(!t.isEmpty()){const i=n.getContext("2d");if(i===null)throw new TypeError("Failed to get canvas 2D context");r=i.getImageData(t.left,t.top,e,s)}return{width:e,height:s,data:r}}function M1(n,t=globalThis.location){if(n.startsWith("data:"))return"";t=t||globalThis.location;const e=new URL(n,document.baseURI);return e.hostname!==t.hostname||e.port!==t.port||e.protocol!==t.protocol?"anonymous":""}function Dn(n,t=1){var s;const e=(s=ht.RETINA_PREFIX)==null?void 0:s.exec(n);return e?parseFloat(e[1]):t}var ot=(n=>(n.Renderer="renderer",n.Application="application",n.RendererSystem="renderer-webgl-system",n.RendererPlugin="renderer-webgl-plugin",n.CanvasRendererSystem="renderer-canvas-system",n.CanvasRendererPlugin="renderer-canvas-plugin",n.Asset="asset",n.LoadParser="load-parser",n.ResolveParser="resolve-parser",n.CacheParser="cache-parser",n.DetectionParser="detection-parser",n))(ot||{});const xc=n=>{if(typeof n=="function"||typeof n=="object"&&n.extension){if(!n.extension)throw new Error("Extension class must have an extension object");n={...typeof n.extension!="object"?{type:n.extension}:n.extension,ref:n}}if(typeof n=="object")n={...n};else throw new Error("Invalid extension type");return typeof n.type=="string"&&(n.type=[n.type]),n},Gu=(n,t)=>xc(n).priority??t,pt={_addHandlers:{},_removeHandlers:{},_queue:{},remove(...n){return n.map(xc).forEach(t=>{t.type.forEach(e=>{var s,r;return(r=(s=this._removeHandlers)[e])==null?void 0:r.call(s,t)})}),this},add(...n){return n.map(xc).forEach(t=>{t.type.forEach(e=>{var i,o;const s=this._addHandlers,r=this._queue;s[e]?(i=s[e])==null||i.call(s,t):(r[e]=r[e]||[],(o=r[e])==null||o.push(t))})}),this},handle(n,t,e){var o;const s=this._addHandlers,r=this._removeHandlers;if(s[n]||r[n])throw new Error(`Extension type ${n} already has a handler`);s[n]=t,r[n]=e;const i=this._queue;return i[n]&&((o=i[n])==null||o.forEach(l=>t(l)),delete i[n]),this},handleByMap(n,t){return this.handle(n,e=>{e.name&&(t[e.name]=e.ref)},e=>{e.name&&delete t[e.name]})},handleByList(n,t,e=-1){return this.handle(n,s=>{t.includes(s.ref)||(t.push(s.ref),t.sort((r,i)=>Gu(i,e)-Gu(r,e)))},s=>{const r=t.indexOf(s.ref);r!==-1&&t.splice(r,1)})}};class bc{constructor(t){typeof t=="number"?this.rawBinaryData=new ArrayBuffer(t):t instanceof Uint8Array?this.rawBinaryData=t.buffer:this.rawBinaryData=t,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}get int8View(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View}get uint8View(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View}get int16View(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View}get uint16View(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View}get int32View(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View}view(t){return this[`${t}View`]}destroy(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null}static sizeOf(t){switch(t){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(`${t} isn't a valid view type`)}}}const P1=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join(`
`);function N1(n){let t="";for(let e=0;e<n;++e)e>0&&(t+=`
else `),e<n-1&&(t+=`if(test == ${e}.0){}`);return t}function F1(n,t){if(n===0)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");const e=t.createShader(t.FRAGMENT_SHADER);for(;;){const s=P1.replace(/%forloop%/gi,N1(n));if(t.shaderSource(e,s),t.compileShader(e),!t.getShaderParameter(e,t.COMPILE_STATUS))n=n/2|0;else break}return n}const Tl=0,Al=1,Cl=2,kl=3,Il=4,Rl=5;class yn{constructor(){this.data=0,this.blendMode=dt.NORMAL,this.polygonOffset=0,this.blend=!0,this.depthMask=!0}get blend(){return!!(this.data&1<<Tl)}set blend(t){!!(this.data&1<<Tl)!==t&&(this.data^=1<<Tl)}get offsets(){return!!(this.data&1<<Al)}set offsets(t){!!(this.data&1<<Al)!==t&&(this.data^=1<<Al)}get culling(){return!!(this.data&1<<Cl)}set culling(t){!!(this.data&1<<Cl)!==t&&(this.data^=1<<Cl)}get depthTest(){return!!(this.data&1<<kl)}set depthTest(t){!!(this.data&1<<kl)!==t&&(this.data^=1<<kl)}get depthMask(){return!!(this.data&1<<Rl)}set depthMask(t){!!(this.data&1<<Rl)!==t&&(this.data^=1<<Rl)}get clockwiseFrontFace(){return!!(this.data&1<<Il)}set clockwiseFrontFace(t){!!(this.data&1<<Il)!==t&&(this.data^=1<<Il)}get blendMode(){return this._blendMode}set blendMode(t){this.blend=t!==dt.NONE,this._blendMode=t}get polygonOffset(){return this._polygonOffset}set polygonOffset(t){this.offsets=!!t,this._polygonOffset=t}static for2d(){const t=new yn;return t.depthTest=!1,t.blend=!0,t}}yn.prototype.toString=function(){return`[@pixi/core:State blendMode=${this.blendMode} clockwiseFrontFace=${this.clockwiseFrontFace} culling=${this.culling} depthMask=${this.depthMask} polygonOffset=${this.polygonOffset}]`};const yc=[];function Um(n,t){if(!n)return null;let e="";if(typeof n=="string"){const s=/\.(\w{3,4})(?:$|\?|#)/i.exec(n);s&&(e=s[1].toLowerCase())}for(let s=yc.length-1;s>=0;--s){const r=yc[s];if(r.test&&r.test(n,e))return new r(n,t)}throw new Error("Unrecognized source type to auto-detect Resource")}class zs{constructor(t){this.items=[],this._name=t,this._aliasCount=0}emit(t,e,s,r,i,o,l,a){if(arguments.length>8)throw new Error("max arguments reached");const{name:c,items:h}=this;this._aliasCount++;for(let d=0,u=h.length;d<u;d++)h[d][c](t,e,s,r,i,o,l,a);return h===this.items&&this._aliasCount--,this}ensureNonAliasedItems(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0))}add(t){return t[this._name]&&(this.ensureNonAliasedItems(),this.remove(t),this.items.push(t)),this}remove(t){const e=this.items.indexOf(t);return e!==-1&&(this.ensureNonAliasedItems(),this.items.splice(e,1)),this}contains(t){return this.items.includes(t)}removeAll(){return this.ensureNonAliasedItems(),this.items.length=0,this}destroy(){this.removeAll(),this.items.length=0,this._name=""}get empty(){return this.items.length===0}get name(){return this._name}}Object.defineProperties(zs.prototype,{dispatch:{value:zs.prototype.emit},run:{value:zs.prototype.emit}});class aa{constructor(t=0,e=0){this._width=t,this._height=e,this.destroyed=!1,this.internal=!1,this.onResize=new zs("setRealSize"),this.onUpdate=new zs("update"),this.onError=new zs("onError")}bind(t){this.onResize.add(t),this.onUpdate.add(t),this.onError.add(t),(this._width||this._height)&&this.onResize.emit(this._width,this._height)}unbind(t){this.onResize.remove(t),this.onUpdate.remove(t),this.onError.remove(t)}resize(t,e){(t!==this._width||e!==this._height)&&(this._width=t,this._height=e,this.onResize.emit(t,e))}get valid(){return!!this._width&&!!this._height}update(){this.destroyed||this.onUpdate.emit()}load(){return Promise.resolve(this)}get width(){return this._width}get height(){return this._height}style(t,e,s){return!1}dispose(){}destroy(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)}static test(t,e){return!1}}class jo extends aa{constructor(t,e){const{width:s,height:r}=e||{};if(!s||!r)throw new Error("BufferResource width or height invalid");super(s,r),this.data=t,this.unpackAlignment=e.unpackAlignment??4}upload(t,e,s){const r=t.gl;r.pixelStorei(r.UNPACK_ALIGNMENT,this.unpackAlignment),r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===Qe.UNPACK);const i=e.realWidth,o=e.realHeight;return s.width===i&&s.height===o?r.texSubImage2D(e.target,0,0,0,i,o,e.format,s.type,this.data):(s.width=i,s.height=o,r.texImage2D(e.target,0,s.internalFormat,i,o,0,e.format,s.type,this.data)),!0}dispose(){this.data=null}static test(t){return t===null||t instanceof Int8Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray||t instanceof Int16Array||t instanceof Uint16Array||t instanceof Int32Array||t instanceof Uint32Array||t instanceof Float32Array}}const D1={scaleMode:ps.NEAREST,alphaMode:Qe.NPM},wc=class ti extends ma{constructor(t=null,e=null){super(),e=Object.assign({},ti.defaultOptions,e);const{alphaMode:s,mipmap:r,anisotropicLevel:i,scaleMode:o,width:l,height:a,wrapMode:c,format:h,type:d,target:u,resolution:f,resourceOptions:m}=e;t&&!(t instanceof aa)&&(t=Um(t,m),t.internal=!0),this.resolution=f||ht.RESOLUTION,this.width=Math.round((l||0)*this.resolution)/this.resolution,this.height=Math.round((a||0)*this.resolution)/this.resolution,this._mipmap=r,this.anisotropicLevel=i,this._wrapMode=c,this._scaleMode=o,this.format=h,this.type=d,this.target=u,this.alphaMode=s,this.uid=Vr(),this.touched=0,this.isPowerOfTwo=!1,this._refreshPOT(),this._glTextures={},this.dirtyId=0,this.dirtyStyleId=0,this.cacheId=null,this.valid=l>0&&a>0,this.textureCacheIds=[],this.destroyed=!1,this.resource=null,this._batchEnabled=0,this._batchLocation=0,this.parentTextureArray=null,this.setResource(t)}get realWidth(){return Math.round(this.width*this.resolution)}get realHeight(){return Math.round(this.height*this.resolution)}get mipmap(){return this._mipmap}set mipmap(t){this._mipmap!==t&&(this._mipmap=t,this.dirtyStyleId++)}get scaleMode(){return this._scaleMode}set scaleMode(t){this._scaleMode!==t&&(this._scaleMode=t,this.dirtyStyleId++)}get wrapMode(){return this._wrapMode}set wrapMode(t){this._wrapMode!==t&&(this._wrapMode=t,this.dirtyStyleId++)}setStyle(t,e){let s;return t!==void 0&&t!==this.scaleMode&&(this.scaleMode=t,s=!0),e!==void 0&&e!==this.mipmap&&(this.mipmap=e,s=!0),s&&this.dirtyStyleId++,this}setSize(t,e,s){return s=s||this.resolution,this.setRealSize(t*s,e*s,s)}setRealSize(t,e,s){return this.resolution=s||this.resolution,this.width=Math.round(t)/this.resolution,this.height=Math.round(e)/this.resolution,this._refreshPOT(),this.update(),this}_refreshPOT(){this.isPowerOfTwo=Lu(this.realWidth)&&Lu(this.realHeight)}setResolution(t){const e=this.resolution;return e===t?this:(this.resolution=t,this.valid&&(this.width=Math.round(this.width*e)/t,this.height=Math.round(this.height*e)/t,this.emit("update",this)),this._refreshPOT(),this)}setResource(t){if(this.resource===t)return this;if(this.resource)throw new Error("Resource can be set only once");return t.bind(this),this.resource=t,this}update(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))}onError(t){this.emit("error",this,t)}destroy(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete Gn[this.cacheId],delete an[this.cacheId],this.cacheId=null),this.valid=!1,this.dispose(),ti.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0,this.emit("destroyed",this),this.removeAllListeners()}dispose(){this.emit("dispose",this)}castToBaseTexture(){return this}static from(t,e,s=ht.STRICT_TEXTURE_CACHE){const r=typeof t=="string";let i=null;if(r)i=t;else{if(!t._pixiId){const l=(e==null?void 0:e.pixiIdPrefix)||"pixiid";t._pixiId=`${l}_${Vr()}`}i=t._pixiId}let o=Gn[i];if(r&&s&&!o)throw new Error(`The cacheId "${i}" does not exist in BaseTextureCache.`);return o||(o=new ti(t,e),o.cacheId=i,ti.addToCache(o,i)),o}static fromBuffer(t,e,s,r){t=t||new Float32Array(e*s*4);const i=new jo(t,{width:e,height:s,...r==null?void 0:r.resourceOptions});let o,l;return t instanceof Float32Array?(o=st.RGBA,l=yt.FLOAT):t instanceof Int32Array?(o=st.RGBA_INTEGER,l=yt.INT):t instanceof Uint32Array?(o=st.RGBA_INTEGER,l=yt.UNSIGNED_INT):t instanceof Int16Array?(o=st.RGBA_INTEGER,l=yt.SHORT):t instanceof Uint16Array?(o=st.RGBA_INTEGER,l=yt.UNSIGNED_SHORT):t instanceof Int8Array?(o=st.RGBA,l=yt.BYTE):(o=st.RGBA,l=yt.UNSIGNED_BYTE),i.internal=!0,new ti(i,Object.assign({},D1,{type:l,format:o},r))}static addToCache(t,e){e&&(t.textureCacheIds.includes(e)||t.textureCacheIds.push(e),Gn[e]&&Gn[e]!==t&&console.warn(`BaseTexture added to the cache with an id [${e}] that already had an entry`),Gn[e]=t)}static removeFromCache(t){if(typeof t=="string"){const e=Gn[t];if(e){const s=e.textureCacheIds.indexOf(t);return s>-1&&e.textureCacheIds.splice(s,1),delete Gn[t],e}}else if(t!=null&&t.textureCacheIds){for(let e=0;e<t.textureCacheIds.length;++e)delete Gn[t.textureCacheIds[e]];return t.textureCacheIds.length=0,t}return null}};wc.defaultOptions={mipmap:Zs.POW2,anisotropicLevel:0,scaleMode:ps.LINEAR,wrapMode:hr.CLAMP,alphaMode:Qe.UNPACK,target:hi.TEXTURE_2D,format:st.RGBA,type:yt.UNSIGNED_BYTE},wc._globalBatch=0;let _t=wc;class vc{constructor(){this.texArray=null,this.blend=0,this.type=Ws.TRIANGLES,this.start=0,this.size=0,this.data=null}}let B1=0;class ve{constructor(t,e=!0,s=!1){this.data=t||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=s,this.static=e,this.id=B1++,this.disposeRunner=new zs("disposeBuffer")}update(t){t instanceof Array&&(t=new Float32Array(t)),this.data=t||this.data,this._updateID++}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.data=null}set index(t){this.type=t?pn.ELEMENT_ARRAY_BUFFER:pn.ARRAY_BUFFER}get index(){return this.type===pn.ELEMENT_ARRAY_BUFFER}static from(t){return t instanceof Array&&(t=new Float32Array(t)),new ve(t)}}class uo{constructor(t,e=0,s=!1,r=yt.FLOAT,i,o,l,a=1){this.buffer=t,this.size=e,this.normalized=s,this.type=r,this.stride=i,this.start=o,this.instance=l,this.divisor=a}destroy(){this.buffer=null}static from(t,e,s,r,i){return new uo(t,e,s,r,i)}}const L1={Float32Array,Uint32Array,Int32Array,Uint8Array};function O1(n,t){let e=0,s=0;const r={};for(let a=0;a<n.length;a++)s+=t[a],e+=n[a].length;const i=new ArrayBuffer(e*4);let o=null,l=0;for(let a=0;a<n.length;a++){const c=t[a],h=n[a],d=Vm(h);r[d]||(r[d]=new L1[d](i)),o=r[d];for(let u=0;u<h.length;u++){const f=(u/c|0)*s+l,m=u%c;o[f+m]=h[u]}l+=c}return new Float32Array(i)}const Yu={5126:4,5123:2,5121:1};let j1=0;const V1={Float32Array,Uint32Array,Int32Array,Uint8Array,Uint16Array};class fr{constructor(t=[],e={}){this.buffers=t,this.indexBuffer=null,this.attributes=e,this.glVertexArrayObjects={},this.id=j1++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new zs("disposeGeometry"),this.refCount=0}addAttribute(t,e,s=0,r=!1,i,o,l,a=!1){if(!e)throw new Error("You must pass a buffer when creating an attribute");e instanceof ve||(e instanceof Array&&(e=new Float32Array(e)),e=new ve(e));const c=t.split("|");if(c.length>1){for(let d=0;d<c.length;d++)this.addAttribute(c[d],e,s,r,i);return this}let h=this.buffers.indexOf(e);return h===-1&&(this.buffers.push(e),h=this.buffers.length-1),this.attributes[t]=new uo(h,s,r,i,o,l,a),this.instanced=this.instanced||a,this}getAttribute(t){return this.attributes[t]}getBuffer(t){return this.buffers[this.getAttribute(t).buffer]}addIndex(t){return t instanceof ve||(t instanceof Array&&(t=new Uint16Array(t)),t=new ve(t)),t.type=pn.ELEMENT_ARRAY_BUFFER,this.indexBuffer=t,this.buffers.includes(t)||this.buffers.push(t),this}getIndex(){return this.indexBuffer}interleave(){if(this.buffers.length===1||this.buffers.length===2&&this.indexBuffer)return this;const t=[],e=[],s=new ve;let r;for(r in this.attributes){const i=this.attributes[r],o=this.buffers[i.buffer];t.push(o.data),e.push(i.size*Yu[i.type]/4),i.buffer=0}for(s.data=O1(t,e),r=0;r<this.buffers.length;r++)this.buffers[r]!==this.indexBuffer&&this.buffers[r].destroy();return this.buffers=[s],this.indexBuffer&&this.buffers.push(this.indexBuffer),this}getSize(){for(const t in this.attributes){const e=this.attributes[t];return this.buffers[e.buffer].data.length/(e.stride/4||e.size)}return 0}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null}clone(){const t=new fr;for(let e=0;e<this.buffers.length;e++)t.buffers[e]=new ve(this.buffers[e].data.slice(0));for(const e in this.attributes){const s=this.attributes[e];t.attributes[e]=new uo(s.buffer,s.size,s.normalized,s.type,s.stride,s.start,s.instance)}return this.indexBuffer&&(t.indexBuffer=t.buffers[this.buffers.indexOf(this.indexBuffer)],t.indexBuffer.type=pn.ELEMENT_ARRAY_BUFFER),t}static merge(t){const e=new fr,s=[],r=[],i=[];let o;for(let l=0;l<t.length;l++){o=t[l];for(let a=0;a<o.buffers.length;a++)r[a]=r[a]||0,r[a]+=o.buffers[a].data.length,i[a]=0}for(let l=0;l<o.buffers.length;l++)s[l]=new V1[Vm(o.buffers[l].data)](r[l]),e.buffers[l]=new ve(s[l]);for(let l=0;l<t.length;l++){o=t[l];for(let a=0;a<o.buffers.length;a++)s[a].set(o.buffers[a].data,i[a]),i[a]+=o.buffers[a].data.length}if(e.attributes=o.attributes,o.indexBuffer){e.indexBuffer=e.buffers[o.buffers.indexOf(o.indexBuffer)],e.indexBuffer.type=pn.ELEMENT_ARRAY_BUFFER;let l=0,a=0,c=0,h=0;for(let d=0;d<o.buffers.length;d++)if(o.buffers[d]!==o.indexBuffer){h=d;break}for(const d in o.attributes){const u=o.attributes[d];(u.buffer|0)===h&&(a+=u.size*Yu[u.type]/4)}for(let d=0;d<t.length;d++){const u=t[d].indexBuffer.data;for(let f=0;f<u.length;f++)e.indexBuffer.data[f+c]+=l;l+=t[d].buffers[h].data.length/a,c+=u.length}}return e}}class Xm extends fr{constructor(t=!1){super(),this._buffer=new ve(null,t,!1),this._indexBuffer=new ve(null,t,!0),this.addAttribute("aVertexPosition",this._buffer,2,!1,yt.FLOAT).addAttribute("aTextureCoord",this._buffer,2,!1,yt.FLOAT).addAttribute("aColor",this._buffer,4,!0,yt.UNSIGNED_BYTE).addAttribute("aTextureId",this._buffer,1,!0,yt.FLOAT).addIndex(this._indexBuffer)}}const fo=Math.PI*2,U1=180/Math.PI,X1=Math.PI/180;var Xe=(n=>(n[n.POLY=0]="POLY",n[n.RECT=1]="RECT",n[n.CIRC=2]="CIRC",n[n.ELIP=3]="ELIP",n[n.RREC=4]="RREC",n))(Xe||{});class Xt{constructor(t=0,e=0){this.x=0,this.y=0,this.x=t,this.y=e}clone(){return new Xt(this.x,this.y)}copyFrom(t){return this.set(t.x,t.y),this}copyTo(t){return t.set(this.x,this.y),t}equals(t){return t.x===this.x&&t.y===this.y}set(t=0,e=t){return this.x=t,this.y=e,this}}Xt.prototype.toString=function(){return`[@pixi/math:Point x=${this.x} y=${this.y}]`};const Ca=[new Xt,new Xt,new Xt,new Xt];class vt{constructor(t=0,e=0,s=0,r=0){this.x=Number(t),this.y=Number(e),this.width=Number(s),this.height=Number(r),this.type=Xe.RECT}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}static get EMPTY(){return new vt(0,0,0,0)}clone(){return new vt(this.x,this.y,this.width,this.height)}copyFrom(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this}copyTo(t){return t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t}contains(t,e){return this.width<=0||this.height<=0?!1:t>=this.x&&t<this.x+this.width&&e>=this.y&&e<this.y+this.height}intersects(t,e){if(!e){const T=this.x<t.x?t.x:this.x;if((this.right>t.right?t.right:this.right)<=T)return!1;const C=this.y<t.y?t.y:this.y;return(this.bottom>t.bottom?t.bottom:this.bottom)>C}const s=this.left,r=this.right,i=this.top,o=this.bottom;if(r<=s||o<=i)return!1;const l=Ca[0].set(t.left,t.top),a=Ca[1].set(t.left,t.bottom),c=Ca[2].set(t.right,t.top),h=Ca[3].set(t.right,t.bottom);if(c.x<=l.x||a.y<=l.y)return!1;const d=Math.sign(e.a*e.d-e.b*e.c);if(d===0||(e.apply(l,l),e.apply(a,a),e.apply(c,c),e.apply(h,h),Math.max(l.x,a.x,c.x,h.x)<=s||Math.min(l.x,a.x,c.x,h.x)>=r||Math.max(l.y,a.y,c.y,h.y)<=i||Math.min(l.y,a.y,c.y,h.y)>=o))return!1;const u=d*(a.y-l.y),f=d*(l.x-a.x),m=u*s+f*i,p=u*r+f*i,g=u*s+f*o,w=u*r+f*o;if(Math.max(m,p,g,w)<=u*l.x+f*l.y||Math.min(m,p,g,w)>=u*h.x+f*h.y)return!1;const x=d*(l.y-c.y),y=d*(c.x-l.x),b=x*s+y*i,_=x*r+y*i,E=x*s+y*o,S=x*r+y*o;return!(Math.max(b,_,E,S)<=x*l.x+y*l.y||Math.min(b,_,E,S)>=x*h.x+y*h.y)}pad(t=0,e=t){return this.x-=t,this.y-=e,this.width+=t*2,this.height+=e*2,this}fit(t){const e=Math.max(this.x,t.x),s=Math.min(this.x+this.width,t.x+t.width),r=Math.max(this.y,t.y),i=Math.min(this.y+this.height,t.y+t.height);return this.x=e,this.width=Math.max(s-e,0),this.y=r,this.height=Math.max(i-r,0),this}ceil(t=1,e=.001){const s=Math.ceil((this.x+this.width-e)*t)/t,r=Math.ceil((this.y+this.height-e)*t)/t;return this.x=Math.floor((this.x+e)*t)/t,this.y=Math.floor((this.y+e)*t)/t,this.width=s-this.x,this.height=r-this.y,this}enlarge(t){const e=Math.min(this.x,t.x),s=Math.max(this.x+this.width,t.x+t.width),r=Math.min(this.y,t.y),i=Math.max(this.y+this.height,t.y+t.height);return this.x=e,this.width=s-e,this.y=r,this.height=i-r,this}}vt.prototype.toString=function(){return`[@pixi/math:Rectangle x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`};class Vo{constructor(t=0,e=0,s=0){this.x=t,this.y=e,this.radius=s,this.type=Xe.CIRC}clone(){return new Vo(this.x,this.y,this.radius)}contains(t,e){if(this.radius<=0)return!1;const s=this.radius*this.radius;let r=this.x-t,i=this.y-e;return r*=r,i*=i,r+i<=s}getBounds(){return new vt(this.x-this.radius,this.y-this.radius,this.radius*2,this.radius*2)}}Vo.prototype.toString=function(){return`[@pixi/math:Circle x=${this.x} y=${this.y} radius=${this.radius}]`};class Uo{constructor(t=0,e=0,s=0,r=0){this.x=t,this.y=e,this.width=s,this.height=r,this.type=Xe.ELIP}clone(){return new Uo(this.x,this.y,this.width,this.height)}contains(t,e){if(this.width<=0||this.height<=0)return!1;let s=(t-this.x)/this.width,r=(e-this.y)/this.height;return s*=s,r*=r,s+r<=1}getBounds(){return new vt(this.x-this.width,this.y-this.height,this.width,this.height)}}Uo.prototype.toString=function(){return`[@pixi/math:Ellipse x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`};class dr{constructor(...t){let e=Array.isArray(t[0])?t[0]:t;if(typeof e[0]!="number"){const s=[];for(let r=0,i=e.length;r<i;r++)s.push(e[r].x,e[r].y);e=s}this.points=e,this.type=Xe.POLY,this.closeStroke=!0}clone(){const t=this.points.slice(),e=new dr(t);return e.closeStroke=this.closeStroke,e}contains(t,e){let s=!1;const r=this.points.length/2;for(let i=0,o=r-1;i<r;o=i++){const l=this.points[i*2],a=this.points[i*2+1],c=this.points[o*2],h=this.points[o*2+1];a>e!=h>e&&t<(c-l)*((e-a)/(h-a))+l&&(s=!s)}return s}}dr.prototype.toString=function(){return`[@pixi/math:PolygoncloseStroke=${this.closeStroke}points=${this.points.reduce((n,t)=>`${n}, ${t}`,"")}]`};class Xo{constructor(t=0,e=0,s=0,r=0,i=20){this.x=t,this.y=e,this.width=s,this.height=r,this.radius=i,this.type=Xe.RREC}clone(){return new Xo(this.x,this.y,this.width,this.height,this.radius)}contains(t,e){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height){const s=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(e>=this.y+s&&e<=this.y+this.height-s||t>=this.x+s&&t<=this.x+this.width-s)return!0;let r=t-(this.x+s),i=e-(this.y+s);const o=s*s;if(r*r+i*i<=o||(r=t-(this.x+this.width-s),r*r+i*i<=o)||(i=e-(this.y+this.height-s),r*r+i*i<=o)||(r=t-(this.x+s),r*r+i*i<=o))return!0}return!1}}Xo.prototype.toString=function(){return`[@pixi/math:RoundedRectangle x=${this.x} y=${this.y}width=${this.width} height=${this.height} radius=${this.radius}]`};class Zt{constructor(t=1,e=0,s=0,r=1,i=0,o=0){this.array=null,this.a=t,this.b=e,this.c=s,this.d=r,this.tx=i,this.ty=o}fromArray(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]}set(t,e,s,r,i,o){return this.a=t,this.b=e,this.c=s,this.d=r,this.tx=i,this.ty=o,this}toArray(t,e){this.array||(this.array=new Float32Array(9));const s=e||this.array;return t?(s[0]=this.a,s[1]=this.b,s[2]=0,s[3]=this.c,s[4]=this.d,s[5]=0,s[6]=this.tx,s[7]=this.ty,s[8]=1):(s[0]=this.a,s[1]=this.c,s[2]=this.tx,s[3]=this.b,s[4]=this.d,s[5]=this.ty,s[6]=0,s[7]=0,s[8]=1),s}apply(t,e){e=e||new Xt;const s=t.x,r=t.y;return e.x=this.a*s+this.c*r+this.tx,e.y=this.b*s+this.d*r+this.ty,e}applyInverse(t,e){e=e||new Xt;const s=1/(this.a*this.d+this.c*-this.b),r=t.x,i=t.y;return e.x=this.d*s*r+-this.c*s*i+(this.ty*this.c-this.tx*this.d)*s,e.y=this.a*s*i+-this.b*s*r+(-this.ty*this.a+this.tx*this.b)*s,e}translate(t,e){return this.tx+=t,this.ty+=e,this}scale(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this}rotate(t){const e=Math.cos(t),s=Math.sin(t),r=this.a,i=this.c,o=this.tx;return this.a=r*e-this.b*s,this.b=r*s+this.b*e,this.c=i*e-this.d*s,this.d=i*s+this.d*e,this.tx=o*e-this.ty*s,this.ty=o*s+this.ty*e,this}append(t){const e=this.a,s=this.b,r=this.c,i=this.d;return this.a=t.a*e+t.b*r,this.b=t.a*s+t.b*i,this.c=t.c*e+t.d*r,this.d=t.c*s+t.d*i,this.tx=t.tx*e+t.ty*r+this.tx,this.ty=t.tx*s+t.ty*i+this.ty,this}setTransform(t,e,s,r,i,o,l,a,c){return this.a=Math.cos(l+c)*i,this.b=Math.sin(l+c)*i,this.c=-Math.sin(l-a)*o,this.d=Math.cos(l-a)*o,this.tx=t-(s*this.a+r*this.c),this.ty=e-(s*this.b+r*this.d),this}prepend(t){const e=this.tx;if(t.a!==1||t.b!==0||t.c!==0||t.d!==1){const s=this.a,r=this.c;this.a=s*t.a+this.b*t.c,this.b=s*t.b+this.b*t.d,this.c=r*t.a+this.d*t.c,this.d=r*t.b+this.d*t.d}return this.tx=e*t.a+this.ty*t.c+t.tx,this.ty=e*t.b+this.ty*t.d+t.ty,this}decompose(t){const e=this.a,s=this.b,r=this.c,i=this.d,o=t.pivot,l=-Math.atan2(-r,i),a=Math.atan2(s,e),c=Math.abs(l+a);return c<1e-5||Math.abs(fo-c)<1e-5?(t.rotation=a,t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=l,t.skew.y=a),t.scale.x=Math.sqrt(e*e+s*s),t.scale.y=Math.sqrt(r*r+i*i),t.position.x=this.tx+(o.x*e+o.y*r),t.position.y=this.ty+(o.x*s+o.y*i),t}invert(){const t=this.a,e=this.b,s=this.c,r=this.d,i=this.tx,o=t*r-e*s;return this.a=r/o,this.b=-e/o,this.c=-s/o,this.d=t/o,this.tx=(s*this.ty-r*i)/o,this.ty=-(t*this.ty-e*i)/o,this}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}clone(){const t=new Zt;return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copyTo(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copyFrom(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this}static get IDENTITY(){return new Zt}static get TEMP_MATRIX(){return new Zt}}Zt.prototype.toString=function(){return`[@pixi/math:Matrix a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty}]`};const _r=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],Er=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],Sr=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],Tr=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],_c=[],Gm=[],ka=Math.sign;function G1(){for(let n=0;n<16;n++){const t=[];_c.push(t);for(let e=0;e<16;e++){const s=ka(_r[n]*_r[e]+Sr[n]*Er[e]),r=ka(Er[n]*_r[e]+Tr[n]*Er[e]),i=ka(_r[n]*Sr[e]+Sr[n]*Tr[e]),o=ka(Er[n]*Sr[e]+Tr[n]*Tr[e]);for(let l=0;l<16;l++)if(_r[l]===s&&Er[l]===r&&Sr[l]===i&&Tr[l]===o){t.push(l);break}}}for(let n=0;n<16;n++){const t=new Zt;t.set(_r[n],Er[n],Sr[n],Tr[n],0,0),Gm.push(t)}}G1();const ue={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:n=>_r[n],uY:n=>Er[n],vX:n=>Sr[n],vY:n=>Tr[n],inv:n=>n&8?n&15:-n&7,add:(n,t)=>_c[n][t],sub:(n,t)=>_c[n][ue.inv(t)],rotate180:n=>n^4,isVertical:n=>(n&3)===2,byDirection:(n,t)=>Math.abs(n)*2<=Math.abs(t)?t>=0?ue.S:ue.N:Math.abs(t)*2<=Math.abs(n)?n>0?ue.E:ue.W:t>0?n>0?ue.SE:ue.SW:n>0?ue.NE:ue.NW,matrixAppendRotationInv:(n,t,e=0,s=0)=>{const r=Gm[ue.inv(t)];r.tx=e,r.ty=s,n.append(r)}};class Mn{constructor(t,e,s=0,r=0){this._x=s,this._y=r,this.cb=t,this.scope=e}clone(t=this.cb,e=this.scope){return new Mn(t,e,this._x,this._y)}set(t=0,e=t){return(this._x!==t||this._y!==e)&&(this._x=t,this._y=e,this.cb.call(this.scope)),this}copyFrom(t){return(this._x!==t.x||this._y!==t.y)&&(this._x=t.x,this._y=t.y,this.cb.call(this.scope)),this}copyTo(t){return t.set(this._x,this._y),t}equals(t){return t.x===this._x&&t.y===this._y}get x(){return this._x}set x(t){this._x!==t&&(this._x=t,this.cb.call(this.scope))}get y(){return this._y}set y(t){this._y!==t&&(this._y=t,this.cb.call(this.scope))}}Mn.prototype.toString=function(){return`[@pixi/math:ObservablePoint x=${this.x} y=${this.y} scope=${this.scope}]`};const Ec=class{constructor(){this.worldTransform=new Zt,this.localTransform=new Zt,this.position=new Mn(this.onChange,this,0,0),this.scale=new Mn(this.onChange,this,1,1),this.pivot=new Mn(this.onChange,this,0,0),this.skew=new Mn(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}onChange(){this._localID++}updateSkew(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++}updateLocalTransform(){const n=this.localTransform;this._localID!==this._currentLocalID&&(n.a=this._cx*this.scale.x,n.b=this._sx*this.scale.x,n.c=this._cy*this.scale.y,n.d=this._sy*this.scale.y,n.tx=this.position.x-(this.pivot.x*n.a+this.pivot.y*n.c),n.ty=this.position.y-(this.pivot.x*n.b+this.pivot.y*n.d),this._currentLocalID=this._localID,this._parentID=-1)}updateTransform(n){const t=this.localTransform;if(this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==n._worldID){const e=n.worldTransform,s=this.worldTransform;s.a=t.a*e.a+t.b*e.c,s.b=t.a*e.b+t.b*e.d,s.c=t.c*e.a+t.d*e.c,s.d=t.c*e.b+t.d*e.d,s.tx=t.tx*e.a+t.ty*e.c+e.tx,s.ty=t.tx*e.b+t.ty*e.d+e.ty,this._parentID=n._worldID,this._worldID++}}setFromMatrix(n){n.decompose(this),this._localID++}get rotation(){return this._rotation}set rotation(n){this._rotation!==n&&(this._rotation=n,this.updateSkew())}};Ec.IDENTITY=new Ec;let Go=Ec;Go.prototype.toString=function(){return`[@pixi/math:Transform position=(${this.position.x}, ${this.position.y}) rotation=${this.rotation} scale=(${this.scale.x}, ${this.scale.y}) skew=(${this.skew.x}, ${this.skew.y}) ]`};var Y1=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor *= texture2D(uSampler, vTextureCoord);
}`,$1=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void){
   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
   vTextureCoord = aTextureCoord;
}
`;function $u(n,t,e){const s=n.createShader(t);return n.shaderSource(s,e),n.compileShader(s),s}function Ml(n){const t=new Array(n);for(let e=0;e<t.length;e++)t[e]=!1;return t}function Ym(n,t){switch(n){case"float":return 0;case"vec2":return new Float32Array(2*t);case"vec3":return new Float32Array(3*t);case"vec4":return new Float32Array(4*t);case"int":case"uint":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*t);case"ivec3":return new Int32Array(3*t);case"ivec4":return new Int32Array(4*t);case"uvec2":return new Uint32Array(2*t);case"uvec3":return new Uint32Array(3*t);case"uvec4":return new Uint32Array(4*t);case"bool":return!1;case"bvec2":return Ml(2*t);case"bvec3":return Ml(3*t);case"bvec4":return Ml(4*t);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}const ui=[{test:n=>n.type==="float"&&n.size===1&&!n.isArray,code:n=>`
            if(uv["${n}"] !== ud["${n}"].value)
            {
                ud["${n}"].value = uv["${n}"]
                gl.uniform1f(ud["${n}"].location, uv["${n}"])
            }
            `},{test:(n,t)=>(n.type==="sampler2D"||n.type==="samplerCube"||n.type==="sampler2DArray")&&n.size===1&&!n.isArray&&(t==null||t.castToBaseTexture!==void 0),code:n=>`t = syncData.textureCount++;

            renderer.texture.bind(uv["${n}"], t);

            if(ud["${n}"].value !== t)
            {
                ud["${n}"].value = t;
                gl.uniform1i(ud["${n}"].location, t);
; // eslint-disable-line max-len
            }`},{test:(n,t)=>n.type==="mat3"&&n.size===1&&!n.isArray&&t.a!==void 0,code:n=>`
            gl.uniformMatrix3fv(ud["${n}"].location, false, uv["${n}"].toArray(true));
            `,codeUbo:n=>`
                var ${n}_matrix = uv.${n}.toArray(true);

                data[offset] = ${n}_matrix[0];
                data[offset+1] = ${n}_matrix[1];
                data[offset+2] = ${n}_matrix[2];
        
                data[offset + 4] = ${n}_matrix[3];
                data[offset + 5] = ${n}_matrix[4];
                data[offset + 6] = ${n}_matrix[5];
        
                data[offset + 8] = ${n}_matrix[6];
                data[offset + 9] = ${n}_matrix[7];
                data[offset + 10] = ${n}_matrix[8];
            `},{test:(n,t)=>n.type==="vec2"&&n.size===1&&!n.isArray&&t.x!==void 0,code:n=>`
                cv = ud["${n}"].value;
                v = uv["${n}"];

                if(cv[0] !== v.x || cv[1] !== v.y)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    gl.uniform2f(ud["${n}"].location, v.x, v.y);
                }`,codeUbo:n=>`
                v = uv.${n};

                data[offset] = v.x;
                data[offset+1] = v.y;
            `},{test:n=>n.type==="vec2"&&n.size===1&&!n.isArray,code:n=>`
                cv = ud["${n}"].value;
                v = uv["${n}"];

                if(cv[0] !== v[0] || cv[1] !== v[1])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    gl.uniform2f(ud["${n}"].location, v[0], v[1]);
                }
            `},{test:(n,t)=>n.type==="vec4"&&n.size===1&&!n.isArray&&t.width!==void 0,code:n=>`
                cv = ud["${n}"].value;
                v = uv["${n}"];

                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    cv[2] = v.width;
                    cv[3] = v.height;
                    gl.uniform4f(ud["${n}"].location, v.x, v.y, v.width, v.height)
                }`,codeUbo:n=>`
                    v = uv.${n};

                    data[offset] = v.x;
                    data[offset+1] = v.y;
                    data[offset+2] = v.width;
                    data[offset+3] = v.height;
                `},{test:(n,t)=>n.type==="vec4"&&n.size===1&&!n.isArray&&t.red!==void 0,code:n=>`
                cv = ud["${n}"].value;
                v = uv["${n}"];

                if(cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.alpha)
                {
                    cv[0] = v.red;
                    cv[1] = v.green;
                    cv[2] = v.blue;
                    cv[3] = v.alpha;
                    gl.uniform4f(ud["${n}"].location, v.red, v.green, v.blue, v.alpha)
                }`,codeUbo:n=>`
                    v = uv.${n};

                    data[offset] = v.red;
                    data[offset+1] = v.green;
                    data[offset+2] = v.blue;
                    data[offset+3] = v.alpha;
                `},{test:(n,t)=>n.type==="vec3"&&n.size===1&&!n.isArray&&t.red!==void 0,code:n=>`
                cv = ud["${n}"].value;
                v = uv["${n}"];

                if(cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.a)
                {
                    cv[0] = v.red;
                    cv[1] = v.green;
                    cv[2] = v.blue;
    
                    gl.uniform3f(ud["${n}"].location, v.red, v.green, v.blue)
                }`,codeUbo:n=>`
                    v = uv.${n};

                    data[offset] = v.red;
                    data[offset+1] = v.green;
                    data[offset+2] = v.blue;
                `},{test:n=>n.type==="vec4"&&n.size===1&&!n.isArray,code:n=>`
                cv = ud["${n}"].value;
                v = uv["${n}"];

                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    cv[2] = v[2];
                    cv[3] = v[3];

                    gl.uniform4f(ud["${n}"].location, v[0], v[1], v[2], v[3])
                }`}],W1={float:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1f(location, v);
    }`,vec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2f(location, v[0], v[1])
    }`,vec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3f(location, v[0], v[1], v[2])
    }`,vec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4f(location, v[0], v[1], v[2], v[3]);
    }`,int:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,ivec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,ivec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,ivec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,uint:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1ui(location, v);
    }`,uvec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2ui(location, v[0], v[1]);
    }`,uvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3ui(location, v[0], v[1], v[2]);
    }`,uvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4ui(location, v[0], v[1], v[2], v[3]);
    }`,bool:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1i(location, v);
    }`,bvec2:`
    if (cv[0] != v[0] || cv[1] != v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,bvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,bvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,samplerCube:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,sampler2DArray:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`},z1={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",uint:"gl.uniform1uiv(location, v)",uvec2:"gl.uniform2uiv(location, v)",uvec3:"gl.uniform3uiv(location, v)",uvec4:"gl.uniform4uiv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};function H1(n,t){var s;const e=[`
        var v = null;
        var cv = null;
        var cu = null;
        var t = 0;
        var gl = renderer.gl;
    `];for(const r in n.uniforms){const i=t[r];if(!i){((s=n.uniforms[r])==null?void 0:s.group)===!0&&(n.uniforms[r].ubo?e.push(`
                        renderer.shader.syncUniformBufferGroup(uv.${r}, '${r}');
                    `):e.push(`
                        renderer.shader.syncUniformGroup(uv.${r}, syncData);
                    `));continue}const o=n.uniforms[r];let l=!1;for(let a=0;a<ui.length;a++)if(ui[a].test(i,o)){e.push(ui[a].code(r,o)),l=!0;break}if(!l){const a=(i.size===1&&!i.isArray?W1:z1)[i.type].replace("location",`ud["${r}"].location`);e.push(`
            cu = ud["${r}"];
            cv = cu.value;
            v = uv["${r}"];
            ${a};`)}}return new Function("ud","uv","renderer","syncData",e.join(`
`))}const $m={};let Zr=$m;function q1(){if(Zr===$m||Zr!=null&&Zr.isContextLost()){const n=ht.ADAPTER.createCanvas();let t;ht.PREFER_ENV>=Yr.WEBGL2&&(t=n.getContext("webgl2",{})),t||(t=n.getContext("webgl",{})||n.getContext("experimental-webgl",{}),t?t.getExtension("WEBGL_draw_buffers"):t=null),Zr=t}return Zr}let Ia;function K1(){if(!Ia){Ia=As.MEDIUM;const n=q1();if(n&&n.getShaderPrecisionFormat){const t=n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.HIGH_FLOAT);t&&(Ia=t.precision?As.HIGH:As.MEDIUM)}}return Ia}function Wu(n,t){const e=n.getShaderSource(t).split(`
`).map((c,h)=>`${h}: ${c}`),s=n.getShaderInfoLog(t),r=s.split(`
`),i={},o=r.map(c=>parseFloat(c.replace(/^ERROR\: 0\:([\d]+)\:.*$/,"$1"))).filter(c=>c&&!i[c]?(i[c]=!0,!0):!1),l=[""];o.forEach(c=>{e[c-1]=`%c${e[c-1]}%c`,l.push("background: #FF0000; color:#FFFFFF; font-size: 10px","font-size: 10px")});const a=e.join(`
`);l[0]=a,console.error(s),console.groupCollapsed("click to view full shader code"),console.warn(...l),console.groupEnd()}function Z1(n,t,e,s){n.getProgramParameter(t,n.LINK_STATUS)||(n.getShaderParameter(e,n.COMPILE_STATUS)||Wu(n,e),n.getShaderParameter(s,n.COMPILE_STATUS)||Wu(n,s),console.error("PixiJS Error: Could not initialize shader."),n.getProgramInfoLog(t)!==""&&console.warn("PixiJS Warning: gl.getProgramInfoLog()",n.getProgramInfoLog(t)))}const Q1={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,uint:1,uvec2:2,uvec3:3,uvec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function Wm(n){return Q1[n]}let Ra=null;const zu={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",UNSIGNED_INT:"uint",UNSIGNED_INT_VEC2:"uvec2",UNSIGNED_INT_VEC3:"uvec3",UNSIGNED_INT_VEC4:"uvec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",INT_SAMPLER_2D:"sampler2D",UNSIGNED_INT_SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",INT_SAMPLER_CUBE:"samplerCube",UNSIGNED_INT_SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray",INT_SAMPLER_2D_ARRAY:"sampler2DArray",UNSIGNED_INT_SAMPLER_2D_ARRAY:"sampler2DArray"};function zm(n,t){if(!Ra){const e=Object.keys(zu);Ra={};for(let s=0;s<e.length;++s){const r=e[s];Ra[n[r]]=zu[r]}}return Ra[t]}function Hu(n,t,e){if(n.substring(0,9)!=="precision"){let s=t;return t===As.HIGH&&e!==As.HIGH&&(s=As.MEDIUM),`precision ${s} float;
${n}`}else if(e!==As.HIGH&&n.substring(0,15)==="precision highp")return n.replace("precision highp","precision mediump");return n}let Pi;function J1(){if(typeof Pi=="boolean")return Pi;try{Pi=new Function("param1","param2","param3","return param1[param2] === param3;")({a:"b"},"a","b")===!0}catch{Pi=!1}return Pi}let tw=0;const Ma={},Sc=class ei{constructor(t,e,s="pixi-shader",r={}){this.extra={},this.id=tw++,this.vertexSrc=t||ei.defaultVertexSrc,this.fragmentSrc=e||ei.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),this.extra=r,this.vertexSrc.substring(0,8)!=="#version"&&(s=s.replace(/\s+/g,"-"),Ma[s]?(Ma[s]++,s+=`-${Ma[s]}`):Ma[s]=1,this.vertexSrc=`#define SHADER_NAME ${s}
${this.vertexSrc}`,this.fragmentSrc=`#define SHADER_NAME ${s}
${this.fragmentSrc}`,this.vertexSrc=Hu(this.vertexSrc,ei.defaultVertexPrecision,As.HIGH),this.fragmentSrc=Hu(this.fragmentSrc,ei.defaultFragmentPrecision,K1())),this.glPrograms={},this.syncUniforms=null}static get defaultVertexSrc(){return $1}static get defaultFragmentSrc(){return Y1}static from(t,e,s){const r=t+e;let i=Vu[r];return i||(Vu[r]=i=new ei(t,e,s)),i}};Sc.defaultVertexPrecision=As.HIGH,Sc.defaultFragmentPrecision=Rn.apple.device?As.HIGH:As.MEDIUM;let Pn=Sc,ew=0;class Hs{constructor(t,e,s){this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=ew++,this.static=!!e,this.ubo=!!s,t instanceof ve?(this.buffer=t,this.buffer.type=pn.UNIFORM_BUFFER,this.autoManage=!1,this.ubo=!0):(this.uniforms=t,this.ubo&&(this.buffer=new ve(new Float32Array(1)),this.buffer.type=pn.UNIFORM_BUFFER,this.autoManage=!0))}update(){this.dirtyId++,!this.autoManage&&this.buffer&&this.buffer.update()}add(t,e,s){if(!this.ubo)this.uniforms[t]=new Hs(e,s);else throw new Error("[UniformGroup] uniform groups in ubo mode cannot be modified, or have uniform groups nested in them")}static from(t,e,s){return new Hs(t,e,s)}static uboFrom(t,e){return new Hs(t,e??!0,!0)}}class gn{constructor(t,e){this.uniformBindCount=0,this.program=t,e?e instanceof Hs?this.uniformGroup=e:this.uniformGroup=new Hs(e):this.uniformGroup=new Hs({}),this.disposeRunner=new zs("disposeShader")}checkUniformExists(t,e){if(e.uniforms[t])return!0;for(const s in e.uniforms){const r=e.uniforms[s];if(r.group===!0&&this.checkUniformExists(t,r))return!0}return!1}destroy(){this.uniformGroup=null,this.disposeRunner.emit(this),this.disposeRunner.destroy()}get uniforms(){return this.uniformGroup.uniforms}static from(t,e,s){const r=Pn.from(t,e);return new gn(r,s)}}class sw{constructor(t,e){if(this.vertexSrc=t,this.fragTemplate=e,this.programCache={},this.defaultGroupCache={},!e.includes("%count%"))throw new Error('Fragment template must contain "%count%".');if(!e.includes("%forloop%"))throw new Error('Fragment template must contain "%forloop%".')}generateShader(t){if(!this.programCache[t]){const s=new Int32Array(t);for(let i=0;i<t;i++)s[i]=i;this.defaultGroupCache[t]=Hs.from({uSamplers:s},!0);let r=this.fragTemplate;r=r.replace(/%count%/gi,`${t}`),r=r.replace(/%forloop%/gi,this.generateSampleSrc(t)),this.programCache[t]=new Pn(this.vertexSrc,r)}const e={tint:new Float32Array([1,1,1,1]),translationMatrix:new Zt,default:this.defaultGroupCache[t]};return new gn(this.programCache[t],e)}generateSampleSrc(t){let e="";e+=`
`,e+=`
`;for(let s=0;s<t;s++)s>0&&(e+=`
else `),s<t-1&&(e+=`if(vTextureId < ${s}.5)`),e+=`
{`,e+=`
	color = texture2D(uSamplers[${s}], vTextureCoord);`,e+=`
}`;return e+=`
`,e+=`
`,e}}class Tc{constructor(){this.elements=[],this.ids=[],this.count=0}clear(){for(let t=0;t<this.count;t++)this.elements[t]=null;this.count=0}}function nw(){return!Rn.apple.device}function rw(n){let t=!0;const e=ht.ADAPTER.getNavigator();if(Rn.tablet||Rn.phone){if(Rn.apple.device){const s=e.userAgent.match(/OS (\d+)_(\d+)?/);s&&parseInt(s[1],10)<11&&(t=!1)}if(Rn.android.device){const s=e.userAgent.match(/Android\s([0-9.]*)/);s&&parseInt(s[1],10)<7&&(t=!1)}}return t?n:4}class Yo{constructor(t){this.renderer=t}flush(){}destroy(){this.renderer=null}start(){}stop(){this.flush()}render(t){}}var iw=`varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;
uniform sampler2D uSamplers[%count%];

void main(void){
    vec4 color;
    %forloop%
    gl_FragColor = color * vColor;
}
`,aw=`precision highp float;
attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;
attribute float aTextureId;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform vec4 tint;

varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;

void main(void){
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vTextureId = aTextureId;
    vColor = aColor * tint;
}
`;const ji=class Ns extends Yo{constructor(t){super(t),this.setShaderGenerator(),this.geometryClass=Xm,this.vertexSize=6,this.state=yn.for2d(),this.size=Ns.defaultBatchSize*4,this._vertexCount=0,this._indexCount=0,this._bufferedElements=[],this._bufferedTextures=[],this._bufferSize=0,this._shader=null,this._packedGeometries=[],this._packedGeometryPoolSize=2,this._flushId=0,this._aBuffers={},this._iBuffers={},this.maxTextures=1,this.renderer.on("prerender",this.onPrerender,this),t.runners.contextChange.add(this),this._dcIndex=0,this._aIndex=0,this._iIndex=0,this._attributeBuffer=null,this._indexBuffer=null,this._tempBoundTextures=[]}static get defaultMaxTextures(){return this._defaultMaxTextures=this._defaultMaxTextures??rw(32),this._defaultMaxTextures}static set defaultMaxTextures(t){this._defaultMaxTextures=t}static get canUploadSameBuffer(){return this._canUploadSameBuffer=this._canUploadSameBuffer??nw(),this._canUploadSameBuffer}static set canUploadSameBuffer(t){this._canUploadSameBuffer=t}get MAX_TEXTURES(){return Pt("7.1.0","BatchRenderer#MAX_TEXTURES renamed to BatchRenderer#maxTextures"),this.maxTextures}static get defaultVertexSrc(){return aw}static get defaultFragmentTemplate(){return iw}setShaderGenerator({vertex:t=Ns.defaultVertexSrc,fragment:e=Ns.defaultFragmentTemplate}={}){this.shaderGenerator=new sw(t,e)}contextChange(){const t=this.renderer.gl;ht.PREFER_ENV===Yr.WEBGL_LEGACY?this.maxTextures=1:(this.maxTextures=Math.min(t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),Ns.defaultMaxTextures),this.maxTextures=F1(this.maxTextures,t)),this._shader=this.shaderGenerator.generateShader(this.maxTextures);for(let e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]=new this.geometryClass;this.initFlushBuffers()}initFlushBuffers(){const{_drawCallPool:t,_textureArrayPool:e}=Ns,s=this.size/4,r=Math.floor(s/this.maxTextures)+1;for(;t.length<s;)t.push(new vc);for(;e.length<r;)e.push(new Tc);for(let i=0;i<this.maxTextures;i++)this._tempBoundTextures[i]=null}onPrerender(){this._flushId=0}render(t){t._texture.valid&&(this._vertexCount+t.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=t.vertexData.length/2,this._indexCount+=t.indices.length,this._bufferedTextures[this._bufferSize]=t._texture.baseTexture,this._bufferedElements[this._bufferSize++]=t)}buildTexturesAndDrawCalls(){const{_bufferedTextures:t,maxTextures:e}=this,s=Ns._textureArrayPool,r=this.renderer.batch,i=this._tempBoundTextures,o=this.renderer.textureGC.count;let l=++_t._globalBatch,a=0,c=s[0],h=0;r.copyBoundTextures(i,e);for(let d=0;d<this._bufferSize;++d){const u=t[d];t[d]=null,u._batchEnabled!==l&&(c.count>=e&&(r.boundArray(c,i,l,e),this.buildDrawCalls(c,h,d),h=d,c=s[++a],++l),u._batchEnabled=l,u.touched=o,c.elements[c.count++]=u)}c.count>0&&(r.boundArray(c,i,l,e),this.buildDrawCalls(c,h,this._bufferSize),++a,++l);for(let d=0;d<i.length;d++)i[d]=null;_t._globalBatch=l}buildDrawCalls(t,e,s){const{_bufferedElements:r,_attributeBuffer:i,_indexBuffer:o,vertexSize:l}=this,a=Ns._drawCallPool;let c=this._dcIndex,h=this._aIndex,d=this._iIndex,u=a[c];u.start=this._iIndex,u.texArray=t;for(let f=e;f<s;++f){const m=r[f],p=m._texture.baseTexture,g=Om[p.alphaMode?1:0][m.blendMode];r[f]=null,e<f&&u.blend!==g&&(u.size=d-u.start,e=f,u=a[++c],u.texArray=t,u.start=d),this.packInterleavedGeometry(m,i,o,h,d),h+=m.vertexData.length/2*l,d+=m.indices.length,u.blend=g}e<s&&(u.size=d-u.start,++c),this._dcIndex=c,this._aIndex=h,this._iIndex=d}bindAndClearTexArray(t){const e=this.renderer.texture;for(let s=0;s<t.count;s++)e.bind(t.elements[s],t.ids[s]),t.elements[s]=null;t.count=0}updateGeometry(){const{_packedGeometries:t,_attributeBuffer:e,_indexBuffer:s}=this;Ns.canUploadSameBuffer?(t[this._flushId]._buffer.update(e.rawBinaryData),t[this._flushId]._indexBuffer.update(s),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,t[this._flushId]=new this.geometryClass),t[this._flushId]._buffer.update(e.rawBinaryData),t[this._flushId]._indexBuffer.update(s),this.renderer.geometry.bind(t[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)}drawBatches(){const t=this._dcIndex,{gl:e,state:s}=this.renderer,r=Ns._drawCallPool;let i=null;for(let o=0;o<t;o++){const{texArray:l,type:a,size:c,start:h,blend:d}=r[o];i!==l&&(i=l,this.bindAndClearTexArray(l)),this.state.blendMode=d,s.set(this.state),e.drawElements(a,c,e.UNSIGNED_SHORT,h*2)}}flush(){this._vertexCount!==0&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)}start(){this.renderer.state.set(this.state),this.renderer.texture.ensureSamplerType(this.maxTextures),this.renderer.shader.bind(this._shader),Ns.canUploadSameBuffer&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])}stop(){this.flush()}destroy(){for(let t=0;t<this._packedGeometryPoolSize;t++)this._packedGeometries[t]&&this._packedGeometries[t].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),super.destroy()}getAttributeBuffer(t){const e=ho(Math.ceil(t/8)),s=Ou(e),r=e*8;this._aBuffers.length<=s&&(this._iBuffers.length=s+1);let i=this._aBuffers[r];return i||(this._aBuffers[r]=i=new bc(r*this.vertexSize*4)),i}getIndexBuffer(t){const e=ho(Math.ceil(t/12)),s=Ou(e),r=e*12;this._iBuffers.length<=s&&(this._iBuffers.length=s+1);let i=this._iBuffers[s];return i||(this._iBuffers[s]=i=new Uint16Array(r)),i}packInterleavedGeometry(t,e,s,r,i){const{uint32View:o,float32View:l}=e,a=r/this.vertexSize,c=t.uvs,h=t.indices,d=t.vertexData,u=t._texture.baseTexture._batchLocation,f=Math.min(t.worldAlpha,1),m=te.shared.setValue(t._tintRGB).toPremultiplied(f,t._texture.baseTexture.alphaMode>0);for(let p=0;p<d.length;p+=2)l[r++]=d[p],l[r++]=d[p+1],l[r++]=c[p],l[r++]=c[p+1],o[r++]=m,l[r++]=u;for(let p=0;p<h.length;p++)s[i++]=a+h[p]}};ji.defaultBatchSize=4096,ji.extension={name:"batch",type:ot.RendererPlugin},ji._drawCallPool=[],ji._textureArrayPool=[];let Ar=ji;pt.add(Ar);var ow=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor = texture2D(uSampler, vTextureCoord);
}
`,lw=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`;const Ac=class Vi extends gn{constructor(t,e,s){const r=Pn.from(t||Vi.defaultVertexSrc,e||Vi.defaultFragmentSrc);super(r,s),this.padding=0,this.resolution=Vi.defaultResolution,this.multisample=Vi.defaultMultisample,this.enabled=!0,this.autoFit=!0,this.state=new yn}apply(t,e,s,r,i){t.applyFilter(this,e,s,r)}get blendMode(){return this.state.blendMode}set blendMode(t){this.state.blendMode=t}get resolution(){return this._resolution}set resolution(t){this._resolution=t}static get defaultVertexSrc(){return lw}static get defaultFragmentSrc(){return ow}};Ac.defaultResolution=1,Ac.defaultMultisample=Ae.NONE;let Je=Ac;class mo{constructor(){this.clearBeforeRender=!0,this._backgroundColor=new te(0),this.alpha=1}init(t){this.clearBeforeRender=t.clearBeforeRender;const{backgroundColor:e,background:s,backgroundAlpha:r}=t,i=s??e;i!==void 0&&(this.color=i),this.alpha=r}get color(){return this._backgroundColor.value}set color(t){this._backgroundColor.setValue(t)}get alpha(){return this._backgroundColor.alpha}set alpha(t){this._backgroundColor.setAlpha(t)}get backgroundColor(){return this._backgroundColor}destroy(){}}mo.defaultOptions={backgroundAlpha:1,backgroundColor:0,clearBeforeRender:!0},mo.extension={type:[ot.RendererSystem,ot.CanvasRendererSystem],name:"background"};pt.add(mo);class Hm{constructor(t){this.renderer=t,this.emptyRenderer=new Yo(t),this.currentRenderer=this.emptyRenderer}setObjectRenderer(t){this.currentRenderer!==t&&(this.currentRenderer.stop(),this.currentRenderer=t,this.currentRenderer.start())}flush(){this.setObjectRenderer(this.emptyRenderer)}reset(){this.setObjectRenderer(this.emptyRenderer)}copyBoundTextures(t,e){const{boundTextures:s}=this.renderer.texture;for(let r=e-1;r>=0;--r)t[r]=s[r]||null,t[r]&&(t[r]._batchLocation=r)}boundArray(t,e,s,r){const{elements:i,ids:o,count:l}=t;let a=0;for(let c=0;c<l;c++){const h=i[c],d=h._batchLocation;if(d>=0&&d<r&&e[d]===h){o[c]=d;continue}for(;a<r;){const u=e[a];if(u&&u._batchEnabled===s&&u._batchLocation===a){a++;continue}o[c]=a,h._batchLocation=a,e[a]=h;break}}}destroy(){this.renderer=null}}Hm.extension={type:ot.RendererSystem,name:"batch"};pt.add(Hm);let qu=0;class po{constructor(t){this.renderer=t,this.webGLVersion=1,this.extensions={},this.supports={uint32Indices:!1},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this)}get isLost(){return!this.gl||this.gl.isContextLost()}contextChange(t){this.gl=t,this.renderer.gl=t,this.renderer.CONTEXT_UID=qu++}init(t){if(t.context)this.initFromContext(t.context);else{const e=this.renderer.background.alpha<1,s=t.premultipliedAlpha;this.preserveDrawingBuffer=t.preserveDrawingBuffer,this.useContextAlpha=t.useContextAlpha,this.powerPreference=t.powerPreference,this.initFromOptions({alpha:e,premultipliedAlpha:s,antialias:t.antialias,stencil:!0,preserveDrawingBuffer:t.preserveDrawingBuffer,powerPreference:t.powerPreference})}}initFromContext(t){this.gl=t,this.validateContext(t),this.renderer.gl=t,this.renderer.CONTEXT_UID=qu++,this.renderer.runners.contextChange.emit(t);const e=this.renderer.view;e.addEventListener!==void 0&&(e.addEventListener("webglcontextlost",this.handleContextLost,!1),e.addEventListener("webglcontextrestored",this.handleContextRestored,!1))}initFromOptions(t){const e=this.createContext(this.renderer.view,t);this.initFromContext(e)}createContext(t,e){let s;if(ht.PREFER_ENV>=Yr.WEBGL2&&(s=t.getContext("webgl2",e)),s)this.webGLVersion=2;else if(this.webGLVersion=1,s=t.getContext("webgl",e)||t.getContext("experimental-webgl",e),!s)throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=s,this.getExtensions(),this.gl}getExtensions(){const{gl:t}=this,e={loseContext:t.getExtension("WEBGL_lose_context"),anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),s3tc:t.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:t.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:t.getExtension("WEBGL_compressed_texture_etc"),etc1:t.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:t.getExtension("WEBGL_compressed_texture_atc"),astc:t.getExtension("WEBGL_compressed_texture_astc"),bptc:t.getExtension("EXT_texture_compression_bptc")};this.webGLVersion===1?Object.assign(this.extensions,e,{drawBuffers:t.getExtension("WEBGL_draw_buffers"),depthTexture:t.getExtension("WEBGL_depth_texture"),vertexArrayObject:t.getExtension("OES_vertex_array_object")||t.getExtension("MOZ_OES_vertex_array_object")||t.getExtension("WEBKIT_OES_vertex_array_object"),uint32ElementIndex:t.getExtension("OES_element_index_uint"),floatTexture:t.getExtension("OES_texture_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),textureHalfFloat:t.getExtension("OES_texture_half_float"),textureHalfFloatLinear:t.getExtension("OES_texture_half_float_linear")}):this.webGLVersion===2&&Object.assign(this.extensions,e,{colorBufferFloat:t.getExtension("EXT_color_buffer_float")})}handleContextLost(t){t.preventDefault(),setTimeout(()=>{this.gl.isContextLost()&&this.extensions.loseContext&&this.extensions.loseContext.restoreContext()},0)}handleContextRestored(){this.renderer.runners.contextChange.emit(this.gl)}destroy(){const t=this.renderer.view;this.renderer=null,t.removeEventListener!==void 0&&(t.removeEventListener("webglcontextlost",this.handleContextLost),t.removeEventListener("webglcontextrestored",this.handleContextRestored)),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()}postrender(){this.renderer.objectRenderer.renderingToScreen&&this.gl.flush()}validateContext(t){const e=t.getContextAttributes(),s="WebGL2RenderingContext"in globalThis&&t instanceof globalThis.WebGL2RenderingContext;s&&(this.webGLVersion=2),e&&!e.stencil&&console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly");const r=s||!!t.getExtension("OES_element_index_uint");this.supports.uint32Indices=r,r||console.warn("Provided WebGL context does not support 32 index buffer, complex graphics may not render correctly")}}po.defaultOptions={context:null,antialias:!1,premultipliedAlpha:!0,preserveDrawingBuffer:!1,powerPreference:"default"},po.extension={type:ot.RendererSystem,name:"context"};pt.add(po);class Cc{constructor(t,e){if(this.width=Math.round(t),this.height=Math.round(e),!this.width||!this.height)throw new Error("Framebuffer width or height is zero");this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new zs("disposeFramebuffer"),this.multisample=Ae.NONE}get colorTexture(){return this.colorTextures[0]}addColorTexture(t=0,e){return this.colorTextures[t]=e||new _t(null,{scaleMode:ps.NEAREST,resolution:1,mipmap:Zs.OFF,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this}addDepthTexture(t){return this.depthTexture=t||new _t(null,{scaleMode:ps.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:Zs.OFF,format:st.DEPTH_COMPONENT,type:yt.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this}enableDepth(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this}enableStencil(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this}resize(t,e){if(t=Math.round(t),e=Math.round(e),!t||!e)throw new Error("Framebuffer width and height must not be zero");if(!(t===this.width&&e===this.height)){this.width=t,this.height=e,this.dirtyId++,this.dirtySize++;for(let s=0;s<this.colorTextures.length;s++){const r=this.colorTextures[s],i=r.resolution;r.setSize(t/i,e/i)}if(this.depthTexture){const s=this.depthTexture.resolution;this.depthTexture.setSize(t/s,e/s)}}}dispose(){this.disposeRunner.emit(this,!1)}destroyDepthTexture(){this.depthTexture&&(this.depthTexture.destroy(),this.depthTexture=null,++this.dirtyId,++this.dirtyFormat)}}class qm extends _t{constructor(t={}){if(typeof t=="number"){const e=arguments[0],s=arguments[1],r=arguments[2],i=arguments[3];t={width:e,height:s,scaleMode:r,resolution:i}}t.width=t.width??100,t.height=t.height??100,t.multisample??(t.multisample=Ae.NONE),super(null,t),this.mipmap=Zs.OFF,this.valid=!0,this._clear=new te([0,0,0,0]),this.framebuffer=new Cc(this.realWidth,this.realHeight).addColorTexture(0,this),this.framebuffer.multisample=t.multisample,this.maskStack=[],this.filterStack=[{}]}set clearColor(t){this._clear.setValue(t)}get clearColor(){return this._clear.value}get clear(){return this._clear}get multisample(){return this.framebuffer.multisample}set multisample(t){this.framebuffer.multisample=t}resize(t,e){this.framebuffer.resize(t*this.resolution,e*this.resolution),this.setRealSize(this.framebuffer.width,this.framebuffer.height)}dispose(){this.framebuffer.dispose(),super.dispose()}destroy(){super.destroy(),this.framebuffer.destroyDepthTexture(),this.framebuffer=null}}class Bn extends aa{constructor(t){const e=t,s=e.naturalWidth||e.videoWidth||e.displayWidth||e.width,r=e.naturalHeight||e.videoHeight||e.displayHeight||e.height;super(s,r),this.source=t,this.noSubImage=!1}static crossOrigin(t,e,s){s===void 0&&!e.startsWith("data:")?t.crossOrigin=M1(e):s!==!1&&(t.crossOrigin=typeof s=="string"?s:"anonymous")}upload(t,e,s,r){const i=t.gl,o=e.realWidth,l=e.realHeight;if(r=r||this.source,typeof HTMLImageElement<"u"&&r instanceof HTMLImageElement){if(!r.complete||r.naturalWidth===0)return!1}else if(typeof HTMLVideoElement<"u"&&r instanceof HTMLVideoElement&&r.readyState<=1)return!1;return i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===Qe.UNPACK),!this.noSubImage&&e.target===i.TEXTURE_2D&&s.width===o&&s.height===l?i.texSubImage2D(i.TEXTURE_2D,0,0,0,e.format,s.type,r):(s.width=o,s.height=l,i.texImage2D(e.target,0,s.internalFormat,e.format,s.type,r)),!0}update(){if(this.destroyed)return;const t=this.source,e=t.naturalWidth||t.videoWidth||t.width,s=t.naturalHeight||t.videoHeight||t.height;this.resize(e,s),super.update()}dispose(){this.source=null}}class Km extends Bn{constructor(t,e){if(e=e||{},typeof t=="string"){const s=new Image;Bn.crossOrigin(s,t,e.crossorigin),s.src=t,t=s}super(t),!t.complete&&this._width&&this._height&&(this._width=0,this._height=0),this.url=t.src,this._process=null,this.preserveBitmap=!1,this.createBitmap=(e.createBitmap??ht.CREATE_IMAGE_BITMAP)&&!!globalThis.createImageBitmap,this.alphaMode=typeof e.alphaMode=="number"?e.alphaMode:null,this.bitmap=null,this._load=null,e.autoLoad!==!1&&this.load()}load(t){return this._load?this._load:(t!==void 0&&(this.createBitmap=t),this._load=new Promise((e,s)=>{const r=this.source;this.url=r.src;const i=()=>{this.destroyed||(r.onload=null,r.onerror=null,this.update(),this._load=null,this.createBitmap?e(this.process()):e(this))};r.complete&&r.src?i():(r.onload=i,r.onerror=o=>{s(o),this.onError.emit(o)})}),this._load)}process(){const t=this.source;if(this._process!==null)return this._process;if(this.bitmap!==null||!globalThis.createImageBitmap)return Promise.resolve(this);const e=globalThis.createImageBitmap,s=!t.crossOrigin||t.crossOrigin==="anonymous";return this._process=fetch(t.src,{mode:s?"cors":"no-cors"}).then(r=>r.blob()).then(r=>e(r,0,0,t.width,t.height,{premultiplyAlpha:this.alphaMode===null||this.alphaMode===Qe.UNPACK?"premultiply":"none"})).then(r=>this.destroyed?Promise.reject():(this.bitmap=r,this.update(),this._process=null,Promise.resolve(this))),this._process}upload(t,e,s){if(typeof this.alphaMode=="number"&&(e.alphaMode=this.alphaMode),!this.createBitmap)return super.upload(t,e,s);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(super.upload(t,e,s,this.bitmap),!this.preserveBitmap){let r=!0;const i=e._glTextures;for(const o in i){const l=i[o];if(l!==s&&l.dirtyId!==e.dirtyId){r=!1;break}}r&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0}dispose(){this.source.onload=null,this.source.onerror=null,super.dispose(),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null}static test(t){return typeof HTMLImageElement<"u"&&(typeof t=="string"||t instanceof HTMLImageElement)}}class Mh{constructor(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)}set(t,e,s){const r=e.width,i=e.height;if(s){const o=t.width/2/r,l=t.height/2/i,a=t.x/r+o,c=t.y/i+l;s=ue.add(s,ue.NW),this.x0=a+o*ue.uX(s),this.y0=c+l*ue.uY(s),s=ue.add(s,2),this.x1=a+o*ue.uX(s),this.y1=c+l*ue.uY(s),s=ue.add(s,2),this.x2=a+o*ue.uX(s),this.y2=c+l*ue.uY(s),s=ue.add(s,2),this.x3=a+o*ue.uX(s),this.y3=c+l*ue.uY(s)}else this.x0=t.x/r,this.y0=t.y/i,this.x1=(t.x+t.width)/r,this.y1=t.y/i,this.x2=(t.x+t.width)/r,this.y2=(t.y+t.height)/i,this.x3=t.x/r,this.y3=(t.y+t.height)/i;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3}}Mh.prototype.toString=function(){return`[@pixi/core:TextureUvs x0=${this.x0} y0=${this.y0} x1=${this.x1} y1=${this.y1} x2=${this.x2} y2=${this.y2} x3=${this.x3} y3=${this.y3}]`};const Ku=new Mh;function Pa(n){n.destroy=function(){},n.on=function(){},n.once=function(){},n.emit=function(){}}class mt extends ma{constructor(t,e,s,r,i,o,l){if(super(),this.noFrame=!1,e||(this.noFrame=!0,e=new vt(0,0,1,1)),t instanceof mt&&(t=t.baseTexture),this.baseTexture=t,this._frame=e,this.trim=r,this.valid=!1,this.destroyed=!1,this._uvs=Ku,this.uvMatrix=null,this.orig=s||e,this._rotate=Number(i||0),i===!0)this._rotate=2;else if(this._rotate%2!==0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");this.defaultAnchor=o?new Xt(o.x,o.y):new Xt(0,0),this.defaultBorders=l,this._updateID=0,this.textureCacheIds=[],t.valid?this.noFrame?t.valid&&this.onBaseTextureUpdated(t):this.frame=e:t.once("loaded",this.onBaseTextureUpdated,this),this.noFrame&&t.on("update",this.onBaseTextureUpdated,this)}update(){this.baseTexture.resource&&this.baseTexture.resource.update()}onBaseTextureUpdated(t){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=t.width,this._frame.height=t.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)}destroy(t){if(this.baseTexture){if(t){const{resource:e}=this.baseTexture;e!=null&&e.url&&an[e.url]&&mt.removeFromCache(e.url),this.baseTexture.destroy()}this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,mt.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0,this.emit("destroyed",this),this.removeAllListeners()}clone(){var r;const t=this._frame.clone(),e=this._frame===this.orig?t:this.orig.clone(),s=new mt(this.baseTexture,!this.noFrame&&t,e,(r=this.trim)==null?void 0:r.clone(),this.rotate,this.defaultAnchor,this.defaultBorders);return this.noFrame&&(s._frame=t),s}updateUvs(){this._uvs===Ku&&(this._uvs=new Mh),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++}static from(t,e={},s=ht.STRICT_TEXTURE_CACHE){const r=typeof t=="string";let i=null;if(r)i=t;else if(t instanceof _t){if(!t.cacheId){const l=(e==null?void 0:e.pixiIdPrefix)||"pixiid";t.cacheId=`${l}-${Vr()}`,_t.addToCache(t,t.cacheId)}i=t.cacheId}else{if(!t._pixiId){const l=(e==null?void 0:e.pixiIdPrefix)||"pixiid";t._pixiId=`${l}_${Vr()}`}i=t._pixiId}let o=an[i];if(r&&s&&!o)throw new Error(`The cacheId "${i}" does not exist in TextureCache.`);return!o&&!(t instanceof _t)?(e.resolution||(e.resolution=Dn(t)),o=new mt(new _t(t,e)),o.baseTexture.cacheId=i,_t.addToCache(o.baseTexture,i),mt.addToCache(o,i)):!o&&t instanceof _t&&(o=new mt(t),mt.addToCache(o,i)),o}static fromURL(t,e){const s=Object.assign({autoLoad:!1},e==null?void 0:e.resourceOptions),r=mt.from(t,Object.assign({resourceOptions:s},e),!1),i=r.baseTexture.resource;return r.baseTexture.valid?Promise.resolve(r):i.load().then(()=>Promise.resolve(r))}static fromBuffer(t,e,s,r){return new mt(_t.fromBuffer(t,e,s,r))}static fromLoader(t,e,s,r){const i=new _t(t,Object.assign({scaleMode:_t.defaultOptions.scaleMode,resolution:Dn(e)},r)),{resource:o}=i;o instanceof Km&&(o.url=e);const l=new mt(i);return s||(s=e),_t.addToCache(l.baseTexture,s),mt.addToCache(l,s),s!==e&&(_t.addToCache(l.baseTexture,e),mt.addToCache(l,e)),l.baseTexture.valid?Promise.resolve(l):new Promise(a=>{l.baseTexture.once("loaded",()=>a(l))})}static addToCache(t,e){e&&(t.textureCacheIds.includes(e)||t.textureCacheIds.push(e),an[e]&&an[e]!==t&&console.warn(`Texture added to the cache with an id [${e}] that already had an entry`),an[e]=t)}static removeFromCache(t){if(typeof t=="string"){const e=an[t];if(e){const s=e.textureCacheIds.indexOf(t);return s>-1&&e.textureCacheIds.splice(s,1),delete an[t],e}}else if(t!=null&&t.textureCacheIds){for(let e=0;e<t.textureCacheIds.length;++e)an[t.textureCacheIds[e]]===t&&delete an[t.textureCacheIds[e]];return t.textureCacheIds.length=0,t}return null}get resolution(){return this.baseTexture.resolution}get frame(){return this._frame}set frame(t){this._frame=t,this.noFrame=!1;const{x:e,y:s,width:r,height:i}=t,o=e+r>this.baseTexture.width,l=s+i>this.baseTexture.height;if(o||l){const a=o&&l?"and":"or",c=`X: ${e} + ${r} = ${e+r} > ${this.baseTexture.width}`,h=`Y: ${s} + ${i} = ${s+i} > ${this.baseTexture.height}`;throw new Error(`Texture Error: frame does not fit inside the base Texture dimensions: ${c} ${a} ${h}`)}this.valid=r&&i&&this.baseTexture.valid,!this.trim&&!this.rotate&&(this.orig=t),this.valid&&this.updateUvs()}get rotate(){return this._rotate}set rotate(t){this._rotate=t,this.valid&&this.updateUvs()}get width(){return this.orig.width}get height(){return this.orig.height}castToBaseTexture(){return this.baseTexture}static get EMPTY(){return mt._EMPTY||(mt._EMPTY=new mt(new _t),Pa(mt._EMPTY),Pa(mt._EMPTY.baseTexture)),mt._EMPTY}static get WHITE(){if(!mt._WHITE){const t=ht.ADAPTER.createCanvas(16,16),e=t.getContext("2d");t.width=16,t.height=16,e.fillStyle="white",e.fillRect(0,0,16,16),mt._WHITE=new mt(_t.from(t)),Pa(mt._WHITE),Pa(mt._WHITE.baseTexture)}return mt._WHITE}}class $r extends mt{constructor(t,e){super(t,e),this.valid=!0,this.filterFrame=null,this.filterPoolKey=null,this.updateUvs()}get framebuffer(){return this.baseTexture.framebuffer}get multisample(){return this.framebuffer.multisample}set multisample(t){this.framebuffer.multisample=t}resize(t,e,s=!0){const r=this.baseTexture.resolution,i=Math.round(t*r)/r,o=Math.round(e*r)/r;this.valid=i>0&&o>0,this._frame.width=this.orig.width=i,this._frame.height=this.orig.height=o,s&&this.baseTexture.resize(i,o),this.updateUvs()}setResolution(t){const{baseTexture:e}=this;e.resolution!==t&&(e.setResolution(t),this.resize(e.width,e.height,!1))}static create(t){return new $r(new qm(t))}}class Zm{constructor(t){this.texturePool={},this.textureOptions=t||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}createTexture(t,e,s=Ae.NONE){const r=new qm(Object.assign({width:t,height:e,resolution:1,multisample:s},this.textureOptions));return new $r(r)}getOptimalTexture(t,e,s=1,r=Ae.NONE){let i;t=Math.max(Math.ceil(t*s-1e-6),1),e=Math.max(Math.ceil(e*s-1e-6),1),!this.enableFullScreen||t!==this._pixelsWidth||e!==this._pixelsHeight?(t=ho(t),e=ho(e),i=((t&65535)<<16|e&65535)>>>0,r>1&&(i+=r*4294967296)):i=r>1?-r:-1,this.texturePool[i]||(this.texturePool[i]=[]);let o=this.texturePool[i].pop();return o||(o=this.createTexture(t,e,r)),o.filterPoolKey=i,o.setResolution(s),o}getFilterTexture(t,e,s){const r=this.getOptimalTexture(t.width,t.height,e||t.resolution,s||Ae.NONE);return r.filterFrame=t.filterFrame,r}returnTexture(t){const e=t.filterPoolKey;t.filterFrame=null,this.texturePool[e].push(t)}returnFilterTexture(t){this.returnTexture(t)}clear(t){if(t=t!==!1,t)for(const e in this.texturePool){const s=this.texturePool[e];if(s)for(let r=0;r<s.length;r++)s[r].destroy(!0)}this.texturePool={}}setScreenSize(t){if(!(t.width===this._pixelsWidth&&t.height===this._pixelsHeight)){this.enableFullScreen=t.width>0&&t.height>0;for(const e in this.texturePool){if(!(Number(e)<0))continue;const s=this.texturePool[e];if(s)for(let r=0;r<s.length;r++)s[r].destroy(!0);this.texturePool[e]=[]}this._pixelsWidth=t.width,this._pixelsHeight=t.height}}}Zm.SCREEN_KEY=-1;class cw extends fr{constructor(){super(),this.addAttribute("aVertexPosition",new Float32Array([0,0,1,0,1,1,0,1])).addIndex([0,1,3,2])}}class Qm extends fr{constructor(){super(),this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.vertexBuffer=new ve(this.vertices),this.uvBuffer=new ve(this.uvs),this.addAttribute("aVertexPosition",this.vertexBuffer).addAttribute("aTextureCoord",this.uvBuffer).addIndex([0,1,2,0,2,3])}map(t,e){let s=0,r=0;return this.uvs[0]=s,this.uvs[1]=r,this.uvs[2]=s+e.width/t.width,this.uvs[3]=r,this.uvs[4]=s+e.width/t.width,this.uvs[5]=r+e.height/t.height,this.uvs[6]=s,this.uvs[7]=r+e.height/t.height,s=e.x,r=e.y,this.vertices[0]=s,this.vertices[1]=r,this.vertices[2]=s+e.width,this.vertices[3]=r,this.vertices[4]=s+e.width,this.vertices[5]=r+e.height,this.vertices[6]=s,this.vertices[7]=r+e.height,this.invalidate(),this}invalidate(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this}}class hw{constructor(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.multisample=Ae.NONE,this.sourceFrame=new vt,this.destinationFrame=new vt,this.bindingSourceFrame=new vt,this.bindingDestinationFrame=new vt,this.filters=[],this.transform=null}clear(){this.target=null,this.filters=null,this.renderTexture=null}}const Na=[new Xt,new Xt,new Xt,new Xt],Pl=new Zt;class Jm{constructor(t){this.renderer=t,this.defaultFilterStack=[{}],this.texturePool=new Zm,this.statePool=[],this.quad=new cw,this.quadUv=new Qm,this.tempRect=new vt,this.activeState={},this.globalUniforms=new Hs({outputFrame:new vt,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this.forceClear=!1,this.useMaxPadding=!1}init(){this.texturePool.setScreenSize(this.renderer.view)}push(t,e){const s=this.renderer,r=this.defaultFilterStack,i=this.statePool.pop()||new hw,o=s.renderTexture;let l,a;if(o.current){const g=o.current;l=g.resolution,a=g.multisample}else l=s.resolution,a=s.multisample;let c=e[0].resolution||l,h=e[0].multisample??a,d=e[0].padding,u=e[0].autoFit,f=e[0].legacy??!0;for(let g=1;g<e.length;g++){const w=e[g];c=Math.min(c,w.resolution||l),h=Math.min(h,w.multisample??a),d=this.useMaxPadding?Math.max(d,w.padding):d+w.padding,u=u&&w.autoFit,f=f||(w.legacy??!0)}r.length===1&&(this.defaultFilterStack[0].renderTexture=o.current),r.push(i),i.resolution=c,i.multisample=h,i.legacy=f,i.target=t,i.sourceFrame.copyFrom(t.filterArea||t.getBounds(!0)),i.sourceFrame.pad(d);const m=this.tempRect.copyFrom(o.sourceFrame);s.projection.transform&&this.transformAABB(Pl.copyFrom(s.projection.transform).invert(),m),u?(i.sourceFrame.fit(m),(i.sourceFrame.width<=0||i.sourceFrame.height<=0)&&(i.sourceFrame.width=0,i.sourceFrame.height=0)):i.sourceFrame.intersects(m)||(i.sourceFrame.width=0,i.sourceFrame.height=0),this.roundFrame(i.sourceFrame,o.current?o.current.resolution:s.resolution,o.sourceFrame,o.destinationFrame,s.projection.transform),i.renderTexture=this.getOptimalFilterTexture(i.sourceFrame.width,i.sourceFrame.height,c,h),i.filters=e,i.destinationFrame.width=i.renderTexture.width,i.destinationFrame.height=i.renderTexture.height;const p=this.tempRect;p.x=0,p.y=0,p.width=i.sourceFrame.width,p.height=i.sourceFrame.height,i.renderTexture.filterFrame=i.sourceFrame,i.bindingSourceFrame.copyFrom(o.sourceFrame),i.bindingDestinationFrame.copyFrom(o.destinationFrame),i.transform=s.projection.transform,s.projection.transform=null,o.bind(i.renderTexture,i.sourceFrame,p),s.framebuffer.clear(0,0,0,0)}pop(){const t=this.defaultFilterStack,e=t.pop(),s=e.filters;this.activeState=e;const r=this.globalUniforms.uniforms;r.outputFrame=e.sourceFrame,r.resolution=e.resolution;const i=r.inputSize,o=r.inputPixel,l=r.inputClamp;if(i[0]=e.destinationFrame.width,i[1]=e.destinationFrame.height,i[2]=1/i[0],i[3]=1/i[1],o[0]=Math.round(i[0]*e.resolution),o[1]=Math.round(i[1]*e.resolution),o[2]=1/o[0],o[3]=1/o[1],l[0]=.5*o[2],l[1]=.5*o[3],l[2]=e.sourceFrame.width*i[2]-.5*o[2],l[3]=e.sourceFrame.height*i[3]-.5*o[3],e.legacy){const c=r.filterArea;c[0]=e.destinationFrame.width,c[1]=e.destinationFrame.height,c[2]=e.sourceFrame.x,c[3]=e.sourceFrame.y,r.filterClamp=r.inputClamp}this.globalUniforms.update();const a=t[t.length-1];if(this.renderer.framebuffer.blit(),s.length===1)s[0].apply(this,e.renderTexture,a.renderTexture,fn.BLEND,e),this.returnFilterTexture(e.renderTexture);else{let c=e.renderTexture,h=this.getOptimalFilterTexture(c.width,c.height,e.resolution);h.filterFrame=c.filterFrame;let d=0;for(d=0;d<s.length-1;++d){d===1&&e.multisample>1&&(h=this.getOptimalFilterTexture(c.width,c.height,e.resolution),h.filterFrame=c.filterFrame),s[d].apply(this,c,h,fn.CLEAR,e);const u=c;c=h,h=u}s[d].apply(this,c,a.renderTexture,fn.BLEND,e),d>1&&e.multisample>1&&this.returnFilterTexture(e.renderTexture),this.returnFilterTexture(c),this.returnFilterTexture(h)}e.clear(),this.statePool.push(e)}bindAndClear(t,e=fn.CLEAR){const{renderTexture:s,state:r}=this.renderer;if(t===this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?this.renderer.projection.transform=this.activeState.transform:this.renderer.projection.transform=null,t==null?void 0:t.filterFrame){const o=this.tempRect;o.x=0,o.y=0,o.width=t.filterFrame.width,o.height=t.filterFrame.height,s.bind(t,t.filterFrame,o)}else t!==this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?s.bind(t):this.renderer.renderTexture.bind(t,this.activeState.bindingSourceFrame,this.activeState.bindingDestinationFrame);const i=r.stateId&1||this.forceClear;(e===fn.CLEAR||e===fn.BLIT&&i)&&this.renderer.framebuffer.clear(0,0,0,0)}applyFilter(t,e,s,r){const i=this.renderer;i.state.set(t.state),this.bindAndClear(s,r),t.uniforms.uSampler=e,t.uniforms.filterGlobals=this.globalUniforms,i.shader.bind(t),t.legacy=!!t.program.attributeData.aTextureCoord,t.legacy?(this.quadUv.map(e._frame,e.filterFrame),i.geometry.bind(this.quadUv),i.geometry.draw(Ws.TRIANGLES)):(i.geometry.bind(this.quad),i.geometry.draw(Ws.TRIANGLE_STRIP))}calculateSpriteMatrix(t,e){const{sourceFrame:s,destinationFrame:r}=this.activeState,{orig:i}=e._texture,o=t.set(r.width,0,0,r.height,s.x,s.y),l=e.worldTransform.copyTo(Zt.TEMP_MATRIX);return l.invert(),o.prepend(l),o.scale(1/i.width,1/i.height),o.translate(e.anchor.x,e.anchor.y),o}destroy(){this.renderer=null,this.texturePool.clear(!1)}getOptimalFilterTexture(t,e,s=1,r=Ae.NONE){return this.texturePool.getOptimalTexture(t,e,s,r)}getFilterTexture(t,e,s){if(typeof t=="number"){const i=t;t=e,e=i}t=t||this.activeState.renderTexture;const r=this.texturePool.getOptimalTexture(t.width,t.height,e||t.resolution,s||Ae.NONE);return r.filterFrame=t.filterFrame,r}returnFilterTexture(t){this.texturePool.returnTexture(t)}emptyPool(){this.texturePool.clear(!0)}resize(){this.texturePool.setScreenSize(this.renderer.view)}transformAABB(t,e){const s=Na[0],r=Na[1],i=Na[2],o=Na[3];s.set(e.left,e.top),r.set(e.left,e.bottom),i.set(e.right,e.top),o.set(e.right,e.bottom),t.apply(s,s),t.apply(r,r),t.apply(i,i),t.apply(o,o);const l=Math.min(s.x,r.x,i.x,o.x),a=Math.min(s.y,r.y,i.y,o.y),c=Math.max(s.x,r.x,i.x,o.x),h=Math.max(s.y,r.y,i.y,o.y);e.x=l,e.y=a,e.width=c-l,e.height=h-a}roundFrame(t,e,s,r,i){if(!(t.width<=0||t.height<=0||s.width<=0||s.height<=0)){if(i){const{a:o,b:l,c:a,d:c}=i;if((Math.abs(l)>1e-4||Math.abs(a)>1e-4)&&(Math.abs(o)>1e-4||Math.abs(c)>1e-4))return}i=i?Pl.copyFrom(i):Pl.identity(),i.translate(-s.x,-s.y).scale(r.width/s.width,r.height/s.height).translate(r.x,r.y),this.transformAABB(i,t),t.ceil(e),this.transformAABB(i.invert(),t)}}}Jm.extension={type:ot.RendererSystem,name:"filter"};pt.add(Jm);class dw{constructor(t){this.framebuffer=t,this.stencil=null,this.dirtyId=-1,this.dirtyFormat=-1,this.dirtySize=-1,this.multisample=Ae.NONE,this.msaaBuffer=null,this.blitFramebuffer=null,this.mipLevel=0}}const uw=new vt;class tp{constructor(t){this.renderer=t,this.managedFramebuffers=[],this.unknownFramebuffer=new Cc(10,10),this.msaaSamples=null}contextChange(){this.disposeAll(!0);const t=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new vt,this.hasMRT=!0,this.writeDepthTexture=!0,this.renderer.context.webGLVersion===1){let e=this.renderer.context.extensions.drawBuffers,s=this.renderer.context.extensions.depthTexture;ht.PREFER_ENV===Yr.WEBGL_LEGACY&&(e=null,s=null),e?t.drawBuffers=r=>e.drawBuffersWEBGL(r):(this.hasMRT=!1,t.drawBuffers=()=>{}),s||(this.writeDepthTexture=!1)}else this.msaaSamples=t.getInternalformatParameter(t.RENDERBUFFER,t.RGBA8,t.SAMPLES)}bind(t,e,s=0){const{gl:r}=this;if(t){const i=t.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(t);this.current!==t&&(this.current=t,r.bindFramebuffer(r.FRAMEBUFFER,i.framebuffer)),i.mipLevel!==s&&(t.dirtyId++,t.dirtyFormat++,i.mipLevel=s),i.dirtyId!==t.dirtyId&&(i.dirtyId=t.dirtyId,i.dirtyFormat!==t.dirtyFormat?(i.dirtyFormat=t.dirtyFormat,i.dirtySize=t.dirtySize,this.updateFramebuffer(t,s)):i.dirtySize!==t.dirtySize&&(i.dirtySize=t.dirtySize,this.resizeFramebuffer(t)));for(let o=0;o<t.colorTextures.length;o++){const l=t.colorTextures[o];this.renderer.texture.unbind(l.parentTextureArray||l)}if(t.depthTexture&&this.renderer.texture.unbind(t.depthTexture),e){const o=e.width>>s,l=e.height>>s,a=o/e.width;this.setViewport(e.x*a,e.y*a,o,l)}else{const o=t.width>>s,l=t.height>>s;this.setViewport(0,0,o,l)}}else this.current&&(this.current=null,r.bindFramebuffer(r.FRAMEBUFFER,null)),e?this.setViewport(e.x,e.y,e.width,e.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)}setViewport(t,e,s,r){const i=this.viewport;t=Math.round(t),e=Math.round(e),s=Math.round(s),r=Math.round(r),(i.width!==s||i.height!==r||i.x!==t||i.y!==e)&&(i.x=t,i.y=e,i.width=s,i.height=r,this.gl.viewport(t,e,s,r))}get size(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}}clear(t,e,s,r,i=hc.COLOR|hc.DEPTH){const{gl:o}=this;o.clearColor(t,e,s,r),o.clear(i)}initFramebuffer(t){const{gl:e}=this,s=new dw(e.createFramebuffer());return s.multisample=this.detectSamples(t.multisample),t.glFramebuffers[this.CONTEXT_UID]=s,this.managedFramebuffers.push(t),t.disposeRunner.add(this),s}resizeFramebuffer(t){const{gl:e}=this,s=t.glFramebuffers[this.CONTEXT_UID];if(s.stencil){e.bindRenderbuffer(e.RENDERBUFFER,s.stencil);let o;this.renderer.context.webGLVersion===1?o=e.DEPTH_STENCIL:t.depth&&t.stencil?o=e.DEPTH24_STENCIL8:t.depth?o=e.DEPTH_COMPONENT24:o=e.STENCIL_INDEX8,s.msaaBuffer?e.renderbufferStorageMultisample(e.RENDERBUFFER,s.multisample,o,t.width,t.height):e.renderbufferStorage(e.RENDERBUFFER,o,t.width,t.height)}const r=t.colorTextures;let i=r.length;e.drawBuffers||(i=Math.min(i,1));for(let o=0;o<i;o++){const l=r[o],a=l.parentTextureArray||l;this.renderer.texture.bind(a,0),o===0&&s.msaaBuffer&&(e.bindRenderbuffer(e.RENDERBUFFER,s.msaaBuffer),e.renderbufferStorageMultisample(e.RENDERBUFFER,s.multisample,a._glTextures[this.CONTEXT_UID].internalFormat,t.width,t.height))}t.depthTexture&&this.writeDepthTexture&&this.renderer.texture.bind(t.depthTexture,0)}updateFramebuffer(t,e){const{gl:s}=this,r=t.glFramebuffers[this.CONTEXT_UID],i=t.colorTextures;let o=i.length;s.drawBuffers||(o=Math.min(o,1)),r.multisample>1&&this.canMultisampleFramebuffer(t)?r.msaaBuffer=r.msaaBuffer||s.createRenderbuffer():r.msaaBuffer&&(s.deleteRenderbuffer(r.msaaBuffer),r.msaaBuffer=null,r.blitFramebuffer&&(r.blitFramebuffer.dispose(),r.blitFramebuffer=null));const l=[];for(let a=0;a<o;a++){const c=i[a],h=c.parentTextureArray||c;this.renderer.texture.bind(h,0),a===0&&r.msaaBuffer?(s.bindRenderbuffer(s.RENDERBUFFER,r.msaaBuffer),s.renderbufferStorageMultisample(s.RENDERBUFFER,r.multisample,h._glTextures[this.CONTEXT_UID].internalFormat,t.width,t.height),s.framebufferRenderbuffer(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.RENDERBUFFER,r.msaaBuffer)):(s.framebufferTexture2D(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0+a,c.target,h._glTextures[this.CONTEXT_UID].texture,e),l.push(s.COLOR_ATTACHMENT0+a))}if(l.length>1&&s.drawBuffers(l),t.depthTexture&&this.writeDepthTexture){const a=t.depthTexture;this.renderer.texture.bind(a,0),s.framebufferTexture2D(s.FRAMEBUFFER,s.DEPTH_ATTACHMENT,s.TEXTURE_2D,a._glTextures[this.CONTEXT_UID].texture,e)}if((t.stencil||t.depth)&&!(t.depthTexture&&this.writeDepthTexture)){r.stencil=r.stencil||s.createRenderbuffer();let a,c;this.renderer.context.webGLVersion===1?(a=s.DEPTH_STENCIL_ATTACHMENT,c=s.DEPTH_STENCIL):t.depth&&t.stencil?(a=s.DEPTH_STENCIL_ATTACHMENT,c=s.DEPTH24_STENCIL8):t.depth?(a=s.DEPTH_ATTACHMENT,c=s.DEPTH_COMPONENT24):(a=s.STENCIL_ATTACHMENT,c=s.STENCIL_INDEX8),s.bindRenderbuffer(s.RENDERBUFFER,r.stencil),r.msaaBuffer?s.renderbufferStorageMultisample(s.RENDERBUFFER,r.multisample,c,t.width,t.height):s.renderbufferStorage(s.RENDERBUFFER,c,t.width,t.height),s.framebufferRenderbuffer(s.FRAMEBUFFER,a,s.RENDERBUFFER,r.stencil)}else r.stencil&&(s.deleteRenderbuffer(r.stencil),r.stencil=null)}canMultisampleFramebuffer(t){return this.renderer.context.webGLVersion!==1&&t.colorTextures.length<=1&&!t.depthTexture}detectSamples(t){const{msaaSamples:e}=this;let s=Ae.NONE;if(t<=1||e===null)return s;for(let r=0;r<e.length;r++)if(e[r]<=t){s=e[r];break}return s===1&&(s=Ae.NONE),s}blit(t,e,s){const{current:r,renderer:i,gl:o,CONTEXT_UID:l}=this;if(i.context.webGLVersion!==2||!r)return;const a=r.glFramebuffers[l];if(!a)return;if(!t){if(!a.msaaBuffer)return;const h=r.colorTextures[0];if(!h)return;a.blitFramebuffer||(a.blitFramebuffer=new Cc(r.width,r.height),a.blitFramebuffer.addColorTexture(0,h)),t=a.blitFramebuffer,t.colorTextures[0]!==h&&(t.colorTextures[0]=h,t.dirtyId++,t.dirtyFormat++),(t.width!==r.width||t.height!==r.height)&&(t.width=r.width,t.height=r.height,t.dirtyId++,t.dirtySize++)}e||(e=uw,e.width=r.width,e.height=r.height),s||(s=e);const c=e.width===s.width&&e.height===s.height;this.bind(t),o.bindFramebuffer(o.READ_FRAMEBUFFER,a.framebuffer),o.blitFramebuffer(e.left,e.top,e.right,e.bottom,s.left,s.top,s.right,s.bottom,o.COLOR_BUFFER_BIT,c?o.NEAREST:o.LINEAR),o.bindFramebuffer(o.READ_FRAMEBUFFER,t.glFramebuffers[this.CONTEXT_UID].framebuffer)}disposeFramebuffer(t,e){const s=t.glFramebuffers[this.CONTEXT_UID],r=this.gl;if(!s)return;delete t.glFramebuffers[this.CONTEXT_UID];const i=this.managedFramebuffers.indexOf(t);i>=0&&this.managedFramebuffers.splice(i,1),t.disposeRunner.remove(this),e||(r.deleteFramebuffer(s.framebuffer),s.msaaBuffer&&r.deleteRenderbuffer(s.msaaBuffer),s.stencil&&r.deleteRenderbuffer(s.stencil)),s.blitFramebuffer&&this.disposeFramebuffer(s.blitFramebuffer,e)}disposeAll(t){const e=this.managedFramebuffers;this.managedFramebuffers=[];for(let s=0;s<e.length;s++)this.disposeFramebuffer(e[s],t)}forceStencil(){const t=this.current;if(!t)return;const e=t.glFramebuffers[this.CONTEXT_UID];if(!e||e.stencil&&t.stencil)return;t.stencil=!0;const s=t.width,r=t.height,i=this.gl,o=e.stencil=i.createRenderbuffer();i.bindRenderbuffer(i.RENDERBUFFER,o);let l,a;this.renderer.context.webGLVersion===1?(l=i.DEPTH_STENCIL_ATTACHMENT,a=i.DEPTH_STENCIL):t.depth?(l=i.DEPTH_STENCIL_ATTACHMENT,a=i.DEPTH24_STENCIL8):(l=i.STENCIL_ATTACHMENT,a=i.STENCIL_INDEX8),e.msaaBuffer?i.renderbufferStorageMultisample(i.RENDERBUFFER,e.multisample,a,s,r):i.renderbufferStorage(i.RENDERBUFFER,a,s,r),i.framebufferRenderbuffer(i.FRAMEBUFFER,l,i.RENDERBUFFER,o)}reset(){this.current=this.unknownFramebuffer,this.viewport=new vt}destroy(){this.renderer=null}}tp.extension={type:ot.RendererSystem,name:"framebuffer"};pt.add(tp);const Nl={5126:4,5123:2,5121:1};class ep{constructor(t){this.renderer=t,this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.managedGeometries={}}contextChange(){this.disposeAll(!0);const t=this.gl=this.renderer.gl,e=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,e.webGLVersion!==2){let s=this.renderer.context.extensions.vertexArrayObject;ht.PREFER_ENV===Yr.WEBGL_LEGACY&&(s=null),s?(t.createVertexArray=()=>s.createVertexArrayOES(),t.bindVertexArray=r=>s.bindVertexArrayOES(r),t.deleteVertexArray=r=>s.deleteVertexArrayOES(r)):(this.hasVao=!1,t.createVertexArray=()=>null,t.bindVertexArray=()=>null,t.deleteVertexArray=()=>null)}if(e.webGLVersion!==2){const s=t.getExtension("ANGLE_instanced_arrays");s?(t.vertexAttribDivisor=(r,i)=>s.vertexAttribDivisorANGLE(r,i),t.drawElementsInstanced=(r,i,o,l,a)=>s.drawElementsInstancedANGLE(r,i,o,l,a),t.drawArraysInstanced=(r,i,o,l)=>s.drawArraysInstancedANGLE(r,i,o,l)):this.hasInstance=!1}this.canUseUInt32ElementIndex=e.webGLVersion===2||!!e.extensions.uint32ElementIndex}bind(t,e){e=e||this.renderer.shader.shader;const{gl:s}=this;let r=t.glVertexArrayObjects[this.CONTEXT_UID],i=!1;r||(this.managedGeometries[t.id]=t,t.disposeRunner.add(this),t.glVertexArrayObjects[this.CONTEXT_UID]=r={},i=!0);const o=r[e.program.id]||this.initGeometryVao(t,e,i);this._activeGeometry=t,this._activeVao!==o&&(this._activeVao=o,this.hasVao?s.bindVertexArray(o):this.activateVao(t,e.program)),this.updateBuffers()}reset(){this.unbind()}updateBuffers(){const t=this._activeGeometry,e=this.renderer.buffer;for(let s=0;s<t.buffers.length;s++){const r=t.buffers[s];e.update(r)}}checkCompatibility(t,e){const s=t.attributes,r=e.attributeData;for(const i in r)if(!s[i])throw new Error(`shader and geometry incompatible, geometry missing the "${i}" attribute`)}getSignature(t,e){const s=t.attributes,r=e.attributeData,i=["g",t.id];for(const o in s)r[o]&&i.push(o,r[o].location);return i.join("-")}initGeometryVao(t,e,s=!0){const r=this.gl,i=this.CONTEXT_UID,o=this.renderer.buffer,l=e.program;l.glPrograms[i]||this.renderer.shader.generateProgram(e),this.checkCompatibility(t,l);const a=this.getSignature(t,l),c=t.glVertexArrayObjects[this.CONTEXT_UID];let h=c[a];if(h)return c[l.id]=h,h;const d=t.buffers,u=t.attributes,f={},m={};for(const p in d)f[p]=0,m[p]=0;for(const p in u)!u[p].size&&l.attributeData[p]?u[p].size=l.attributeData[p].size:u[p].size||console.warn(`PIXI Geometry attribute '${p}' size cannot be determined (likely the bound shader does not have the attribute)`),f[u[p].buffer]+=u[p].size*Nl[u[p].type];for(const p in u){const g=u[p],w=g.size;g.stride===void 0&&(f[g.buffer]===w*Nl[g.type]?g.stride=0:g.stride=f[g.buffer]),g.start===void 0&&(g.start=m[g.buffer],m[g.buffer]+=w*Nl[g.type])}h=r.createVertexArray(),r.bindVertexArray(h);for(let p=0;p<d.length;p++){const g=d[p];o.bind(g),s&&g._glBuffers[i].refCount++}return this.activateVao(t,l),c[l.id]=h,c[a]=h,r.bindVertexArray(null),o.unbind(pn.ARRAY_BUFFER),h}disposeGeometry(t,e){var l;if(!this.managedGeometries[t.id])return;delete this.managedGeometries[t.id];const s=t.glVertexArrayObjects[this.CONTEXT_UID],r=this.gl,i=t.buffers,o=(l=this.renderer)==null?void 0:l.buffer;if(t.disposeRunner.remove(this),!!s){if(o)for(let a=0;a<i.length;a++){const c=i[a]._glBuffers[this.CONTEXT_UID];c&&(c.refCount--,c.refCount===0&&!e&&o.dispose(i[a],e))}if(!e){for(const a in s)if(a[0]==="g"){const c=s[a];this._activeVao===c&&this.unbind(),r.deleteVertexArray(c)}}delete t.glVertexArrayObjects[this.CONTEXT_UID]}}disposeAll(t){const e=Object.keys(this.managedGeometries);for(let s=0;s<e.length;s++)this.disposeGeometry(this.managedGeometries[e[s]],t)}activateVao(t,e){const s=this.gl,r=this.CONTEXT_UID,i=this.renderer.buffer,o=t.buffers,l=t.attributes;t.indexBuffer&&i.bind(t.indexBuffer);let a=null;for(const c in l){const h=l[c],d=o[h.buffer],u=d._glBuffers[r];if(e.attributeData[c]){a!==u&&(i.bind(d),a=u);const f=e.attributeData[c].location;if(s.enableVertexAttribArray(f),s.vertexAttribPointer(f,h.size,h.type||s.FLOAT,h.normalized,h.stride,h.start),h.instance)if(this.hasInstance)s.vertexAttribDivisor(f,h.divisor);else throw new Error("geometry error, GPU Instancing is not supported on this device")}}}draw(t,e,s,r){const{gl:i}=this,o=this._activeGeometry;if(o.indexBuffer){const l=o.indexBuffer.data.BYTES_PER_ELEMENT,a=l===2?i.UNSIGNED_SHORT:i.UNSIGNED_INT;l===2||l===4&&this.canUseUInt32ElementIndex?o.instanced?i.drawElementsInstanced(t,e||o.indexBuffer.data.length,a,(s||0)*l,r||1):i.drawElements(t,e||o.indexBuffer.data.length,a,(s||0)*l):console.warn("unsupported index buffer type: uint32")}else o.instanced?i.drawArraysInstanced(t,s,e||o.getSize(),r||1):i.drawArrays(t,s,e||o.getSize());return this}unbind(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null}destroy(){this.renderer=null}}ep.extension={type:ot.RendererSystem,name:"geometry"};pt.add(ep);const Zu=new Zt;class sp{constructor(t,e){this._texture=t,this.mapCoord=new Zt,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,this.clampMargin=typeof e>"u"?.5:e,this.isSimple=!1}get texture(){return this._texture}set texture(t){this._texture=t,this._textureID=-1}multiplyUvs(t,e){e===void 0&&(e=t);const s=this.mapCoord;for(let r=0;r<t.length;r+=2){const i=t[r],o=t[r+1];e[r]=i*s.a+o*s.c+s.tx,e[r+1]=i*s.b+o*s.d+s.ty}return e}update(t){const e=this._texture;if(!e||!e.valid||!t&&this._textureID===e._updateID)return!1;this._textureID=e._updateID,this._updateID++;const s=e._uvs;this.mapCoord.set(s.x1-s.x0,s.y1-s.y0,s.x3-s.x0,s.y3-s.y0,s.x0,s.y0);const r=e.orig,i=e.trim;i&&(Zu.set(r.width/i.width,0,0,r.height/i.height,-i.x/i.width,-i.y/i.height),this.mapCoord.append(Zu));const o=e.baseTexture,l=this.uClampFrame,a=this.clampMargin/o.resolution,c=this.clampOffset;return l[0]=(e._frame.x+a+c)/o.width,l[1]=(e._frame.y+a+c)/o.height,l[2]=(e._frame.x+e._frame.width-a+c)/o.width,l[3]=(e._frame.y+e._frame.height-a+c)/o.height,this.uClampOffset[0]=c/o.realWidth,this.uClampOffset[1]=c/o.realHeight,this.isSimple=e._frame.width===o.width&&e._frame.height===o.height&&e.rotate===0,!0}}var fw=`varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform sampler2D mask;
uniform float alpha;
uniform float npmAlpha;
uniform vec4 maskClamp;

void main(void)
{
    float clip = step(3.5,
        step(maskClamp.x, vMaskCoord.x) +
        step(maskClamp.y, vMaskCoord.y) +
        step(vMaskCoord.x, maskClamp.z) +
        step(vMaskCoord.y, maskClamp.w));

    vec4 original = texture2D(uSampler, vTextureCoord);
    vec4 masky = texture2D(mask, vMaskCoord);
    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);

    original *= (alphaMul * masky.r * alpha * clip);

    gl_FragColor = original;
}
`,mw=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 otherMatrix;

varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;
}
`;class pw extends Je{constructor(t,e,s){let r=null;typeof t!="string"&&e===void 0&&s===void 0&&(r=t,t=void 0,e=void 0,s=void 0),super(t||mw,e||fw,s),this.maskSprite=r,this.maskMatrix=new Zt}get maskSprite(){return this._maskSprite}set maskSprite(t){this._maskSprite=t,this._maskSprite&&(this._maskSprite.renderable=!1)}apply(t,e,s,r){const i=this._maskSprite,o=i._texture;o.valid&&(o.uvMatrix||(o.uvMatrix=new sp(o,0)),o.uvMatrix.update(),this.uniforms.npmAlpha=o.baseTexture.alphaMode?0:1,this.uniforms.mask=o,this.uniforms.otherMatrix=t.calculateSpriteMatrix(this.maskMatrix,i).prepend(o.uvMatrix.mapCoord),this.uniforms.alpha=i.worldAlpha,this.uniforms.maskClamp=o.uvMatrix.uClampFrame,t.applyFilter(this,e,s,r))}}class gw{constructor(t=null){this.type=Ce.NONE,this.autoDetect=!0,this.maskObject=t||null,this.pooled=!1,this.isMaskData=!0,this.resolution=null,this.multisample=Je.defaultMultisample,this.enabled=!0,this.colorMask=15,this._filters=null,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._scissorRectLocal=null,this._colorMask=15,this._target=null}get filter(){return this._filters?this._filters[0]:null}set filter(t){t?this._filters?this._filters[0]=t:this._filters=[t]:this._filters=null}reset(){this.pooled&&(this.maskObject=null,this.type=Ce.NONE,this.autoDetect=!0),this._target=null,this._scissorRectLocal=null}copyCountersOrReset(t){t?(this._stencilCounter=t._stencilCounter,this._scissorCounter=t._scissorCounter,this._scissorRect=t._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)}}class np{constructor(t){this.renderer=t,this.enableScissor=!0,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],this.alphaMaskIndex=0}setMaskStack(t){this.maskStack=t,this.renderer.scissor.setMaskStack(t),this.renderer.stencil.setMaskStack(t)}push(t,e){let s=e;if(!s.isMaskData){const i=this.maskDataPool.pop()||new gw;i.pooled=!0,i.maskObject=e,s=i}const r=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null;if(s.copyCountersOrReset(r),s._colorMask=r?r._colorMask:15,s.autoDetect&&this.detect(s),s._target=t,s.type!==Ce.SPRITE&&this.maskStack.push(s),s.enabled)switch(s.type){case Ce.SCISSOR:this.renderer.scissor.push(s);break;case Ce.STENCIL:this.renderer.stencil.push(s);break;case Ce.SPRITE:s.copyCountersOrReset(null),this.pushSpriteMask(s);break;case Ce.COLOR:this.pushColorMask(s);break}s.type===Ce.SPRITE&&this.maskStack.push(s)}pop(t){const e=this.maskStack.pop();if(!(!e||e._target!==t)){if(e.enabled)switch(e.type){case Ce.SCISSOR:this.renderer.scissor.pop(e);break;case Ce.STENCIL:this.renderer.stencil.pop(e.maskObject);break;case Ce.SPRITE:this.popSpriteMask(e);break;case Ce.COLOR:this.popColorMask(e);break}if(e.reset(),e.pooled&&this.maskDataPool.push(e),this.maskStack.length!==0){const s=this.maskStack[this.maskStack.length-1];s.type===Ce.SPRITE&&s._filters&&(s._filters[0].maskSprite=s.maskObject)}}}detect(t){const e=t.maskObject;e?e.isSprite?t.type=Ce.SPRITE:this.enableScissor&&this.renderer.scissor.testScissor(t)?t.type=Ce.SCISSOR:t.type=Ce.STENCIL:t.type=Ce.COLOR}pushSpriteMask(t){const{maskObject:e}=t,s=t._target;let r=t._filters;r||(r=this.alphaMaskPool[this.alphaMaskIndex],r||(r=this.alphaMaskPool[this.alphaMaskIndex]=[new pw])),r[0].resolution=t.resolution,r[0].multisample=t.multisample,r[0].maskSprite=e;const i=s.filterArea;s.filterArea=e.getBounds(!0),this.renderer.filter.push(s,r),s.filterArea=i,t._filters||this.alphaMaskIndex++}popSpriteMask(t){this.renderer.filter.pop(),t._filters?t._filters[0].maskSprite=null:(this.alphaMaskIndex--,this.alphaMaskPool[this.alphaMaskIndex][0].maskSprite=null)}pushColorMask(t){const e=t._colorMask,s=t._colorMask=e&t.colorMask;s!==e&&this.renderer.gl.colorMask((s&1)!==0,(s&2)!==0,(s&4)!==0,(s&8)!==0)}popColorMask(t){const e=t._colorMask,s=this.maskStack.length>0?this.maskStack[this.maskStack.length-1]._colorMask:15;s!==e&&this.renderer.gl.colorMask((s&1)!==0,(s&2)!==0,(s&4)!==0,(s&8)!==0)}destroy(){this.renderer=null}}np.extension={type:ot.RendererSystem,name:"mask"};pt.add(np);class rp{constructor(t){this.renderer=t,this.maskStack=[],this.glConst=0}getStackLength(){return this.maskStack.length}setMaskStack(t){const{gl:e}=this.renderer,s=this.getStackLength();this.maskStack=t;const r=this.getStackLength();r!==s&&(r===0?e.disable(this.glConst):(e.enable(this.glConst),this._useCurrent()))}_useCurrent(){}destroy(){this.renderer=null,this.maskStack=null}}const Qu=new Zt,Ju=[],ip=class Ja extends rp{constructor(t){super(t),this.glConst=ht.ADAPTER.getWebGLRenderingContext().SCISSOR_TEST}getStackLength(){const t=this.maskStack[this.maskStack.length-1];return t?t._scissorCounter:0}calcScissorRect(t){if(t._scissorRectLocal)return;const e=t._scissorRect,{maskObject:s}=t,{renderer:r}=this,i=r.renderTexture,o=s.getBounds(!0,Ju.pop()??new vt);this.roundFrameToPixels(o,i.current?i.current.resolution:r.resolution,i.sourceFrame,i.destinationFrame,r.projection.transform),e&&o.fit(e),t._scissorRectLocal=o}static isMatrixRotated(t){if(!t)return!1;const{a:e,b:s,c:r,d:i}=t;return(Math.abs(s)>1e-4||Math.abs(r)>1e-4)&&(Math.abs(e)>1e-4||Math.abs(i)>1e-4)}testScissor(t){const{maskObject:e}=t;if(!e.isFastRect||!e.isFastRect()||Ja.isMatrixRotated(e.worldTransform)||Ja.isMatrixRotated(this.renderer.projection.transform))return!1;this.calcScissorRect(t);const s=t._scissorRectLocal;return s.width>0&&s.height>0}roundFrameToPixels(t,e,s,r,i){Ja.isMatrixRotated(i)||(i=i?Qu.copyFrom(i):Qu.identity(),i.translate(-s.x,-s.y).scale(r.width/s.width,r.height/s.height).translate(r.x,r.y),this.renderer.filter.transformAABB(i,t),t.fit(r),t.x=Math.round(t.x*e),t.y=Math.round(t.y*e),t.width=Math.round(t.width*e),t.height=Math.round(t.height*e))}push(t){t._scissorRectLocal||this.calcScissorRect(t);const{gl:e}=this.renderer;t._scissorRect||e.enable(e.SCISSOR_TEST),t._scissorCounter++,t._scissorRect=t._scissorRectLocal,this._useCurrent()}pop(t){const{gl:e}=this.renderer;t&&Ju.push(t._scissorRectLocal),this.getStackLength()>0?this._useCurrent():e.disable(e.SCISSOR_TEST)}_useCurrent(){const t=this.maskStack[this.maskStack.length-1]._scissorRect;let e;this.renderer.renderTexture.current?e=t.y:e=this.renderer.height-t.height-t.y,this.renderer.gl.scissor(t.x,e,t.width,t.height)}};ip.extension={type:ot.RendererSystem,name:"scissor"};let xw=ip;pt.add(xw);class ap extends rp{constructor(t){super(t),this.glConst=ht.ADAPTER.getWebGLRenderingContext().STENCIL_TEST}getStackLength(){const t=this.maskStack[this.maskStack.length-1];return t?t._stencilCounter:0}push(t){const e=t.maskObject,{gl:s}=this.renderer,r=t._stencilCounter;r===0&&(this.renderer.framebuffer.forceStencil(),s.clearStencil(0),s.clear(s.STENCIL_BUFFER_BIT),s.enable(s.STENCIL_TEST)),t._stencilCounter++;const i=t._colorMask;i!==0&&(t._colorMask=0,s.colorMask(!1,!1,!1,!1)),s.stencilFunc(s.EQUAL,r,4294967295),s.stencilOp(s.KEEP,s.KEEP,s.INCR),e.renderable=!0,e.render(this.renderer),this.renderer.batch.flush(),e.renderable=!1,i!==0&&(t._colorMask=i,s.colorMask((i&1)!==0,(i&2)!==0,(i&4)!==0,(i&8)!==0)),this._useCurrent()}pop(t){const e=this.renderer.gl;if(this.getStackLength()===0)e.disable(e.STENCIL_TEST);else{const s=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null,r=s?s._colorMask:15;r!==0&&(s._colorMask=0,e.colorMask(!1,!1,!1,!1)),e.stencilOp(e.KEEP,e.KEEP,e.DECR),t.renderable=!0,t.render(this.renderer),this.renderer.batch.flush(),t.renderable=!1,r!==0&&(s._colorMask=r,e.colorMask((r&1)!==0,(r&2)!==0,(r&4)!==0,(r&8)!==0)),this._useCurrent()}}_useCurrent(){const t=this.renderer.gl;t.stencilFunc(t.EQUAL,this.getStackLength(),4294967295),t.stencilOp(t.KEEP,t.KEEP,t.KEEP)}}ap.extension={type:ot.RendererSystem,name:"stencil"};pt.add(ap);class op{constructor(t){this.renderer=t,this.plugins={},Object.defineProperties(this.plugins,{extract:{enumerable:!1,get(){return Pt("7.0.0","renderer.plugins.extract has moved to renderer.extract"),t.extract}},prepare:{enumerable:!1,get(){return Pt("7.0.0","renderer.plugins.prepare has moved to renderer.prepare"),t.prepare}},interaction:{enumerable:!1,get(){return Pt("7.0.0","renderer.plugins.interaction has been deprecated, use renderer.events"),t.events}}})}init(){const t=this.rendererPlugins;for(const e in t)this.plugins[e]=new t[e](this.renderer)}destroy(){for(const t in this.plugins)this.plugins[t].destroy(),this.plugins[t]=null}}op.extension={type:[ot.RendererSystem,ot.CanvasRendererSystem],name:"_plugin"};pt.add(op);class lp{constructor(t){this.renderer=t,this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new Zt,this.transform=null}update(t,e,s,r){this.destinationFrame=t||this.destinationFrame||this.defaultFrame,this.sourceFrame=e||this.sourceFrame||t,this.calculateProjection(this.destinationFrame,this.sourceFrame,s,r),this.transform&&this.projectionMatrix.append(this.transform);const i=this.renderer;i.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,i.globalUniforms.update(),i.shader.shader&&i.shader.syncUniformGroup(i.shader.shader.uniforms.globals)}calculateProjection(t,e,s,r){const i=this.projectionMatrix,o=r?-1:1;i.identity(),i.a=1/e.width*2,i.d=o*(1/e.height*2),i.tx=-1-e.x*i.a,i.ty=-o-e.y*i.d}setTransform(t){}destroy(){this.renderer=null}}lp.extension={type:ot.RendererSystem,name:"projection"};pt.add(lp);const bw=new Go,tf=new vt;class cp{constructor(t){this.renderer=t,this._tempMatrix=new Zt}generateTexture(t,e){const{region:s,...r}=e||{},i=(s==null?void 0:s.copyTo(tf))||t.getLocalBounds(tf,!0),o=r.resolution||this.renderer.resolution;i.width=Math.max(i.width,1/o),i.height=Math.max(i.height,1/o),r.width=i.width,r.height=i.height,r.resolution=o,r.multisample??(r.multisample=this.renderer.multisample);const l=$r.create(r);this._tempMatrix.tx=-i.x,this._tempMatrix.ty=-i.y;const a=t.transform;return t.transform=bw,this.renderer.render(t,{renderTexture:l,transform:this._tempMatrix,skipUpdateTransform:!!t.parent,blit:!0}),t.transform=a,l}destroy(){}}cp.extension={type:[ot.RendererSystem,ot.CanvasRendererSystem],name:"textureGenerator"};pt.add(cp);const wr=new vt,Ni=new vt;class hp{constructor(t){this.renderer=t,this.defaultMaskStack=[],this.current=null,this.sourceFrame=new vt,this.destinationFrame=new vt,this.viewportFrame=new vt}contextChange(){var e;const t=(e=this.renderer)==null?void 0:e.gl.getContextAttributes();this._rendererPremultipliedAlpha=!!(t&&t.alpha&&t.premultipliedAlpha)}bind(t=null,e,s){const r=this.renderer;this.current=t;let i,o,l;t?(i=t.baseTexture,l=i.resolution,e||(wr.width=t.frame.width,wr.height=t.frame.height,e=wr),s||(Ni.x=t.frame.x,Ni.y=t.frame.y,Ni.width=e.width,Ni.height=e.height,s=Ni),o=i.framebuffer):(l=r.resolution,e||(wr.width=r._view.screen.width,wr.height=r._view.screen.height,e=wr),s||(s=wr,s.width=e.width,s.height=e.height));const a=this.viewportFrame;a.x=s.x*l,a.y=s.y*l,a.width=s.width*l,a.height=s.height*l,t||(a.y=r.view.height-(a.y+a.height)),a.ceil(),this.renderer.framebuffer.bind(o,a),this.renderer.projection.update(s,e,l,!o),t?this.renderer.mask.setMaskStack(i.maskStack):this.renderer.mask.setMaskStack(this.defaultMaskStack),this.sourceFrame.copyFrom(e),this.destinationFrame.copyFrom(s)}clear(t,e){const s=this.current?this.current.baseTexture.clear:this.renderer.background.backgroundColor,r=te.shared.setValue(t||s);(this.current&&this.current.baseTexture.alphaMode>0||!this.current&&this._rendererPremultipliedAlpha)&&r.premultiply(r.alpha);const i=this.destinationFrame,o=this.current?this.current.baseTexture:this.renderer._view.screen,l=i.width!==o.width||i.height!==o.height;if(l){let{x:a,y:c,width:h,height:d}=this.viewportFrame;a=Math.round(a),c=Math.round(c),h=Math.round(h),d=Math.round(d),this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST),this.renderer.gl.scissor(a,c,h,d)}this.renderer.framebuffer.clear(r.red,r.green,r.blue,r.alpha,e),l&&this.renderer.scissor.pop()}resize(){this.bind(null)}reset(){this.bind(null)}destroy(){this.renderer=null}}hp.extension={type:ot.RendererSystem,name:"renderTexture"};pt.add(hp);class yw{constructor(t,e){this.program=t,this.uniformData=e,this.uniformGroups={},this.uniformDirtyGroups={},this.uniformBufferBindings={}}destroy(){this.uniformData=null,this.uniformGroups=null,this.uniformDirtyGroups=null,this.uniformBufferBindings=null,this.program=null}}function ww(n,t){const e={},s=t.getProgramParameter(n,t.ACTIVE_ATTRIBUTES);for(let r=0;r<s;r++){const i=t.getActiveAttrib(n,r);if(i.name.startsWith("gl_"))continue;const o=zm(t,i.type),l={type:o,name:i.name,size:Wm(o),location:t.getAttribLocation(n,i.name)};e[i.name]=l}return e}function vw(n,t){const e={},s=t.getProgramParameter(n,t.ACTIVE_UNIFORMS);for(let r=0;r<s;r++){const i=t.getActiveUniform(n,r),o=i.name.replace(/\[.*?\]$/,""),l=!!i.name.match(/\[.*?\]$/),a=zm(t,i.type);e[o]={name:o,index:r,type:a,size:i.size,isArray:l,value:Ym(a,i.size)}}return e}function _w(n,t){var l;const e=$u(n,n.VERTEX_SHADER,t.vertexSrc),s=$u(n,n.FRAGMENT_SHADER,t.fragmentSrc),r=n.createProgram();n.attachShader(r,e),n.attachShader(r,s);const i=(l=t.extra)==null?void 0:l.transformFeedbackVaryings;if(i&&(typeof n.transformFeedbackVaryings!="function"?console.warn("TransformFeedback is not supported but TransformFeedbackVaryings are given."):n.transformFeedbackVaryings(r,i.names,i.bufferMode==="separate"?n.SEPARATE_ATTRIBS:n.INTERLEAVED_ATTRIBS)),n.linkProgram(r),n.getProgramParameter(r,n.LINK_STATUS)||Z1(n,r,e,s),t.attributeData=ww(r,n),t.uniformData=vw(r,n),!/^[ \t]*#[ \t]*version[ \t]+300[ \t]+es[ \t]*$/m.test(t.vertexSrc)){const a=Object.keys(t.attributeData);a.sort((c,h)=>c>h?1:-1);for(let c=0;c<a.length;c++)t.attributeData[a[c]].location=c,n.bindAttribLocation(r,c,a[c]);n.linkProgram(r)}n.deleteShader(e),n.deleteShader(s);const o={};for(const a in t.uniformData){const c=t.uniformData[a];o[a]={location:n.getUniformLocation(r,a),value:Ym(c.type,c.size)}}return new yw(r,o)}function Ew(n,t,e,s,r){e.buffer.update(r)}const Sw={float:`
        data[offset] = v;
    `,vec2:`
        data[offset] = v[0];
        data[offset+1] = v[1];
    `,vec3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

    `,vec4:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];
        data[offset+3] = v[3];
    `,mat2:`
        data[offset] = v[0];
        data[offset+1] = v[1];

        data[offset+4] = v[2];
        data[offset+5] = v[3];
    `,mat3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

        data[offset + 4] = v[3];
        data[offset + 5] = v[4];
        data[offset + 6] = v[5];

        data[offset + 8] = v[6];
        data[offset + 9] = v[7];
        data[offset + 10] = v[8];
    `,mat4:`
        for(var i = 0; i < 16; i++)
        {
            data[offset + i] = v[i];
        }
    `},dp={float:4,vec2:8,vec3:12,vec4:16,int:4,ivec2:8,ivec3:12,ivec4:16,uint:4,uvec2:8,uvec3:12,uvec4:16,bool:4,bvec2:8,bvec3:12,bvec4:16,mat2:16*2,mat3:16*3,mat4:16*4};function Tw(n){const t=n.map(i=>({data:i,offset:0,dataLen:0,dirty:0}));let e=0,s=0,r=0;for(let i=0;i<t.length;i++){const o=t[i];if(e=dp[o.data.type],o.data.size>1&&(e=Math.max(e,16)*o.data.size),o.dataLen=e,s%e!==0&&s<16){const l=s%e%16;s+=l,r+=l}s+e>16?(r=Math.ceil(r/16)*16,o.offset=r,r+=e,s=e):(o.offset=r,s+=e,r+=e)}return r=Math.ceil(r/16)*16,{uboElements:t,size:r}}function Aw(n,t){const e=[];for(const s in n)t[s]&&e.push(t[s]);return e.sort((s,r)=>s.index-r.index),e}function Cw(n,t){if(!n.autoManage)return{size:0,syncFunc:Ew};const e=Aw(n.uniforms,t),{uboElements:s,size:r}=Tw(e),i=[`
    var v = null;
    var v2 = null;
    var cv = null;
    var t = 0;
    var gl = renderer.gl
    var index = 0;
    var data = buffer.data;
    `];for(let o=0;o<s.length;o++){const l=s[o],a=n.uniforms[l.data.name],c=l.data.name;let h=!1;for(let d=0;d<ui.length;d++){const u=ui[d];if(u.codeUbo&&u.test(l.data,a)){i.push(`offset = ${l.offset/4};`,ui[d].codeUbo(l.data.name,a)),h=!0;break}}if(!h)if(l.data.size>1){const d=Wm(l.data.type),u=Math.max(dp[l.data.type]/16,1),f=d/u,m=(4-f%4)%4;i.push(`
                cv = ud.${c}.value;
                v = uv.${c};
                offset = ${l.offset/4};

                t = 0;

                for(var i=0; i < ${l.data.size*u}; i++)
                {
                    for(var j = 0; j < ${f}; j++)
                    {
                        data[offset++] = v[t++];
                    }
                    offset += ${m};
                }

                `)}else{const d=Sw[l.data.type];i.push(`
                cv = ud.${c}.value;
                v = uv.${c};
                offset = ${l.offset/4};
                ${d};
                `)}}return i.push(`
       renderer.buffer.update(buffer);
    `),{size:r,syncFunc:new Function("ud","uv","renderer","syncData","buffer",i.join(`
`))}}let kw=0;const Fa={textureCount:0,uboCount:0};class Ph{constructor(t){this.destroyed=!1,this.renderer=t,this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this._uboCache={},this.id=kw++}systemCheck(){if(!J1())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")}contextChange(t){this.gl=t,this.reset()}bind(t,e){t.disposeRunner.add(this),t.uniforms.globals=this.renderer.globalUniforms;const s=t.program,r=s.glPrograms[this.renderer.CONTEXT_UID]||this.generateProgram(t);return this.shader=t,this.program!==s&&(this.program=s,this.gl.useProgram(r.program)),e||(Fa.textureCount=0,Fa.uboCount=0,this.syncUniformGroup(t.uniformGroup,Fa)),r}setUniforms(t){const e=this.shader.program,s=e.glPrograms[this.renderer.CONTEXT_UID];e.syncUniforms(s.uniformData,t,this.renderer)}syncUniformGroup(t,e){const s=this.getGlProgram();(!t.static||t.dirtyId!==s.uniformDirtyGroups[t.id])&&(s.uniformDirtyGroups[t.id]=t.dirtyId,this.syncUniforms(t,s,e))}syncUniforms(t,e,s){(t.syncUniforms[this.shader.program.id]||this.createSyncGroups(t))(e.uniformData,t.uniforms,this.renderer,s)}createSyncGroups(t){const e=this.getSignature(t,this.shader.program.uniformData,"u");return this.cache[e]||(this.cache[e]=H1(t,this.shader.program.uniformData)),t.syncUniforms[this.shader.program.id]=this.cache[e],t.syncUniforms[this.shader.program.id]}syncUniformBufferGroup(t,e){const s=this.getGlProgram();if(!t.static||t.dirtyId!==0||!s.uniformGroups[t.id]){t.dirtyId=0;const r=s.uniformGroups[t.id]||this.createSyncBufferGroup(t,s,e);t.buffer.update(),r(s.uniformData,t.uniforms,this.renderer,Fa,t.buffer)}this.renderer.buffer.bindBufferBase(t.buffer,s.uniformBufferBindings[e])}createSyncBufferGroup(t,e,s){const{gl:r}=this.renderer;this.renderer.buffer.bind(t.buffer);const i=this.gl.getUniformBlockIndex(e.program,s);e.uniformBufferBindings[s]=this.shader.uniformBindCount,r.uniformBlockBinding(e.program,i,this.shader.uniformBindCount),this.shader.uniformBindCount++;const o=this.getSignature(t,this.shader.program.uniformData,"ubo");let l=this._uboCache[o];if(l||(l=this._uboCache[o]=Cw(t,this.shader.program.uniformData)),t.autoManage){const a=new Float32Array(l.size/4);t.buffer.update(a)}return e.uniformGroups[t.id]=l.syncFunc,e.uniformGroups[t.id]}getSignature(t,e,s){const r=t.uniforms,i=[`${s}-`];for(const o in r)i.push(o),e[o]&&i.push(e[o].type);return i.join("-")}getGlProgram(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null}generateProgram(t){const e=this.gl,s=t.program,r=_w(e,s);return s.glPrograms[this.renderer.CONTEXT_UID]=r,r}reset(){this.program=null,this.shader=null}disposeShader(t){this.shader===t&&(this.shader=null)}destroy(){this.renderer=null,this.destroyed=!0}}Ph.extension={type:ot.RendererSystem,name:"shader"};pt.add(Ph);class go{constructor(t){this.renderer=t}run(t){const{renderer:e}=this;e.runners.init.emit(e.options),t.hello&&console.log(`PixiJS 7.4.2 - ${e.rendererLogId} - https://pixijs.com`),e.resize(e.screen.width,e.screen.height)}destroy(){}}go.defaultOptions={hello:!1},go.extension={type:[ot.RendererSystem,ot.CanvasRendererSystem],name:"startup"};pt.add(go);function Iw(n,t=[]){return t[dt.NORMAL]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],t[dt.ADD]=[n.ONE,n.ONE],t[dt.MULTIPLY]=[n.DST_COLOR,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA],t[dt.SCREEN]=[n.ONE,n.ONE_MINUS_SRC_COLOR,n.ONE,n.ONE_MINUS_SRC_ALPHA],t[dt.OVERLAY]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],t[dt.DARKEN]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],t[dt.LIGHTEN]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],t[dt.COLOR_DODGE]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],t[dt.COLOR_BURN]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],t[dt.HARD_LIGHT]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],t[dt.SOFT_LIGHT]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],t[dt.DIFFERENCE]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],t[dt.EXCLUSION]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],t[dt.HUE]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],t[dt.SATURATION]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],t[dt.COLOR]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],t[dt.LUMINOSITY]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],t[dt.NONE]=[0,0],t[dt.NORMAL_NPM]=[n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA],t[dt.ADD_NPM]=[n.SRC_ALPHA,n.ONE,n.ONE,n.ONE],t[dt.SCREEN_NPM]=[n.SRC_ALPHA,n.ONE_MINUS_SRC_COLOR,n.ONE,n.ONE_MINUS_SRC_ALPHA],t[dt.SRC_IN]=[n.DST_ALPHA,n.ZERO],t[dt.SRC_OUT]=[n.ONE_MINUS_DST_ALPHA,n.ZERO],t[dt.SRC_ATOP]=[n.DST_ALPHA,n.ONE_MINUS_SRC_ALPHA],t[dt.DST_OVER]=[n.ONE_MINUS_DST_ALPHA,n.ONE],t[dt.DST_IN]=[n.ZERO,n.SRC_ALPHA],t[dt.DST_OUT]=[n.ZERO,n.ONE_MINUS_SRC_ALPHA],t[dt.DST_ATOP]=[n.ONE_MINUS_DST_ALPHA,n.SRC_ALPHA],t[dt.XOR]=[n.ONE_MINUS_DST_ALPHA,n.ONE_MINUS_SRC_ALPHA],t[dt.SUBTRACT]=[n.ONE,n.ONE,n.ONE,n.ONE,n.FUNC_REVERSE_SUBTRACT,n.FUNC_ADD],t}const Rw=0,Mw=1,Pw=2,Nw=3,Fw=4,Dw=5,up=class kc{constructor(){this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=dt.NONE,this._blendEq=!1,this.map=[],this.map[Rw]=this.setBlend,this.map[Mw]=this.setOffset,this.map[Pw]=this.setCullFace,this.map[Nw]=this.setDepthTest,this.map[Fw]=this.setFrontFace,this.map[Dw]=this.setDepthMask,this.checks=[],this.defaultState=new yn,this.defaultState.blend=!0}contextChange(t){this.gl=t,this.blendModes=Iw(t),this.set(this.defaultState),this.reset()}set(t){if(t=t||this.defaultState,this.stateId!==t.data){let e=this.stateId^t.data,s=0;for(;e;)e&1&&this.map[s].call(this,!!(t.data&1<<s)),e=e>>1,s++;this.stateId=t.data}for(let e=0;e<this.checks.length;e++)this.checks[e](this,t)}forceState(t){t=t||this.defaultState;for(let e=0;e<this.map.length;e++)this.map[e].call(this,!!(t.data&1<<e));for(let e=0;e<this.checks.length;e++)this.checks[e](this,t);this.stateId=t.data}setBlend(t){this.updateCheck(kc.checkBlendMode,t),this.gl[t?"enable":"disable"](this.gl.BLEND)}setOffset(t){this.updateCheck(kc.checkPolygonOffset,t),this.gl[t?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)}setDepthTest(t){this.gl[t?"enable":"disable"](this.gl.DEPTH_TEST)}setDepthMask(t){this.gl.depthMask(t)}setCullFace(t){this.gl[t?"enable":"disable"](this.gl.CULL_FACE)}setFrontFace(t){this.gl.frontFace(this.gl[t?"CW":"CCW"])}setBlendMode(t){if(t===this.blendMode)return;this.blendMode=t;const e=this.blendModes[t],s=this.gl;e.length===2?s.blendFunc(e[0],e[1]):s.blendFuncSeparate(e[0],e[1],e[2],e[3]),e.length===6?(this._blendEq=!0,s.blendEquationSeparate(e[4],e[5])):this._blendEq&&(this._blendEq=!1,s.blendEquationSeparate(s.FUNC_ADD,s.FUNC_ADD))}setPolygonOffset(t,e){this.gl.polygonOffset(t,e)}reset(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(this.defaultState),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)}updateCheck(t,e){const s=this.checks.indexOf(t);e&&s===-1?this.checks.push(t):!e&&s!==-1&&this.checks.splice(s,1)}static checkBlendMode(t,e){t.setBlendMode(e.blendMode)}static checkPolygonOffset(t,e){t.setPolygonOffset(1,e.polygonOffset)}destroy(){this.gl=null}};up.extension={type:ot.RendererSystem,name:"state"};let Bw=up;pt.add(Bw);class Lw extends ma{constructor(){super(...arguments),this.runners={},this._systemsHash={}}setup(t){this.addRunners(...t.runners);const e=(t.priority??[]).filter(r=>t.systems[r]),s=[...e,...Object.keys(t.systems).filter(r=>!e.includes(r))];for(const r of s)this.addSystem(t.systems[r],r)}addRunners(...t){t.forEach(e=>{this.runners[e]=new zs(e)})}addSystem(t,e){const s=new t(this);if(this[e])throw new Error(`Whoops! The name "${e}" is already in use`);this[e]=s,this._systemsHash[e]=s;for(const r in this.runners)this.runners[r].add(s);return this}emitWithCustomOptions(t,e){const s=Object.keys(this._systemsHash);t.items.forEach(r=>{const i=s.find(o=>this._systemsHash[o]===r);r[t.name](e[i])})}destroy(){Object.values(this.runners).forEach(t=>{t.destroy()}),this._systemsHash={}}}const Ui=class to{constructor(t){this.renderer=t,this.count=0,this.checkCount=0,this.maxIdle=to.defaultMaxIdle,this.checkCountMax=to.defaultCheckCountMax,this.mode=to.defaultMode}postrender(){this.renderer.objectRenderer.renderingToScreen&&(this.count++,this.mode!==Ih.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))}run(){const t=this.renderer.texture,e=t.managedTextures;let s=!1;for(let r=0;r<e.length;r++){const i=e[r];i.resource&&this.count-i.touched>this.maxIdle&&(t.destroyTexture(i,!0),e[r]=null,s=!0)}if(s){let r=0;for(let i=0;i<e.length;i++)e[i]!==null&&(e[r++]=e[i]);e.length=r}}unload(t){const e=this.renderer.texture,s=t._texture;s&&!s.framebuffer&&e.destroyTexture(s);for(let r=t.children.length-1;r>=0;r--)this.unload(t.children[r])}destroy(){this.renderer=null}};Ui.defaultMode=Ih.AUTO,Ui.defaultMaxIdle=60*60,Ui.defaultCheckCountMax=60*10,Ui.extension={type:ot.RendererSystem,name:"textureGC"};let Cr=Ui;pt.add(Cr);class Fl{constructor(t){this.texture=t,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=yt.UNSIGNED_BYTE,this.internalFormat=st.RGBA,this.samplerType=0}}function Ow(n){let t;return"WebGL2RenderingContext"in globalThis&&n instanceof globalThis.WebGL2RenderingContext?t={[n.RGB]:ut.FLOAT,[n.RGBA]:ut.FLOAT,[n.ALPHA]:ut.FLOAT,[n.LUMINANCE]:ut.FLOAT,[n.LUMINANCE_ALPHA]:ut.FLOAT,[n.R8]:ut.FLOAT,[n.R8_SNORM]:ut.FLOAT,[n.RG8]:ut.FLOAT,[n.RG8_SNORM]:ut.FLOAT,[n.RGB8]:ut.FLOAT,[n.RGB8_SNORM]:ut.FLOAT,[n.RGB565]:ut.FLOAT,[n.RGBA4]:ut.FLOAT,[n.RGB5_A1]:ut.FLOAT,[n.RGBA8]:ut.FLOAT,[n.RGBA8_SNORM]:ut.FLOAT,[n.RGB10_A2]:ut.FLOAT,[n.RGB10_A2UI]:ut.FLOAT,[n.SRGB8]:ut.FLOAT,[n.SRGB8_ALPHA8]:ut.FLOAT,[n.R16F]:ut.FLOAT,[n.RG16F]:ut.FLOAT,[n.RGB16F]:ut.FLOAT,[n.RGBA16F]:ut.FLOAT,[n.R32F]:ut.FLOAT,[n.RG32F]:ut.FLOAT,[n.RGB32F]:ut.FLOAT,[n.RGBA32F]:ut.FLOAT,[n.R11F_G11F_B10F]:ut.FLOAT,[n.RGB9_E5]:ut.FLOAT,[n.R8I]:ut.INT,[n.R8UI]:ut.UINT,[n.R16I]:ut.INT,[n.R16UI]:ut.UINT,[n.R32I]:ut.INT,[n.R32UI]:ut.UINT,[n.RG8I]:ut.INT,[n.RG8UI]:ut.UINT,[n.RG16I]:ut.INT,[n.RG16UI]:ut.UINT,[n.RG32I]:ut.INT,[n.RG32UI]:ut.UINT,[n.RGB8I]:ut.INT,[n.RGB8UI]:ut.UINT,[n.RGB16I]:ut.INT,[n.RGB16UI]:ut.UINT,[n.RGB32I]:ut.INT,[n.RGB32UI]:ut.UINT,[n.RGBA8I]:ut.INT,[n.RGBA8UI]:ut.UINT,[n.RGBA16I]:ut.INT,[n.RGBA16UI]:ut.UINT,[n.RGBA32I]:ut.INT,[n.RGBA32UI]:ut.UINT,[n.DEPTH_COMPONENT16]:ut.FLOAT,[n.DEPTH_COMPONENT24]:ut.FLOAT,[n.DEPTH_COMPONENT32F]:ut.FLOAT,[n.DEPTH_STENCIL]:ut.FLOAT,[n.DEPTH24_STENCIL8]:ut.FLOAT,[n.DEPTH32F_STENCIL8]:ut.FLOAT}:t={[n.RGB]:ut.FLOAT,[n.RGBA]:ut.FLOAT,[n.ALPHA]:ut.FLOAT,[n.LUMINANCE]:ut.FLOAT,[n.LUMINANCE_ALPHA]:ut.FLOAT,[n.DEPTH_STENCIL]:ut.FLOAT},t}function jw(n){let t;return"WebGL2RenderingContext"in globalThis&&n instanceof globalThis.WebGL2RenderingContext?t={[yt.UNSIGNED_BYTE]:{[st.RGBA]:n.RGBA8,[st.RGB]:n.RGB8,[st.RG]:n.RG8,[st.RED]:n.R8,[st.RGBA_INTEGER]:n.RGBA8UI,[st.RGB_INTEGER]:n.RGB8UI,[st.RG_INTEGER]:n.RG8UI,[st.RED_INTEGER]:n.R8UI,[st.ALPHA]:n.ALPHA,[st.LUMINANCE]:n.LUMINANCE,[st.LUMINANCE_ALPHA]:n.LUMINANCE_ALPHA},[yt.BYTE]:{[st.RGBA]:n.RGBA8_SNORM,[st.RGB]:n.RGB8_SNORM,[st.RG]:n.RG8_SNORM,[st.RED]:n.R8_SNORM,[st.RGBA_INTEGER]:n.RGBA8I,[st.RGB_INTEGER]:n.RGB8I,[st.RG_INTEGER]:n.RG8I,[st.RED_INTEGER]:n.R8I},[yt.UNSIGNED_SHORT]:{[st.RGBA_INTEGER]:n.RGBA16UI,[st.RGB_INTEGER]:n.RGB16UI,[st.RG_INTEGER]:n.RG16UI,[st.RED_INTEGER]:n.R16UI,[st.DEPTH_COMPONENT]:n.DEPTH_COMPONENT16},[yt.SHORT]:{[st.RGBA_INTEGER]:n.RGBA16I,[st.RGB_INTEGER]:n.RGB16I,[st.RG_INTEGER]:n.RG16I,[st.RED_INTEGER]:n.R16I},[yt.UNSIGNED_INT]:{[st.RGBA_INTEGER]:n.RGBA32UI,[st.RGB_INTEGER]:n.RGB32UI,[st.RG_INTEGER]:n.RG32UI,[st.RED_INTEGER]:n.R32UI,[st.DEPTH_COMPONENT]:n.DEPTH_COMPONENT24},[yt.INT]:{[st.RGBA_INTEGER]:n.RGBA32I,[st.RGB_INTEGER]:n.RGB32I,[st.RG_INTEGER]:n.RG32I,[st.RED_INTEGER]:n.R32I},[yt.FLOAT]:{[st.RGBA]:n.RGBA32F,[st.RGB]:n.RGB32F,[st.RG]:n.RG32F,[st.RED]:n.R32F,[st.DEPTH_COMPONENT]:n.DEPTH_COMPONENT32F},[yt.HALF_FLOAT]:{[st.RGBA]:n.RGBA16F,[st.RGB]:n.RGB16F,[st.RG]:n.RG16F,[st.RED]:n.R16F},[yt.UNSIGNED_SHORT_5_6_5]:{[st.RGB]:n.RGB565},[yt.UNSIGNED_SHORT_4_4_4_4]:{[st.RGBA]:n.RGBA4},[yt.UNSIGNED_SHORT_5_5_5_1]:{[st.RGBA]:n.RGB5_A1},[yt.UNSIGNED_INT_2_10_10_10_REV]:{[st.RGBA]:n.RGB10_A2,[st.RGBA_INTEGER]:n.RGB10_A2UI},[yt.UNSIGNED_INT_10F_11F_11F_REV]:{[st.RGB]:n.R11F_G11F_B10F},[yt.UNSIGNED_INT_5_9_9_9_REV]:{[st.RGB]:n.RGB9_E5},[yt.UNSIGNED_INT_24_8]:{[st.DEPTH_STENCIL]:n.DEPTH24_STENCIL8},[yt.FLOAT_32_UNSIGNED_INT_24_8_REV]:{[st.DEPTH_STENCIL]:n.DEPTH32F_STENCIL8}}:t={[yt.UNSIGNED_BYTE]:{[st.RGBA]:n.RGBA,[st.RGB]:n.RGB,[st.ALPHA]:n.ALPHA,[st.LUMINANCE]:n.LUMINANCE,[st.LUMINANCE_ALPHA]:n.LUMINANCE_ALPHA},[yt.UNSIGNED_SHORT_5_6_5]:{[st.RGB]:n.RGB},[yt.UNSIGNED_SHORT_4_4_4_4]:{[st.RGBA]:n.RGBA},[yt.UNSIGNED_SHORT_5_5_5_1]:{[st.RGBA]:n.RGBA}},t}class fp{constructor(t){this.renderer=t,this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new _t,this.hasIntegerTextures=!1}contextChange(){const t=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion,this.internalFormats=jw(t),this.samplerTypes=Ow(t);const e=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=e;for(let r=0;r<e;r++)this.boundTextures[r]=null;this.emptyTextures={};const s=new Fl(t.createTexture());t.bindTexture(t.TEXTURE_2D,s.texture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[t.TEXTURE_2D]=s,this.emptyTextures[t.TEXTURE_CUBE_MAP]=new Fl(t.createTexture()),t.bindTexture(t.TEXTURE_CUBE_MAP,this.emptyTextures[t.TEXTURE_CUBE_MAP].texture);for(let r=0;r<6;r++)t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+r,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,null);t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MIN_FILTER,t.LINEAR);for(let r=0;r<this.boundTextures.length;r++)this.bind(null,r)}bind(t,e=0){const{gl:s}=this;if(t=t==null?void 0:t.castToBaseTexture(),(t==null?void 0:t.valid)&&!t.parentTextureArray){t.touched=this.renderer.textureGC.count;const r=t._glTextures[this.CONTEXT_UID]||this.initTexture(t);this.boundTextures[e]!==t&&(this.currentLocation!==e&&(this.currentLocation=e,s.activeTexture(s.TEXTURE0+e)),s.bindTexture(t.target,r.texture)),r.dirtyId!==t.dirtyId?(this.currentLocation!==e&&(this.currentLocation=e,s.activeTexture(s.TEXTURE0+e)),this.updateTexture(t)):r.dirtyStyleId!==t.dirtyStyleId&&this.updateTextureStyle(t),this.boundTextures[e]=t}else this.currentLocation!==e&&(this.currentLocation=e,s.activeTexture(s.TEXTURE0+e)),s.bindTexture(s.TEXTURE_2D,this.emptyTextures[s.TEXTURE_2D].texture),this.boundTextures[e]=null}reset(){this._unknownBoundTextures=!0,this.hasIntegerTextures=!1,this.currentLocation=-1;for(let t=0;t<this.boundTextures.length;t++)this.boundTextures[t]=this.unknownTexture}unbind(t){const{gl:e,boundTextures:s}=this;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(let r=0;r<s.length;r++)s[r]===this.unknownTexture&&this.bind(null,r)}for(let r=0;r<s.length;r++)s[r]===t&&(this.currentLocation!==r&&(e.activeTexture(e.TEXTURE0+r),this.currentLocation=r),e.bindTexture(t.target,this.emptyTextures[t.target].texture),s[r]=null)}ensureSamplerType(t){const{boundTextures:e,hasIntegerTextures:s,CONTEXT_UID:r}=this;if(s)for(let i=t-1;i>=0;--i){const o=e[i];o&&o._glTextures[r].samplerType!==ut.FLOAT&&this.renderer.texture.unbind(o)}}initTexture(t){const e=new Fl(this.gl.createTexture());return e.dirtyId=-1,t._glTextures[this.CONTEXT_UID]=e,this.managedTextures.push(t),t.on("dispose",this.destroyTexture,this),e}initTextureType(t,e){var s;e.internalFormat=((s=this.internalFormats[t.type])==null?void 0:s[t.format])??t.format,e.samplerType=this.samplerTypes[e.internalFormat]??ut.FLOAT,this.webGLVersion===2&&t.type===yt.HALF_FLOAT?e.type=this.gl.HALF_FLOAT:e.type=t.type}updateTexture(t){var r;const e=t._glTextures[this.CONTEXT_UID];if(!e)return;const s=this.renderer;if(this.initTextureType(t,e),(r=t.resource)==null?void 0:r.upload(s,t,e))e.samplerType!==ut.FLOAT&&(this.hasIntegerTextures=!0);else{const i=t.realWidth,o=t.realHeight,l=s.gl;(e.width!==i||e.height!==o||e.dirtyId<0)&&(e.width=i,e.height=o,l.texImage2D(t.target,0,e.internalFormat,i,o,0,t.format,e.type,null))}t.dirtyStyleId!==e.dirtyStyleId&&this.updateTextureStyle(t),e.dirtyId=t.dirtyId}destroyTexture(t,e){const{gl:s}=this;if(t=t.castToBaseTexture(),t._glTextures[this.CONTEXT_UID]&&(this.unbind(t),s.deleteTexture(t._glTextures[this.CONTEXT_UID].texture),t.off("dispose",this.destroyTexture,this),delete t._glTextures[this.CONTEXT_UID],!e)){const r=this.managedTextures.indexOf(t);r!==-1&&di(this.managedTextures,r,1)}}updateTextureStyle(t){var s;const e=t._glTextures[this.CONTEXT_UID];e&&((t.mipmap===Zs.POW2||this.webGLVersion!==2)&&!t.isPowerOfTwo?e.mipmap=!1:e.mipmap=t.mipmap>=1,this.webGLVersion!==2&&!t.isPowerOfTwo?e.wrapMode=hr.CLAMP:e.wrapMode=t.wrapMode,(s=t.resource)!=null&&s.style(this.renderer,t,e)||this.setStyle(t,e),e.dirtyStyleId=t.dirtyStyleId)}setStyle(t,e){const s=this.gl;if(e.mipmap&&t.mipmap!==Zs.ON_MANUAL&&s.generateMipmap(t.target),s.texParameteri(t.target,s.TEXTURE_WRAP_S,e.wrapMode),s.texParameteri(t.target,s.TEXTURE_WRAP_T,e.wrapMode),e.mipmap){s.texParameteri(t.target,s.TEXTURE_MIN_FILTER,t.scaleMode===ps.LINEAR?s.LINEAR_MIPMAP_LINEAR:s.NEAREST_MIPMAP_NEAREST);const r=this.renderer.context.extensions.anisotropicFiltering;if(r&&t.anisotropicLevel>0&&t.scaleMode===ps.LINEAR){const i=Math.min(t.anisotropicLevel,s.getParameter(r.MAX_TEXTURE_MAX_ANISOTROPY_EXT));s.texParameterf(t.target,r.TEXTURE_MAX_ANISOTROPY_EXT,i)}}else s.texParameteri(t.target,s.TEXTURE_MIN_FILTER,t.scaleMode===ps.LINEAR?s.LINEAR:s.NEAREST);s.texParameteri(t.target,s.TEXTURE_MAG_FILTER,t.scaleMode===ps.LINEAR?s.LINEAR:s.NEAREST)}destroy(){this.renderer=null}}fp.extension={type:ot.RendererSystem,name:"texture"};pt.add(fp);class mp{constructor(t){this.renderer=t}contextChange(){this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(t){const{gl:e,CONTEXT_UID:s}=this,r=t._glTransformFeedbacks[s]||this.createGLTransformFeedback(t);e.bindTransformFeedback(e.TRANSFORM_FEEDBACK,r)}unbind(){const{gl:t}=this;t.bindTransformFeedback(t.TRANSFORM_FEEDBACK,null)}beginTransformFeedback(t,e){const{gl:s,renderer:r}=this;e&&r.shader.bind(e),s.beginTransformFeedback(t)}endTransformFeedback(){const{gl:t}=this;t.endTransformFeedback()}createGLTransformFeedback(t){const{gl:e,renderer:s,CONTEXT_UID:r}=this,i=e.createTransformFeedback();t._glTransformFeedbacks[r]=i,e.bindTransformFeedback(e.TRANSFORM_FEEDBACK,i);for(let o=0;o<t.buffers.length;o++){const l=t.buffers[o];l&&(s.buffer.update(l),l._glBuffers[r].refCount++,e.bindBufferBase(e.TRANSFORM_FEEDBACK_BUFFER,o,l._glBuffers[r].buffer||null))}return e.bindTransformFeedback(e.TRANSFORM_FEEDBACK,null),t.disposeRunner.add(this),i}disposeTransformFeedback(t,e){const s=t._glTransformFeedbacks[this.CONTEXT_UID],r=this.gl;t.disposeRunner.remove(this);const i=this.renderer.buffer;if(i)for(let o=0;o<t.buffers.length;o++){const l=t.buffers[o];if(!l)continue;const a=l._glBuffers[this.CONTEXT_UID];a&&(a.refCount--,a.refCount===0&&!e&&i.dispose(l,e))}s&&(e||r.deleteTransformFeedback(s),delete t._glTransformFeedbacks[this.CONTEXT_UID])}destroy(){this.renderer=null}}mp.extension={type:ot.RendererSystem,name:"transformFeedback"};pt.add(mp);class xo{constructor(t){this.renderer=t}init(t){this.screen=new vt(0,0,t.width,t.height),this.element=t.view||ht.ADAPTER.createCanvas(),this.resolution=t.resolution||ht.RESOLUTION,this.autoDensity=!!t.autoDensity}resizeView(t,e){this.element.width=Math.round(t*this.resolution),this.element.height=Math.round(e*this.resolution);const s=this.element.width/this.resolution,r=this.element.height/this.resolution;this.screen.width=s,this.screen.height=r,this.autoDensity&&(this.element.style.width=`${s}px`,this.element.style.height=`${r}px`),this.renderer.emit("resize",s,r),this.renderer.runners.resize.emit(this.screen.width,this.screen.height)}destroy(t){var e;t&&((e=this.element.parentNode)==null||e.removeChild(this.element)),this.renderer=null,this.element=null,this.screen=null}}xo.defaultOptions={width:800,height:600,resolution:void 0,autoDensity:!1},xo.extension={type:[ot.RendererSystem,ot.CanvasRendererSystem],name:"_view"};pt.add(xo);ht.PREFER_ENV=Yr.WEBGL2;ht.STRICT_TEXTURE_CACHE=!1;ht.RENDER_OPTIONS={...po.defaultOptions,...mo.defaultOptions,...xo.defaultOptions,...go.defaultOptions};Object.defineProperties(ht,{WRAP_MODE:{get(){return _t.defaultOptions.wrapMode},set(n){Pt("7.1.0","settings.WRAP_MODE is deprecated, use BaseTexture.defaultOptions.wrapMode"),_t.defaultOptions.wrapMode=n}},SCALE_MODE:{get(){return _t.defaultOptions.scaleMode},set(n){Pt("7.1.0","settings.SCALE_MODE is deprecated, use BaseTexture.defaultOptions.scaleMode"),_t.defaultOptions.scaleMode=n}},MIPMAP_TEXTURES:{get(){return _t.defaultOptions.mipmap},set(n){Pt("7.1.0","settings.MIPMAP_TEXTURES is deprecated, use BaseTexture.defaultOptions.mipmap"),_t.defaultOptions.mipmap=n}},ANISOTROPIC_LEVEL:{get(){return _t.defaultOptions.anisotropicLevel},set(n){Pt("7.1.0","settings.ANISOTROPIC_LEVEL is deprecated, use BaseTexture.defaultOptions.anisotropicLevel"),_t.defaultOptions.anisotropicLevel=n}},FILTER_RESOLUTION:{get(){return Pt("7.1.0","settings.FILTER_RESOLUTION is deprecated, use Filter.defaultResolution"),Je.defaultResolution},set(n){Je.defaultResolution=n}},FILTER_MULTISAMPLE:{get(){return Pt("7.1.0","settings.FILTER_MULTISAMPLE is deprecated, use Filter.defaultMultisample"),Je.defaultMultisample},set(n){Je.defaultMultisample=n}},SPRITE_MAX_TEXTURES:{get(){return Ar.defaultMaxTextures},set(n){Pt("7.1.0","settings.SPRITE_MAX_TEXTURES is deprecated, use BatchRenderer.defaultMaxTextures"),Ar.defaultMaxTextures=n}},SPRITE_BATCH_SIZE:{get(){return Ar.defaultBatchSize},set(n){Pt("7.1.0","settings.SPRITE_BATCH_SIZE is deprecated, use BatchRenderer.defaultBatchSize"),Ar.defaultBatchSize=n}},CAN_UPLOAD_SAME_BUFFER:{get(){return Ar.canUploadSameBuffer},set(n){Pt("7.1.0","settings.CAN_UPLOAD_SAME_BUFFER is deprecated, use BatchRenderer.canUploadSameBuffer"),Ar.canUploadSameBuffer=n}},GC_MODE:{get(){return Cr.defaultMode},set(n){Pt("7.1.0","settings.GC_MODE is deprecated, use TextureGCSystem.defaultMode"),Cr.defaultMode=n}},GC_MAX_IDLE:{get(){return Cr.defaultMaxIdle},set(n){Pt("7.1.0","settings.GC_MAX_IDLE is deprecated, use TextureGCSystem.defaultMaxIdle"),Cr.defaultMaxIdle=n}},GC_MAX_CHECK_COUNT:{get(){return Cr.defaultCheckCountMax},set(n){Pt("7.1.0","settings.GC_MAX_CHECK_COUNT is deprecated, use TextureGCSystem.defaultCheckCountMax"),Cr.defaultCheckCountMax=n}},PRECISION_VERTEX:{get(){return Pn.defaultVertexPrecision},set(n){Pt("7.1.0","settings.PRECISION_VERTEX is deprecated, use Program.defaultVertexPrecision"),Pn.defaultVertexPrecision=n}},PRECISION_FRAGMENT:{get(){return Pn.defaultFragmentPrecision},set(n){Pt("7.1.0","settings.PRECISION_FRAGMENT is deprecated, use Program.defaultFragmentPrecision"),Pn.defaultFragmentPrecision=n}}});var Ur=(n=>(n[n.INTERACTION=50]="INTERACTION",n[n.HIGH=25]="HIGH",n[n.NORMAL=0]="NORMAL",n[n.LOW=-25]="LOW",n[n.UTILITY=-50]="UTILITY",n))(Ur||{});class Dl{constructor(t,e=null,s=0,r=!1){this.next=null,this.previous=null,this._destroyed=!1,this.fn=t,this.context=e,this.priority=s,this.once=r}match(t,e=null){return this.fn===t&&this.context===e}emit(t){this.fn&&(this.context?this.fn.call(this.context,t):this.fn(t));const e=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),e}connect(t){this.previous=t,t.next&&(t.next.previous=this),this.next=t.next,t.next=this}destroy(t=!1){this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);const e=this.next;return this.next=t?null:e,this.previous=null,e}}const pp=class fs{constructor(){this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new Dl(null,null,1/0),this.deltaMS=1/fs.targetFPMS,this.elapsedMS=1/fs.targetFPMS,this._tick=t=>{this._requestId=null,this.started&&(this.update(t),this.started&&this._requestId===null&&this._head.next&&(this._requestId=requestAnimationFrame(this._tick)))}}_requestIfNeeded(){this._requestId===null&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))}_cancelIfNeeded(){this._requestId!==null&&(cancelAnimationFrame(this._requestId),this._requestId=null)}_startIfPossible(){this.started?this._requestIfNeeded():this.autoStart&&this.start()}add(t,e,s=Ur.NORMAL){return this._addListener(new Dl(t,e,s))}addOnce(t,e,s=Ur.NORMAL){return this._addListener(new Dl(t,e,s,!0))}_addListener(t){let e=this._head.next,s=this._head;if(!e)t.connect(s);else{for(;e;){if(t.priority>e.priority){t.connect(s);break}s=e,e=e.next}t.previous||t.connect(s)}return this._startIfPossible(),this}remove(t,e){let s=this._head.next;for(;s;)s.match(t,e)?s=s.destroy():s=s.next;return this._head.next||this._cancelIfNeeded(),this}get count(){if(!this._head)return 0;let t=0,e=this._head;for(;e=e.next;)t++;return t}start(){this.started||(this.started=!0,this._requestIfNeeded())}stop(){this.started&&(this.started=!1,this._cancelIfNeeded())}destroy(){if(!this._protected){this.stop();let t=this._head.next;for(;t;)t=t.destroy(!0);this._head.destroy(),this._head=null}}update(t=performance.now()){let e;if(t>this.lastTime){if(e=this.elapsedMS=t-this.lastTime,e>this._maxElapsedMS&&(e=this._maxElapsedMS),e*=this.speed,this._minElapsedMS){const i=t-this._lastFrame|0;if(i<this._minElapsedMS)return;this._lastFrame=t-i%this._minElapsedMS}this.deltaMS=e,this.deltaTime=this.deltaMS*fs.targetFPMS;const s=this._head;let r=s.next;for(;r;)r=r.emit(this.deltaTime);s.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=t}get FPS(){return 1e3/this.elapsedMS}get minFPS(){return 1e3/this._maxElapsedMS}set minFPS(t){const e=Math.min(this.maxFPS,t),s=Math.min(Math.max(0,e)/1e3,fs.targetFPMS);this._maxElapsedMS=1/s}get maxFPS(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0}set maxFPS(t){if(t===0)this._minElapsedMS=0;else{const e=Math.max(this.minFPS,t);this._minElapsedMS=1/(e/1e3)}}static get shared(){if(!fs._shared){const t=fs._shared=new fs;t.autoStart=!0,t._protected=!0}return fs._shared}static get system(){if(!fs._system){const t=fs._system=new fs;t.autoStart=!0,t._protected=!0}return fs._system}};pp.targetFPMS=.06;let gs=pp;Object.defineProperties(ht,{TARGET_FPMS:{get(){return gs.targetFPMS},set(n){Pt("7.1.0","settings.TARGET_FPMS is deprecated, use Ticker.targetFPMS"),gs.targetFPMS=n}}});class gp{static init(t){t=Object.assign({autoStart:!0,sharedTicker:!1},t),Object.defineProperty(this,"ticker",{set(e){this._ticker&&this._ticker.remove(this.render,this),this._ticker=e,e&&e.add(this.render,this,Ur.LOW)},get(){return this._ticker}}),this.stop=()=>{this._ticker.stop()},this.start=()=>{this._ticker.start()},this._ticker=null,this.ticker=t.sharedTicker?gs.shared:new gs,t.autoStart&&this.start()}static destroy(){if(this._ticker){const t=this._ticker;this.ticker=null,t.destroy()}}}gp.extension=ot.Application;pt.add(gp);const xp=[];pt.handleByList(ot.Renderer,xp);function Vw(n){for(const t of xp)if(t.test(n))return new t(n);throw new Error("Unable to auto-detect a suitable renderer.")}var Uw=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,Xw=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`;const Gw=Uw,bp=Xw;class yp{constructor(t){this.renderer=t}contextChange(t){let e;if(this.renderer.context.webGLVersion===1){const s=t.getParameter(t.FRAMEBUFFER_BINDING);t.bindFramebuffer(t.FRAMEBUFFER,null),e=t.getParameter(t.SAMPLES),t.bindFramebuffer(t.FRAMEBUFFER,s)}else{const s=t.getParameter(t.DRAW_FRAMEBUFFER_BINDING);t.bindFramebuffer(t.DRAW_FRAMEBUFFER,null),e=t.getParameter(t.SAMPLES),t.bindFramebuffer(t.DRAW_FRAMEBUFFER,s)}e>=Ae.HIGH?this.multisample=Ae.HIGH:e>=Ae.MEDIUM?this.multisample=Ae.MEDIUM:e>=Ae.LOW?this.multisample=Ae.LOW:this.multisample=Ae.NONE}destroy(){}}yp.extension={type:ot.RendererSystem,name:"_multisample"};pt.add(yp);class Yw{constructor(t){this.buffer=t||null,this.updateID=-1,this.byteLength=-1,this.refCount=0}}class wp{constructor(t){this.renderer=t,this.managedBuffers={},this.boundBufferBases={}}destroy(){this.renderer=null}contextChange(){this.disposeAll(!0),this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(t){const{gl:e,CONTEXT_UID:s}=this,r=t._glBuffers[s]||this.createGLBuffer(t);e.bindBuffer(t.type,r.buffer)}unbind(t){const{gl:e}=this;e.bindBuffer(t,null)}bindBufferBase(t,e){const{gl:s,CONTEXT_UID:r}=this;if(this.boundBufferBases[e]!==t){const i=t._glBuffers[r]||this.createGLBuffer(t);this.boundBufferBases[e]=t,s.bindBufferBase(s.UNIFORM_BUFFER,e,i.buffer)}}bindBufferRange(t,e,s){const{gl:r,CONTEXT_UID:i}=this;s=s||0;const o=t._glBuffers[i]||this.createGLBuffer(t);r.bindBufferRange(r.UNIFORM_BUFFER,e||0,o.buffer,s*256,256)}update(t){const{gl:e,CONTEXT_UID:s}=this,r=t._glBuffers[s]||this.createGLBuffer(t);if(t._updateID!==r.updateID)if(r.updateID=t._updateID,e.bindBuffer(t.type,r.buffer),r.byteLength>=t.data.byteLength)e.bufferSubData(t.type,0,t.data);else{const i=t.static?e.STATIC_DRAW:e.DYNAMIC_DRAW;r.byteLength=t.data.byteLength,e.bufferData(t.type,t.data,i)}}dispose(t,e){if(!this.managedBuffers[t.id])return;delete this.managedBuffers[t.id];const s=t._glBuffers[this.CONTEXT_UID],r=this.gl;t.disposeRunner.remove(this),s&&(e||r.deleteBuffer(s.buffer),delete t._glBuffers[this.CONTEXT_UID])}disposeAll(t){const e=Object.keys(this.managedBuffers);for(let s=0;s<e.length;s++)this.dispose(this.managedBuffers[e[s]],t)}createGLBuffer(t){const{CONTEXT_UID:e,gl:s}=this;return t._glBuffers[e]=new Yw(s.createBuffer()),this.managedBuffers[t.id]=t,t.disposeRunner.add(this),t._glBuffers[e]}}wp.extension={type:ot.RendererSystem,name:"buffer"};pt.add(wp);class vp{constructor(t){this.renderer=t}render(t,e){const s=this.renderer;let r,i,o,l;if(e&&(r=e.renderTexture,i=e.clear,o=e.transform,l=e.skipUpdateTransform),this.renderingToScreen=!r,s.runners.prerender.emit(),s.emit("prerender"),s.projection.transform=o,!s.context.isLost){if(r||(this.lastObjectRendered=t),!l){const a=t.enableTempParent();t.updateTransform(),t.disableTempParent(a)}s.renderTexture.bind(r),s.batch.currentRenderer.start(),(i??s.background.clearBeforeRender)&&s.renderTexture.clear(),t.render(s),s.batch.currentRenderer.flush(),r&&(e.blit&&s.framebuffer.blit(),r.baseTexture.update()),s.runners.postrender.emit(),s.projection.transform=null,s.emit("postrender")}}destroy(){this.renderer=null,this.lastObjectRendered=null}}vp.extension={type:ot.RendererSystem,name:"objectRenderer"};pt.add(vp);const eo=class Ic extends Lw{constructor(t){super(),this.type=Rm.WEBGL,t=Object.assign({},ht.RENDER_OPTIONS,t),this.gl=null,this.CONTEXT_UID=0,this.globalUniforms=new Hs({projectionMatrix:new Zt},!0);const e={runners:["init","destroy","contextChange","resolutionChange","reset","update","postrender","prerender","resize"],systems:Ic.__systems,priority:["_view","textureGenerator","background","_plugin","startup","context","state","texture","buffer","geometry","framebuffer","transformFeedback","mask","scissor","stencil","projection","textureGC","filter","renderTexture","batch","objectRenderer","_multisample"]};this.setup(e),"useContextAlpha"in t&&(Pt("7.0.0","options.useContextAlpha is deprecated, use options.premultipliedAlpha and options.backgroundAlpha instead"),t.premultipliedAlpha=t.useContextAlpha&&t.useContextAlpha!=="notMultiplied",t.backgroundAlpha=t.useContextAlpha===!1?1:t.backgroundAlpha),this._plugin.rendererPlugins=Ic.__plugins,this.options=t,this.startup.run(this.options)}static test(t){return t!=null&&t.forceCanvas?!1:f1()}render(t,e){this.objectRenderer.render(t,e)}resize(t,e){this._view.resizeView(t,e)}reset(){return this.runners.reset.emit(),this}clear(){this.renderTexture.bind(),this.renderTexture.clear()}destroy(t=!1){this.runners.destroy.items.reverse(),this.emitWithCustomOptions(this.runners.destroy,{_view:t}),super.destroy()}get plugins(){return this._plugin.plugins}get multisample(){return this._multisample.multisample}get width(){return this._view.element.width}get height(){return this._view.element.height}get resolution(){return this._view.resolution}set resolution(t){this._view.resolution=t,this.runners.resolutionChange.emit(t)}get autoDensity(){return this._view.autoDensity}get view(){return this._view.element}get screen(){return this._view.screen}get lastObjectRendered(){return this.objectRenderer.lastObjectRendered}get renderingToScreen(){return this.objectRenderer.renderingToScreen}get rendererLogId(){return`WebGL ${this.context.webGLVersion}`}get clearBeforeRender(){return Pt("7.0.0","renderer.clearBeforeRender has been deprecated, please use renderer.background.clearBeforeRender instead."),this.background.clearBeforeRender}get useContextAlpha(){return Pt("7.0.0","renderer.useContextAlpha has been deprecated, please use renderer.context.premultipliedAlpha instead."),this.context.useContextAlpha}get preserveDrawingBuffer(){return Pt("7.0.0","renderer.preserveDrawingBuffer has been deprecated, we cannot truly know this unless pixi created the context"),this.context.preserveDrawingBuffer}get backgroundColor(){return Pt("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color}set backgroundColor(t){Pt("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color=t}get backgroundAlpha(){return Pt("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha}set backgroundAlpha(t){Pt("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha=t}get powerPreference(){return Pt("7.0.0","renderer.powerPreference has been deprecated, we can only know this if pixi creates the context"),this.context.powerPreference}generateTexture(t,e){return this.textureGenerator.generateTexture(t,e)}};eo.extension={type:ot.Renderer,priority:1},eo.__plugins={},eo.__systems={};let Nh=eo;pt.handleByMap(ot.RendererPlugin,Nh.__plugins);pt.handleByMap(ot.RendererSystem,Nh.__systems);pt.add(Nh);class _p extends aa{constructor(t,e){const{width:s,height:r}=e||{};super(s,r),this.items=[],this.itemDirtyIds=[];for(let i=0;i<t;i++){const o=new _t;this.items.push(o),this.itemDirtyIds.push(-2)}this.length=t,this._load=null,this.baseTexture=null}initFromArray(t,e){for(let s=0;s<this.length;s++)t[s]&&(t[s].castToBaseTexture?this.addBaseTextureAt(t[s].castToBaseTexture(),s):t[s]instanceof aa?this.addResourceAt(t[s],s):this.addResourceAt(Um(t[s],e),s))}dispose(){for(let t=0,e=this.length;t<e;t++)this.items[t].destroy();this.items=null,this.itemDirtyIds=null,this._load=null}addResourceAt(t,e){if(!this.items[e])throw new Error(`Index ${e} is out of bounds`);return t.valid&&!this.valid&&this.resize(t.width,t.height),this.items[e].setResource(t),this}bind(t){if(this.baseTexture!==null)throw new Error("Only one base texture per TextureArray is allowed");super.bind(t);for(let e=0;e<this.length;e++)this.items[e].parentTextureArray=t,this.items[e].on("update",t.update,t)}unbind(t){super.unbind(t);for(let e=0;e<this.length;e++)this.items[e].parentTextureArray=null,this.items[e].off("update",t.update,t)}load(){if(this._load)return this._load;const t=this.items.map(e=>e.resource).filter(e=>e).map(e=>e.load());return this._load=Promise.all(t).then(()=>{const{realWidth:e,realHeight:s}=this.items[0];return this.resize(e,s),this.update(),Promise.resolve(this)}),this._load}}class $w extends _p{constructor(t,e){const{width:s,height:r}=e||{};let i,o;Array.isArray(t)?(i=t,o=t.length):o=t,super(o,{width:s,height:r}),i&&this.initFromArray(i,e)}addBaseTextureAt(t,e){if(t.resource)this.addResourceAt(t.resource,e);else throw new Error("ArrayResource does not support RenderTexture");return this}bind(t){super.bind(t),t.target=hi.TEXTURE_2D_ARRAY}upload(t,e,s){const{length:r,itemDirtyIds:i,items:o}=this,{gl:l}=t;s.dirtyId<0&&l.texImage3D(l.TEXTURE_2D_ARRAY,0,s.internalFormat,this._width,this._height,r,0,e.format,s.type,null);for(let a=0;a<r;a++){const c=o[a];i[a]<c.dirtyId&&(i[a]=c.dirtyId,c.valid&&l.texSubImage3D(l.TEXTURE_2D_ARRAY,0,0,0,a,c.resource.width,c.resource.height,1,e.format,s.type,c.resource.source))}return!0}}class Ww extends Bn{constructor(t){super(t)}static test(t){const{OffscreenCanvas:e}=globalThis;return e&&t instanceof e?!0:globalThis.HTMLCanvasElement&&t instanceof HTMLCanvasElement}}const Ep=class Xi extends _p{constructor(t,e){const{width:s,height:r,autoLoad:i,linkBaseTexture:o}=e||{};if(t&&t.length!==Xi.SIDES)throw new Error(`Invalid length. Got ${t.length}, expected 6`);super(6,{width:s,height:r});for(let l=0;l<Xi.SIDES;l++)this.items[l].target=hi.TEXTURE_CUBE_MAP_POSITIVE_X+l;this.linkBaseTexture=o!==!1,t&&this.initFromArray(t,e),i!==!1&&this.load()}bind(t){super.bind(t),t.target=hi.TEXTURE_CUBE_MAP}addBaseTextureAt(t,e,s){if(s===void 0&&(s=this.linkBaseTexture),!this.items[e])throw new Error(`Index ${e} is out of bounds`);if(!this.linkBaseTexture||t.parentTextureArray||Object.keys(t._glTextures).length>0)if(t.resource)this.addResourceAt(t.resource,e);else throw new Error("CubeResource does not support copying of renderTexture.");else t.target=hi.TEXTURE_CUBE_MAP_POSITIVE_X+e,t.parentTextureArray=this.baseTexture,this.items[e]=t;return t.valid&&!this.valid&&this.resize(t.realWidth,t.realHeight),this.items[e]=t,this}upload(t,e,s){const r=this.itemDirtyIds;for(let i=0;i<Xi.SIDES;i++){const o=this.items[i];(r[i]<o.dirtyId||s.dirtyId<e.dirtyId)&&(o.valid&&o.resource?(o.resource.upload(t,o,s),r[i]=o.dirtyId):r[i]<-1&&(t.gl.texImage2D(o.target,0,s.internalFormat,e.realWidth,e.realHeight,0,e.format,s.type,null),r[i]=-1))}return!0}static test(t){return Array.isArray(t)&&t.length===Xi.SIDES}};Ep.SIDES=6;let zw=Ep;class ci extends Bn{constructor(t,e){e=e||{};let s,r,i;typeof t=="string"?(s=ci.EMPTY,r=t,i=!0):(s=t,r=null,i=!1),super(s),this.url=r,this.crossOrigin=e.crossOrigin??!0,this.alphaMode=typeof e.alphaMode=="number"?e.alphaMode:null,this.ownsImageBitmap=e.ownsImageBitmap??i,this._load=null,e.autoLoad!==!1&&this.load()}load(){return this._load?this._load:(this._load=new Promise(async(t,e)=>{if(this.url===null){t(this);return}try{const s=await ht.ADAPTER.fetch(this.url,{mode:this.crossOrigin?"cors":"no-cors"});if(this.destroyed)return;const r=await s.blob();if(this.destroyed)return;const i=await createImageBitmap(r,{premultiplyAlpha:this.alphaMode===null||this.alphaMode===Qe.UNPACK?"premultiply":"none"});if(this.destroyed){i.close();return}this.source=i,this.update(),t(this)}catch(s){if(this.destroyed)return;e(s),this.onError.emit(s)}}),this._load)}upload(t,e,s){return this.source instanceof ImageBitmap?(typeof this.alphaMode=="number"&&(e.alphaMode=this.alphaMode),super.upload(t,e,s)):(this.load(),!1)}dispose(){this.ownsImageBitmap&&this.source instanceof ImageBitmap&&this.source.close(),super.dispose(),this._load=null}static test(t){return!!globalThis.createImageBitmap&&typeof ImageBitmap<"u"&&(typeof t=="string"||t instanceof ImageBitmap)}static get EMPTY(){return ci._EMPTY=ci._EMPTY??ht.ADAPTER.createCanvas(0,0),ci._EMPTY}}const Rc=class so extends Bn{constructor(t,e){e=e||{},super(ht.ADAPTER.createCanvas()),this._width=0,this._height=0,this.svg=t,this.scale=e.scale||1,this._overrideWidth=e.width,this._overrideHeight=e.height,this._resolve=null,this._crossorigin=e.crossorigin,this._load=null,e.autoLoad!==!1&&this.load()}load(){return this._load?this._load:(this._load=new Promise(t=>{if(this._resolve=()=>{this.update(),t(this)},so.SVG_XML.test(this.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");this.svg=`data:image/svg+xml;base64,${btoa(unescape(encodeURIComponent(this.svg)))}`}this._loadSvg()}),this._load)}_loadSvg(){const t=new Image;Bn.crossOrigin(t,this.svg,this._crossorigin),t.src=this.svg,t.onerror=e=>{this._resolve&&(t.onerror=null,this.onError.emit(e))},t.onload=()=>{if(!this._resolve)return;const e=t.width,s=t.height;if(!e||!s)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");let r=e*this.scale,i=s*this.scale;(this._overrideWidth||this._overrideHeight)&&(r=this._overrideWidth||this._overrideHeight/s*e,i=this._overrideHeight||this._overrideWidth/e*s),r=Math.round(r),i=Math.round(i);const o=this.source;o.width=r,o.height=i,o._pixiId=`canvas_${Vr()}`,o.getContext("2d").drawImage(t,0,0,e,s,0,0,r,i),this._resolve(),this._resolve=null}}static getSize(t){const e=so.SVG_SIZE.exec(t),s={};return e&&(s[e[1]]=Math.round(parseFloat(e[3])),s[e[5]]=Math.round(parseFloat(e[7]))),s}dispose(){super.dispose(),this._resolve=null,this._crossorigin=null}static test(t,e){return e==="svg"||typeof t=="string"&&t.startsWith("data:image/svg+xml")||typeof t=="string"&&so.SVG_XML.test(t)}};Rc.SVG_XML=/^(<\?xml[^?]+\?>)?\s*(<!--[^(-->)]*-->)?\s*\<svg/m,Rc.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i;let Mc=Rc;class Hw extends Bn{constructor(t){super(t)}static test(t){return!!globalThis.VideoFrame&&t instanceof globalThis.VideoFrame}}const Pc=class Nc extends Bn{constructor(t,e){if(e=e||{},!(t instanceof HTMLVideoElement)){const s=document.createElement("video");e.autoLoad!==!1&&s.setAttribute("preload","auto"),e.playsinline!==!1&&(s.setAttribute("webkit-playsinline",""),s.setAttribute("playsinline","")),e.muted===!0&&(s.setAttribute("muted",""),s.muted=!0),e.loop===!0&&s.setAttribute("loop",""),e.autoPlay!==!1&&s.setAttribute("autoplay",""),typeof t=="string"&&(t=[t]);const r=t[0].src||t[0];Bn.crossOrigin(s,r,e.crossorigin);for(let i=0;i<t.length;++i){const o=document.createElement("source");let{src:l,mime:a}=t[i];if(l=l||t[i],l.startsWith("data:"))a=l.slice(5,l.indexOf(";"));else if(!l.startsWith("blob:")){const c=l.split("?").shift().toLowerCase(),h=c.slice(c.lastIndexOf(".")+1);a=a||Nc.MIME_TYPES[h]||`video/${h}`}o.src=l,a&&(o.type=a),s.appendChild(o)}t=s}super(t),this.noSubImage=!0,this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=e.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=e.autoPlay!==!1,this._videoFrameRequestCallback=this._videoFrameRequestCallback.bind(this),this._videoFrameRequestCallbackHandle=null,this._load=null,this._resolve=null,this._reject=null,this._onCanPlay=this._onCanPlay.bind(this),this._onError=this._onError.bind(this),this._onPlayStart=this._onPlayStart.bind(this),this._onPlayStop=this._onPlayStop.bind(this),this._onSeeked=this._onSeeked.bind(this),e.autoLoad!==!1&&this.load()}update(t=0){if(!this.destroyed){if(this._updateFPS){const e=gs.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-e)}(!this._updateFPS||this._msToNextUpdate<=0)&&(super.update(),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}}_videoFrameRequestCallback(){this.update(),this.destroyed?this._videoFrameRequestCallbackHandle=null:this._videoFrameRequestCallbackHandle=this.source.requestVideoFrameCallback(this._videoFrameRequestCallback)}load(){if(this._load)return this._load;const t=this.source;return(t.readyState===t.HAVE_ENOUGH_DATA||t.readyState===t.HAVE_FUTURE_DATA)&&t.width&&t.height&&(t.complete=!0),t.addEventListener("play",this._onPlayStart),t.addEventListener("pause",this._onPlayStop),t.addEventListener("seeked",this._onSeeked),this._isSourceReady()?this._onCanPlay():(t.addEventListener("canplay",this._onCanPlay),t.addEventListener("canplaythrough",this._onCanPlay),t.addEventListener("error",this._onError,!0)),this._load=new Promise((e,s)=>{this.valid?e(this):(this._resolve=e,this._reject=s,t.load())}),this._load}_onError(t){this.source.removeEventListener("error",this._onError,!0),this.onError.emit(t),this._reject&&(this._reject(t),this._reject=null,this._resolve=null)}_isSourcePlaying(){const t=this.source;return!t.paused&&!t.ended}_isSourceReady(){return this.source.readyState>2}_onPlayStart(){this.valid||this._onCanPlay(),this._configureAutoUpdate()}_onPlayStop(){this._configureAutoUpdate()}_onSeeked(){this._autoUpdate&&!this._isSourcePlaying()&&(this._msToNextUpdate=0,this.update(),this._msToNextUpdate=0)}_onCanPlay(){const t=this.source;t.removeEventListener("canplay",this._onCanPlay),t.removeEventListener("canplaythrough",this._onCanPlay);const e=this.valid;this._msToNextUpdate=0,this.update(),this._msToNextUpdate=0,!e&&this._resolve&&(this._resolve(this),this._resolve=null,this._reject=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&t.play()}dispose(){this._configureAutoUpdate();const t=this.source;t&&(t.removeEventListener("play",this._onPlayStart),t.removeEventListener("pause",this._onPlayStop),t.removeEventListener("seeked",this._onSeeked),t.removeEventListener("canplay",this._onCanPlay),t.removeEventListener("canplaythrough",this._onCanPlay),t.removeEventListener("error",this._onError,!0),t.pause(),t.src="",t.load()),super.dispose()}get autoUpdate(){return this._autoUpdate}set autoUpdate(t){t!==this._autoUpdate&&(this._autoUpdate=t,this._configureAutoUpdate())}get updateFPS(){return this._updateFPS}set updateFPS(t){t!==this._updateFPS&&(this._updateFPS=t,this._configureAutoUpdate())}_configureAutoUpdate(){this._autoUpdate&&this._isSourcePlaying()?!this._updateFPS&&this.source.requestVideoFrameCallback?(this._isConnectedToTicker&&(gs.shared.remove(this.update,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0),this._videoFrameRequestCallbackHandle===null&&(this._videoFrameRequestCallbackHandle=this.source.requestVideoFrameCallback(this._videoFrameRequestCallback))):(this._videoFrameRequestCallbackHandle!==null&&(this.source.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker||(gs.shared.add(this.update,this),this._isConnectedToTicker=!0,this._msToNextUpdate=0)):(this._videoFrameRequestCallbackHandle!==null&&(this.source.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker&&(gs.shared.remove(this.update,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0))}static test(t,e){return globalThis.HTMLVideoElement&&t instanceof HTMLVideoElement||Nc.TYPES.includes(e)}};Pc.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"],Pc.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"};let Sp=Pc;yc.push(ci,Km,Ww,Sp,Hw,Mc,jo,zw,$w);const qw={vec3(n,t,e,s){(e[0]!==s[0]||e[1]!==s[1]||e[2]!==s[2])&&(e[0]=s[0],e[1]=s[1],e[2]=s[2],n.uniform3f(t,s[0],s[1],s[2]))},int(n,t,e,s){n.uniform1i(t,s)},ivec2(n,t,e,s){n.uniform2i(t,s[0],s[1])},ivec3(n,t,e,s){n.uniform3i(t,s[0],s[1],s[2])},ivec4(n,t,e,s){n.uniform4i(t,s[0],s[1],s[2],s[3])},uint(n,t,e,s){n.uniform1ui(t,s)},uvec2(n,t,e,s){n.uniform2ui(t,s[0],s[1])},uvec3(n,t,e,s){n.uniform3ui(t,s[0],s[1],s[2])},uvec4(n,t,e,s){n.uniform4ui(t,s[0],s[1],s[2],s[3])},bvec2(n,t,e,s){n.uniform2i(t,s[0],s[1])},bvec3(n,t,e,s){n.uniform3i(t,s[0],s[1],s[2])},bvec4(n,t,e,s){n.uniform4i(t,s[0],s[1],s[2],s[3])},mat2(n,t,e,s){n.uniformMatrix2fv(t,!1,s)},mat4(n,t,e,s){n.uniformMatrix4fv(t,!1,s)}},Kw={float(n,t,e,s){n.uniform1fv(t,s)},vec2(n,t,e,s){n.uniform2fv(t,s)},vec3(n,t,e,s){n.uniform3fv(t,s)},vec4(n,t,e,s){n.uniform4fv(t,s)},int(n,t,e,s){n.uniform1iv(t,s)},ivec2(n,t,e,s){n.uniform2iv(t,s)},ivec3(n,t,e,s){n.uniform3iv(t,s)},ivec4(n,t,e,s){n.uniform4iv(t,s)},uint(n,t,e,s){n.uniform1uiv(t,s)},uvec2(n,t,e,s){n.uniform2uiv(t,s)},uvec3(n,t,e,s){n.uniform3uiv(t,s)},uvec4(n,t,e,s){n.uniform4uiv(t,s)},bool(n,t,e,s){n.uniform1iv(t,s)},bvec2(n,t,e,s){n.uniform2iv(t,s)},bvec3(n,t,e,s){n.uniform3iv(t,s)},bvec4(n,t,e,s){n.uniform4iv(t,s)},sampler2D(n,t,e,s){n.uniform1iv(t,s)},samplerCube(n,t,e,s){n.uniform1iv(t,s)},sampler2DArray(n,t,e,s){n.uniform1iv(t,s)}};function Zw(n,t,e,s,r){let i=0,o=null,l=null;const a=r.gl;for(const c in n.uniforms){const h=t[c],d=s[c],u=e[c],f=n.uniforms[c];if(!h){f.group===!0&&r.shader.syncUniformGroup(d);continue}h.type==="float"&&h.size===1&&!h.isArray?d!==u.value&&(u.value=d,a.uniform1f(u.location,d)):h.type==="bool"&&h.size===1&&!h.isArray?d!==u.value&&(u.value=d,a.uniform1i(u.location,Number(d))):(h.type==="sampler2D"||h.type==="samplerCube"||h.type==="sampler2DArray")&&h.size===1&&!h.isArray?(r.texture.bind(d,i),u.value!==i&&(u.value=i,a.uniform1i(u.location,i)),i++):h.type==="mat3"&&h.size===1&&!h.isArray?f.a!==void 0?a.uniformMatrix3fv(u.location,!1,d.toArray(!0)):a.uniformMatrix3fv(u.location,!1,d):h.type==="vec2"&&h.size===1&&!h.isArray?f.x!==void 0?(l=u.value,o=d,(l[0]!==o.x||l[1]!==o.y)&&(l[0]=o.x,l[1]=o.y,a.uniform2f(u.location,o.x,o.y))):(l=u.value,o=d,(l[0]!==o[0]||l[1]!==o[1])&&(l[0]=o[0],l[1]=o[1],a.uniform2f(u.location,o[0],o[1]))):h.type==="vec4"&&h.size===1&&!h.isArray?f.width!==void 0?(l=u.value,o=d,(l[0]!==o.x||l[1]!==o.y||l[2]!==o.width||l[3]!==o.height)&&(l[0]=o.x,l[1]=o.y,l[2]=o.width,l[3]=o.height,a.uniform4f(u.location,o.x,o.y,o.width,o.height))):(l=u.value,o=d,(l[0]!==o[0]||l[1]!==o[1]||l[2]!==o[2]||l[3]!==o[3])&&(l[0]=o[0],l[1]=o[1],l[2]=o[2],l[3]=o[3],a.uniform4f(u.location,o[0],o[1],o[2],o[3]))):(h.size===1&&!h.isArray?qw:Kw)[h.type].call(null,a,u.location,u.value,d)}}function Qw(){Object.assign(Ph.prototype,{systemCheck(){},syncUniforms(n,t){const{shader:e,renderer:s}=this;Zw(n,e.program.uniformData,t.uniformData,n.uniforms,s)}})}Qw();class bo{constructor(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null,this.updateID=-1}isEmpty(){return this.minX>this.maxX||this.minY>this.maxY}clear(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0}getRectangle(t){return this.minX>this.maxX||this.minY>this.maxY?vt.EMPTY:(t=t||new vt(0,0,1,1),t.x=this.minX,t.y=this.minY,t.width=this.maxX-this.minX,t.height=this.maxY-this.minY,t)}addPoint(t){this.minX=Math.min(this.minX,t.x),this.maxX=Math.max(this.maxX,t.x),this.minY=Math.min(this.minY,t.y),this.maxY=Math.max(this.maxY,t.y)}addPointMatrix(t,e){const{a:s,b:r,c:i,d:o,tx:l,ty:a}=t,c=s*e.x+i*e.y+l,h=r*e.x+o*e.y+a;this.minX=Math.min(this.minX,c),this.maxX=Math.max(this.maxX,c),this.minY=Math.min(this.minY,h),this.maxY=Math.max(this.maxY,h)}addQuad(t){let e=this.minX,s=this.minY,r=this.maxX,i=this.maxY,o=t[0],l=t[1];e=o<e?o:e,s=l<s?l:s,r=o>r?o:r,i=l>i?l:i,o=t[2],l=t[3],e=o<e?o:e,s=l<s?l:s,r=o>r?o:r,i=l>i?l:i,o=t[4],l=t[5],e=o<e?o:e,s=l<s?l:s,r=o>r?o:r,i=l>i?l:i,o=t[6],l=t[7],e=o<e?o:e,s=l<s?l:s,r=o>r?o:r,i=l>i?l:i,this.minX=e,this.minY=s,this.maxX=r,this.maxY=i}addFrame(t,e,s,r,i){this.addFrameMatrix(t.worldTransform,e,s,r,i)}addFrameMatrix(t,e,s,r,i){const o=t.a,l=t.b,a=t.c,c=t.d,h=t.tx,d=t.ty;let u=this.minX,f=this.minY,m=this.maxX,p=this.maxY,g=o*e+a*s+h,w=l*e+c*s+d;u=g<u?g:u,f=w<f?w:f,m=g>m?g:m,p=w>p?w:p,g=o*r+a*s+h,w=l*r+c*s+d,u=g<u?g:u,f=w<f?w:f,m=g>m?g:m,p=w>p?w:p,g=o*e+a*i+h,w=l*e+c*i+d,u=g<u?g:u,f=w<f?w:f,m=g>m?g:m,p=w>p?w:p,g=o*r+a*i+h,w=l*r+c*i+d,u=g<u?g:u,f=w<f?w:f,m=g>m?g:m,p=w>p?w:p,this.minX=u,this.minY=f,this.maxX=m,this.maxY=p}addVertexData(t,e,s){let r=this.minX,i=this.minY,o=this.maxX,l=this.maxY;for(let a=e;a<s;a+=2){const c=t[a],h=t[a+1];r=c<r?c:r,i=h<i?h:i,o=c>o?c:o,l=h>l?h:l}this.minX=r,this.minY=i,this.maxX=o,this.maxY=l}addVertices(t,e,s,r){this.addVerticesMatrix(t.worldTransform,e,s,r)}addVerticesMatrix(t,e,s,r,i=0,o=i){const l=t.a,a=t.b,c=t.c,h=t.d,d=t.tx,u=t.ty;let f=this.minX,m=this.minY,p=this.maxX,g=this.maxY;for(let w=s;w<r;w+=2){const x=e[w],y=e[w+1],b=l*x+c*y+d,_=h*y+a*x+u;f=Math.min(f,b-i),p=Math.max(p,b+i),m=Math.min(m,_-o),g=Math.max(g,_+o)}this.minX=f,this.minY=m,this.maxX=p,this.maxY=g}addBounds(t){const e=this.minX,s=this.minY,r=this.maxX,i=this.maxY;this.minX=t.minX<e?t.minX:e,this.minY=t.minY<s?t.minY:s,this.maxX=t.maxX>r?t.maxX:r,this.maxY=t.maxY>i?t.maxY:i}addBoundsMask(t,e){const s=t.minX>e.minX?t.minX:e.minX,r=t.minY>e.minY?t.minY:e.minY,i=t.maxX<e.maxX?t.maxX:e.maxX,o=t.maxY<e.maxY?t.maxY:e.maxY;if(s<=i&&r<=o){const l=this.minX,a=this.minY,c=this.maxX,h=this.maxY;this.minX=s<l?s:l,this.minY=r<a?r:a,this.maxX=i>c?i:c,this.maxY=o>h?o:h}}addBoundsMatrix(t,e){this.addFrameMatrix(e,t.minX,t.minY,t.maxX,t.maxY)}addBoundsArea(t,e){const s=t.minX>e.x?t.minX:e.x,r=t.minY>e.y?t.minY:e.y,i=t.maxX<e.x+e.width?t.maxX:e.x+e.width,o=t.maxY<e.y+e.height?t.maxY:e.y+e.height;if(s<=i&&r<=o){const l=this.minX,a=this.minY,c=this.maxX,h=this.maxY;this.minX=s<l?s:l,this.minY=r<a?r:a,this.maxX=i>c?i:c,this.maxY=o>h?o:h}}pad(t=0,e=t){this.isEmpty()||(this.minX-=t,this.maxX+=t,this.minY-=e,this.maxY+=e)}addFramePad(t,e,s,r,i,o){t-=i,e-=o,s+=i,r+=o,this.minX=this.minX<t?this.minX:t,this.maxX=this.maxX>s?this.maxX:s,this.minY=this.minY<e?this.minY:e,this.maxY=this.maxY>r?this.maxY:r}}class pe extends ma{constructor(){super(),this.tempDisplayObjectParent=null,this.transform=new Go,this.alpha=1,this.visible=!0,this.renderable=!0,this.cullable=!1,this.cullArea=null,this.parent=null,this.worldAlpha=1,this._lastSortedIndex=0,this._zIndex=0,this.filterArea=null,this.filters=null,this._enabledFilters=null,this._bounds=new bo,this._localBounds=null,this._boundsID=0,this._boundsRect=null,this._localBoundsRect=null,this._mask=null,this._maskRefCount=0,this._destroyed=!1,this.isSprite=!1,this.isMask=!1}static mixin(t){const e=Object.keys(t);for(let s=0;s<e.length;++s){const r=e[s];Object.defineProperty(pe.prototype,r,Object.getOwnPropertyDescriptor(t,r))}}get destroyed(){return this._destroyed}_recursivePostUpdateTransform(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)}updateTransform(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha}getBounds(t,e){return t||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._bounds.updateID!==this._boundsID&&(this.calculateBounds(),this._bounds.updateID=this._boundsID),e||(this._boundsRect||(this._boundsRect=new vt),e=this._boundsRect),this._bounds.getRectangle(e)}getLocalBounds(t){t||(this._localBoundsRect||(this._localBoundsRect=new vt),t=this._localBoundsRect),this._localBounds||(this._localBounds=new bo);const e=this.transform,s=this.parent;this.parent=null,this._tempDisplayObjectParent.worldAlpha=(s==null?void 0:s.worldAlpha)??1,this.transform=this._tempDisplayObjectParent.transform;const r=this._bounds,i=this._boundsID;this._bounds=this._localBounds;const o=this.getBounds(!1,t);return this.parent=s,this.transform=e,this._bounds=r,this._bounds.updateID+=this._boundsID-i,o}toGlobal(t,e,s=!1){return s||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(t,e)}toLocal(t,e,s,r){return e&&(t=e.toGlobal(t,s,r)),r||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(t,s)}setParent(t){if(!t||!t.addChild)throw new Error("setParent: Argument must be a Container");return t.addChild(this),t}removeFromParent(){var t;(t=this.parent)==null||t.removeChild(this)}setTransform(t=0,e=0,s=1,r=1,i=0,o=0,l=0,a=0,c=0){return this.position.x=t,this.position.y=e,this.scale.x=s||1,this.scale.y=r||1,this.rotation=i,this.skew.x=o,this.skew.y=l,this.pivot.x=a,this.pivot.y=c,this}destroy(t){this.removeFromParent(),this._destroyed=!0,this.transform=null,this.parent=null,this._bounds=null,this.mask=null,this.cullArea=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.eventMode="auto",this.interactiveChildren=!1,this.emit("destroyed"),this.removeAllListeners()}get _tempDisplayObjectParent(){return this.tempDisplayObjectParent===null&&(this.tempDisplayObjectParent=new Jw),this.tempDisplayObjectParent}enableTempParent(){const t=this.parent;return this.parent=this._tempDisplayObjectParent,t}disableTempParent(t){this.parent=t}get x(){return this.position.x}set x(t){this.transform.position.x=t}get y(){return this.position.y}set y(t){this.transform.position.y=t}get worldTransform(){return this.transform.worldTransform}get localTransform(){return this.transform.localTransform}get position(){return this.transform.position}set position(t){this.transform.position.copyFrom(t)}get scale(){return this.transform.scale}set scale(t){this.transform.scale.copyFrom(t)}get pivot(){return this.transform.pivot}set pivot(t){this.transform.pivot.copyFrom(t)}get skew(){return this.transform.skew}set skew(t){this.transform.skew.copyFrom(t)}get rotation(){return this.transform.rotation}set rotation(t){this.transform.rotation=t}get angle(){return this.transform.rotation*U1}set angle(t){this.transform.rotation=t*X1}get zIndex(){return this._zIndex}set zIndex(t){this._zIndex!==t&&(this._zIndex=t,this.parent&&(this.parent.sortDirty=!0))}get worldVisible(){let t=this;do{if(!t.visible)return!1;t=t.parent}while(t);return!0}get mask(){return this._mask}set mask(t){if(this._mask!==t){if(this._mask){const e=this._mask.isMaskData?this._mask.maskObject:this._mask;e&&(e._maskRefCount--,e._maskRefCount===0&&(e.renderable=!0,e.isMask=!1))}if(this._mask=t,this._mask){const e=this._mask.isMaskData?this._mask.maskObject:this._mask;e&&(e._maskRefCount===0&&(e.renderable=!1,e.isMask=!0),e._maskRefCount++)}}}}class Jw extends pe{constructor(){super(...arguments),this.sortDirty=null}}pe.prototype.displayObjectUpdateTransform=pe.prototype.updateTransform;const tv=new Zt;function ev(n,t){return n.zIndex===t.zIndex?n._lastSortedIndex-t._lastSortedIndex:n.zIndex-t.zIndex}const Tp=class Fc extends pe{constructor(){super(),this.children=[],this.sortableChildren=Fc.defaultSortableChildren,this.sortDirty=!1}onChildrenChange(t){}addChild(...t){if(t.length>1)for(let e=0;e<t.length;e++)this.addChild(t[e]);else{const e=t[0];e.parent&&e.parent.removeChild(e),e.parent=this,this.sortDirty=!0,e.transform._parentID=-1,this.children.push(e),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",e,this,this.children.length-1),e.emit("added",this)}return t[0]}addChildAt(t,e){if(e<0||e>this.children.length)throw new Error(`${t}addChildAt: The index ${e} supplied is out of bounds ${this.children.length}`);return t.parent&&t.parent.removeChild(t),t.parent=this,this.sortDirty=!0,t.transform._parentID=-1,this.children.splice(e,0,t),this._boundsID++,this.onChildrenChange(e),t.emit("added",this),this.emit("childAdded",t,this,e),t}swapChildren(t,e){if(t===e)return;const s=this.getChildIndex(t),r=this.getChildIndex(e);this.children[s]=e,this.children[r]=t,this.onChildrenChange(s<r?s:r)}getChildIndex(t){const e=this.children.indexOf(t);if(e===-1)throw new Error("The supplied DisplayObject must be a child of the caller");return e}setChildIndex(t,e){if(e<0||e>=this.children.length)throw new Error(`The index ${e} supplied is out of bounds ${this.children.length}`);const s=this.getChildIndex(t);di(this.children,s,1),this.children.splice(e,0,t),this.onChildrenChange(e)}getChildAt(t){if(t<0||t>=this.children.length)throw new Error(`getChildAt: Index (${t}) does not exist.`);return this.children[t]}removeChild(...t){if(t.length>1)for(let e=0;e<t.length;e++)this.removeChild(t[e]);else{const e=t[0],s=this.children.indexOf(e);if(s===-1)return null;e.parent=null,e.transform._parentID=-1,di(this.children,s,1),this._boundsID++,this.onChildrenChange(s),e.emit("removed",this),this.emit("childRemoved",e,this,s)}return t[0]}removeChildAt(t){const e=this.getChildAt(t);return e.parent=null,e.transform._parentID=-1,di(this.children,t,1),this._boundsID++,this.onChildrenChange(t),e.emit("removed",this),this.emit("childRemoved",e,this,t),e}removeChildren(t=0,e=this.children.length){const s=t,r=e,i=r-s;let o;if(i>0&&i<=r){o=this.children.splice(s,i);for(let l=0;l<o.length;++l)o[l].parent=null,o[l].transform&&(o[l].transform._parentID=-1);this._boundsID++,this.onChildrenChange(t);for(let l=0;l<o.length;++l)o[l].emit("removed",this),this.emit("childRemoved",o[l],this,l);return o}else if(i===0&&this.children.length===0)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")}sortChildren(){let t=!1;for(let e=0,s=this.children.length;e<s;++e){const r=this.children[e];r._lastSortedIndex=e,!t&&r.zIndex!==0&&(t=!0)}t&&this.children.length>1&&this.children.sort(ev),this.sortDirty=!1}updateTransform(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(let t=0,e=this.children.length;t<e;++t){const s=this.children[t];s.visible&&s.updateTransform()}}calculateBounds(){this._bounds.clear(),this._calculateBounds();for(let t=0;t<this.children.length;t++){const e=this.children[t];if(!(!e.visible||!e.renderable))if(e.calculateBounds(),e._mask){const s=e._mask.isMaskData?e._mask.maskObject:e._mask;s?(s.calculateBounds(),this._bounds.addBoundsMask(e._bounds,s._bounds)):this._bounds.addBounds(e._bounds)}else e.filterArea?this._bounds.addBoundsArea(e._bounds,e.filterArea):this._bounds.addBounds(e._bounds)}this._bounds.updateID=this._boundsID}getLocalBounds(t,e=!1){const s=super.getLocalBounds(t);if(!e)for(let r=0,i=this.children.length;r<i;++r){const o=this.children[r];o.visible&&o.updateTransform()}return s}_calculateBounds(){}_renderWithCulling(t){const e=t.renderTexture.sourceFrame;if(!(e.width>0&&e.height>0))return;let s,r;this.cullArea?(s=this.cullArea,r=this.worldTransform):this._render!==Fc.prototype._render&&(s=this.getBounds(!0));const i=t.projection.transform;if(i&&(r?(r=tv.copyFrom(r),r.prepend(i)):r=i),s&&e.intersects(s,r))this._render(t);else if(this.cullArea)return;for(let o=0,l=this.children.length;o<l;++o){const a=this.children[o],c=a.cullable;a.cullable=c||!this.cullArea,a.render(t),a.cullable=c}}render(t){var e;if(!(!this.visible||this.worldAlpha<=0||!this.renderable))if(this._mask||(e=this.filters)!=null&&e.length)this.renderAdvanced(t);else if(this.cullable)this._renderWithCulling(t);else{this._render(t);for(let s=0,r=this.children.length;s<r;++s)this.children[s].render(t)}}renderAdvanced(t){var i,o,l;const e=this.filters,s=this._mask;if(e){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(let a=0;a<e.length;a++)e[a].enabled&&this._enabledFilters.push(e[a])}const r=e&&((i=this._enabledFilters)==null?void 0:i.length)||s&&(!s.isMaskData||s.enabled&&(s.autoDetect||s.type!==Ce.NONE));if(r&&t.batch.flush(),e&&((o=this._enabledFilters)!=null&&o.length)&&t.filter.push(this,this._enabledFilters),s&&t.mask.push(this,this._mask),this.cullable)this._renderWithCulling(t);else{this._render(t);for(let a=0,c=this.children.length;a<c;++a)this.children[a].render(t)}r&&t.batch.flush(),s&&t.mask.pop(this),e&&((l=this._enabledFilters)!=null&&l.length)&&t.filter.pop()}_render(t){}destroy(t){super.destroy(),this.sortDirty=!1;const e=typeof t=="boolean"?t:t==null?void 0:t.children,s=this.removeChildren(0,this.children.length);if(e)for(let r=0;r<s.length;++r)s[r].destroy(t)}get width(){return this.scale.x*this.getLocalBounds().width}set width(t){const e=this.getLocalBounds().width;e!==0?this.scale.x=t/e:this.scale.x=1,this._width=t}get height(){return this.scale.y*this.getLocalBounds().height}set height(t){const e=this.getLocalBounds().height;e!==0?this.scale.y=t/e:this.scale.y=1,this._height=t}};Tp.defaultSortableChildren=!1;let ts=Tp;ts.prototype.containerUpdateTransform=ts.prototype.updateTransform;Object.defineProperties(ht,{SORTABLE_CHILDREN:{get(){return ts.defaultSortableChildren},set(n){Pt("7.1.0","settings.SORTABLE_CHILDREN is deprecated, use Container.defaultSortableChildren"),ts.defaultSortableChildren=n}}});const Fi=new Xt,sv=new Uint16Array([0,1,2,0,2,3]);class Wr extends ts{constructor(t){super(),this._anchor=new Mn(this._onAnchorUpdate,this,t?t.defaultAnchor.x:0,t?t.defaultAnchor.y:0),this._texture=null,this._width=0,this._height=0,this._tintColor=new te(16777215),this._tintRGB=null,this.tint=16777215,this.blendMode=dt.NORMAL,this._cachedTint=16777215,this.uvs=null,this.texture=t||mt.EMPTY,this.vertexData=new Float32Array(8),this.vertexTrimmedData=null,this._transformID=-1,this._textureID=-1,this._transformTrimmedID=-1,this._textureTrimmedID=-1,this.indices=sv,this.pluginName="batch",this.isSprite=!0,this._roundPixels=ht.ROUND_PIXELS}_onTextureUpdate(){this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this._width&&(this.scale.x=lr(this.scale.x)*this._width/this._texture.orig.width),this._height&&(this.scale.y=lr(this.scale.y)*this._height/this._texture.orig.height)}_onAnchorUpdate(){this._transformID=-1,this._transformTrimmedID=-1}calculateVertices(){const t=this._texture;if(this._transformID===this.transform._worldID&&this._textureID===t._updateID)return;this._textureID!==t._updateID&&(this.uvs=this._texture._uvs.uvsFloat32),this._transformID=this.transform._worldID,this._textureID=t._updateID;const e=this.transform.worldTransform,s=e.a,r=e.b,i=e.c,o=e.d,l=e.tx,a=e.ty,c=this.vertexData,h=t.trim,d=t.orig,u=this._anchor;let f=0,m=0,p=0,g=0;if(h?(m=h.x-u._x*d.width,f=m+h.width,g=h.y-u._y*d.height,p=g+h.height):(m=-u._x*d.width,f=m+d.width,g=-u._y*d.height,p=g+d.height),c[0]=s*m+i*g+l,c[1]=o*g+r*m+a,c[2]=s*f+i*g+l,c[3]=o*g+r*f+a,c[4]=s*f+i*p+l,c[5]=o*p+r*f+a,c[6]=s*m+i*p+l,c[7]=o*p+r*m+a,this._roundPixels){const w=ht.RESOLUTION;for(let x=0;x<c.length;++x)c[x]=Math.round(c[x]*w)/w}}calculateTrimmedVertices(){if(!this.vertexTrimmedData)this.vertexTrimmedData=new Float32Array(8);else if(this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID)return;this._transformTrimmedID=this.transform._worldID,this._textureTrimmedID=this._texture._updateID;const t=this._texture,e=this.vertexTrimmedData,s=t.orig,r=this._anchor,i=this.transform.worldTransform,o=i.a,l=i.b,a=i.c,c=i.d,h=i.tx,d=i.ty,u=-r._x*s.width,f=u+s.width,m=-r._y*s.height,p=m+s.height;if(e[0]=o*u+a*m+h,e[1]=c*m+l*u+d,e[2]=o*f+a*m+h,e[3]=c*m+l*f+d,e[4]=o*f+a*p+h,e[5]=c*p+l*f+d,e[6]=o*u+a*p+h,e[7]=c*p+l*u+d,this._roundPixels){const g=ht.RESOLUTION;for(let w=0;w<e.length;++w)e[w]=Math.round(e[w]*g)/g}}_render(t){this.calculateVertices(),t.batch.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this)}_calculateBounds(){const t=this._texture.trim,e=this._texture.orig;!t||t.width===e.width&&t.height===e.height?(this.calculateVertices(),this._bounds.addQuad(this.vertexData)):(this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData))}getLocalBounds(t){return this.children.length===0?(this._localBounds||(this._localBounds=new bo),this._localBounds.minX=this._texture.orig.width*-this._anchor._x,this._localBounds.minY=this._texture.orig.height*-this._anchor._y,this._localBounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._localBounds.maxY=this._texture.orig.height*(1-this._anchor._y),t||(this._localBoundsRect||(this._localBoundsRect=new vt),t=this._localBoundsRect),this._localBounds.getRectangle(t)):super.getLocalBounds.call(this,t)}containsPoint(t){this.worldTransform.applyInverse(t,Fi);const e=this._texture.orig.width,s=this._texture.orig.height,r=-e*this.anchor.x;let i=0;return Fi.x>=r&&Fi.x<r+e&&(i=-s*this.anchor.y,Fi.y>=i&&Fi.y<i+s)}destroy(t){if(super.destroy(t),this._texture.off("update",this._onTextureUpdate,this),this._anchor=null,typeof t=="boolean"?t:t==null?void 0:t.texture){const e=typeof t=="boolean"?t:t==null?void 0:t.baseTexture;this._texture.destroy(!!e)}this._texture=null}static from(t,e){const s=t instanceof mt?t:mt.from(t,e);return new Wr(s)}set roundPixels(t){this._roundPixels!==t&&(this._transformID=-1,this._transformTrimmedID=-1),this._roundPixels=t}get roundPixels(){return this._roundPixels}get width(){return Math.abs(this.scale.x)*this._texture.orig.width}set width(t){const e=lr(this.scale.x)||1;this.scale.x=e*t/this._texture.orig.width,this._width=t}get height(){return Math.abs(this.scale.y)*this._texture.orig.height}set height(t){const e=lr(this.scale.y)||1;this.scale.y=e*t/this._texture.orig.height,this._height=t}get anchor(){return this._anchor}set anchor(t){this._anchor.copyFrom(t)}get tint(){return this._tintColor.value}set tint(t){this._tintColor.setValue(t),this._tintRGB=this._tintColor.toLittleEndianNumber()}get tintValue(){return this._tintColor.toNumber()}get texture(){return this._texture}set texture(t){this._texture!==t&&(this._texture&&this._texture.off("update",this._onTextureUpdate,this),this._texture=t||mt.EMPTY,this._cachedTint=16777215,this._textureID=-1,this._textureTrimmedID=-1,t&&(t.baseTexture.valid?this._onTextureUpdate():t.once("update",this._onTextureUpdate,this)))}}const Ap=new Zt;pe.prototype._cacheAsBitmap=!1;pe.prototype._cacheData=null;pe.prototype._cacheAsBitmapResolution=null;pe.prototype._cacheAsBitmapMultisample=null;class nv{constructor(){this.textureCacheId=null,this.originalRender=null,this.originalRenderCanvas=null,this.originalCalculateBounds=null,this.originalGetLocalBounds=null,this.originalUpdateTransform=null,this.originalDestroy=null,this.originalMask=null,this.originalFilterArea=null,this.originalContainsPoint=null,this.sprite=null}}Object.defineProperties(pe.prototype,{cacheAsBitmapResolution:{get(){return this._cacheAsBitmapResolution},set(n){n!==this._cacheAsBitmapResolution&&(this._cacheAsBitmapResolution=n,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmapMultisample:{get(){return this._cacheAsBitmapMultisample},set(n){n!==this._cacheAsBitmapMultisample&&(this._cacheAsBitmapMultisample=n,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmap:{get(){return this._cacheAsBitmap},set(n){if(this._cacheAsBitmap===n)return;this._cacheAsBitmap=n;let t;n?(this._cacheData||(this._cacheData=new nv),t=this._cacheData,t.originalRender=this.render,t.originalRenderCanvas=this.renderCanvas,t.originalUpdateTransform=this.updateTransform,t.originalCalculateBounds=this.calculateBounds,t.originalGetLocalBounds=this.getLocalBounds,t.originalDestroy=this.destroy,t.originalContainsPoint=this.containsPoint,t.originalMask=this._mask,t.originalFilterArea=this.filterArea,this.render=this._renderCached,this.renderCanvas=this._renderCachedCanvas,this.destroy=this._cacheAsBitmapDestroy):(t=this._cacheData,t.sprite&&this._destroyCachedDisplayObject(),this.render=t.originalRender,this.renderCanvas=t.originalRenderCanvas,this.calculateBounds=t.originalCalculateBounds,this.getLocalBounds=t.originalGetLocalBounds,this.destroy=t.originalDestroy,this.updateTransform=t.originalUpdateTransform,this.containsPoint=t.originalContainsPoint,this._mask=t.originalMask,this.filterArea=t.originalFilterArea)}}});pe.prototype._renderCached=function(n){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObject(n),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._render(n))};pe.prototype._initCachedDisplayObject=function(n){var u,f;if((u=this._cacheData)!=null&&u.sprite)return;const t=this.alpha;this.alpha=1,n.batch.flush();const e=this.getLocalBounds(new vt,!0);if((f=this.filters)!=null&&f.length){const m=this.filters[0].padding;e.pad(m)}const s=this.cacheAsBitmapResolution||n.resolution;e.ceil(s),e.width=Math.max(e.width,1/s),e.height=Math.max(e.height,1/s);const r=n.renderTexture.current,i=n.renderTexture.sourceFrame.clone(),o=n.renderTexture.destinationFrame.clone(),l=n.projection.transform,a=$r.create({width:e.width,height:e.height,resolution:s,multisample:this.cacheAsBitmapMultisample??n.multisample}),c=`cacheAsBitmap_${Vr()}`;this._cacheData.textureCacheId=c,_t.addToCache(a.baseTexture,c),mt.addToCache(a,c);const h=this.transform.localTransform.copyTo(Ap).invert().translate(-e.x,-e.y);this.render=this._cacheData.originalRender,n.render(this,{renderTexture:a,clear:!0,transform:h,skipUpdateTransform:!1}),n.framebuffer.blit(),n.projection.transform=l,n.renderTexture.bind(r,i,o),this.render=this._renderCached,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=t;const d=new Wr(a);d.transform.worldTransform=this.transform.worldTransform,d.anchor.x=-(e.x/e.width),d.anchor.y=-(e.y/e.height),d.alpha=t,d._bounds=this._bounds,this._cacheData.sprite=d,this.transform._parentID=-1,this.parent?this.updateTransform():(this.enableTempParent(),this.updateTransform(),this.disableTempParent(null)),this.containsPoint=d.containsPoint.bind(d)};pe.prototype._renderCachedCanvas=function(n){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObjectCanvas(n),this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._renderCanvas(n))};pe.prototype._initCachedDisplayObjectCanvas=function(n){var h;if((h=this._cacheData)!=null&&h.sprite)return;const t=this.getLocalBounds(new vt,!0),e=this.alpha;this.alpha=1;const s=n.canvasContext.activeContext,r=n._projTransform,i=this.cacheAsBitmapResolution||n.resolution;t.ceil(i),t.width=Math.max(t.width,1/i),t.height=Math.max(t.height,1/i);const o=$r.create({width:t.width,height:t.height,resolution:i}),l=`cacheAsBitmap_${Vr()}`;this._cacheData.textureCacheId=l,_t.addToCache(o.baseTexture,l),mt.addToCache(o,l);const a=Ap;this.transform.localTransform.copyTo(a),a.invert(),a.tx-=t.x,a.ty-=t.y,this.renderCanvas=this._cacheData.originalRenderCanvas,n.render(this,{renderTexture:o,clear:!0,transform:a,skipUpdateTransform:!1}),n.canvasContext.activeContext=s,n._projTransform=r,this.renderCanvas=this._renderCachedCanvas,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=e;const c=new Wr(o);c.transform.worldTransform=this.transform.worldTransform,c.anchor.x=-(t.x/t.width),c.anchor.y=-(t.y/t.height),c.alpha=e,c._bounds=this._bounds,this._cacheData.sprite=c,this.transform._parentID=-1,this.parent?this.updateTransform():(this.parent=n._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.containsPoint=c.containsPoint.bind(c)};pe.prototype._calculateCachedBounds=function(){this._bounds.clear(),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite._calculateBounds(),this._bounds.updateID=this._boundsID};pe.prototype._getCachedLocalBounds=function(){return this._cacheData.sprite.getLocalBounds(null)};pe.prototype._destroyCachedDisplayObject=function(){this._cacheData.sprite._texture.destroy(!0),this._cacheData.sprite=null,_t.removeFromCache(this._cacheData.textureCacheId),mt.removeFromCache(this._cacheData.textureCacheId),this._cacheData.textureCacheId=null};pe.prototype._cacheAsBitmapDestroy=function(n){this.cacheAsBitmap=!1,this.destroy(n)};pe.prototype.name=null;ts.prototype.getChildByName=function(n,t){for(let e=0,s=this.children.length;e<s;e++)if(this.children[e].name===n)return this.children[e];if(t)for(let e=0,s=this.children.length;e<s;e++){const r=this.children[e];if(!r.getChildByName)continue;const i=r.getChildByName(n,!0);if(i)return i}return null};pe.prototype.getGlobalPosition=function(n=new Xt,t=!1){return this.parent?this.parent.toGlobal(this.position,n,t):(n.x=this.position.x,n.y=this.position.y),n};var rv=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform float uAlpha;

void main(void)
{
   gl_FragColor = texture2D(uSampler, vTextureCoord) * uAlpha;
}
`;class iv extends Je{constructor(t=1){super(Gw,rv,{uAlpha:1}),this.alpha=t}get alpha(){return this.uniforms.uAlpha}set alpha(t){this.uniforms.uAlpha=t}}const av={5:[.153388,.221461,.250301],7:[.071303,.131514,.189879,.214607],9:[.028532,.067234,.124009,.179044,.20236],11:[.0093,.028002,.065984,.121703,.175713,.198596],13:[.002406,.009255,.027867,.065666,.121117,.174868,.197641],15:[489e-6,.002403,.009246,.02784,.065602,.120999,.174697,.197448]},ov=["varying vec2 vBlurTexCoords[%size%];","uniform sampler2D uSampler;","void main(void)","{","    gl_FragColor = vec4(0.0);","    %blur%","}"].join(`
`);function lv(n){const t=av[n],e=t.length;let s=ov,r="";const i="gl_FragColor += texture2D(uSampler, vBlurTexCoords[%index%]) * %value%;";let o;for(let l=0;l<n;l++){let a=i.replace("%index%",l.toString());o=l,l>=e&&(o=n-l-1),a=a.replace("%value%",t[o].toString()),r+=a,r+=`
`}return s=s.replace("%blur%",r),s=s.replace("%size%",n.toString()),s}const cv=`
    attribute vec2 aVertexPosition;

    uniform mat3 projectionMatrix;

    uniform float strength;

    varying vec2 vBlurTexCoords[%size%];

    uniform vec4 inputSize;
    uniform vec4 outputFrame;

    vec4 filterVertexPosition( void )
    {
        vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

        return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
    }

    vec2 filterTextureCoord( void )
    {
        return aVertexPosition * (outputFrame.zw * inputSize.zw);
    }

    void main(void)
    {
        gl_Position = filterVertexPosition();

        vec2 textureCoord = filterTextureCoord();
        %blur%
    }`;function hv(n,t){const e=Math.ceil(n/2);let s=cv,r="",i;t?i="vBlurTexCoords[%index%] =  textureCoord + vec2(%sampleIndex% * strength, 0.0);":i="vBlurTexCoords[%index%] =  textureCoord + vec2(0.0, %sampleIndex% * strength);";for(let o=0;o<n;o++){let l=i.replace("%index%",o.toString());l=l.replace("%sampleIndex%",`${o-(e-1)}.0`),r+=l,r+=`
`}return s=s.replace("%blur%",r),s=s.replace("%size%",n.toString()),s}class Dc extends Je{constructor(t,e=8,s=4,r=Je.defaultResolution,i=5){const o=hv(i,t),l=lv(i);super(o,l),this.horizontal=t,this.resolution=r,this._quality=0,this.quality=s,this.blur=e}apply(t,e,s,r){if(s?this.horizontal?this.uniforms.strength=1/s.width*(s.width/e.width):this.uniforms.strength=1/s.height*(s.height/e.height):this.horizontal?this.uniforms.strength=1/t.renderer.width*(t.renderer.width/e.width):this.uniforms.strength=1/t.renderer.height*(t.renderer.height/e.height),this.uniforms.strength*=this.strength,this.uniforms.strength/=this.passes,this.passes===1)t.applyFilter(this,e,s,r);else{const i=t.getFilterTexture(),o=t.renderer;let l=e,a=i;this.state.blend=!1,t.applyFilter(this,l,a,fn.CLEAR);for(let c=1;c<this.passes-1;c++){t.bindAndClear(l,fn.BLIT),this.uniforms.uSampler=a;const h=a;a=l,l=h,o.shader.bind(this),o.geometry.draw(5)}this.state.blend=!0,t.applyFilter(this,a,s,r),t.returnFilterTexture(i)}}get blur(){return this.strength}set blur(t){this.padding=1+Math.abs(t)*2,this.strength=t}get quality(){return this._quality}set quality(t){this._quality=t,this.passes=t}}class dv extends Je{constructor(t=8,e=4,s=Je.defaultResolution,r=5){super(),this._repeatEdgePixels=!1,this.blurXFilter=new Dc(!0,t,e,s,r),this.blurYFilter=new Dc(!1,t,e,s,r),this.resolution=s,this.quality=e,this.blur=t,this.repeatEdgePixels=!1}apply(t,e,s,r){const i=Math.abs(this.blurXFilter.strength),o=Math.abs(this.blurYFilter.strength);if(i&&o){const l=t.getFilterTexture();this.blurXFilter.apply(t,e,l,fn.CLEAR),this.blurYFilter.apply(t,l,s,r),t.returnFilterTexture(l)}else o?this.blurYFilter.apply(t,e,s,r):this.blurXFilter.apply(t,e,s,r)}updatePadding(){this._repeatEdgePixels?this.padding=0:this.padding=Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))*2}get blur(){return this.blurXFilter.blur}set blur(t){this.blurXFilter.blur=this.blurYFilter.blur=t,this.updatePadding()}get quality(){return this.blurXFilter.quality}set quality(t){this.blurXFilter.quality=this.blurYFilter.quality=t}get blurX(){return this.blurXFilter.blur}set blurX(t){this.blurXFilter.blur=t,this.updatePadding()}get blurY(){return this.blurYFilter.blur}set blurY(t){this.blurYFilter.blur=t,this.updatePadding()}get blendMode(){return this.blurYFilter.blendMode}set blendMode(t){this.blurYFilter.blendMode=t}get repeatEdgePixels(){return this._repeatEdgePixels}set repeatEdgePixels(t){this._repeatEdgePixels=t,this.updatePadding()}}var uv=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform float m[20];
uniform float uAlpha;

void main(void)
{
    vec4 c = texture2D(uSampler, vTextureCoord);

    if (uAlpha == 0.0) {
        gl_FragColor = c;
        return;
    }

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (c.a > 0.0) {
      c.rgb /= c.a;
    }

    vec4 result;

    result.r = (m[0] * c.r);
        result.r += (m[1] * c.g);
        result.r += (m[2] * c.b);
        result.r += (m[3] * c.a);
        result.r += m[4];

    result.g = (m[5] * c.r);
        result.g += (m[6] * c.g);
        result.g += (m[7] * c.b);
        result.g += (m[8] * c.a);
        result.g += m[9];

    result.b = (m[10] * c.r);
       result.b += (m[11] * c.g);
       result.b += (m[12] * c.b);
       result.b += (m[13] * c.a);
       result.b += m[14];

    result.a = (m[15] * c.r);
       result.a += (m[16] * c.g);
       result.a += (m[17] * c.b);
       result.a += (m[18] * c.a);
       result.a += m[19];

    vec3 rgb = mix(c.rgb, result.rgb, uAlpha);

    // Premultiply alpha again.
    rgb *= result.a;

    gl_FragColor = vec4(rgb, result.a);
}
`;class Bc extends Je{constructor(){const t={m:new Float32Array([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]),uAlpha:1};super(bp,uv,t),this.alpha=1}_loadMatrix(t,e=!1){let s=t;e&&(this._multiply(s,this.uniforms.m,t),s=this._colorMatrix(s)),this.uniforms.m=s}_multiply(t,e,s){return t[0]=e[0]*s[0]+e[1]*s[5]+e[2]*s[10]+e[3]*s[15],t[1]=e[0]*s[1]+e[1]*s[6]+e[2]*s[11]+e[3]*s[16],t[2]=e[0]*s[2]+e[1]*s[7]+e[2]*s[12]+e[3]*s[17],t[3]=e[0]*s[3]+e[1]*s[8]+e[2]*s[13]+e[3]*s[18],t[4]=e[0]*s[4]+e[1]*s[9]+e[2]*s[14]+e[3]*s[19]+e[4],t[5]=e[5]*s[0]+e[6]*s[5]+e[7]*s[10]+e[8]*s[15],t[6]=e[5]*s[1]+e[6]*s[6]+e[7]*s[11]+e[8]*s[16],t[7]=e[5]*s[2]+e[6]*s[7]+e[7]*s[12]+e[8]*s[17],t[8]=e[5]*s[3]+e[6]*s[8]+e[7]*s[13]+e[8]*s[18],t[9]=e[5]*s[4]+e[6]*s[9]+e[7]*s[14]+e[8]*s[19]+e[9],t[10]=e[10]*s[0]+e[11]*s[5]+e[12]*s[10]+e[13]*s[15],t[11]=e[10]*s[1]+e[11]*s[6]+e[12]*s[11]+e[13]*s[16],t[12]=e[10]*s[2]+e[11]*s[7]+e[12]*s[12]+e[13]*s[17],t[13]=e[10]*s[3]+e[11]*s[8]+e[12]*s[13]+e[13]*s[18],t[14]=e[10]*s[4]+e[11]*s[9]+e[12]*s[14]+e[13]*s[19]+e[14],t[15]=e[15]*s[0]+e[16]*s[5]+e[17]*s[10]+e[18]*s[15],t[16]=e[15]*s[1]+e[16]*s[6]+e[17]*s[11]+e[18]*s[16],t[17]=e[15]*s[2]+e[16]*s[7]+e[17]*s[12]+e[18]*s[17],t[18]=e[15]*s[3]+e[16]*s[8]+e[17]*s[13]+e[18]*s[18],t[19]=e[15]*s[4]+e[16]*s[9]+e[17]*s[14]+e[18]*s[19]+e[19],t}_colorMatrix(t){const e=new Float32Array(t);return e[4]/=255,e[9]/=255,e[14]/=255,e[19]/=255,e}brightness(t,e){const s=[t,0,0,0,0,0,t,0,0,0,0,0,t,0,0,0,0,0,1,0];this._loadMatrix(s,e)}tint(t,e){const[s,r,i]=te.shared.setValue(t).toArray(),o=[s,0,0,0,0,0,r,0,0,0,0,0,i,0,0,0,0,0,1,0];this._loadMatrix(o,e)}greyscale(t,e){const s=[t,t,t,0,0,t,t,t,0,0,t,t,t,0,0,0,0,0,1,0];this._loadMatrix(s,e)}blackAndWhite(t){const e=[.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0];this._loadMatrix(e,t)}hue(t,e){t=(t||0)/180*Math.PI;const s=Math.cos(t),r=Math.sin(t),i=Math.sqrt,o=1/3,l=i(o),a=s+(1-s)*o,c=o*(1-s)-l*r,h=o*(1-s)+l*r,d=o*(1-s)+l*r,u=s+o*(1-s),f=o*(1-s)-l*r,m=o*(1-s)-l*r,p=o*(1-s)+l*r,g=s+o*(1-s),w=[a,c,h,0,0,d,u,f,0,0,m,p,g,0,0,0,0,0,1,0];this._loadMatrix(w,e)}contrast(t,e){const s=(t||0)+1,r=-.5*(s-1),i=[s,0,0,0,r,0,s,0,0,r,0,0,s,0,r,0,0,0,1,0];this._loadMatrix(i,e)}saturate(t=0,e){const s=t*2/3+1,r=(s-1)*-.5,i=[s,r,r,0,0,r,s,r,0,0,r,r,s,0,0,0,0,0,1,0];this._loadMatrix(i,e)}desaturate(){this.saturate(-1)}negative(t){const e=[-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,0];this._loadMatrix(e,t)}sepia(t){const e=[.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0];this._loadMatrix(e,t)}technicolor(t){const e=[1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0];this._loadMatrix(e,t)}polaroid(t){const e=[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0];this._loadMatrix(e,t)}toBGR(t){const e=[0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0];this._loadMatrix(e,t)}kodachrome(t){const e=[1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0];this._loadMatrix(e,t)}browni(t){const e=[.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0];this._loadMatrix(e,t)}vintage(t){const e=[.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0];this._loadMatrix(e,t)}colorTone(t,e,s,r,i){t=t||.2,e=e||.15,s=s||16770432,r=r||3375104;const o=te.shared,[l,a,c]=o.setValue(s).toArray(),[h,d,u]=o.setValue(r).toArray(),f=[.3,.59,.11,0,0,l,a,c,t,0,h,d,u,e,0,l-h,a-d,c-u,0,0];this._loadMatrix(f,i)}night(t,e){t=t||.1;const s=[t*-2,-t,0,0,0,-t,0,t,0,0,0,t,t*2,0,0,0,0,0,1,0];this._loadMatrix(s,e)}predator(t,e){const s=[11.224130630493164*t,-4.794486999511719*t,-2.8746118545532227*t,0*t,.40342438220977783*t,-3.6330697536468506*t,9.193157196044922*t,-2.951810836791992*t,0*t,-1.316135048866272*t,-3.2184197902679443*t,-4.2375030517578125*t,7.476448059082031*t,0*t,.8044459223747253*t,0,0,0,1,0];this._loadMatrix(s,e)}lsd(t){const e=[2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0];this._loadMatrix(e,t)}reset(){const t=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0];this._loadMatrix(t,!1)}get matrix(){return this.uniforms.m}set matrix(t){this.uniforms.m=t}get alpha(){return this.uniforms.uAlpha}set alpha(t){this.uniforms.uAlpha=t}}Bc.prototype.grayscale=Bc.prototype.greyscale;var fv=`varying vec2 vFilterCoord;
varying vec2 vTextureCoord;

uniform vec2 scale;
uniform mat2 rotation;
uniform sampler2D uSampler;
uniform sampler2D mapSampler;

uniform highp vec4 inputSize;
uniform vec4 inputClamp;

void main(void)
{
  vec4 map =  texture2D(mapSampler, vFilterCoord);

  map -= 0.5;
  map.xy = scale * inputSize.zw * (rotation * map.xy);

  gl_FragColor = texture2D(uSampler, clamp(vec2(vTextureCoord.x + map.x, vTextureCoord.y + map.y), inputClamp.xy, inputClamp.zw));
}
`,mv=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;
uniform mat3 filterMatrix;

varying vec2 vTextureCoord;
varying vec2 vFilterCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
	gl_Position = filterVertexPosition();
	vTextureCoord = filterTextureCoord();
	vFilterCoord = ( filterMatrix * vec3( vTextureCoord, 1.0)  ).xy;
}
`;class pv extends Je{constructor(t,e){const s=new Zt;t.renderable=!1,super(mv,fv,{mapSampler:t._texture,filterMatrix:s,scale:{x:1,y:1},rotation:new Float32Array([1,0,0,1])}),this.maskSprite=t,this.maskMatrix=s,e==null&&(e=20),this.scale=new Xt(e,e)}apply(t,e,s,r){this.uniforms.filterMatrix=t.calculateSpriteMatrix(this.maskMatrix,this.maskSprite),this.uniforms.scale.x=this.scale.x,this.uniforms.scale.y=this.scale.y;const i=this.maskSprite.worldTransform,o=Math.sqrt(i.a*i.a+i.b*i.b),l=Math.sqrt(i.c*i.c+i.d*i.d);o!==0&&l!==0&&(this.uniforms.rotation[0]=i.a/o,this.uniforms.rotation[1]=i.b/o,this.uniforms.rotation[2]=i.c/l,this.uniforms.rotation[3]=i.d/l),t.applyFilter(this,e,s,r)}get map(){return this.uniforms.mapSampler}set map(t){this.uniforms.mapSampler=t}}var gv=`varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;
uniform sampler2D uSampler;
uniform highp vec4 inputSize;


/**
 Basic FXAA implementation based on the code on geeks3d.com with the
 modification that the texture2DLod stuff was removed since it's
 unsupported by WebGL.

 --

 From:
 https://github.com/mitsuhiko/webgl-meincraft

 Copyright (c) 2011 by Armin Ronacher.

 Some rights reserved.

 Redistribution and use in source and binary forms, with or without
 modification, are permitted provided that the following conditions are
 met:

 * Redistributions of source code must retain the above copyright
 notice, this list of conditions and the following disclaimer.

 * Redistributions in binary form must reproduce the above
 copyright notice, this list of conditions and the following
 disclaimer in the documentation and/or other materials provided
 with the distribution.

 * The names of the contributors may not be used to endorse or
 promote products derived from this software without specific
 prior written permission.

 THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
 "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
 LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
 A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
 OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
 SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
 LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
 THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */

#ifndef FXAA_REDUCE_MIN
#define FXAA_REDUCE_MIN   (1.0/ 128.0)
#endif
#ifndef FXAA_REDUCE_MUL
#define FXAA_REDUCE_MUL   (1.0 / 8.0)
#endif
#ifndef FXAA_SPAN_MAX
#define FXAA_SPAN_MAX     8.0
#endif

//optimized version for mobile, where dependent
//texture reads can be a bottleneck
vec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 inverseVP,
          vec2 v_rgbNW, vec2 v_rgbNE,
          vec2 v_rgbSW, vec2 v_rgbSE,
          vec2 v_rgbM) {
    vec4 color;
    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;
    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;
    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;
    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;
    vec4 texColor = texture2D(tex, v_rgbM);
    vec3 rgbM  = texColor.xyz;
    vec3 luma = vec3(0.299, 0.587, 0.114);
    float lumaNW = dot(rgbNW, luma);
    float lumaNE = dot(rgbNE, luma);
    float lumaSW = dot(rgbSW, luma);
    float lumaSE = dot(rgbSE, luma);
    float lumaM  = dot(rgbM,  luma);
    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));
    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));

    mediump vec2 dir;
    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));
    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));

    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *
                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);

    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);
    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),
              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),
                  dir * rcpDirMin)) * inverseVP;

    vec3 rgbA = 0.5 * (
                       texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +
                       texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);
    vec3 rgbB = rgbA * 0.5 + 0.25 * (
                                     texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +
                                     texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);

    float lumaB = dot(rgbB, luma);
    if ((lumaB < lumaMin) || (lumaB > lumaMax))
        color = vec4(rgbA, texColor.a);
    else
        color = vec4(rgbB, texColor.a);
    return color;
}

void main() {

      vec4 color;

      color = fxaa(uSampler, vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);

      gl_FragColor = color;
}
`,xv=`
attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

void texcoords(vec2 fragCoord, vec2 inverseVP,
               out vec2 v_rgbNW, out vec2 v_rgbNE,
               out vec2 v_rgbSW, out vec2 v_rgbSE,
               out vec2 v_rgbM) {
    v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;
    v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;
    v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;
    v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;
    v_rgbM = vec2(fragCoord * inverseVP);
}

void main(void) {

   gl_Position = filterVertexPosition();

   vFragCoord = aVertexPosition * outputFrame.zw;

   texcoords(vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);
}
`;class bv extends Je{constructor(){super(xv,gv)}}var yv=`precision highp float;

varying vec2 vTextureCoord;
varying vec4 vColor;

uniform float uNoise;
uniform float uSeed;
uniform sampler2D uSampler;

float rand(vec2 co)
{
    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
}

void main()
{
    vec4 color = texture2D(uSampler, vTextureCoord);
    float randomValue = rand(gl_FragCoord.xy * uSeed);
    float diff = (randomValue - 0.5) * uNoise;

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (color.a > 0.0) {
        color.rgb /= color.a;
    }

    color.r += diff;
    color.g += diff;
    color.b += diff;

    // Premultiply alpha again.
    color.rgb *= color.a;

    gl_FragColor = color;
}
`;class wv extends Je{constructor(t=.5,e=Math.random()){super(bp,yv,{uNoise:0,uSeed:0}),this.noise=t,this.seed=e}get noise(){return this.uniforms.uNoise}set noise(t){this.uniforms.uNoise=t}get seed(){return this.uniforms.uSeed}set seed(t){this.uniforms.uSeed=t}}const ef={AlphaFilter:iv,BlurFilter:dv,BlurFilterPass:Dc,ColorMatrixFilter:Bc,DisplacementFilter:pv,FXAAFilter:bv,NoiseFilter:wv};Object.entries(ef).forEach(([n,t])=>{Object.defineProperty(ef,n,{get(){return Pt("7.1.0",`filters.${n} has moved to ${n}`),t}})});class vv{constructor(){this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this.tickerAdded=!1,this._pauseUpdate=!0}init(t){this.removeTickerListener(),this.events=t,this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this.tickerAdded=!1,this._pauseUpdate=!0}get pauseUpdate(){return this._pauseUpdate}set pauseUpdate(t){this._pauseUpdate=t}addTickerListener(){this.tickerAdded||!this.domElement||(gs.system.add(this.tickerUpdate,this,Ur.INTERACTION),this.tickerAdded=!0)}removeTickerListener(){this.tickerAdded&&(gs.system.remove(this.tickerUpdate,this),this.tickerAdded=!1)}pointerMoved(){this._didMove=!0}update(){if(!this.domElement||this._pauseUpdate)return;if(this._didMove){this._didMove=!1;return}const t=this.events.rootPointerEvent;this.events.supportsTouchEvents&&t.pointerType==="touch"||globalThis.document.dispatchEvent(new PointerEvent("pointermove",{clientX:t.clientX,clientY:t.clientY}))}tickerUpdate(t){this._deltaTime+=t,!(this._deltaTime<this.interactionFrequency)&&(this._deltaTime=0,this.update())}}const ir=new vv;class pa{constructor(t){this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.composed=!1,this.defaultPrevented=!1,this.eventPhase=pa.prototype.NONE,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer=new Xt,this.page=new Xt,this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=t}get layerX(){return this.layer.x}get layerY(){return this.layer.y}get pageX(){return this.page.x}get pageY(){return this.page.y}get data(){return this}composedPath(){return this.manager&&(!this.path||this.path[this.path.length-1]!==this.target)&&(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path}initEvent(t,e,s){throw new Error("initEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}initUIEvent(t,e,s,r,i){throw new Error("initUIEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}preventDefault(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0}stopImmediatePropagation(){this.propagationImmediatelyStopped=!0}stopPropagation(){this.propagationStopped=!0}}class yo extends pa{constructor(){super(...arguments),this.client=new Xt,this.movement=new Xt,this.offset=new Xt,this.global=new Xt,this.screen=new Xt}get clientX(){return this.client.x}get clientY(){return this.client.y}get x(){return this.clientX}get y(){return this.clientY}get movementX(){return this.movement.x}get movementY(){return this.movement.y}get offsetX(){return this.offset.x}get offsetY(){return this.offset.y}get globalX(){return this.global.x}get globalY(){return this.global.y}get screenX(){return this.screen.x}get screenY(){return this.screen.y}getLocalPosition(t,e,s){return t.worldTransform.applyInverse(s||this.global,e)}getModifierState(t){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(t)}initMouseEvent(t,e,s,r,i,o,l,a,c,h,d,u,f,m,p){throw new Error("Method not implemented.")}}class Fs extends yo{constructor(){super(...arguments),this.width=0,this.height=0,this.isPrimary=!1}getCoalescedEvents(){return this.type==="pointermove"||this.type==="mousemove"||this.type==="touchmove"?[this]:[]}getPredictedEvents(){throw new Error("getPredictedEvents is not supported!")}}class fi extends yo{constructor(){super(...arguments),this.DOM_DELTA_PIXEL=0,this.DOM_DELTA_LINE=1,this.DOM_DELTA_PAGE=2}}fi.DOM_DELTA_PIXEL=0,fi.DOM_DELTA_LINE=1,fi.DOM_DELTA_PAGE=2;const _v=2048,Ev=new Xt,Bl=new Xt;class Sv{constructor(t){this.dispatch=new ma,this.moveOnAll=!1,this.enableGlobalMoveEvents=!0,this.mappingState={trackingData:{}},this.eventPool=new Map,this._allInteractiveElements=[],this._hitElements=[],this._isPointerMoveEvent=!1,this.rootTarget=t,this.hitPruneFn=this.hitPruneFn.bind(this),this.hitTestFn=this.hitTestFn.bind(this),this.mapPointerDown=this.mapPointerDown.bind(this),this.mapPointerMove=this.mapPointerMove.bind(this),this.mapPointerOut=this.mapPointerOut.bind(this),this.mapPointerOver=this.mapPointerOver.bind(this),this.mapPointerUp=this.mapPointerUp.bind(this),this.mapPointerUpOutside=this.mapPointerUpOutside.bind(this),this.mapWheel=this.mapWheel.bind(this),this.mappingTable={},this.addEventMapping("pointerdown",this.mapPointerDown),this.addEventMapping("pointermove",this.mapPointerMove),this.addEventMapping("pointerout",this.mapPointerOut),this.addEventMapping("pointerleave",this.mapPointerOut),this.addEventMapping("pointerover",this.mapPointerOver),this.addEventMapping("pointerup",this.mapPointerUp),this.addEventMapping("pointerupoutside",this.mapPointerUpOutside),this.addEventMapping("wheel",this.mapWheel)}addEventMapping(t,e){this.mappingTable[t]||(this.mappingTable[t]=[]),this.mappingTable[t].push({fn:e,priority:0}),this.mappingTable[t].sort((s,r)=>s.priority-r.priority)}dispatchEvent(t,e){t.propagationStopped=!1,t.propagationImmediatelyStopped=!1,this.propagate(t,e),this.dispatch.emit(e||t.type,t)}mapEvent(t){if(!this.rootTarget)return;const e=this.mappingTable[t.type];if(e)for(let s=0,r=e.length;s<r;s++)e[s].fn(t);else console.warn(`[EventBoundary]: Event mapping not defined for ${t.type}`)}hitTest(t,e){ir.pauseUpdate=!0;const s=this._isPointerMoveEvent&&this.enableGlobalMoveEvents?"hitTestMoveRecursive":"hitTestRecursive",r=this[s](this.rootTarget,this.rootTarget.eventMode,Ev.set(t,e),this.hitTestFn,this.hitPruneFn);return r&&r[0]}propagate(t,e){if(!t.target)return;const s=t.composedPath();t.eventPhase=t.CAPTURING_PHASE;for(let r=0,i=s.length-1;r<i;r++)if(t.currentTarget=s[r],this.notifyTarget(t,e),t.propagationStopped||t.propagationImmediatelyStopped)return;if(t.eventPhase=t.AT_TARGET,t.currentTarget=t.target,this.notifyTarget(t,e),!(t.propagationStopped||t.propagationImmediatelyStopped)){t.eventPhase=t.BUBBLING_PHASE;for(let r=s.length-2;r>=0;r--)if(t.currentTarget=s[r],this.notifyTarget(t,e),t.propagationStopped||t.propagationImmediatelyStopped)return}}all(t,e,s=this._allInteractiveElements){if(s.length===0)return;t.eventPhase=t.BUBBLING_PHASE;const r=Array.isArray(e)?e:[e];for(let i=s.length-1;i>=0;i--)r.forEach(o=>{t.currentTarget=s[i],this.notifyTarget(t,o)})}propagationPath(t){const e=[t];for(let s=0;s<_v&&t!==this.rootTarget;s++){if(!t.parent)throw new Error("Cannot find propagation path to disconnected target");e.push(t.parent),t=t.parent}return e.reverse(),e}hitTestMoveRecursive(t,e,s,r,i,o=!1){let l=!1;if(this._interactivePrune(t))return null;if((t.eventMode==="dynamic"||e==="dynamic")&&(ir.pauseUpdate=!1),t.interactiveChildren&&t.children){const h=t.children;for(let d=h.length-1;d>=0;d--){const u=h[d],f=this.hitTestMoveRecursive(u,this._isInteractive(e)?e:u.eventMode,s,r,i,o||i(t,s));if(f){if(f.length>0&&!f[f.length-1].parent)continue;const m=t.isInteractive();(f.length>0||m)&&(m&&this._allInteractiveElements.push(t),f.push(t)),this._hitElements.length===0&&(this._hitElements=f),l=!0}}}const a=this._isInteractive(e),c=t.isInteractive();return a&&c&&this._allInteractiveElements.push(t),o||this._hitElements.length>0?null:l?this._hitElements:a&&!i(t,s)&&r(t,s)?c?[t]:[]:null}hitTestRecursive(t,e,s,r,i){if(this._interactivePrune(t)||i(t,s))return null;if((t.eventMode==="dynamic"||e==="dynamic")&&(ir.pauseUpdate=!1),t.interactiveChildren&&t.children){const a=t.children;for(let c=a.length-1;c>=0;c--){const h=a[c],d=this.hitTestRecursive(h,this._isInteractive(e)?e:h.eventMode,s,r,i);if(d){if(d.length>0&&!d[d.length-1].parent)continue;const u=t.isInteractive();return(d.length>0||u)&&d.push(t),d}}}const o=this._isInteractive(e),l=t.isInteractive();return o&&r(t,s)?l?[t]:[]:null}_isInteractive(t){return t==="static"||t==="dynamic"}_interactivePrune(t){return!!(!t||t.isMask||!t.visible||!t.renderable||t.eventMode==="none"||t.eventMode==="passive"&&!t.interactiveChildren||t.isMask)}hitPruneFn(t,e){var s;if(t.hitArea&&(t.worldTransform.applyInverse(e,Bl),!t.hitArea.contains(Bl.x,Bl.y)))return!0;if(t._mask){const r=t._mask.isMaskData?t._mask.maskObject:t._mask;if(r&&!((s=r.containsPoint)!=null&&s.call(r,e)))return!0}return!1}hitTestFn(t,e){return t.eventMode==="passive"?!1:t.hitArea?!0:t.containsPoint?t.containsPoint(e):!1}notifyTarget(t,e){var i,o;e=e??t.type;const s=`on${e}`;(o=(i=t.currentTarget)[s])==null||o.call(i,t);const r=t.eventPhase===t.CAPTURING_PHASE||t.eventPhase===t.AT_TARGET?`${e}capture`:e;this.notifyListeners(t,r),t.eventPhase===t.AT_TARGET&&this.notifyListeners(t,e)}mapPointerDown(t){if(!(t instanceof Fs)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const e=this.createPointerEvent(t);if(this.dispatchEvent(e,"pointerdown"),e.pointerType==="touch")this.dispatchEvent(e,"touchstart");else if(e.pointerType==="mouse"||e.pointerType==="pen"){const r=e.button===2;this.dispatchEvent(e,r?"rightdown":"mousedown")}const s=this.trackingData(t.pointerId);s.pressTargetsByButton[t.button]=e.composedPath(),this.freeEvent(e)}mapPointerMove(t){var a,c;if(!(t instanceof Fs)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}this._allInteractiveElements.length=0,this._hitElements.length=0,this._isPointerMoveEvent=!0;const e=this.createPointerEvent(t);this._isPointerMoveEvent=!1;const s=e.pointerType==="mouse"||e.pointerType==="pen",r=this.trackingData(t.pointerId),i=this.findMountedTarget(r.overTargets);if(((a=r.overTargets)==null?void 0:a.length)>0&&i!==e.target){const h=t.type==="mousemove"?"mouseout":"pointerout",d=this.createPointerEvent(t,h,i);if(this.dispatchEvent(d,"pointerout"),s&&this.dispatchEvent(d,"mouseout"),!e.composedPath().includes(i)){const u=this.createPointerEvent(t,"pointerleave",i);for(u.eventPhase=u.AT_TARGET;u.target&&!e.composedPath().includes(u.target);)u.currentTarget=u.target,this.notifyTarget(u),s&&this.notifyTarget(u,"mouseleave"),u.target=u.target.parent;this.freeEvent(u)}this.freeEvent(d)}if(i!==e.target){const h=t.type==="mousemove"?"mouseover":"pointerover",d=this.clonePointerEvent(e,h);this.dispatchEvent(d,"pointerover"),s&&this.dispatchEvent(d,"mouseover");let u=i==null?void 0:i.parent;for(;u&&u!==this.rootTarget.parent&&u!==e.target;)u=u.parent;if(!u||u===this.rootTarget.parent){const f=this.clonePointerEvent(e,"pointerenter");for(f.eventPhase=f.AT_TARGET;f.target&&f.target!==i&&f.target!==this.rootTarget.parent;)f.currentTarget=f.target,this.notifyTarget(f),s&&this.notifyTarget(f,"mouseenter"),f.target=f.target.parent;this.freeEvent(f)}this.freeEvent(d)}const o=[],l=this.enableGlobalMoveEvents??!0;this.moveOnAll?o.push("pointermove"):this.dispatchEvent(e,"pointermove"),l&&o.push("globalpointermove"),e.pointerType==="touch"&&(this.moveOnAll?o.splice(1,0,"touchmove"):this.dispatchEvent(e,"touchmove"),l&&o.push("globaltouchmove")),s&&(this.moveOnAll?o.splice(1,0,"mousemove"):this.dispatchEvent(e,"mousemove"),l&&o.push("globalmousemove"),this.cursor=(c=e.target)==null?void 0:c.cursor),o.length>0&&this.all(e,o),this._allInteractiveElements.length=0,this._hitElements.length=0,r.overTargets=e.composedPath(),this.freeEvent(e)}mapPointerOver(t){var o;if(!(t instanceof Fs)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const e=this.trackingData(t.pointerId),s=this.createPointerEvent(t),r=s.pointerType==="mouse"||s.pointerType==="pen";this.dispatchEvent(s,"pointerover"),r&&this.dispatchEvent(s,"mouseover"),s.pointerType==="mouse"&&(this.cursor=(o=s.target)==null?void 0:o.cursor);const i=this.clonePointerEvent(s,"pointerenter");for(i.eventPhase=i.AT_TARGET;i.target&&i.target!==this.rootTarget.parent;)i.currentTarget=i.target,this.notifyTarget(i),r&&this.notifyTarget(i,"mouseenter"),i.target=i.target.parent;e.overTargets=s.composedPath(),this.freeEvent(s),this.freeEvent(i)}mapPointerOut(t){if(!(t instanceof Fs)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const e=this.trackingData(t.pointerId);if(e.overTargets){const s=t.pointerType==="mouse"||t.pointerType==="pen",r=this.findMountedTarget(e.overTargets),i=this.createPointerEvent(t,"pointerout",r);this.dispatchEvent(i),s&&this.dispatchEvent(i,"mouseout");const o=this.createPointerEvent(t,"pointerleave",r);for(o.eventPhase=o.AT_TARGET;o.target&&o.target!==this.rootTarget.parent;)o.currentTarget=o.target,this.notifyTarget(o),s&&this.notifyTarget(o,"mouseleave"),o.target=o.target.parent;e.overTargets=null,this.freeEvent(i),this.freeEvent(o)}this.cursor=null}mapPointerUp(t){if(!(t instanceof Fs)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const e=performance.now(),s=this.createPointerEvent(t);if(this.dispatchEvent(s,"pointerup"),s.pointerType==="touch")this.dispatchEvent(s,"touchend");else if(s.pointerType==="mouse"||s.pointerType==="pen"){const l=s.button===2;this.dispatchEvent(s,l?"rightup":"mouseup")}const r=this.trackingData(t.pointerId),i=this.findMountedTarget(r.pressTargetsByButton[t.button]);let o=i;if(i&&!s.composedPath().includes(i)){let l=i;for(;l&&!s.composedPath().includes(l);){if(s.currentTarget=l,this.notifyTarget(s,"pointerupoutside"),s.pointerType==="touch")this.notifyTarget(s,"touchendoutside");else if(s.pointerType==="mouse"||s.pointerType==="pen"){const a=s.button===2;this.notifyTarget(s,a?"rightupoutside":"mouseupoutside")}l=l.parent}delete r.pressTargetsByButton[t.button],o=l}if(o){const l=this.clonePointerEvent(s,"click");l.target=o,l.path=null,r.clicksByButton[t.button]||(r.clicksByButton[t.button]={clickCount:0,target:l.target,timeStamp:e});const a=r.clicksByButton[t.button];if(a.target===l.target&&e-a.timeStamp<200?++a.clickCount:a.clickCount=1,a.target=l.target,a.timeStamp=e,l.detail=a.clickCount,l.pointerType==="mouse"){const c=l.button===2;this.dispatchEvent(l,c?"rightclick":"click")}else l.pointerType==="touch"&&this.dispatchEvent(l,"tap");this.dispatchEvent(l,"pointertap"),this.freeEvent(l)}this.freeEvent(s)}mapPointerUpOutside(t){if(!(t instanceof Fs)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const e=this.trackingData(t.pointerId),s=this.findMountedTarget(e.pressTargetsByButton[t.button]),r=this.createPointerEvent(t);if(s){let i=s;for(;i;)r.currentTarget=i,this.notifyTarget(r,"pointerupoutside"),r.pointerType==="touch"?this.notifyTarget(r,"touchendoutside"):(r.pointerType==="mouse"||r.pointerType==="pen")&&this.notifyTarget(r,r.button===2?"rightupoutside":"mouseupoutside"),i=i.parent;delete e.pressTargetsByButton[t.button]}this.freeEvent(r)}mapWheel(t){if(!(t instanceof fi)){console.warn("EventBoundary cannot map a non-wheel event as a wheel event");return}const e=this.createWheelEvent(t);this.dispatchEvent(e),this.freeEvent(e)}findMountedTarget(t){if(!t)return null;let e=t[0];for(let s=1;s<t.length&&t[s].parent===e;s++)e=t[s];return e}createPointerEvent(t,e,s){const r=this.allocateEvent(Fs);return this.copyPointerData(t,r),this.copyMouseData(t,r),this.copyData(t,r),r.nativeEvent=t.nativeEvent,r.originalEvent=t,r.target=s??this.hitTest(r.global.x,r.global.y)??this._hitElements[0],typeof e=="string"&&(r.type=e),r}createWheelEvent(t){const e=this.allocateEvent(fi);return this.copyWheelData(t,e),this.copyMouseData(t,e),this.copyData(t,e),e.nativeEvent=t.nativeEvent,e.originalEvent=t,e.target=this.hitTest(e.global.x,e.global.y),e}clonePointerEvent(t,e){const s=this.allocateEvent(Fs);return s.nativeEvent=t.nativeEvent,s.originalEvent=t.originalEvent,this.copyPointerData(t,s),this.copyMouseData(t,s),this.copyData(t,s),s.target=t.target,s.path=t.composedPath().slice(),s.type=e??s.type,s}copyWheelData(t,e){e.deltaMode=t.deltaMode,e.deltaX=t.deltaX,e.deltaY=t.deltaY,e.deltaZ=t.deltaZ}copyPointerData(t,e){t instanceof Fs&&e instanceof Fs&&(e.pointerId=t.pointerId,e.width=t.width,e.height=t.height,e.isPrimary=t.isPrimary,e.pointerType=t.pointerType,e.pressure=t.pressure,e.tangentialPressure=t.tangentialPressure,e.tiltX=t.tiltX,e.tiltY=t.tiltY,e.twist=t.twist)}copyMouseData(t,e){t instanceof yo&&e instanceof yo&&(e.altKey=t.altKey,e.button=t.button,e.buttons=t.buttons,e.client.copyFrom(t.client),e.ctrlKey=t.ctrlKey,e.metaKey=t.metaKey,e.movement.copyFrom(t.movement),e.screen.copyFrom(t.screen),e.shiftKey=t.shiftKey,e.global.copyFrom(t.global))}copyData(t,e){e.isTrusted=t.isTrusted,e.srcElement=t.srcElement,e.timeStamp=performance.now(),e.type=t.type,e.detail=t.detail,e.view=t.view,e.which=t.which,e.layer.copyFrom(t.layer),e.page.copyFrom(t.page)}trackingData(t){return this.mappingState.trackingData[t]||(this.mappingState.trackingData[t]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[t]}allocateEvent(t){this.eventPool.has(t)||this.eventPool.set(t,[]);const e=this.eventPool.get(t).pop()||new t(this);return e.eventPhase=e.NONE,e.currentTarget=null,e.path=null,e.target=null,e}freeEvent(t){if(t.manager!==this)throw new Error("It is illegal to free an event not managed by this EventBoundary!");const e=t.constructor;this.eventPool.has(e)||this.eventPool.set(e,[]),this.eventPool.get(e).push(t)}notifyListeners(t,e){const s=t.currentTarget._events[e];if(s&&t.currentTarget.isInteractive())if("fn"in s)s.once&&t.currentTarget.removeListener(e,s.fn,void 0,!0),s.fn.call(s.context,t);else for(let r=0,i=s.length;r<i&&!t.propagationImmediatelyStopped;r++)s[r].once&&t.currentTarget.removeListener(e,s[r].fn,void 0,!0),s[r].fn.call(s[r].context,t)}}const Tv=1,Av={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"},Lc=class Oc{constructor(t){this.supportsTouchEvents="ontouchstart"in globalThis,this.supportsPointerEvents=!!globalThis.PointerEvent,this.domElement=null,this.resolution=1,this.renderer=t,this.rootBoundary=new Sv(null),ir.init(this),this.autoPreventDefault=!0,this.eventsAdded=!1,this.rootPointerEvent=new Fs(null),this.rootWheelEvent=new fi(null),this.cursorStyles={default:"inherit",pointer:"pointer"},this.features=new Proxy({...Oc.defaultEventFeatures},{set:(e,s,r)=>(s==="globalMove"&&(this.rootBoundary.enableGlobalMoveEvents=r),e[s]=r,!0)}),this.onPointerDown=this.onPointerDown.bind(this),this.onPointerMove=this.onPointerMove.bind(this),this.onPointerUp=this.onPointerUp.bind(this),this.onPointerOverOut=this.onPointerOverOut.bind(this),this.onWheel=this.onWheel.bind(this)}static get defaultEventMode(){return this._defaultEventMode}init(t){const{view:e,resolution:s}=this.renderer;this.setTargetElement(e),this.resolution=s,Oc._defaultEventMode=t.eventMode??"auto",Object.assign(this.features,t.eventFeatures??{}),this.rootBoundary.enableGlobalMoveEvents=this.features.globalMove}resolutionChange(t){this.resolution=t}destroy(){this.setTargetElement(null),this.renderer=null}setCursor(t){t=t||"default";let e=!0;if(globalThis.OffscreenCanvas&&this.domElement instanceof OffscreenCanvas&&(e=!1),this.currentCursor===t)return;this.currentCursor=t;const s=this.cursorStyles[t];if(s)switch(typeof s){case"string":e&&(this.domElement.style.cursor=s);break;case"function":s(t);break;case"object":e&&Object.assign(this.domElement.style,s);break}else e&&typeof t=="string"&&!Object.prototype.hasOwnProperty.call(this.cursorStyles,t)&&(this.domElement.style.cursor=t)}get pointer(){return this.rootPointerEvent}onPointerDown(t){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;const e=this.normalizeToPointerData(t);this.autoPreventDefault&&e[0].isNormalized&&(t.cancelable||!("cancelable"in t))&&t.preventDefault();for(let s=0,r=e.length;s<r;s++){const i=e[s],o=this.bootstrapEvent(this.rootPointerEvent,i);this.rootBoundary.mapEvent(o)}this.setCursor(this.rootBoundary.cursor)}onPointerMove(t){if(!this.features.move)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,ir.pointerMoved();const e=this.normalizeToPointerData(t);for(let s=0,r=e.length;s<r;s++){const i=this.bootstrapEvent(this.rootPointerEvent,e[s]);this.rootBoundary.mapEvent(i)}this.setCursor(this.rootBoundary.cursor)}onPointerUp(t){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;let e=t.target;t.composedPath&&t.composedPath().length>0&&(e=t.composedPath()[0]);const s=e!==this.domElement?"outside":"",r=this.normalizeToPointerData(t);for(let i=0,o=r.length;i<o;i++){const l=this.bootstrapEvent(this.rootPointerEvent,r[i]);l.type+=s,this.rootBoundary.mapEvent(l)}this.setCursor(this.rootBoundary.cursor)}onPointerOverOut(t){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;const e=this.normalizeToPointerData(t);for(let s=0,r=e.length;s<r;s++){const i=this.bootstrapEvent(this.rootPointerEvent,e[s]);this.rootBoundary.mapEvent(i)}this.setCursor(this.rootBoundary.cursor)}onWheel(t){if(!this.features.wheel)return;const e=this.normalizeWheelEvent(t);this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.rootBoundary.mapEvent(e)}setTargetElement(t){this.removeEvents(),this.domElement=t,ir.domElement=t,this.addEvents()}addEvents(){if(this.eventsAdded||!this.domElement)return;ir.addTickerListener();const t=this.domElement.style;t&&(globalThis.navigator.msPointerEnabled?(t.msContentZooming="none",t.msTouchAction="none"):this.supportsPointerEvents&&(t.touchAction="none")),this.supportsPointerEvents?(globalThis.document.addEventListener("pointermove",this.onPointerMove,!0),this.domElement.addEventListener("pointerdown",this.onPointerDown,!0),this.domElement.addEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.addEventListener("pointerover",this.onPointerOverOut,!0),globalThis.addEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.addEventListener("mousemove",this.onPointerMove,!0),this.domElement.addEventListener("mousedown",this.onPointerDown,!0),this.domElement.addEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.addEventListener("mouseover",this.onPointerOverOut,!0),globalThis.addEventListener("mouseup",this.onPointerUp,!0),this.supportsTouchEvents&&(this.domElement.addEventListener("touchstart",this.onPointerDown,!0),this.domElement.addEventListener("touchend",this.onPointerUp,!0),this.domElement.addEventListener("touchmove",this.onPointerMove,!0))),this.domElement.addEventListener("wheel",this.onWheel,{passive:!0,capture:!0}),this.eventsAdded=!0}removeEvents(){if(!this.eventsAdded||!this.domElement)return;ir.removeTickerListener();const t=this.domElement.style;globalThis.navigator.msPointerEnabled?(t.msContentZooming="",t.msTouchAction=""):this.supportsPointerEvents&&(t.touchAction=""),this.supportsPointerEvents?(globalThis.document.removeEventListener("pointermove",this.onPointerMove,!0),this.domElement.removeEventListener("pointerdown",this.onPointerDown,!0),this.domElement.removeEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.removeEventListener("pointerover",this.onPointerOverOut,!0),globalThis.removeEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.removeEventListener("mousemove",this.onPointerMove,!0),this.domElement.removeEventListener("mousedown",this.onPointerDown,!0),this.domElement.removeEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.removeEventListener("mouseover",this.onPointerOverOut,!0),globalThis.removeEventListener("mouseup",this.onPointerUp,!0),this.supportsTouchEvents&&(this.domElement.removeEventListener("touchstart",this.onPointerDown,!0),this.domElement.removeEventListener("touchend",this.onPointerUp,!0),this.domElement.removeEventListener("touchmove",this.onPointerMove,!0))),this.domElement.removeEventListener("wheel",this.onWheel,!0),this.domElement=null,this.eventsAdded=!1}mapPositionToPoint(t,e,s){const r=this.domElement.isConnected?this.domElement.getBoundingClientRect():{x:0,y:0,width:this.domElement.width,height:this.domElement.height,left:0,top:0},i=1/this.resolution;t.x=(e-r.left)*(this.domElement.width/r.width)*i,t.y=(s-r.top)*(this.domElement.height/r.height)*i}normalizeToPointerData(t){const e=[];if(this.supportsTouchEvents&&t instanceof TouchEvent)for(let s=0,r=t.changedTouches.length;s<r;s++){const i=t.changedTouches[s];typeof i.button>"u"&&(i.button=0),typeof i.buttons>"u"&&(i.buttons=1),typeof i.isPrimary>"u"&&(i.isPrimary=t.touches.length===1&&t.type==="touchstart"),typeof i.width>"u"&&(i.width=i.radiusX||1),typeof i.height>"u"&&(i.height=i.radiusY||1),typeof i.tiltX>"u"&&(i.tiltX=0),typeof i.tiltY>"u"&&(i.tiltY=0),typeof i.pointerType>"u"&&(i.pointerType="touch"),typeof i.pointerId>"u"&&(i.pointerId=i.identifier||0),typeof i.pressure>"u"&&(i.pressure=i.force||.5),typeof i.twist>"u"&&(i.twist=0),typeof i.tangentialPressure>"u"&&(i.tangentialPressure=0),typeof i.layerX>"u"&&(i.layerX=i.offsetX=i.clientX),typeof i.layerY>"u"&&(i.layerY=i.offsetY=i.clientY),i.isNormalized=!0,i.type=t.type,e.push(i)}else if(!globalThis.MouseEvent||t instanceof MouseEvent&&(!this.supportsPointerEvents||!(t instanceof globalThis.PointerEvent))){const s=t;typeof s.isPrimary>"u"&&(s.isPrimary=!0),typeof s.width>"u"&&(s.width=1),typeof s.height>"u"&&(s.height=1),typeof s.tiltX>"u"&&(s.tiltX=0),typeof s.tiltY>"u"&&(s.tiltY=0),typeof s.pointerType>"u"&&(s.pointerType="mouse"),typeof s.pointerId>"u"&&(s.pointerId=Tv),typeof s.pressure>"u"&&(s.pressure=.5),typeof s.twist>"u"&&(s.twist=0),typeof s.tangentialPressure>"u"&&(s.tangentialPressure=0),s.isNormalized=!0,e.push(s)}else e.push(t);return e}normalizeWheelEvent(t){const e=this.rootWheelEvent;return this.transferMouseData(e,t),e.deltaX=t.deltaX,e.deltaY=t.deltaY,e.deltaZ=t.deltaZ,e.deltaMode=t.deltaMode,this.mapPositionToPoint(e.screen,t.clientX,t.clientY),e.global.copyFrom(e.screen),e.offset.copyFrom(e.screen),e.nativeEvent=t,e.type=t.type,e}bootstrapEvent(t,e){return t.originalEvent=null,t.nativeEvent=e,t.pointerId=e.pointerId,t.width=e.width,t.height=e.height,t.isPrimary=e.isPrimary,t.pointerType=e.pointerType,t.pressure=e.pressure,t.tangentialPressure=e.tangentialPressure,t.tiltX=e.tiltX,t.tiltY=e.tiltY,t.twist=e.twist,this.transferMouseData(t,e),this.mapPositionToPoint(t.screen,e.clientX,e.clientY),t.global.copyFrom(t.screen),t.offset.copyFrom(t.screen),t.isTrusted=e.isTrusted,t.type==="pointerleave"&&(t.type="pointerout"),t.type.startsWith("mouse")&&(t.type=t.type.replace("mouse","pointer")),t.type.startsWith("touch")&&(t.type=Av[t.type]||t.type),t}transferMouseData(t,e){t.isTrusted=e.isTrusted,t.srcElement=e.srcElement,t.timeStamp=performance.now(),t.type=e.type,t.altKey=e.altKey,t.button=e.button,t.buttons=e.buttons,t.client.x=e.clientX,t.client.y=e.clientY,t.ctrlKey=e.ctrlKey,t.metaKey=e.metaKey,t.movement.x=e.movementX,t.movement.y=e.movementY,t.page.x=e.pageX,t.page.y=e.pageY,t.relatedTarget=null,t.shiftKey=e.shiftKey}};Lc.extension={name:"events",type:[ot.RendererSystem,ot.CanvasRendererSystem]},Lc.defaultEventFeatures={move:!0,globalMove:!0,click:!0,wheel:!0};let jc=Lc;pt.add(jc);function sf(n){return n==="dynamic"||n==="static"}const Cv={onclick:null,onmousedown:null,onmouseenter:null,onmouseleave:null,onmousemove:null,onglobalmousemove:null,onmouseout:null,onmouseover:null,onmouseup:null,onmouseupoutside:null,onpointercancel:null,onpointerdown:null,onpointerenter:null,onpointerleave:null,onpointermove:null,onglobalpointermove:null,onpointerout:null,onpointerover:null,onpointertap:null,onpointerup:null,onpointerupoutside:null,onrightclick:null,onrightdown:null,onrightup:null,onrightupoutside:null,ontap:null,ontouchcancel:null,ontouchend:null,ontouchendoutside:null,ontouchmove:null,onglobaltouchmove:null,ontouchstart:null,onwheel:null,_internalInteractive:void 0,get interactive(){return this._internalInteractive??sf(jc.defaultEventMode)},set interactive(n){Pt("7.2.0","Setting interactive is deprecated, use eventMode = 'none'/'passive'/'auto'/'static'/'dynamic' instead."),this._internalInteractive=n,this.eventMode=n?"static":"auto"},_internalEventMode:void 0,get eventMode(){return this._internalEventMode??jc.defaultEventMode},set eventMode(n){this._internalInteractive=sf(n),this._internalEventMode=n},isInteractive(){return this.eventMode==="static"||this.eventMode==="dynamic"},interactiveChildren:!0,hitArea:null,addEventListener(n,t,e){const s=typeof e=="boolean"&&e||typeof e=="object"&&e.capture,r=typeof e=="object"?e.signal:void 0,i=typeof e=="object"?e.once===!0:!1,o=typeof t=="function"?void 0:t;n=s?`${n}capture`:n;const l=typeof t=="function"?t:t.handleEvent,a=this;r&&r.addEventListener("abort",()=>{a.off(n,l,o)}),i?a.once(n,l,o):a.on(n,l,o)},removeEventListener(n,t,e){const s=typeof e=="boolean"&&e||typeof e=="object"&&e.capture,r=typeof t=="function"?void 0:t;n=s?`${n}capture`:n,t=typeof t=="function"?t:t.handleEvent,this.off(n,t,r)},dispatchEvent(n){if(!(n instanceof pa))throw new Error("DisplayObject cannot propagate events outside of the Federated Events API");return n.defaultPrevented=!1,n.path=null,n.target=this,n.manager.dispatchEvent(n),!n.defaultPrevented}};pe.mixin(Cv);const kv={accessible:!1,accessibleTitle:null,accessibleHint:null,tabIndex:0,_accessibleActive:!1,_accessibleDiv:null,accessibleType:"button",accessiblePointerEvents:"auto",accessibleChildren:!0,renderId:-1};pe.mixin(kv);const Iv=9,Da=100,Rv=0,Mv=0,nf=2,rf=1,Pv=-1e3,Nv=-1e3,Fv=2;class Cp{constructor(t){this.debug=!1,this._isActive=!1,this._isMobileAccessibility=!1,this.pool=[],this.renderId=0,this.children=[],this.androidUpdateCount=0,this.androidUpdateFrequency=500,this._hookDiv=null,(Rn.tablet||Rn.phone)&&this.createTouchHook();const e=document.createElement("div");e.style.width=`${Da}px`,e.style.height=`${Da}px`,e.style.position="absolute",e.style.top=`${Rv}px`,e.style.left=`${Mv}px`,e.style.zIndex=nf.toString(),this.div=e,this.renderer=t,this._onKeyDown=this._onKeyDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),globalThis.addEventListener("keydown",this._onKeyDown,!1)}get isActive(){return this._isActive}get isMobileAccessibility(){return this._isMobileAccessibility}createTouchHook(){const t=document.createElement("button");t.style.width=`${rf}px`,t.style.height=`${rf}px`,t.style.position="absolute",t.style.top=`${Pv}px`,t.style.left=`${Nv}px`,t.style.zIndex=Fv.toString(),t.style.backgroundColor="#FF0000",t.title="select to enable accessibility for this content",t.addEventListener("focus",()=>{this._isMobileAccessibility=!0,this.activate(),this.destroyTouchHook()}),document.body.appendChild(t),this._hookDiv=t}destroyTouchHook(){this._hookDiv&&(document.body.removeChild(this._hookDiv),this._hookDiv=null)}activate(){var t;this._isActive||(this._isActive=!0,globalThis.document.addEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown,!1),this.renderer.on("postrender",this.update,this),(t=this.renderer.view.parentNode)==null||t.appendChild(this.div))}deactivate(){var t;!this._isActive||this._isMobileAccessibility||(this._isActive=!1,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.addEventListener("keydown",this._onKeyDown,!1),this.renderer.off("postrender",this.update),(t=this.div.parentNode)==null||t.removeChild(this.div))}updateAccessibleObjects(t){if(!t.visible||!t.accessibleChildren)return;t.accessible&&t.isInteractive()&&(t._accessibleActive||this.addChild(t),t.renderId=this.renderId);const e=t.children;if(e)for(let s=0;s<e.length;s++)this.updateAccessibleObjects(e[s])}update(){const t=performance.now();if(Rn.android.device&&t<this.androidUpdateCount||(this.androidUpdateCount=t+this.androidUpdateFrequency,!this.renderer.renderingToScreen))return;this.renderer.lastObjectRendered&&this.updateAccessibleObjects(this.renderer.lastObjectRendered);const{x:e,y:s,width:r,height:i}=this.renderer.view.getBoundingClientRect(),{width:o,height:l,resolution:a}=this.renderer,c=r/o*a,h=i/l*a;let d=this.div;d.style.left=`${e}px`,d.style.top=`${s}px`,d.style.width=`${o}px`,d.style.height=`${l}px`;for(let u=0;u<this.children.length;u++){const f=this.children[u];if(f.renderId!==this.renderId)f._accessibleActive=!1,di(this.children,u,1),this.div.removeChild(f._accessibleDiv),this.pool.push(f._accessibleDiv),f._accessibleDiv=null,u--;else{d=f._accessibleDiv;let m=f.hitArea;const p=f.worldTransform;f.hitArea?(d.style.left=`${(p.tx+m.x*p.a)*c}px`,d.style.top=`${(p.ty+m.y*p.d)*h}px`,d.style.width=`${m.width*p.a*c}px`,d.style.height=`${m.height*p.d*h}px`):(m=f.getBounds(),this.capHitArea(m),d.style.left=`${m.x*c}px`,d.style.top=`${m.y*h}px`,d.style.width=`${m.width*c}px`,d.style.height=`${m.height*h}px`,d.title!==f.accessibleTitle&&f.accessibleTitle!==null&&(d.title=f.accessibleTitle),d.getAttribute("aria-label")!==f.accessibleHint&&f.accessibleHint!==null&&d.setAttribute("aria-label",f.accessibleHint)),(f.accessibleTitle!==d.title||f.tabIndex!==d.tabIndex)&&(d.title=f.accessibleTitle,d.tabIndex=f.tabIndex,this.debug&&this.updateDebugHTML(d))}}this.renderId++}updateDebugHTML(t){t.innerHTML=`type: ${t.type}</br> title : ${t.title}</br> tabIndex: ${t.tabIndex}`}capHitArea(t){t.x<0&&(t.width+=t.x,t.x=0),t.y<0&&(t.height+=t.y,t.y=0);const{width:e,height:s}=this.renderer;t.x+t.width>e&&(t.width=e-t.x),t.y+t.height>s&&(t.height=s-t.y)}addChild(t){let e=this.pool.pop();e||(e=document.createElement("button"),e.style.width=`${Da}px`,e.style.height=`${Da}px`,e.style.backgroundColor=this.debug?"rgba(255,255,255,0.5)":"transparent",e.style.position="absolute",e.style.zIndex=nf.toString(),e.style.borderStyle="none",navigator.userAgent.toLowerCase().includes("chrome")?e.setAttribute("aria-live","off"):e.setAttribute("aria-live","polite"),navigator.userAgent.match(/rv:.*Gecko\//)?e.setAttribute("aria-relevant","additions"):e.setAttribute("aria-relevant","text"),e.addEventListener("click",this._onClick.bind(this)),e.addEventListener("focus",this._onFocus.bind(this)),e.addEventListener("focusout",this._onFocusOut.bind(this))),e.style.pointerEvents=t.accessiblePointerEvents,e.type=t.accessibleType,t.accessibleTitle&&t.accessibleTitle!==null?e.title=t.accessibleTitle:(!t.accessibleHint||t.accessibleHint===null)&&(e.title=`displayObject ${t.tabIndex}`),t.accessibleHint&&t.accessibleHint!==null&&e.setAttribute("aria-label",t.accessibleHint),this.debug&&this.updateDebugHTML(e),t._accessibleActive=!0,t._accessibleDiv=e,e.displayObject=t,this.children.push(t),this.div.appendChild(t._accessibleDiv),t._accessibleDiv.tabIndex=t.tabIndex}_dispatchEvent(t,e){const{displayObject:s}=t.target,r=this.renderer.events.rootBoundary,i=Object.assign(new pa(r),{target:s});r.rootTarget=this.renderer.lastObjectRendered,e.forEach(o=>r.dispatchEvent(i,o))}_onClick(t){this._dispatchEvent(t,["click","pointertap","tap"])}_onFocus(t){t.target.getAttribute("aria-live")||t.target.setAttribute("aria-live","assertive"),this._dispatchEvent(t,["mouseover"])}_onFocusOut(t){t.target.getAttribute("aria-live")||t.target.setAttribute("aria-live","polite"),this._dispatchEvent(t,["mouseout"])}_onKeyDown(t){t.keyCode===Iv&&this.activate()}_onMouseMove(t){t.movementX===0&&t.movementY===0||this.deactivate()}destroy(){this.destroyTouchHook(),this.div=null,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown),this.pool=null,this.children=null,this.renderer=null}}Cp.extension={name:"accessibility",type:[ot.RendererPlugin,ot.CanvasRendererPlugin]};pt.add(Cp);const kp=class Vc{constructor(t){this.stage=new ts,t=Object.assign({forceCanvas:!1},t),this.renderer=Vw(t),Vc._plugins.forEach(e=>{e.init.call(this,t)})}render(){this.renderer.render(this.stage)}get view(){var t;return(t=this.renderer)==null?void 0:t.view}get screen(){var t;return(t=this.renderer)==null?void 0:t.screen}destroy(t,e){const s=Vc._plugins.slice(0);s.reverse(),s.forEach(r=>{r.destroy.call(this)}),this.stage.destroy(e),this.stage=null,this.renderer.destroy(t),this.renderer=null}};kp._plugins=[];let Ip=kp;pt.handleByList(ot.Application,Ip._plugins);class Rp{static init(t){Object.defineProperty(this,"resizeTo",{set(e){globalThis.removeEventListener("resize",this.queueResize),this._resizeTo=e,e&&(globalThis.addEventListener("resize",this.queueResize),this.resize())},get(){return this._resizeTo}}),this.queueResize=()=>{this._resizeTo&&(this.cancelResize(),this._resizeId=requestAnimationFrame(()=>this.resize()))},this.cancelResize=()=>{this._resizeId&&(cancelAnimationFrame(this._resizeId),this._resizeId=null)},this.resize=()=>{if(!this._resizeTo)return;this.cancelResize();let e,s;if(this._resizeTo===globalThis.window)e=globalThis.innerWidth,s=globalThis.innerHeight;else{const{clientWidth:r,clientHeight:i}=this._resizeTo;e=r,s=i}this.renderer.resize(e,s),this.render()},this._resizeId=null,this._resizeTo=null,this.resizeTo=t.resizeTo||null}static destroy(){globalThis.removeEventListener("resize",this.queueResize),this.cancelResize(),this.cancelResize=null,this.queueResize=null,this.resizeTo=null,this.resize=null}}Rp.extension=ot.Application;pt.add(Rp);const af={loader:ot.LoadParser,resolver:ot.ResolveParser,cache:ot.CacheParser,detection:ot.DetectionParser};pt.handle(ot.Asset,n=>{const t=n.ref;Object.entries(af).filter(([e])=>!!t[e]).forEach(([e,s])=>pt.add(Object.assign(t[e],{extension:t[e].extension??s})))},n=>{const t=n.ref;Object.keys(af).filter(e=>!!t[e]).forEach(e=>pt.remove(t[e]))});class Dv{constructor(t,e=!1){this._loader=t,this._assetList=[],this._isLoading=!1,this._maxConcurrent=1,this.verbose=e}add(t){t.forEach(e=>{this._assetList.push(e)}),this.verbose&&console.log("[BackgroundLoader] assets: ",this._assetList),this._isActive&&!this._isLoading&&this._next()}async _next(){if(this._assetList.length&&this._isActive){this._isLoading=!0;const t=[],e=Math.min(this._assetList.length,this._maxConcurrent);for(let s=0;s<e;s++)t.push(this._assetList.pop());await this._loader.load(t),this._isLoading=!1,this._next()}}get active(){return this._isActive}set active(t){this._isActive!==t&&(this._isActive=t,t&&!this._isLoading&&this._next())}}function vi(n,t){if(Array.isArray(t)){for(const e of t)if(n.startsWith(`data:${e}`))return!0;return!1}return n.startsWith(`data:${t}`)}function cs(n,t){const e=n.split("?")[0],s=re.extname(e).toLowerCase();return Array.isArray(t)?t.includes(s):s===t}const $s=(n,t,e=!1)=>(Array.isArray(n)||(n=[n]),t?n.map(s=>typeof s=="string"||e?t(s):s):n),Uc=(n,t)=>{const e=t.split("?")[1];return e&&(n+=`?${e}`),n};function Mp(n,t,e,s,r){const i=t[e];for(let o=0;o<i.length;o++){const l=i[o];e<t.length-1?Mp(n.replace(s[e],l),t,e+1,s,r):r.push(n.replace(s[e],l))}}function Bv(n){const t=/\{(.*?)\}/g,e=n.match(t),s=[];if(e){const r=[];e.forEach(i=>{const o=i.substring(1,i.length-1).split(",");r.push(o)}),Mp(n,r,0,e,s)}else s.push(n);return s}const wo=n=>!Array.isArray(n);class Lv{constructor(){this._parsers=[],this._cache=new Map,this._cacheMap=new Map}reset(){this._cacheMap.clear(),this._cache.clear()}has(t){return this._cache.has(t)}get(t){const e=this._cache.get(t);return e||console.warn(`[Assets] Asset id ${t} was not found in the Cache`),e}set(t,e){const s=$s(t);let r;for(let l=0;l<this.parsers.length;l++){const a=this.parsers[l];if(a.test(e)){r=a.getCacheableAssets(s,e);break}}r||(r={},s.forEach(l=>{r[l]=e}));const i=Object.keys(r),o={cacheKeys:i,keys:s};if(s.forEach(l=>{this._cacheMap.set(l,o)}),i.forEach(l=>{this._cache.has(l)&&this._cache.get(l)!==e&&console.warn("[Cache] already has key:",l),this._cache.set(l,r[l])}),e instanceof mt){const l=e;s.forEach(a=>{l.baseTexture!==mt.EMPTY.baseTexture&&_t.addToCache(l.baseTexture,a),mt.addToCache(l,a)})}}remove(t){if(!this._cacheMap.has(t)){console.warn(`[Assets] Asset id ${t} was not found in the Cache`);return}const e=this._cacheMap.get(t);e.cacheKeys.forEach(s=>{this._cache.delete(s)}),e.keys.forEach(s=>{this._cacheMap.delete(s)})}get parsers(){return this._parsers}}const Nr=new Lv;class Ov{constructor(){this._parsers=[],this._parsersValidated=!1,this.parsers=new Proxy(this._parsers,{set:(t,e,s)=>(this._parsersValidated=!1,t[e]=s,!0)}),this.promiseCache={}}reset(){this._parsersValidated=!1,this.promiseCache={}}_getLoadPromiseAndParser(t,e){const s={promise:null,parser:null};return s.promise=(async()=>{var o,l;let r=null,i=null;if(e.loadParser&&(i=this._parserHash[e.loadParser],i||console.warn(`[Assets] specified load parser "${e.loadParser}" not found while loading ${t}`)),!i){for(let a=0;a<this.parsers.length;a++){const c=this.parsers[a];if(c.load&&((o=c.test)!=null&&o.call(c,t,e,this))){i=c;break}}if(!i)return console.warn(`[Assets] ${t} could not be loaded as we don't know how to parse it, ensure the correct parser has been added`),null}r=await i.load(t,e,this),s.parser=i;for(let a=0;a<this.parsers.length;a++){const c=this.parsers[a];c.parse&&c.parse&&await((l=c.testParse)==null?void 0:l.call(c,r,e,this))&&(r=await c.parse(r,e,this)||r,s.parser=c)}return r})(),s}async load(t,e){this._parsersValidated||this._validateParsers();let s=0;const r={},i=wo(t),o=$s(t,c=>({alias:[c],src:c})),l=o.length,a=o.map(async c=>{const h=re.toAbsolute(c.src);if(!r[c.src])try{this.promiseCache[h]||(this.promiseCache[h]=this._getLoadPromiseAndParser(h,c)),r[c.src]=await this.promiseCache[h].promise,e&&e(++s/l)}catch(d){throw delete this.promiseCache[h],delete r[c.src],new Error(`[Loader.load] Failed to load ${h}.
${d}`)}});return await Promise.all(a),i?r[o[0].src]:r}async unload(t){const e=$s(t,s=>({alias:[s],src:s})).map(async s=>{var o,l;const r=re.toAbsolute(s.src),i=this.promiseCache[r];if(i){const a=await i.promise;delete this.promiseCache[r],(l=(o=i.parser)==null?void 0:o.unload)==null||l.call(o,a,s,this)}});await Promise.all(e)}_validateParsers(){this._parsersValidated=!0,this._parserHash=this._parsers.filter(t=>t.name).reduce((t,e)=>(t[e.name]&&console.warn(`[Assets] loadParser name conflict "${e.name}"`),{...t,[e.name]:e}),{})}}var _s=(n=>(n[n.Low=0]="Low",n[n.Normal=1]="Normal",n[n.High=2]="High",n))(_s||{});const jv=".json",Vv="application/json",Uv={extension:{type:ot.LoadParser,priority:_s.Low},name:"loadJson",test(n){return vi(n,Vv)||cs(n,jv)},async load(n){return await(await ht.ADAPTER.fetch(n)).json()}};pt.add(Uv);const Xv=".txt",Gv="text/plain",Yv={name:"loadTxt",extension:{type:ot.LoadParser,priority:_s.Low},test(n){return vi(n,Gv)||cs(n,Xv)},async load(n){return await(await ht.ADAPTER.fetch(n)).text()}};pt.add(Yv);const $v=["normal","bold","100","200","300","400","500","600","700","800","900"],Wv=[".ttf",".otf",".woff",".woff2"],zv=["font/ttf","font/otf","font/woff","font/woff2"],Hv=/^(--|-?[A-Z_])[0-9A-Z_-]*$/i;function qv(n){const t=re.extname(n),e=re.basename(n,t).replace(/(-|_)/g," ").toLowerCase().split(" ").map(i=>i.charAt(0).toUpperCase()+i.slice(1));let s=e.length>0;for(const i of e)if(!i.match(Hv)){s=!1;break}let r=e.join(" ");return s||(r=`"${r.replace(/[\\"]/g,"\\$&")}"`),r}const Kv=/^[0-9A-Za-z%:/?#\[\]@!\$&'()\*\+,;=\-._~]*$/;function Zv(n){return Kv.test(n)?n:encodeURI(n)}const Qv={extension:{type:ot.LoadParser,priority:_s.Low},name:"loadWebFont",test(n){return vi(n,zv)||cs(n,Wv)},async load(n,t){var s,r,i;const e=ht.ADAPTER.getFontFaceSet();if(e){const o=[],l=((s=t.data)==null?void 0:s.family)??qv(n),a=((i=(r=t.data)==null?void 0:r.weights)==null?void 0:i.filter(h=>$v.includes(h)))??["normal"],c=t.data??{};for(let h=0;h<a.length;h++){const d=a[h],u=new FontFace(l,`url(${Zv(n)})`,{...c,weight:d});await u.load(),e.add(u),o.push(u)}return o.length===1?o[0]:o}return console.warn("[loadWebFont] FontFace API is not supported. Skipping loading font"),null},unload(n){(Array.isArray(n)?n:[n]).forEach(t=>ht.ADAPTER.getFontFaceSet().delete(t))}};pt.add(Qv);const Jv=`(function() {
  "use strict";
  const WHITE_PNG = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=";
  async function checkImageBitmap() {
    try {
      if (typeof createImageBitmap != "function")
        return !1;
      const imageBlob = await (await fetch(WHITE_PNG)).blob(), imageBitmap = await createImageBitmap(imageBlob);
      return imageBitmap.width === 1 && imageBitmap.height === 1;
    } catch {
      return !1;
    }
  }
  checkImageBitmap().then((result) => {
    self.postMessage(result);
  });
})();
`;let mi=null,Xc=class{constructor(){mi||(mi=URL.createObjectURL(new Blob([Jv],{type:"application/javascript"}))),this.worker=new Worker(mi)}};Xc.revokeObjectURL=function(){mi&&(URL.revokeObjectURL(mi),mi=null)};const t_=`(function() {
  "use strict";
  async function loadImageBitmap(url) {
    const response = await fetch(url);
    if (!response.ok)
      throw new Error(\`[WorkerManager.loadImageBitmap] Failed to fetch \${url}: \${response.status} \${response.statusText}\`);
    const imageBlob = await response.blob();
    return await createImageBitmap(imageBlob);
  }
  self.onmessage = async (event) => {
    try {
      const imageBitmap = await loadImageBitmap(event.data.data[0]);
      self.postMessage({
        data: imageBitmap,
        uuid: event.data.uuid,
        id: event.data.id
      }, [imageBitmap]);
    } catch (e) {
      self.postMessage({
        error: e,
        uuid: event.data.uuid,
        id: event.data.id
      });
    }
  };
})();
`;let pi=null;class Pp{constructor(){pi||(pi=URL.createObjectURL(new Blob([t_],{type:"application/javascript"}))),this.worker=new Worker(pi)}}Pp.revokeObjectURL=function(){pi&&(URL.revokeObjectURL(pi),pi=null)};let of=0,Ll;class e_{constructor(){this._initialized=!1,this._createdWorkers=0,this.workerPool=[],this.queue=[],this.resolveHash={}}isImageBitmapSupported(){return this._isImageBitmapSupported!==void 0?this._isImageBitmapSupported:(this._isImageBitmapSupported=new Promise(t=>{const{worker:e}=new Xc;e.addEventListener("message",s=>{e.terminate(),Xc.revokeObjectURL(),t(s.data)})}),this._isImageBitmapSupported)}loadImageBitmap(t){return this._run("loadImageBitmap",[t])}async _initWorkers(){this._initialized||(this._initialized=!0)}getWorker(){Ll===void 0&&(Ll=navigator.hardwareConcurrency||4);let t=this.workerPool.pop();return!t&&this._createdWorkers<Ll&&(this._createdWorkers++,t=new Pp().worker,t.addEventListener("message",e=>{this.complete(e.data),this.returnWorker(e.target),this.next()})),t}returnWorker(t){this.workerPool.push(t)}complete(t){t.error!==void 0?this.resolveHash[t.uuid].reject(t.error):this.resolveHash[t.uuid].resolve(t.data),this.resolveHash[t.uuid]=null}async _run(t,e){await this._initWorkers();const s=new Promise((r,i)=>{this.queue.push({id:t,arguments:e,resolve:r,reject:i})});return this.next(),s}next(){if(!this.queue.length)return;const t=this.getWorker();if(!t)return;const e=this.queue.pop(),s=e.id;this.resolveHash[of]={resolve:e.resolve,reject:e.reject},t.postMessage({data:e.arguments,uuid:of++,id:s})}}const lf=new e_;function ga(n,t,e){n.resource.internal=!0;const s=new mt(n),r=()=>{delete t.promiseCache[e],Nr.has(e)&&Nr.remove(e)};return s.baseTexture.once("destroyed",()=>{e in t.promiseCache&&(console.warn("[Assets] A BaseTexture managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the BaseTexture."),r())}),s.once("destroyed",()=>{n.destroyed||(console.warn("[Assets] A Texture managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the Texture."),r())}),s}const s_=[".jpeg",".jpg",".png",".webp",".avif"],n_=["image/jpeg","image/png","image/webp","image/avif"];async function r_(n){const t=await ht.ADAPTER.fetch(n);if(!t.ok)throw new Error(`[loadImageBitmap] Failed to fetch ${n}: ${t.status} ${t.statusText}`);const e=await t.blob();return await createImageBitmap(e)}const $o={name:"loadTextures",extension:{type:ot.LoadParser,priority:_s.High},config:{preferWorkers:!0,preferCreateImageBitmap:!0,crossOrigin:"anonymous"},test(n){return vi(n,n_)||cs(n,s_)},async load(n,t,e){var l;const s=globalThis.createImageBitmap&&this.config.preferCreateImageBitmap;let r;s?this.config.preferWorkers&&await lf.isImageBitmapSupported()?r=await lf.loadImageBitmap(n):r=await r_(n):r=await new Promise((a,c)=>{const h=new Image;h.crossOrigin=this.config.crossOrigin,h.src=n,h.complete?a(h):(h.onload=()=>a(h),h.onerror=d=>c(d))});const i={...t.data};i.resolution??(i.resolution=Dn(n)),s&&((l=i.resourceOptions)==null?void 0:l.ownsImageBitmap)===void 0&&(i.resourceOptions={...i.resourceOptions},i.resourceOptions.ownsImageBitmap=!0);const o=new _t(r,i);return o.resource.src=n,ga(o,e,n)},unload(n){n.destroy(!0)}};pt.add($o);const i_=".svg",a_="image/svg+xml",o_={extension:{type:ot.LoadParser,priority:_s.High},name:"loadSVG",test(n){return vi(n,a_)||cs(n,i_)},async testParse(n){return Mc.test(n)},async parse(n,t,e){var i;const s=new Mc(n,(i=t==null?void 0:t.data)==null?void 0:i.resourceOptions);await s.load();const r=new _t(s,{resolution:Dn(n),...t==null?void 0:t.data});return r.resource.src=t.src,ga(r,e,t.src)},async load(n,t){return(await ht.ADAPTER.fetch(n)).text()},unload:$o.unload};pt.add(o_);const l_=[".mp4",".m4v",".webm",".ogv"],c_=["video/mp4","video/webm","video/ogg"],h_={name:"loadVideo",extension:{type:ot.LoadParser,priority:_s.High},config:{defaultAutoPlay:!0,defaultUpdateFPS:0,defaultLoop:!1,defaultMuted:!1,defaultPlaysinline:!0},test(n){return vi(n,c_)||cs(n,l_)},async load(n,t,e){var o;let s;const r=await(await ht.ADAPTER.fetch(n)).blob(),i=URL.createObjectURL(r);try{const l={autoPlay:this.config.defaultAutoPlay,updateFPS:this.config.defaultUpdateFPS,loop:this.config.defaultLoop,muted:this.config.defaultMuted,playsinline:this.config.defaultPlaysinline,...(o=t==null?void 0:t.data)==null?void 0:o.resourceOptions,autoLoad:!0},a=new Sp(i,l);await a.load();const c=new _t(a,{alphaMode:await u1(),resolution:Dn(n),...t==null?void 0:t.data});c.resource.src=n,s=ga(c,e,n),s.baseTexture.once("destroyed",()=>{URL.revokeObjectURL(i)})}catch(l){throw URL.revokeObjectURL(i),l}return s},unload(n){n.destroy(!0)}};pt.add(h_);class d_{constructor(){this._defaultBundleIdentifierOptions={connector:"-",createBundleAssetId:(t,e)=>`${t}${this._bundleIdConnector}${e}`,extractAssetIdFromBundle:(t,e)=>e.replace(`${t}${this._bundleIdConnector}`,"")},this._bundleIdConnector=this._defaultBundleIdentifierOptions.connector,this._createBundleAssetId=this._defaultBundleIdentifierOptions.createBundleAssetId,this._extractAssetIdFromBundle=this._defaultBundleIdentifierOptions.extractAssetIdFromBundle,this._assetMap={},this._preferredOrder=[],this._parsers=[],this._resolverHash={},this._bundles={}}setBundleIdentifier(t){if(this._bundleIdConnector=t.connector??this._bundleIdConnector,this._createBundleAssetId=t.createBundleAssetId??this._createBundleAssetId,this._extractAssetIdFromBundle=t.extractAssetIdFromBundle??this._extractAssetIdFromBundle,this._extractAssetIdFromBundle("foo",this._createBundleAssetId("foo","bar"))!=="bar")throw new Error("[Resolver] GenerateBundleAssetId are not working correctly")}prefer(...t){t.forEach(e=>{this._preferredOrder.push(e),e.priority||(e.priority=Object.keys(e.params))}),this._resolverHash={}}set basePath(t){this._basePath=t}get basePath(){return this._basePath}set rootPath(t){this._rootPath=t}get rootPath(){return this._rootPath}get parsers(){return this._parsers}reset(){this.setBundleIdentifier(this._defaultBundleIdentifierOptions),this._assetMap={},this._preferredOrder=[],this._resolverHash={},this._rootPath=null,this._basePath=null,this._manifest=null,this._bundles={},this._defaultSearchParams=null}setDefaultSearchParams(t){if(typeof t=="string")this._defaultSearchParams=t;else{const e=t;this._defaultSearchParams=Object.keys(e).map(s=>`${encodeURIComponent(s)}=${encodeURIComponent(e[s])}`).join("&")}}getAlias(t){const{alias:e,name:s,src:r,srcs:i}=t;return $s(e||s||r||i,o=>typeof o=="string"?o:Array.isArray(o)?o.map(l=>(l==null?void 0:l.src)??(l==null?void 0:l.srcs)??l):o!=null&&o.src||o!=null&&o.srcs?o.src??o.srcs:o,!0)}addManifest(t){this._manifest&&console.warn("[Resolver] Manifest already exists, this will be overwritten"),this._manifest=t,t.bundles.forEach(e=>{this.addBundle(e.name,e.assets)})}addBundle(t,e){const s=[];Array.isArray(e)?e.forEach(r=>{const i=r.src??r.srcs,o=r.alias??r.name;let l;if(typeof o=="string"){const a=this._createBundleAssetId(t,o);s.push(a),l=[o,a]}else{const a=o.map(c=>this._createBundleAssetId(t,c));s.push(...a),l=[...o,...a]}this.add({...r,alias:l,src:i})}):Object.keys(e).forEach(r=>{const i=[r,this._createBundleAssetId(t,r)];if(typeof e[r]=="string")this.add({alias:i,src:e[r]});else if(Array.isArray(e[r]))this.add({alias:i,src:e[r]});else{const o=e[r],l=o.src??o.srcs;this.add({...o,alias:i,src:Array.isArray(l)?l:[l]})}s.push(...i)}),this._bundles[t]=s}add(t,e,s,r,i){const o=[];typeof t=="string"||Array.isArray(t)&&typeof t[0]=="string"?(Pt("7.2.0",`Assets.add now uses an object instead of individual parameters.
Please use Assets.add({ alias, src, data, format, loadParser }) instead.`),o.push({alias:t,src:e,data:s,format:r,loadParser:i})):Array.isArray(t)?o.push(...t):o.push(t);let l;l=a=>{this.hasKey(a)&&console.warn(`[Resolver] already has key: ${a} overwriting`)},$s(o).forEach(a=>{const{src:c,srcs:h}=a;let{data:d,format:u,loadParser:f}=a;const m=$s(c||h).map(w=>typeof w=="string"?Bv(w):Array.isArray(w)?w:[w]),p=this.getAlias(a);Array.isArray(p)?p.forEach(l):l(p);const g=[];m.forEach(w=>{w.forEach(x=>{let y={};if(typeof x!="object"){y.src=x;for(let b=0;b<this._parsers.length;b++){const _=this._parsers[b];if(_.test(x)){y=_.parse(x);break}}}else d=x.data??d,u=x.format??u,f=x.loadParser??f,y={...y,...x};if(!p)throw new Error(`[Resolver] alias is undefined for this asset: ${y.src}`);y=this.buildResolvedAsset(y,{aliases:p,data:d,format:u,loadParser:f}),g.push(y)})}),p.forEach(w=>{this._assetMap[w]=g})})}resolveBundle(t){const e=wo(t);t=$s(t);const s={};return t.forEach(r=>{const i=this._bundles[r];if(i){const o=this.resolve(i),l={};for(const a in o){const c=o[a];l[this._extractAssetIdFromBundle(r,a)]=c}s[r]=l}}),e?s[t[0]]:s}resolveUrl(t){const e=this.resolve(t);if(typeof t!="string"){const s={};for(const r in e)s[r]=e[r].src;return s}return e.src}resolve(t){const e=wo(t);t=$s(t);const s={};return t.forEach(r=>{if(!this._resolverHash[r])if(this._assetMap[r]){let i=this._assetMap[r];const o=i[0],l=this._getPreferredOrder(i);l==null||l.priority.forEach(a=>{l.params[a].forEach(c=>{const h=i.filter(d=>d[a]?d[a]===c:!1);h.length&&(i=h)})}),this._resolverHash[r]=i[0]??o}else this._resolverHash[r]=this.buildResolvedAsset({alias:[r],src:r},{});s[r]=this._resolverHash[r]}),e?s[t[0]]:s}hasKey(t){return!!this._assetMap[t]}hasBundle(t){return!!this._bundles[t]}_getPreferredOrder(t){for(let e=0;e<t.length;e++){const s=t[0],r=this._preferredOrder.find(i=>i.params.format.includes(s.format));if(r)return r}return this._preferredOrder[0]}_appendDefaultSearchParams(t){if(!this._defaultSearchParams)return t;const e=/\?/.test(t)?"&":"?";return`${t}${e}${this._defaultSearchParams}`}buildResolvedAsset(t,e){const{aliases:s,data:r,loadParser:i,format:o}=e;return(this._basePath||this._rootPath)&&(t.src=re.toAbsolute(t.src,this._basePath,this._rootPath)),t.alias=s??t.alias??[t.src],t.src=this._appendDefaultSearchParams(t.src),t.data={...r||{},...t.data},t.loadParser=i??t.loadParser,t.format=o??t.format??re.extname(t.src).slice(1),t.srcs=t.src,t.name=t.alias,t}}class u_{constructor(){this._detections=[],this._initialized=!1,this.resolver=new d_,this.loader=new Ov,this.cache=Nr,this._backgroundLoader=new Dv(this.loader),this._backgroundLoader.active=!0,this.reset()}async init(t={}){var i,o;if(this._initialized){console.warn("[Assets]AssetManager already initialized, did you load before calling this Assets.init()?");return}if(this._initialized=!0,t.defaultSearchParams&&this.resolver.setDefaultSearchParams(t.defaultSearchParams),t.basePath&&(this.resolver.basePath=t.basePath),t.bundleIdentifier&&this.resolver.setBundleIdentifier(t.bundleIdentifier),t.manifest){let l=t.manifest;typeof l=="string"&&(l=await this.load(l)),this.resolver.addManifest(l)}const e=((i=t.texturePreference)==null?void 0:i.resolution)??1,s=typeof e=="number"?[e]:e,r=await this._detectFormats({preferredFormats:(o=t.texturePreference)==null?void 0:o.format,skipDetections:t.skipDetections,detections:this._detections});this.resolver.prefer({params:{format:r,resolution:s}}),t.preferences&&this.setPreferences(t.preferences)}add(t,e,s,r,i){this.resolver.add(t,e,s,r,i)}async load(t,e){this._initialized||await this.init();const s=wo(t),r=$s(t).map(l=>{if(typeof l!="string"){const a=this.resolver.getAlias(l);return a.some(c=>!this.resolver.hasKey(c))&&this.add(l),Array.isArray(a)?a[0]:a}return this.resolver.hasKey(l)||this.add({alias:l,src:l}),l}),i=this.resolver.resolve(r),o=await this._mapLoadToResolve(i,e);return s?o[r[0]]:o}addBundle(t,e){this.resolver.addBundle(t,e)}async loadBundle(t,e){this._initialized||await this.init();let s=!1;typeof t=="string"&&(s=!0,t=[t]);const r=this.resolver.resolveBundle(t),i={},o=Object.keys(r);let l=0,a=0;const c=()=>{e==null||e(++l/a)},h=o.map(d=>{const u=r[d];return a+=Object.keys(u).length,this._mapLoadToResolve(u,c).then(f=>{i[d]=f})});return await Promise.all(h),s?i[t[0]]:i}async backgroundLoad(t){this._initialized||await this.init(),typeof t=="string"&&(t=[t]);const e=this.resolver.resolve(t);this._backgroundLoader.add(Object.values(e))}async backgroundLoadBundle(t){this._initialized||await this.init(),typeof t=="string"&&(t=[t]);const e=this.resolver.resolveBundle(t);Object.values(e).forEach(s=>{this._backgroundLoader.add(Object.values(s))})}reset(){this.resolver.reset(),this.loader.reset(),this.cache.reset(),this._initialized=!1}get(t){if(typeof t=="string")return Nr.get(t);const e={};for(let s=0;s<t.length;s++)e[s]=Nr.get(t[s]);return e}async _mapLoadToResolve(t,e){const s=Object.values(t),r=Object.keys(t);this._backgroundLoader.active=!1;const i=await this.loader.load(s,e);this._backgroundLoader.active=!0;const o={};return s.forEach((l,a)=>{const c=i[l.src],h=[l.src];l.alias&&h.push(...l.alias),o[r[a]]=c,Nr.set(h,c)}),o}async unload(t){this._initialized||await this.init();const e=$s(t).map(r=>typeof r!="string"?r.src:r),s=this.resolver.resolve(e);await this._unloadFromResolved(s)}async unloadBundle(t){this._initialized||await this.init(),t=$s(t);const e=this.resolver.resolveBundle(t),s=Object.keys(e).map(r=>this._unloadFromResolved(e[r]));await Promise.all(s)}async _unloadFromResolved(t){const e=Object.values(t);e.forEach(s=>{Nr.remove(s.src)}),await this.loader.unload(e)}async _detectFormats(t){let e=[];t.preferredFormats&&(e=Array.isArray(t.preferredFormats)?t.preferredFormats:[t.preferredFormats]);for(const s of t.detections)t.skipDetections||await s.test()?e=await s.add(e):t.skipDetections||(e=await s.remove(e));return e=e.filter((s,r)=>e.indexOf(s)===r),e}get detections(){return this._detections}get preferWorkers(){return $o.config.preferWorkers}set preferWorkers(t){Pt("7.2.0","Assets.prefersWorkers is deprecated, use Assets.setPreferences({ preferWorkers: true }) instead."),this.setPreferences({preferWorkers:t})}setPreferences(t){this.loader.parsers.forEach(e=>{e.config&&Object.keys(e.config).filter(s=>s in t).forEach(s=>{e.config[s]=t[s]})})}}const Gi=new u_;pt.handleByList(ot.LoadParser,Gi.loader.parsers).handleByList(ot.ResolveParser,Gi.resolver.parsers).handleByList(ot.CacheParser,Gi.cache.parsers).handleByList(ot.DetectionParser,Gi.detections);const f_={extension:ot.CacheParser,test:n=>Array.isArray(n)&&n.every(t=>t instanceof mt),getCacheableAssets:(n,t)=>{const e={};return n.forEach(s=>{t.forEach((r,i)=>{e[s+(i===0?"":i+1)]=r})}),e}};pt.add(f_);async function Np(n){if("Image"in globalThis)return new Promise(t=>{const e=new Image;e.onload=()=>{t(!0)},e.onerror=()=>{t(!1)},e.src=n});if("createImageBitmap"in globalThis&&"fetch"in globalThis){try{const t=await(await fetch(n)).blob();await createImageBitmap(t)}catch{return!1}return!0}return!1}const m_={extension:{type:ot.DetectionParser,priority:1},test:async()=>Np("data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A="),add:async n=>[...n,"avif"],remove:async n=>n.filter(t=>t!=="avif")};pt.add(m_);const p_={extension:{type:ot.DetectionParser,priority:0},test:async()=>Np("data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA="),add:async n=>[...n,"webp"],remove:async n=>n.filter(t=>t!=="webp")};pt.add(p_);const cf=["png","jpg","jpeg"],g_={extension:{type:ot.DetectionParser,priority:-1},test:()=>Promise.resolve(!0),add:async n=>[...n,...cf],remove:async n=>n.filter(t=>!cf.includes(t))};pt.add(g_);const x_="WorkerGlobalScope"in globalThis&&globalThis instanceof globalThis.WorkerGlobalScope;function Fh(n){return x_?!1:document.createElement("video").canPlayType(n)!==""}const b_={extension:{type:ot.DetectionParser,priority:0},test:async()=>Fh("video/webm"),add:async n=>[...n,"webm"],remove:async n=>n.filter(t=>t!=="webm")};pt.add(b_);const y_={extension:{type:ot.DetectionParser,priority:0},test:async()=>Fh("video/mp4"),add:async n=>[...n,"mp4","m4v"],remove:async n=>n.filter(t=>t!=="mp4"&&t!=="m4v")};pt.add(y_);const w_={extension:{type:ot.DetectionParser,priority:0},test:async()=>Fh("video/ogg"),add:async n=>[...n,"ogv"],remove:async n=>n.filter(t=>t!=="ogv")};pt.add(w_);const v_={extension:ot.ResolveParser,test:$o.test,parse:n=>{var t;return{resolution:parseFloat(((t=ht.RETINA_PREFIX.exec(n))==null?void 0:t[1])??"1"),format:re.extname(n).slice(1),src:n}}};pt.add(v_);var Ve=(n=>(n[n.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",n[n.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",n[n.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",n[n.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",n[n.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917]="COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT",n[n.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918]="COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT",n[n.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919]="COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT",n[n.COMPRESSED_SRGB_S3TC_DXT1_EXT=35916]="COMPRESSED_SRGB_S3TC_DXT1_EXT",n[n.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",n[n.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",n[n.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",n[n.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",n[n.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",n[n.COMPRESSED_RGBA8_ETC2_EAC=37496]="COMPRESSED_RGBA8_ETC2_EAC",n[n.COMPRESSED_SRGB8_ETC2=37493]="COMPRESSED_SRGB8_ETC2",n[n.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37497]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",n[n.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37494]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",n[n.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37495]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",n[n.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",n[n.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",n[n.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",n[n.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",n[n.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",n[n.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",n[n.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35987]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",n[n.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL",n[n.COMPRESSED_RGBA_ASTC_4x4_KHR=37808]="COMPRESSED_RGBA_ASTC_4x4_KHR",n[n.COMPRESSED_RGBA_BPTC_UNORM_EXT=36492]="COMPRESSED_RGBA_BPTC_UNORM_EXT",n[n.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT=36493]="COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT",n[n.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT=36494]="COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT",n[n.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT=36495]="COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT",n))(Ve||{});const vo={33776:.5,33777:.5,33778:1,33779:1,35916:.5,35917:.5,35918:1,35919:1,37488:.5,37489:.5,37490:1,37491:1,37492:.5,37496:1,37493:.5,37497:1,37494:.5,37495:.5,35840:.5,35842:.5,35841:.25,35843:.25,36196:.5,35986:.5,35987:1,34798:1,37808:1,36492:1,36493:1,36494:1,36495:1};let on,si;function hf(){si={bptc:on.getExtension("EXT_texture_compression_bptc"),astc:on.getExtension("WEBGL_compressed_texture_astc"),etc:on.getExtension("WEBGL_compressed_texture_etc"),s3tc:on.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:on.getExtension("WEBGL_compressed_texture_s3tc_srgb"),pvrtc:on.getExtension("WEBGL_compressed_texture_pvrtc")||on.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),etc1:on.getExtension("WEBGL_compressed_texture_etc1"),atc:on.getExtension("WEBGL_compressed_texture_atc")}}const __={extension:{type:ot.DetectionParser,priority:2},test:async()=>{const n=ht.ADAPTER.createCanvas().getContext("webgl");return n?(on=n,!0):(console.warn("WebGL not available for compressed textures."),!1)},add:async n=>{si||hf();const t=[];for(const e in si)si[e]&&t.push(e);return[...t,...n]},remove:async n=>(si||hf(),n.filter(t=>!(t in si)))};pt.add(__);class E_ extends jo{constructor(t,e={width:1,height:1,autoLoad:!0}){let s,r;typeof t=="string"?(s=t,r=new Uint8Array):(s=null,r=t),super(r,e),this.origin=s,this.buffer=r?new bc(r):null,this._load=null,this.loaded=!1,this.origin!==null&&e.autoLoad!==!1&&this.load(),this.origin===null&&this.buffer&&(this._load=Promise.resolve(this),this.loaded=!0,this.onBlobLoaded(this.buffer.rawBinaryData))}onBlobLoaded(t){}load(){return this._load?this._load:(this._load=fetch(this.origin).then(t=>t.blob()).then(t=>t.arrayBuffer()).then(t=>(this.data=new Uint32Array(t),this.buffer=new bc(t),this.loaded=!0,this.onBlobLoaded(t),this.update(),this)),this._load)}}class Lr extends E_{constructor(t,e){super(t,e),this.format=e.format,this.levels=e.levels||1,this._width=e.width,this._height=e.height,this._extension=Lr._formatToExtension(this.format),(e.levelBuffers||this.buffer)&&(this._levelBuffers=e.levelBuffers||Lr._createLevelBuffers(t instanceof Uint8Array?t:this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height))}upload(t,e,s){const r=t.gl;if(!t.context.extensions[this._extension])throw new Error(`${this._extension} textures are not supported on the current machine`);if(!this._levelBuffers)return!1;r.pixelStorei(r.UNPACK_ALIGNMENT,4);for(let i=0,o=this.levels;i<o;i++){const{levelID:l,levelWidth:a,levelHeight:c,levelBuffer:h}=this._levelBuffers[i];r.compressedTexImage2D(r.TEXTURE_2D,l,this.format,a,c,0,h)}return!0}onBlobLoaded(){this._levelBuffers=Lr._createLevelBuffers(this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height)}static _formatToExtension(t){if(t>=33776&&t<=33779)return"s3tc";if(t>=35916&&t<=35919)return"s3tc_sRGB";if(t>=37488&&t<=37497)return"etc";if(t>=35840&&t<=35843)return"pvrtc";if(t===36196)return"etc1";if(t===35986||t===35987||t===34798)return"atc";if(t>=36492&&t<=36495)return"bptc";if(t===37808)return"astc";throw new Error(`Invalid (compressed) texture format given: ${t}`)}static _createLevelBuffers(t,e,s,r,i,o,l){const a=new Array(s);let c=t.byteOffset,h=o,d=l,u=h+r-1&~(r-1),f=d+i-1&~(i-1),m=u*f*vo[e];for(let p=0;p<s;p++)a[p]={levelID:p,levelWidth:s>1?h:u,levelHeight:s>1?d:f,levelBuffer:new Uint8Array(t.buffer,c,m)},c+=m,h=h>>1||1,d=d>>1||1,u=h+r-1&~(r-1),f=d+i-1&~(i-1),m=u*f*vo[e];return a}}const Ol=4,Ba=124,S_=32,df=20,T_=542327876,La={SIZE:1,FLAGS:2,HEIGHT:3,WIDTH:4,MIPMAP_COUNT:7,PIXEL_FORMAT:19},A_={SIZE:0,FLAGS:1,FOURCC:2,RGB_BITCOUNT:3,R_BIT_MASK:4,G_BIT_MASK:5,B_BIT_MASK:6,A_BIT_MASK:7},Oa={DXGI_FORMAT:0,RESOURCE_DIMENSION:1,MISC_FLAG:2,ARRAY_SIZE:3,MISC_FLAGS2:4},C_=1,k_=2,I_=4,R_=64,M_=512,P_=131072,N_=827611204,F_=861165636,D_=894720068,B_=808540228,L_=4,O_={[N_]:Ve.COMPRESSED_RGBA_S3TC_DXT1_EXT,[F_]:Ve.COMPRESSED_RGBA_S3TC_DXT3_EXT,[D_]:Ve.COMPRESSED_RGBA_S3TC_DXT5_EXT},j_={70:Ve.COMPRESSED_RGBA_S3TC_DXT1_EXT,71:Ve.COMPRESSED_RGBA_S3TC_DXT1_EXT,73:Ve.COMPRESSED_RGBA_S3TC_DXT3_EXT,74:Ve.COMPRESSED_RGBA_S3TC_DXT3_EXT,76:Ve.COMPRESSED_RGBA_S3TC_DXT5_EXT,77:Ve.COMPRESSED_RGBA_S3TC_DXT5_EXT,72:Ve.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT,75:Ve.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT,78:Ve.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT,96:Ve.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT,95:Ve.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT,98:Ve.COMPRESSED_RGBA_BPTC_UNORM_EXT,99:Ve.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT};function V_(n){const t=new Uint32Array(n);if(t[0]!==T_)throw new Error("Invalid DDS file magic word");const e=new Uint32Array(n,0,Ba/Uint32Array.BYTES_PER_ELEMENT),s=e[La.HEIGHT],r=e[La.WIDTH],i=e[La.MIPMAP_COUNT],o=new Uint32Array(n,La.PIXEL_FORMAT*Uint32Array.BYTES_PER_ELEMENT,S_/Uint32Array.BYTES_PER_ELEMENT),l=o[C_];if(l&I_){const a=o[A_.FOURCC];if(a!==B_){const x=O_[a],y=Ol+Ba,b=new Uint8Array(n,y);return[new Lr(b,{format:x,width:r,height:s,levels:i})]}const c=Ol+Ba,h=new Uint32Array(t.buffer,c,df/Uint32Array.BYTES_PER_ELEMENT),d=h[Oa.DXGI_FORMAT],u=h[Oa.RESOURCE_DIMENSION],f=h[Oa.MISC_FLAG],m=h[Oa.ARRAY_SIZE],p=j_[d];if(p===void 0)throw new Error(`DDSParser cannot parse texture data with DXGI format ${d}`);if(f===L_)throw new Error("DDSParser does not support cubemap textures");if(u===6)throw new Error("DDSParser does not supported 3D texture data");const g=new Array,w=Ol+Ba+df;if(m===1)g.push(new Uint8Array(n,w));else{const x=vo[p];let y=0,b=r,_=s;for(let S=0;S<i;S++){const T=Math.max(1,b+3&-4),C=Math.max(1,_+3&-4),A=T*C*x;y+=A,b=b>>>1,_=_>>>1}let E=w;for(let S=0;S<m;S++)g.push(new Uint8Array(n,E,y)),E+=y}return g.map(x=>new Lr(x,{format:p,width:r,height:s,levels:i}))}throw l&R_?new Error("DDSParser does not support uncompressed texture data."):l&M_?new Error("DDSParser does not supported YUV uncompressed texture data."):l&P_?new Error("DDSParser does not support single-channel (lumninance) texture data!"):l&k_?new Error("DDSParser does not support single-channel (alpha) texture data!"):new Error("DDSParser failed to load a texture file due to an unknown reason!")}const uf=[171,75,84,88,32,49,49,187,13,10,26,10],U_=67305985,Ps={FILE_IDENTIFIER:0,ENDIANNESS:12,GL_TYPE:16,GL_TYPE_SIZE:20,GL_FORMAT:24,GL_INTERNAL_FORMAT:28,GL_BASE_INTERNAL_FORMAT:32,PIXEL_WIDTH:36,PIXEL_HEIGHT:40,PIXEL_DEPTH:44,NUMBER_OF_ARRAY_ELEMENTS:48,NUMBER_OF_FACES:52,NUMBER_OF_MIPMAP_LEVELS:56,BYTES_OF_KEY_VALUE_DATA:60},Gc=64,ff={[yt.UNSIGNED_BYTE]:1,[yt.UNSIGNED_SHORT]:2,[yt.INT]:4,[yt.UNSIGNED_INT]:4,[yt.FLOAT]:4,[yt.HALF_FLOAT]:8},X_={[st.RGBA]:4,[st.RGB]:3,[st.RG]:2,[st.RED]:1,[st.LUMINANCE]:1,[st.LUMINANCE_ALPHA]:2,[st.ALPHA]:1},G_={[yt.UNSIGNED_SHORT_4_4_4_4]:2,[yt.UNSIGNED_SHORT_5_5_5_1]:2,[yt.UNSIGNED_SHORT_5_6_5]:2};function Y_(n,t,e=!1){const s=new DataView(t);if(!$_(n,s))return null;const r=s.getUint32(Ps.ENDIANNESS,!0)===U_,i=s.getUint32(Ps.GL_TYPE,r),o=s.getUint32(Ps.GL_FORMAT,r),l=s.getUint32(Ps.GL_INTERNAL_FORMAT,r),a=s.getUint32(Ps.PIXEL_WIDTH,r),c=s.getUint32(Ps.PIXEL_HEIGHT,r)||1,h=s.getUint32(Ps.PIXEL_DEPTH,r)||1,d=s.getUint32(Ps.NUMBER_OF_ARRAY_ELEMENTS,r)||1,u=s.getUint32(Ps.NUMBER_OF_FACES,r),f=s.getUint32(Ps.NUMBER_OF_MIPMAP_LEVELS,r),m=s.getUint32(Ps.BYTES_OF_KEY_VALUE_DATA,r);if(c===0||h!==1)throw new Error("Only 2D textures are supported");if(u!==1)throw new Error("CubeTextures are not supported by KTXLoader yet!");if(d!==1)throw new Error("WebGL does not support array textures");const p=4,g=4,w=a+3&-4,x=c+3&-4,y=new Array(d);let b=a*c;i===0&&(b=w*x);let _;if(i!==0?ff[i]?_=ff[i]*X_[o]:_=G_[i]:_=vo[l],_===void 0)throw new Error("Unable to resolve the pixel format stored in the *.ktx file!");const E=e?z_(s,m,r):null;let S=b*_,T=a,C=c,A=w,R=x,M=Gc+m;for(let I=0;I<f;I++){const N=s.getUint32(M,r);let F=M+4;for(let B=0;B<d;B++){let Y=y[B];Y||(Y=y[B]=new Array(f)),Y[I]={levelID:I,levelWidth:f>1||i!==0?T:A,levelHeight:f>1||i!==0?C:R,levelBuffer:new Uint8Array(t,F,S)},F+=S}M+=N+4,M=M%4!==0?M+4-M%4:M,T=T>>1||1,C=C>>1||1,A=T+p-1&~(p-1),R=C+g-1&~(g-1),S=A*R*_}return i!==0?{uncompressed:y.map(I=>{let N=I[0].levelBuffer,F=!1;return i===yt.FLOAT?N=new Float32Array(I[0].levelBuffer.buffer,I[0].levelBuffer.byteOffset,I[0].levelBuffer.byteLength/4):i===yt.UNSIGNED_INT?(F=!0,N=new Uint32Array(I[0].levelBuffer.buffer,I[0].levelBuffer.byteOffset,I[0].levelBuffer.byteLength/4)):i===yt.INT&&(F=!0,N=new Int32Array(I[0].levelBuffer.buffer,I[0].levelBuffer.byteOffset,I[0].levelBuffer.byteLength/4)),{resource:new jo(N,{width:I[0].levelWidth,height:I[0].levelHeight}),type:i,format:F?W_(o):o}}),kvData:E}:{compressed:y.map(I=>new Lr(null,{format:l,width:a,height:c,levels:f,levelBuffers:I})),kvData:E}}function $_(n,t){for(let e=0;e<uf.length;e++)if(t.getUint8(e)!==uf[e])return console.error(`${n} is not a valid *.ktx file!`),!1;return!0}function W_(n){switch(n){case st.RGBA:return st.RGBA_INTEGER;case st.RGB:return st.RGB_INTEGER;case st.RG:return st.RG_INTEGER;case st.RED:return st.RED_INTEGER;default:return n}}function z_(n,t,e){const s=new Map;let r=0;for(;r<t;){const i=n.getUint32(Gc+r,e),o=Gc+r+4,l=3-(i+3)%4;if(i===0||i>t-r){console.error("KTXLoader: keyAndValueByteSize out of bounds");break}let a=0;for(;a<i&&n.getUint8(o+a)!==0;a++);if(a===-1){console.error("KTXLoader: Failed to find null byte terminating kvData key");break}const c=new TextDecoder().decode(new Uint8Array(n.buffer,o,a)),h=new DataView(n.buffer,o+a+1,i-a-1);s.set(c,h),r+=4+i+l}return s}const H_={extension:{type:ot.LoadParser,priority:_s.High},name:"loadDDS",test(n){return cs(n,".dds")},async load(n,t,e){const s=await(await ht.ADAPTER.fetch(n)).arrayBuffer(),r=V_(s).map(i=>{const o=new _t(i,{mipmap:Zs.OFF,alphaMode:Qe.NO_PREMULTIPLIED_ALPHA,resolution:Dn(n),...t.data});return ga(o,e,n)});return r.length===1?r[0]:r},unload(n){Array.isArray(n)?n.forEach(t=>t.destroy(!0)):n.destroy(!0)}};pt.add(H_);const q_={extension:{type:ot.LoadParser,priority:_s.High},name:"loadKTX",test(n){return cs(n,".ktx")},async load(n,t,e){const s=await(await ht.ADAPTER.fetch(n)).arrayBuffer(),{compressed:r,uncompressed:i,kvData:o}=Y_(n,s),l=r??i,a={mipmap:Zs.OFF,alphaMode:Qe.NO_PREMULTIPLIED_ALPHA,resolution:Dn(n),...t.data},c=l.map(h=>{l===i&&Object.assign(a,{type:h.type,format:h.format});const d=h.resource??h,u=new _t(d,a);return u.ktxKeyValueData=o,ga(u,e,n)});return c.length===1?c[0]:c},unload(n){Array.isArray(n)?n.forEach(t=>t.destroy(!0)):n.destroy(!0)}};pt.add(q_);const K_=["s3tc","s3tc_sRGB","etc","etc1","pvrtc","atc","astc","bptc"],Z_={extension:ot.ResolveParser,test:n=>{const t=re.extname(n).slice(1);return["basis","ktx","dds"].includes(t)},parse:n=>{var s,r;const t=n.split("."),e=t.pop();if(["ktx","dds"].includes(e)){const i=t.pop();if(K_.includes(i))return{resolution:parseFloat(((s=ht.RETINA_PREFIX.exec(n))==null?void 0:s[1])??"1"),format:i,src:n}}return{resolution:parseFloat(((r=ht.RETINA_PREFIX.exec(n))==null?void 0:r[1])??"1"),format:e,src:n}}};pt.add(Z_);const ja=new vt,Q_=4,Fp=class Yi{constructor(t){this.renderer=t,this._rendererPremultipliedAlpha=!1}contextChange(){var e;const t=(e=this.renderer)==null?void 0:e.gl.getContextAttributes();this._rendererPremultipliedAlpha=!!(t&&t.alpha&&t.premultipliedAlpha)}async image(t,e,s,r){const i=new Image;return i.src=await this.base64(t,e,s,r),i}async base64(t,e,s,r){const i=this.canvas(t,r);if(i.toBlob!==void 0)return new Promise((o,l)=>{i.toBlob(a=>{if(!a){l(new Error("ICanvas.toBlob failed!"));return}const c=new FileReader;c.onload=()=>o(c.result),c.onerror=l,c.readAsDataURL(a)},e,s)});if(i.toDataURL!==void 0)return i.toDataURL(e,s);if(i.convertToBlob!==void 0){const o=await i.convertToBlob({type:e,quality:s});return new Promise((l,a)=>{const c=new FileReader;c.onload=()=>l(c.result),c.onerror=a,c.readAsDataURL(o)})}throw new Error("Extract.base64() requires ICanvas.toDataURL, ICanvas.toBlob, or ICanvas.convertToBlob to be implemented")}canvas(t,e){const{pixels:s,width:r,height:i,flipY:o,premultipliedAlpha:l}=this._rawPixels(t,e);o&&Yi._flipY(s,r,i),l&&Yi._unpremultiplyAlpha(s);const a=new k1(r,i,1),c=new ImageData(new Uint8ClampedArray(s.buffer),r,i);return a.context.putImageData(c,0,0),a.canvas}pixels(t,e){const{pixels:s,width:r,height:i,flipY:o,premultipliedAlpha:l}=this._rawPixels(t,e);return o&&Yi._flipY(s,r,i),l&&Yi._unpremultiplyAlpha(s),s}_rawPixels(t,e){const s=this.renderer;if(!s)throw new Error("The Extract has already been destroyed");let r,i=!1,o=!1,l,a=!1;t&&(t instanceof $r?l=t:(l=s.generateTexture(t,{region:e,resolution:s.resolution,multisample:s.multisample}),a=!0,e&&(ja.width=e.width,ja.height=e.height,e=ja)));const c=s.gl;if(l){if(r=l.baseTexture.resolution,e=e??l.frame,i=!1,o=l.baseTexture.alphaMode>0&&l.baseTexture.format===st.RGBA,!a){s.renderTexture.bind(l);const f=l.framebuffer.glFramebuffers[s.CONTEXT_UID];f.blitFramebuffer&&s.framebuffer.bind(f.blitFramebuffer)}}else r=s.resolution,e||(e=ja,e.width=s.width/r,e.height=s.height/r),i=!0,o=this._rendererPremultipliedAlpha,s.renderTexture.bind();const h=Math.max(Math.round(e.width*r),1),d=Math.max(Math.round(e.height*r),1),u=new Uint8Array(Q_*h*d);return c.readPixels(Math.round(e.x*r),Math.round(e.y*r),h,d,c.RGBA,c.UNSIGNED_BYTE,u),a&&(l==null||l.destroy(!0)),{pixels:u,width:h,height:d,flipY:i,premultipliedAlpha:o}}destroy(){this.renderer=null}static _flipY(t,e,s){const r=e<<2,i=s>>1,o=new Uint8Array(r);for(let l=0;l<i;l++){const a=l*r,c=(s-l-1)*r;o.set(t.subarray(a,a+r)),t.copyWithin(a,c,c+r),t.set(o,c)}}static _unpremultiplyAlpha(t){t instanceof Uint8ClampedArray&&(t=new Uint8Array(t.buffer));const e=t.length;for(let s=0;s<e;s+=4){const r=t[s+3];if(r!==0){const i=255.001/r;t[s]=t[s]*i+.5,t[s+1]=t[s+1]*i+.5,t[s+2]=t[s+2]*i+.5}}}};Fp.extension={name:"extract",type:ot.RendererSystem};let J_=Fp;pt.add(J_);const _o={build(n){const t=n.points;let e,s,r,i,o,l;if(n.type===Xe.CIRC){const m=n.shape;e=m.x,s=m.y,o=l=m.radius,r=i=0}else if(n.type===Xe.ELIP){const m=n.shape;e=m.x,s=m.y,o=m.width,l=m.height,r=i=0}else{const m=n.shape,p=m.width/2,g=m.height/2;e=m.x+p,s=m.y+g,o=l=Math.max(0,Math.min(m.radius,Math.min(p,g))),r=p-o,i=g-l}if(!(o>=0&&l>=0&&r>=0&&i>=0)){t.length=0;return}const a=Math.ceil(2.3*Math.sqrt(o+l)),c=a*8+(r?4:0)+(i?4:0);if(t.length=c,c===0)return;if(a===0){t.length=8,t[0]=t[6]=e+r,t[1]=t[3]=s+i,t[2]=t[4]=e-r,t[5]=t[7]=s-i;return}let h=0,d=a*4+(r?2:0)+2,u=d,f=c;{const m=r+o,p=i,g=e+m,w=e-m,x=s+p;if(t[h++]=g,t[h++]=x,t[--d]=x,t[--d]=w,i){const y=s-p;t[u++]=w,t[u++]=y,t[--f]=y,t[--f]=g}}for(let m=1;m<a;m++){const p=Math.PI/2*(m/a),g=r+Math.cos(p)*o,w=i+Math.sin(p)*l,x=e+g,y=e-g,b=s+w,_=s-w;t[h++]=x,t[h++]=b,t[--d]=b,t[--d]=y,t[u++]=y,t[u++]=_,t[--f]=_,t[--f]=x}{const m=r,p=i+l,g=e+m,w=e-m,x=s+p,y=s-p;t[h++]=g,t[h++]=x,t[--f]=y,t[--f]=g,r&&(t[h++]=w,t[h++]=x,t[--f]=y,t[--f]=w)}},triangulate(n,t){const e=n.points,s=t.points,r=t.indices;if(e.length===0)return;let i=s.length/2;const o=i;let l,a;if(n.type!==Xe.RREC){const h=n.shape;l=h.x,a=h.y}else{const h=n.shape;l=h.x+h.width/2,a=h.y+h.height/2}const c=n.matrix;s.push(n.matrix?c.a*l+c.c*a+c.tx:l,n.matrix?c.b*l+c.d*a+c.ty:a),i++,s.push(e[0],e[1]);for(let h=2;h<e.length;h+=2)s.push(e[h],e[h+1]),r.push(i++,o,i);r.push(o+1,o,i)}};function mf(n,t=!1){const e=n.length;if(e<6)return;let s=0;for(let r=0,i=n[e-2],o=n[e-1];r<e;r+=2){const l=n[r],a=n[r+1];s+=(l-i)*(a+o),i=l,o=a}if(!t&&s>0||t&&s<=0){const r=e/2;for(let i=r+r%2;i<e;i+=2){const o=e-i-2,l=e-i-1,a=i,c=i+1;[n[o],n[a]]=[n[a],n[o]],[n[l],n[c]]=[n[c],n[l]]}}}const Dp={build(n){n.points=n.shape.points.slice()},triangulate(n,t){let e=n.points;const s=n.holes,r=t.points,i=t.indices;if(e.length>=6){mf(e,!1);const o=[];for(let c=0;c<s.length;c++){const h=s[c];mf(h.points,!0),o.push(e.length/2),e=e.concat(h.points)}const l=l1(e,o,2);if(!l)return;const a=r.length/2;for(let c=0;c<l.length;c+=3)i.push(l[c]+a),i.push(l[c+1]+a),i.push(l[c+2]+a);for(let c=0;c<e.length;c++)r.push(e[c])}}},tE={build(n){const t=n.shape,e=t.x,s=t.y,r=t.width,i=t.height,o=n.points;o.length=0,r>=0&&i>=0&&o.push(e,s,e+r,s,e+r,s+i,e,s+i)},triangulate(n,t){const e=n.points,s=t.points;if(e.length===0)return;const r=s.length/2;s.push(e[0],e[1],e[2],e[3],e[6],e[7],e[4],e[5]),t.indices.push(r,r+1,r+2,r+1,r+2,r+3)}},eE={build(n){_o.build(n)},triangulate(n,t){_o.triangulate(n,t)}};var Ts=(n=>(n.MITER="miter",n.BEVEL="bevel",n.ROUND="round",n))(Ts||{}),cr=(n=>(n.BUTT="butt",n.ROUND="round",n.SQUARE="square",n))(cr||{});const bi={adaptive:!0,maxLength:10,minSegments:8,maxSegments:2048,epsilon:1e-4,_segmentsCount(n,t=20){if(!this.adaptive||!n||isNaN(n))return t;let e=Math.ceil(n/this.maxLength);return e<this.minSegments?e=this.minSegments:e>this.maxSegments&&(e=this.maxSegments),e}};class pf{static curveTo(t,e,s,r,i,o){const l=o[o.length-2],a=o[o.length-1]-e,c=l-t,h=r-e,d=s-t,u=Math.abs(a*d-c*h);if(u<1e-8||i===0)return(o[o.length-2]!==t||o[o.length-1]!==e)&&o.push(t,e),null;const f=a*a+c*c,m=h*h+d*d,p=a*h+c*d,g=i*Math.sqrt(f)/u,w=i*Math.sqrt(m)/u,x=g*p/f,y=w*p/m,b=g*d+w*c,_=g*h+w*a,E=c*(w+x),S=a*(w+x),T=d*(g+y),C=h*(g+y),A=Math.atan2(S-_,E-b),R=Math.atan2(C-_,T-b);return{cx:b+t,cy:_+e,radius:i,startAngle:A,endAngle:R,anticlockwise:c*h>d*a}}static arc(t,e,s,r,i,o,l,a,c){const h=l-o,d=bi._segmentsCount(Math.abs(h)*i,Math.ceil(Math.abs(h)/fo)*40),u=h/(d*2),f=u*2,m=Math.cos(u),p=Math.sin(u),g=d-1,w=g%1/g;for(let x=0;x<=g;++x){const y=x+w*x,b=u+o+f*y,_=Math.cos(b),E=-Math.sin(b);c.push((m*_+p*E)*i+s,(m*-E+p*_)*i+r)}}}class sE{constructor(){this.reset()}begin(t,e,s){this.reset(),this.style=t,this.start=e,this.attribStart=s}end(t,e){this.attribSize=e-this.attribStart,this.size=t-this.start}reset(){this.style=null,this.size=0,this.start=0,this.attribStart=0,this.attribSize=0}}class Dh{static curveLength(t,e,s,r,i,o,l,a){let c=0,h=0,d=0,u=0,f=0,m=0,p=0,g=0,w=0,x=0,y=0,b=t,_=e;for(let E=1;E<=10;++E)h=E/10,d=h*h,u=d*h,f=1-h,m=f*f,p=m*f,g=p*t+3*m*h*s+3*f*d*i+u*l,w=p*e+3*m*h*r+3*f*d*o+u*a,x=b-g,y=_-w,b=g,_=w,c+=Math.sqrt(x*x+y*y);return c}static curveTo(t,e,s,r,i,o,l){const a=l[l.length-2],c=l[l.length-1];l.length-=2;const h=bi._segmentsCount(Dh.curveLength(a,c,t,e,s,r,i,o));let d=0,u=0,f=0,m=0,p=0;l.push(a,c);for(let g=1,w=0;g<=h;++g)w=g/h,d=1-w,u=d*d,f=u*d,m=w*w,p=m*w,l.push(f*a+3*u*w*t+3*d*m*s+p*i,f*c+3*u*w*e+3*d*m*r+p*o)}}function gf(n,t,e,s,r,i,o,l){const a=n-e*r,c=t-s*r,h=n+e*i,d=t+s*i;let u,f;o?(u=s,f=-e):(u=-s,f=e);const m=a+u,p=c+f,g=h+u,w=d+f;return l.push(m,p,g,w),2}function vr(n,t,e,s,r,i,o,l){const a=e-n,c=s-t;let h=Math.atan2(a,c),d=Math.atan2(r-n,i-t);l&&h<d?h+=Math.PI*2:!l&&h>d&&(d+=Math.PI*2);let u=h;const f=d-h,m=Math.abs(f),p=Math.sqrt(a*a+c*c),g=(15*m*Math.sqrt(p)/Math.PI>>0)+1,w=f/g;if(u+=w,l){o.push(n,t,e,s);for(let x=1,y=u;x<g;x++,y+=w)o.push(n,t,n+Math.sin(y)*p,t+Math.cos(y)*p);o.push(n,t,r,i)}else{o.push(e,s,n,t);for(let x=1,y=u;x<g;x++,y+=w)o.push(n+Math.sin(y)*p,t+Math.cos(y)*p,n,t);o.push(r,i,n,t)}return g*2}function nE(n,t){const e=n.shape;let s=n.points||e.points.slice();const r=t.closePointEps;if(s.length===0)return;const i=n.lineStyle,o=new Xt(s[0],s[1]),l=new Xt(s[s.length-2],s[s.length-1]),a=e.type!==Xe.POLY||e.closeStroke,c=Math.abs(o.x-l.x)<r&&Math.abs(o.y-l.y)<r;if(a){s=s.slice(),c&&(s.pop(),s.pop(),l.set(s[s.length-2],s[s.length-1]));const Y=(o.x+l.x)*.5,O=(l.y+o.y)*.5;s.unshift(Y,O),s.push(Y,O)}const h=t.points,d=s.length/2;let u=s.length;const f=h.length/2,m=i.width/2,p=m*m,g=i.miterLimit*i.miterLimit;let w=s[0],x=s[1],y=s[2],b=s[3],_=0,E=0,S=-(x-b),T=w-y,C=0,A=0,R=Math.sqrt(S*S+T*T);S/=R,T/=R,S*=m,T*=m;const M=i.alignment,I=(1-M)*2,N=M*2;a||(i.cap===cr.ROUND?u+=vr(w-S*(I-N)*.5,x-T*(I-N)*.5,w-S*I,x-T*I,w+S*N,x+T*N,h,!0)+2:i.cap===cr.SQUARE&&(u+=gf(w,x,S,T,I,N,!0,h))),h.push(w-S*I,x-T*I,w+S*N,x+T*N);for(let Y=1;Y<d-1;++Y){w=s[(Y-1)*2],x=s[(Y-1)*2+1],y=s[Y*2],b=s[Y*2+1],_=s[(Y+1)*2],E=s[(Y+1)*2+1],S=-(x-b),T=w-y,R=Math.sqrt(S*S+T*T),S/=R,T/=R,S*=m,T*=m,C=-(b-E),A=y-_,R=Math.sqrt(C*C+A*A),C/=R,A/=R,C*=m,A*=m;const O=y-w,V=x-b,j=y-_,X=E-b,L=O*j+V*X,U=V*j-X*O,q=U<0;if(Math.abs(U)<.001*Math.abs(L)){h.push(y-S*I,b-T*I,y+S*N,b+T*N),L>=0&&(i.join===Ts.ROUND?u+=vr(y,b,y-S*I,b-T*I,y-C*I,b-A*I,h,!1)+4:u+=2,h.push(y-C*N,b-A*N,y+C*I,b+A*I));continue}const H=(-S+w)*(-T+b)-(-S+y)*(-T+x),J=(-C+_)*(-A+b)-(-C+y)*(-A+E),Q=(O*J-j*H)/U,W=(X*H-V*J)/U,K=(Q-y)*(Q-y)+(W-b)*(W-b),Z=y+(Q-y)*I,nt=b+(W-b)*I,gt=y-(Q-y)*N,rt=b-(W-b)*N,bt=Math.min(O*O+V*V,j*j+X*X),Ct=q?I:N,jt=bt+Ct*Ct*p,kt=K<=jt;let ee=i.join;if(ee===Ts.MITER&&K/p>g&&(ee=Ts.BEVEL),kt)switch(ee){case Ts.MITER:{h.push(Z,nt,gt,rt);break}case Ts.BEVEL:{q?h.push(Z,nt,y+S*N,b+T*N,Z,nt,y+C*N,b+A*N):h.push(y-S*I,b-T*I,gt,rt,y-C*I,b-A*I,gt,rt),u+=2;break}case Ts.ROUND:{q?(h.push(Z,nt,y+S*N,b+T*N),u+=vr(y,b,y+S*N,b+T*N,y+C*N,b+A*N,h,!0)+4,h.push(Z,nt,y+C*N,b+A*N)):(h.push(y-S*I,b-T*I,gt,rt),u+=vr(y,b,y-S*I,b-T*I,y-C*I,b-A*I,h,!1)+4,h.push(y-C*I,b-A*I,gt,rt));break}}else{switch(h.push(y-S*I,b-T*I,y+S*N,b+T*N),ee){case Ts.MITER:{q?h.push(gt,rt,gt,rt):h.push(Z,nt,Z,nt),u+=2;break}case Ts.ROUND:{q?u+=vr(y,b,y+S*N,b+T*N,y+C*N,b+A*N,h,!0)+2:u+=vr(y,b,y-S*I,b-T*I,y-C*I,b-A*I,h,!1)+2;break}}h.push(y-C*I,b-A*I,y+C*N,b+A*N),u+=2}}w=s[(d-2)*2],x=s[(d-2)*2+1],y=s[(d-1)*2],b=s[(d-1)*2+1],S=-(x-b),T=w-y,R=Math.sqrt(S*S+T*T),S/=R,T/=R,S*=m,T*=m,h.push(y-S*I,b-T*I,y+S*N,b+T*N),a||(i.cap===cr.ROUND?u+=vr(y-S*(I-N)*.5,b-T*(I-N)*.5,y-S*I,b-T*I,y+S*N,b+T*N,h,!1)+2:i.cap===cr.SQUARE&&(u+=gf(y,b,S,T,I,N,!1,h)));const F=t.indices,B=bi.epsilon*bi.epsilon;for(let Y=f;Y<u+f-2;++Y)w=h[Y*2],x=h[Y*2+1],y=h[(Y+1)*2],b=h[(Y+1)*2+1],_=h[(Y+2)*2],E=h[(Y+2)*2+1],!(Math.abs(w*(b-E)+y*(E-x)+_*(x-b))<B)&&F.push(Y,Y+1,Y+2)}function rE(n,t){let e=0;const s=n.shape,r=n.points||s.points,i=s.type!==Xe.POLY||s.closeStroke;if(r.length===0)return;const o=t.points,l=t.indices,a=r.length/2,c=o.length/2;let h=c;for(o.push(r[0],r[1]),e=1;e<a;e++)o.push(r[e*2],r[e*2+1]),l.push(h,h+1),h++;i&&l.push(h,c)}function xf(n,t){n.lineStyle.native?rE(n,t):nE(n,t)}class Bh{static curveLength(t,e,s,r,i,o){const l=t-2*s+i,a=e-2*r+o,c=2*s-2*t,h=2*r-2*e,d=4*(l*l+a*a),u=4*(l*c+a*h),f=c*c+h*h,m=2*Math.sqrt(d+u+f),p=Math.sqrt(d),g=2*d*p,w=2*Math.sqrt(f),x=u/p;return(g*m+p*u*(m-w)+(4*f*d-u*u)*Math.log((2*p+x+m)/(x+w)))/(4*g)}static curveTo(t,e,s,r,i){const o=i[i.length-2],l=i[i.length-1],a=bi._segmentsCount(Bh.curveLength(o,l,t,e,s,r));let c=0,h=0;for(let d=1;d<=a;++d){const u=d/a;c=o+(t-o)*u,h=l+(e-l)*u,i.push(c+(t+(s-t)*u-c)*u,h+(e+(r-e)*u-h)*u)}}}const jl={[Xe.POLY]:Dp,[Xe.CIRC]:_o,[Xe.ELIP]:_o,[Xe.RECT]:tE,[Xe.RREC]:eE},bf=[],Va=[];class Eo{constructor(t,e=null,s=null,r=null){this.points=[],this.holes=[],this.shape=t,this.lineStyle=s,this.fillStyle=e,this.matrix=r,this.type=t.type}clone(){return new Eo(this.shape,this.fillStyle,this.lineStyle,this.matrix)}destroy(){this.shape=null,this.holes.length=0,this.holes=null,this.points.length=0,this.points=null,this.lineStyle=null,this.fillStyle=null}}const Qr=new Xt,Bp=class Lp extends Xm{constructor(){super(),this.closePointEps=1e-4,this.boundsPadding=0,this.uvsFloat32=null,this.indicesUint16=null,this.batchable=!1,this.points=[],this.colors=[],this.uvs=[],this.indices=[],this.textureIds=[],this.graphicsData=[],this.drawCalls=[],this.batchDirty=-1,this.batches=[],this.dirty=0,this.cacheDirty=-1,this.clearDirty=0,this.shapeIndex=0,this._bounds=new bo,this.boundsDirty=-1}get bounds(){return this.updateBatches(),this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.calculateBounds()),this._bounds}invalidate(){this.boundsDirty=-1,this.dirty++,this.batchDirty++,this.shapeIndex=0,this.points.length=0,this.colors.length=0,this.uvs.length=0,this.indices.length=0,this.textureIds.length=0;for(let t=0;t<this.drawCalls.length;t++)this.drawCalls[t].texArray.clear(),Va.push(this.drawCalls[t]);this.drawCalls.length=0;for(let t=0;t<this.batches.length;t++){const e=this.batches[t];e.reset(),bf.push(e)}this.batches.length=0}clear(){return this.graphicsData.length>0&&(this.invalidate(),this.clearDirty++,this.graphicsData.length=0),this}drawShape(t,e=null,s=null,r=null){const i=new Eo(t,e,s,r);return this.graphicsData.push(i),this.dirty++,this}drawHole(t,e=null){if(!this.graphicsData.length)return null;const s=new Eo(t,null,null,e),r=this.graphicsData[this.graphicsData.length-1];return s.lineStyle=r.lineStyle,r.holes.push(s),this.dirty++,this}destroy(){super.destroy();for(let t=0;t<this.graphicsData.length;++t)this.graphicsData[t].destroy();this.points.length=0,this.points=null,this.colors.length=0,this.colors=null,this.uvs.length=0,this.uvs=null,this.indices.length=0,this.indices=null,this.indexBuffer.destroy(),this.indexBuffer=null,this.graphicsData.length=0,this.graphicsData=null,this.drawCalls.length=0,this.drawCalls=null,this.batches.length=0,this.batches=null,this._bounds=null}containsPoint(t){const e=this.graphicsData;for(let s=0;s<e.length;++s){const r=e[s];if(r.fillStyle.visible&&r.shape&&(r.matrix?r.matrix.applyInverse(t,Qr):Qr.copyFrom(t),r.shape.contains(Qr.x,Qr.y))){let i=!1;if(r.holes){for(let o=0;o<r.holes.length;o++)if(r.holes[o].shape.contains(Qr.x,Qr.y)){i=!0;break}}if(!i)return!0}}return!1}updateBatches(){if(!this.graphicsData.length){this.batchable=!0;return}if(!this.validateBatching())return;this.cacheDirty=this.dirty;const t=this.uvs,e=this.graphicsData;let s=null,r=null;this.batches.length>0&&(s=this.batches[this.batches.length-1],r=s.style);for(let a=this.shapeIndex;a<e.length;a++){this.shapeIndex++;const c=e[a],h=c.fillStyle,d=c.lineStyle;jl[c.type].build(c),c.matrix&&this.transformPoints(c.points,c.matrix),(h.visible||d.visible)&&this.processHoles(c.holes);for(let u=0;u<2;u++){const f=u===0?h:d;if(!f.visible)continue;const m=f.texture.baseTexture,p=this.indices.length,g=this.points.length/2;m.wrapMode=hr.REPEAT,u===0?this.processFill(c):this.processLine(c);const w=this.points.length/2-g;w!==0&&(s&&!this._compareStyles(r,f)&&(s.end(p,g),s=null),s||(s=bf.pop()||new sE,s.begin(f,p,g),this.batches.push(s),r=f),this.addUvs(this.points,t,f.texture,g,w,f.matrix))}}const i=this.indices.length,o=this.points.length/2;if(s&&s.end(i,o),this.batches.length===0){this.batchable=!0;return}const l=o>65535;this.indicesUint16&&this.indices.length===this.indicesUint16.length&&l===this.indicesUint16.BYTES_PER_ELEMENT>2?this.indicesUint16.set(this.indices):this.indicesUint16=l?new Uint32Array(this.indices):new Uint16Array(this.indices),this.batchable=this.isBatchable(),this.batchable?this.packBatches():this.buildDrawCalls()}_compareStyles(t,e){return!(!t||!e||t.texture.baseTexture!==e.texture.baseTexture||t.color+t.alpha!==e.color+e.alpha||!!t.native!=!!e.native)}validateBatching(){if(this.dirty===this.cacheDirty||!this.graphicsData.length)return!1;for(let t=0,e=this.graphicsData.length;t<e;t++){const s=this.graphicsData[t],r=s.fillStyle,i=s.lineStyle;if(r&&!r.texture.baseTexture.valid||i&&!i.texture.baseTexture.valid)return!1}return!0}packBatches(){this.batchDirty++,this.uvsFloat32=new Float32Array(this.uvs);const t=this.batches;for(let e=0,s=t.length;e<s;e++){const r=t[e];for(let i=0;i<r.size;i++){const o=r.start+i;this.indicesUint16[o]=this.indicesUint16[o]-r.attribStart}}}isBatchable(){if(this.points.length>65535*2)return!1;const t=this.batches;for(let e=0;e<t.length;e++)if(t[e].style.native)return!1;return this.points.length<Lp.BATCHABLE_SIZE*2}buildDrawCalls(){let t=++_t._globalBatch;for(let d=0;d<this.drawCalls.length;d++)this.drawCalls[d].texArray.clear(),Va.push(this.drawCalls[d]);this.drawCalls.length=0;const e=this.colors,s=this.textureIds;let r=Va.pop();r||(r=new vc,r.texArray=new Tc),r.texArray.count=0,r.start=0,r.size=0,r.type=Ws.TRIANGLES;let i=0,o=null,l=0,a=!1,c=Ws.TRIANGLES,h=0;this.drawCalls.push(r);for(let d=0;d<this.batches.length;d++){const u=this.batches[d],f=8,m=u.style,p=m.texture.baseTexture;a!==!!m.native&&(a=!!m.native,c=a?Ws.LINES:Ws.TRIANGLES,o=null,i=f,t++),o!==p&&(o=p,p._batchEnabled!==t&&(i===f&&(t++,i=0,r.size>0&&(r=Va.pop(),r||(r=new vc,r.texArray=new Tc),this.drawCalls.push(r)),r.start=h,r.size=0,r.texArray.count=0,r.type=c),p.touched=1,p._batchEnabled=t,p._batchLocation=i,p.wrapMode=hr.REPEAT,r.texArray.elements[r.texArray.count++]=p,i++)),r.size+=u.size,h+=u.size,l=p._batchLocation,this.addColors(e,m.color,m.alpha,u.attribSize,u.attribStart),this.addTextureIds(s,l,u.attribSize,u.attribStart)}_t._globalBatch=t,this.packAttributes()}packAttributes(){const t=this.points,e=this.uvs,s=this.colors,r=this.textureIds,i=new ArrayBuffer(t.length*3*4),o=new Float32Array(i),l=new Uint32Array(i);let a=0;for(let c=0;c<t.length/2;c++)o[a++]=t[c*2],o[a++]=t[c*2+1],o[a++]=e[c*2],o[a++]=e[c*2+1],l[a++]=s[c],o[a++]=r[c];this._buffer.update(i),this._indexBuffer.update(this.indicesUint16)}processFill(t){t.holes.length?Dp.triangulate(t,this):jl[t.type].triangulate(t,this)}processLine(t){xf(t,this);for(let e=0;e<t.holes.length;e++)xf(t.holes[e],this)}processHoles(t){for(let e=0;e<t.length;e++){const s=t[e];jl[s.type].build(s),s.matrix&&this.transformPoints(s.points,s.matrix)}}calculateBounds(){const t=this._bounds;t.clear(),t.addVertexData(this.points,0,this.points.length),t.pad(this.boundsPadding,this.boundsPadding)}transformPoints(t,e){for(let s=0;s<t.length/2;s++){const r=t[s*2],i=t[s*2+1];t[s*2]=e.a*r+e.c*i+e.tx,t[s*2+1]=e.b*r+e.d*i+e.ty}}addColors(t,e,s,r,i=0){const o=te.shared.setValue(e).toLittleEndianNumber(),l=te.shared.setValue(o).toPremultiplied(s);t.length=Math.max(t.length,i+r);for(let a=0;a<r;a++)t[i+a]=l}addTextureIds(t,e,s,r=0){t.length=Math.max(t.length,r+s);for(let i=0;i<s;i++)t[r+i]=e}addUvs(t,e,s,r,i,o=null){let l=0;const a=e.length,c=s.frame;for(;l<i;){let d=t[(r+l)*2],u=t[(r+l)*2+1];if(o){const f=o.a*d+o.c*u+o.tx;u=o.b*d+o.d*u+o.ty,d=f}l++,e.push(d/c.width,u/c.height)}const h=s.baseTexture;(c.width<h.width||c.height<h.height)&&this.adjustUvs(e,s,a,i)}adjustUvs(t,e,s,r){const i=e.baseTexture,o=1e-6,l=s+r*2,a=e.frame,c=a.width/i.width,h=a.height/i.height;let d=a.x/a.width,u=a.y/a.height,f=Math.floor(t[s]+o),m=Math.floor(t[s+1]+o);for(let p=s+2;p<l;p+=2)f=Math.min(f,Math.floor(t[p]+o)),m=Math.min(m,Math.floor(t[p+1]+o));d-=f,u-=m;for(let p=s;p<l;p+=2)t[p]=(t[p]+d)*c,t[p+1]=(t[p+1]+u)*h}};Bp.BATCHABLE_SIZE=100;let iE=Bp;class Wo{constructor(){this.color=16777215,this.alpha=1,this.texture=mt.WHITE,this.matrix=null,this.visible=!1,this.reset()}clone(){const t=new Wo;return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.visible=this.visible,t}reset(){this.color=16777215,this.alpha=1,this.texture=mt.WHITE,this.matrix=null,this.visible=!1}destroy(){this.texture=null,this.matrix=null}}class Lh extends Wo{constructor(){super(...arguments),this.width=0,this.alignment=.5,this.native=!1,this.cap=cr.BUTT,this.join=Ts.MITER,this.miterLimit=10}clone(){const t=new Lh;return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.visible=this.visible,t.width=this.width,t.alignment=this.alignment,t.native=this.native,t.cap=this.cap,t.join=this.join,t.miterLimit=this.miterLimit,t}reset(){super.reset(),this.color=0,this.alignment=.5,this.width=0,this.native=!1,this.cap=cr.BUTT,this.join=Ts.MITER,this.miterLimit=10}}const Vl={},Yc=class no extends ts{constructor(t=null){super(),this.shader=null,this.pluginName="batch",this.currentPath=null,this.batches=[],this.batchTint=-1,this.batchDirty=-1,this.vertexData=null,this._fillStyle=new Wo,this._lineStyle=new Lh,this._matrix=null,this._holeMode=!1,this.state=yn.for2d(),this._geometry=t||new iE,this._geometry.refCount++,this._transformID=-1,this._tintColor=new te(16777215),this.blendMode=dt.NORMAL}get geometry(){return this._geometry}clone(){return this.finishPoly(),new no(this._geometry)}set blendMode(t){this.state.blendMode=t}get blendMode(){return this.state.blendMode}get tint(){return this._tintColor.value}set tint(t){this._tintColor.setValue(t)}get fill(){return this._fillStyle}get line(){return this._lineStyle}lineStyle(t=null,e=0,s,r=.5,i=!1){return typeof t=="number"&&(t={width:t,color:e,alpha:s,alignment:r,native:i}),this.lineTextureStyle(t)}lineTextureStyle(t){const e={width:0,texture:mt.WHITE,color:t!=null&&t.texture?16777215:0,matrix:null,alignment:.5,native:!1,cap:cr.BUTT,join:Ts.MITER,miterLimit:10};t=Object.assign(e,t),this.normalizeColor(t),this.currentPath&&this.startPoly();const s=t.width>0&&t.alpha>0;return s?(t.matrix&&(t.matrix=t.matrix.clone(),t.matrix.invert()),Object.assign(this._lineStyle,{visible:s},t)):this._lineStyle.reset(),this}startPoly(){if(this.currentPath){const t=this.currentPath.points,e=this.currentPath.points.length;e>2&&(this.drawShape(this.currentPath),this.currentPath=new dr,this.currentPath.closeStroke=!1,this.currentPath.points.push(t[e-2],t[e-1]))}else this.currentPath=new dr,this.currentPath.closeStroke=!1}finishPoly(){this.currentPath&&(this.currentPath.points.length>2?(this.drawShape(this.currentPath),this.currentPath=null):this.currentPath.points.length=0)}moveTo(t,e){return this.startPoly(),this.currentPath.points[0]=t,this.currentPath.points[1]=e,this}lineTo(t,e){this.currentPath||this.moveTo(0,0);const s=this.currentPath.points,r=s[s.length-2],i=s[s.length-1];return(r!==t||i!==e)&&s.push(t,e),this}_initCurve(t=0,e=0){this.currentPath?this.currentPath.points.length===0&&(this.currentPath.points=[t,e]):this.moveTo(t,e)}quadraticCurveTo(t,e,s,r){this._initCurve();const i=this.currentPath.points;return i.length===0&&this.moveTo(0,0),Bh.curveTo(t,e,s,r,i),this}bezierCurveTo(t,e,s,r,i,o){return this._initCurve(),Dh.curveTo(t,e,s,r,i,o,this.currentPath.points),this}arcTo(t,e,s,r,i){this._initCurve(t,e);const o=this.currentPath.points,l=pf.curveTo(t,e,s,r,i,o);if(l){const{cx:a,cy:c,radius:h,startAngle:d,endAngle:u,anticlockwise:f}=l;this.arc(a,c,h,d,u,f)}return this}arc(t,e,s,r,i,o=!1){if(r===i)return this;if(!o&&i<=r?i+=fo:o&&r<=i&&(r+=fo),i-r===0)return this;const l=t+Math.cos(r)*s,a=e+Math.sin(r)*s,c=this._geometry.closePointEps;let h=this.currentPath?this.currentPath.points:null;if(h){const d=Math.abs(h[h.length-2]-l),u=Math.abs(h[h.length-1]-a);d<c&&u<c||h.push(l,a)}else this.moveTo(l,a),h=this.currentPath.points;return pf.arc(l,a,t,e,s,r,i,o,h),this}beginFill(t=0,e){return this.beginTextureFill({texture:mt.WHITE,color:t,alpha:e})}normalizeColor(t){const e=te.shared.setValue(t.color??0);t.color=e.toNumber(),t.alpha??(t.alpha=e.alpha)}beginTextureFill(t){const e={texture:mt.WHITE,color:16777215,matrix:null};t=Object.assign(e,t),this.normalizeColor(t),this.currentPath&&this.startPoly();const s=t.alpha>0;return s?(t.matrix&&(t.matrix=t.matrix.clone(),t.matrix.invert()),Object.assign(this._fillStyle,{visible:s},t)):this._fillStyle.reset(),this}endFill(){return this.finishPoly(),this._fillStyle.reset(),this}drawRect(t,e,s,r){return this.drawShape(new vt(t,e,s,r))}drawRoundedRect(t,e,s,r,i){return this.drawShape(new Xo(t,e,s,r,i))}drawCircle(t,e,s){return this.drawShape(new Vo(t,e,s))}drawEllipse(t,e,s,r){return this.drawShape(new Uo(t,e,s,r))}drawPolygon(...t){let e,s=!0;const r=t[0];r.points?(s=r.closeStroke,e=r.points):Array.isArray(t[0])?e=t[0]:e=t;const i=new dr(e);return i.closeStroke=s,this.drawShape(i),this}drawShape(t){return this._holeMode?this._geometry.drawHole(t,this._matrix):this._geometry.drawShape(t,this._fillStyle.clone(),this._lineStyle.clone(),this._matrix),this}clear(){return this._geometry.clear(),this._lineStyle.reset(),this._fillStyle.reset(),this._boundsID++,this._matrix=null,this._holeMode=!1,this.currentPath=null,this}isFastRect(){const t=this._geometry.graphicsData;return t.length===1&&t[0].shape.type===Xe.RECT&&!t[0].matrix&&!t[0].holes.length&&!(t[0].lineStyle.visible&&t[0].lineStyle.width)}_render(t){this.finishPoly();const e=this._geometry;e.updateBatches(),e.batchable?(this.batchDirty!==e.batchDirty&&this._populateBatches(),this._renderBatched(t)):(t.batch.flush(),this._renderDirect(t))}_populateBatches(){const t=this._geometry,e=this.blendMode,s=t.batches.length;this.batchTint=-1,this._transformID=-1,this.batchDirty=t.batchDirty,this.batches.length=s,this.vertexData=new Float32Array(t.points);for(let r=0;r<s;r++){const i=t.batches[r],o=i.style.color,l=new Float32Array(this.vertexData.buffer,i.attribStart*4*2,i.attribSize*2),a=new Float32Array(t.uvsFloat32.buffer,i.attribStart*4*2,i.attribSize*2),c=new Uint16Array(t.indicesUint16.buffer,i.start*2,i.size),h={vertexData:l,blendMode:e,indices:c,uvs:a,_batchRGB:te.shared.setValue(o).toRgbArray(),_tintRGB:o,_texture:i.style.texture,alpha:i.style.alpha,worldAlpha:1};this.batches[r]=h}}_renderBatched(t){if(this.batches.length){t.batch.setObjectRenderer(t.plugins[this.pluginName]),this.calculateVertices(),this.calculateTints();for(let e=0,s=this.batches.length;e<s;e++){const r=this.batches[e];r.worldAlpha=this.worldAlpha*r.alpha,t.plugins[this.pluginName].render(r)}}}_renderDirect(t){const e=this._resolveDirectShader(t),s=this._geometry,r=this.worldAlpha,i=e.uniforms,o=s.drawCalls;i.translationMatrix=this.transform.worldTransform,te.shared.setValue(this._tintColor).premultiply(r).toArray(i.tint),t.shader.bind(e),t.geometry.bind(s,e),t.state.set(this.state);for(let l=0,a=o.length;l<a;l++)this._renderDrawCallDirect(t,s.drawCalls[l])}_renderDrawCallDirect(t,e){const{texArray:s,type:r,size:i,start:o}=e,l=s.count;for(let a=0;a<l;a++)t.texture.bind(s.elements[a],a);t.geometry.draw(r,i,o)}_resolveDirectShader(t){let e=this.shader;const s=this.pluginName;if(!e){if(!Vl[s]){const{maxTextures:r}=t.plugins[s],i=new Int32Array(r);for(let a=0;a<r;a++)i[a]=a;const o={tint:new Float32Array([1,1,1,1]),translationMatrix:new Zt,default:Hs.from({uSamplers:i},!0)},l=t.plugins[s]._shader.program;Vl[s]=new gn(l,o)}e=Vl[s]}return e}_calculateBounds(){this.finishPoly();const t=this._geometry;if(!t.graphicsData.length)return;const{minX:e,minY:s,maxX:r,maxY:i}=t.bounds;this._bounds.addFrame(this.transform,e,s,r,i)}containsPoint(t){return this.worldTransform.applyInverse(t,no._TEMP_POINT),this._geometry.containsPoint(no._TEMP_POINT)}calculateTints(){if(this.batchTint!==this.tint){this.batchTint=this._tintColor.toNumber();for(let t=0;t<this.batches.length;t++){const e=this.batches[t];e._tintRGB=te.shared.setValue(this._tintColor).multiply(e._batchRGB).toLittleEndianNumber()}}}calculateVertices(){const t=this.transform._worldID;if(this._transformID===t)return;this._transformID=t;const e=this.transform.worldTransform,s=e.a,r=e.b,i=e.c,o=e.d,l=e.tx,a=e.ty,c=this._geometry.points,h=this.vertexData;let d=0;for(let u=0;u<c.length;u+=2){const f=c[u],m=c[u+1];h[d++]=s*f+i*m+l,h[d++]=o*m+r*f+a}}closePath(){const t=this.currentPath;return t&&(t.closeStroke=!0,this.finishPoly()),this}setMatrix(t){return this._matrix=t,this}beginHole(){return this.finishPoly(),this._holeMode=!0,this}endHole(){return this.finishPoly(),this._holeMode=!1,this}destroy(t){this._geometry.refCount--,this._geometry.refCount===0&&this._geometry.dispose(),this._matrix=null,this.currentPath=null,this._lineStyle.destroy(),this._lineStyle=null,this._fillStyle.destroy(),this._fillStyle=null,this._geometry=null,this.shader=null,this.vertexData=null,this.batches.length=0,this.batches=null,super.destroy(t)}};Yc.curves=bi,Yc._TEMP_POINT=new Xt;let Oh=Yc;class aE{constructor(t,e){this.uvBuffer=t,this.uvMatrix=e,this.data=null,this._bufferUpdateId=-1,this._textureUpdateId=-1,this._updateID=0}update(t){if(!t&&this._bufferUpdateId===this.uvBuffer._updateID&&this._textureUpdateId===this.uvMatrix._updateID)return;this._bufferUpdateId=this.uvBuffer._updateID,this._textureUpdateId=this.uvMatrix._updateID;const e=this.uvBuffer.data;(!this.data||this.data.length!==e.length)&&(this.data=new Float32Array(e.length)),this.uvMatrix.multiplyUvs(e,this.data),this._updateID++}}const Ul=new Xt,yf=new dr,Op=class jp extends ts{constructor(t,e,s,r=Ws.TRIANGLES){super(),this.geometry=t,this.shader=e,this.state=s||yn.for2d(),this.drawMode=r,this.start=0,this.size=0,this.uvs=null,this.indices=null,this.vertexData=new Float32Array(1),this.vertexDirty=-1,this._transformID=-1,this._roundPixels=ht.ROUND_PIXELS,this.batchUvs=null}get geometry(){return this._geometry}set geometry(t){this._geometry!==t&&(this._geometry&&(this._geometry.refCount--,this._geometry.refCount===0&&this._geometry.dispose()),this._geometry=t,this._geometry&&this._geometry.refCount++,this.vertexDirty=-1)}get uvBuffer(){return this.geometry.buffers[1]}get verticesBuffer(){return this.geometry.buffers[0]}set material(t){this.shader=t}get material(){return this.shader}set blendMode(t){this.state.blendMode=t}get blendMode(){return this.state.blendMode}set roundPixels(t){this._roundPixels!==t&&(this._transformID=-1),this._roundPixels=t}get roundPixels(){return this._roundPixels}get tint(){return"tint"in this.shader?this.shader.tint:null}set tint(t){this.shader.tint=t}get tintValue(){return this.shader.tintValue}get texture(){return"texture"in this.shader?this.shader.texture:null}set texture(t){this.shader.texture=t}_render(t){const e=this.geometry.buffers[0].data;this.shader.batchable&&this.drawMode===Ws.TRIANGLES&&e.length<jp.BATCHABLE_SIZE*2?this._renderToBatch(t):this._renderDefault(t)}_renderDefault(t){const e=this.shader;e.alpha=this.worldAlpha,e.update&&e.update(),t.batch.flush(),e.uniforms.translationMatrix=this.transform.worldTransform.toArray(!0),t.shader.bind(e),t.state.set(this.state),t.geometry.bind(this.geometry,e),t.geometry.draw(this.drawMode,this.size,this.start,this.geometry.instanceCount)}_renderToBatch(t){const e=this.geometry,s=this.shader;s.uvMatrix&&(s.uvMatrix.update(),this.calculateUvs()),this.calculateVertices(),this.indices=e.indexBuffer.data,this._tintRGB=s._tintRGB,this._texture=s.texture;const r=this.material.pluginName;t.batch.setObjectRenderer(t.plugins[r]),t.plugins[r].render(this)}calculateVertices(){const t=this.geometry.buffers[0],e=t.data,s=t._updateID;if(s===this.vertexDirty&&this._transformID===this.transform._worldID)return;this._transformID=this.transform._worldID,this.vertexData.length!==e.length&&(this.vertexData=new Float32Array(e.length));const r=this.transform.worldTransform,i=r.a,o=r.b,l=r.c,a=r.d,c=r.tx,h=r.ty,d=this.vertexData;for(let u=0;u<d.length/2;u++){const f=e[u*2],m=e[u*2+1];d[u*2]=i*f+l*m+c,d[u*2+1]=o*f+a*m+h}if(this._roundPixels){const u=ht.RESOLUTION;for(let f=0;f<d.length;++f)d[f]=Math.round(d[f]*u)/u}this.vertexDirty=s}calculateUvs(){const t=this.geometry.buffers[1],e=this.shader;e.uvMatrix.isSimple?this.uvs=t.data:(this.batchUvs||(this.batchUvs=new aE(t,e.uvMatrix)),this.batchUvs.update(),this.uvs=this.batchUvs.data)}_calculateBounds(){this.calculateVertices(),this._bounds.addVertexData(this.vertexData,0,this.vertexData.length)}containsPoint(t){if(!this.getBounds().contains(t.x,t.y))return!1;this.worldTransform.applyInverse(t,Ul);const e=this.geometry.getBuffer("aVertexPosition").data,s=yf.points,r=this.geometry.getIndex().data,i=r.length,o=this.drawMode===4?3:1;for(let l=0;l+2<i;l+=o){const a=r[l]*2,c=r[l+1]*2,h=r[l+2]*2;if(s[0]=e[a],s[1]=e[a+1],s[2]=e[c],s[3]=e[c+1],s[4]=e[h],s[5]=e[h+1],yf.contains(Ul.x,Ul.y))return!0}return!1}destroy(t){super.destroy(t),this._cachedTexture&&(this._cachedTexture.destroy(),this._cachedTexture=null),this.geometry=null,this.shader=null,this.state=null,this.uvs=null,this.indices=null,this.vertexData=null}};Op.BATCHABLE_SIZE=100;let $c=Op;class Vp extends fr{constructor(t,e,s){super();const r=new ve(t),i=new ve(e,!0),o=new ve(s,!0,!0);this.addAttribute("aVertexPosition",r,2,!1,yt.FLOAT).addAttribute("aTextureCoord",i,2,!1,yt.FLOAT).addIndex(o),this._updateId=-1}get vertexDirtyId(){return this.buffers[0]._updateID}}var oE=`varying vec2 vTextureCoord;
uniform vec4 uColor;

uniform sampler2D uSampler;

void main(void)
{
    gl_FragColor = texture2D(uSampler, vTextureCoord) * uColor;
}
`,lE=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTextureMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;
}
`;class Wc extends gn{constructor(t,e){const s={uSampler:t,alpha:1,uTextureMatrix:Zt.IDENTITY,uColor:new Float32Array([1,1,1,1])};e=Object.assign({tint:16777215,alpha:1,pluginName:"batch"},e),e.uniforms&&Object.assign(s,e.uniforms),super(e.program||Pn.from(lE,oE),s),this._colorDirty=!1,this.uvMatrix=new sp(t),this.batchable=e.program===void 0,this.pluginName=e.pluginName,this._tintColor=new te(e.tint),this._tintRGB=this._tintColor.toLittleEndianNumber(),this._colorDirty=!0,this.alpha=e.alpha}get texture(){return this.uniforms.uSampler}set texture(t){this.uniforms.uSampler!==t&&(!this.uniforms.uSampler.baseTexture.alphaMode!=!t.baseTexture.alphaMode&&(this._colorDirty=!0),this.uniforms.uSampler=t,this.uvMatrix.texture=t)}set alpha(t){t!==this._alpha&&(this._alpha=t,this._colorDirty=!0)}get alpha(){return this._alpha}set tint(t){t!==this.tint&&(this._tintColor.setValue(t),this._tintRGB=this._tintColor.toLittleEndianNumber(),this._colorDirty=!0)}get tint(){return this._tintColor.value}get tintValue(){return this._tintColor.toNumber()}update(){if(this._colorDirty){this._colorDirty=!1;const t=this.texture.baseTexture.alphaMode;te.shared.setValue(this._tintColor).premultiply(this._alpha,t).toArray(this.uniforms.uColor)}this.uvMatrix.update()&&(this.uniforms.uTextureMatrix=this.uvMatrix.mapCoord)}}class cE extends $c{constructor(t=mt.EMPTY,e,s,r,i){const o=new Vp(e,s,r);o.getBuffer("aVertexPosition").static=!1;const l=new Wc(t);super(o,l,null,i),this.autoUpdate=!0}get vertices(){return this.geometry.getBuffer("aVertexPosition").data}set vertices(t){this.geometry.getBuffer("aVertexPosition").data=t}_render(t){this.autoUpdate&&this.geometry.getBuffer("aVertexPosition").update(),super._render(t)}}class wf{constructor(t,e,s){this.geometry=new fr,this.indexBuffer=null,this.size=s,this.dynamicProperties=[],this.staticProperties=[];for(let r=0;r<t.length;++r){let i=t[r];i={attributeName:i.attributeName,size:i.size,uploadFunction:i.uploadFunction,type:i.type||yt.FLOAT,offset:i.offset},e[r]?this.dynamicProperties.push(i):this.staticProperties.push(i)}this.staticStride=0,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.dynamicStride=0,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this._updateID=0,this.initBuffers()}initBuffers(){const t=this.geometry;let e=0;this.indexBuffer=new ve(A1(this.size),!0,!0),t.addIndex(this.indexBuffer),this.dynamicStride=0;for(let o=0;o<this.dynamicProperties.length;++o){const l=this.dynamicProperties[o];l.offset=e,e+=l.size,this.dynamicStride+=l.size}const s=new ArrayBuffer(this.size*this.dynamicStride*4*4);this.dynamicData=new Float32Array(s),this.dynamicDataUint32=new Uint32Array(s),this.dynamicBuffer=new ve(this.dynamicData,!1,!1);let r=0;this.staticStride=0;for(let o=0;o<this.staticProperties.length;++o){const l=this.staticProperties[o];l.offset=r,r+=l.size,this.staticStride+=l.size}const i=new ArrayBuffer(this.size*this.staticStride*4*4);this.staticData=new Float32Array(i),this.staticDataUint32=new Uint32Array(i),this.staticBuffer=new ve(this.staticData,!0,!1);for(let o=0;o<this.dynamicProperties.length;++o){const l=this.dynamicProperties[o];t.addAttribute(l.attributeName,this.dynamicBuffer,0,l.type===yt.UNSIGNED_BYTE,l.type,this.dynamicStride*4,l.offset*4)}for(let o=0;o<this.staticProperties.length;++o){const l=this.staticProperties[o];t.addAttribute(l.attributeName,this.staticBuffer,0,l.type===yt.UNSIGNED_BYTE,l.type,this.staticStride*4,l.offset*4)}}uploadDynamic(t,e,s){for(let r=0;r<this.dynamicProperties.length;r++){const i=this.dynamicProperties[r];i.uploadFunction(t,e,s,i.type===yt.UNSIGNED_BYTE?this.dynamicDataUint32:this.dynamicData,this.dynamicStride,i.offset)}this.dynamicBuffer._updateID++}uploadStatic(t,e,s){for(let r=0;r<this.staticProperties.length;r++){const i=this.staticProperties[r];i.uploadFunction(t,e,s,i.type===yt.UNSIGNED_BYTE?this.staticDataUint32:this.staticData,this.staticStride,i.offset)}this.staticBuffer._updateID++}destroy(){this.indexBuffer=null,this.dynamicProperties=null,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this.staticProperties=null,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.geometry.destroy()}}var hE=`varying vec2 vTextureCoord;
varying vec4 vColor;

uniform sampler2D uSampler;

void main(void){
    vec4 color = texture2D(uSampler, vTextureCoord) * vColor;
    gl_FragColor = color;
}`,dE=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;

attribute vec2 aPositionCoord;
attribute float aRotation;

uniform mat3 translationMatrix;
uniform vec4 uColor;

varying vec2 vTextureCoord;
varying vec4 vColor;

void main(void){
    float x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);
    float y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);

    vec2 v = vec2(x, y);
    v = v + aPositionCoord;

    gl_Position = vec4((translationMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vColor = aColor * uColor;
}
`;class Up extends Yo{constructor(t){super(t),this.shader=null,this.properties=null,this.tempMatrix=new Zt,this.properties=[{attributeName:"aVertexPosition",size:2,uploadFunction:this.uploadVertices,offset:0},{attributeName:"aPositionCoord",size:2,uploadFunction:this.uploadPosition,offset:0},{attributeName:"aRotation",size:1,uploadFunction:this.uploadRotation,offset:0},{attributeName:"aTextureCoord",size:2,uploadFunction:this.uploadUvs,offset:0},{attributeName:"aColor",size:1,type:yt.UNSIGNED_BYTE,uploadFunction:this.uploadTint,offset:0}],this.shader=gn.from(dE,hE,{}),this.state=yn.for2d()}render(t){const e=t.children,s=t._maxSize,r=t._batchSize,i=this.renderer;let o=e.length;if(o===0)return;o>s&&!t.autoResize&&(o=s);let l=t._buffers;l||(l=t._buffers=this.generateBuffers(t));const a=e[0]._texture.baseTexture,c=a.alphaMode>0;this.state.blendMode=jm(t.blendMode,c),i.state.set(this.state);const h=i.gl,d=t.worldTransform.copyTo(this.tempMatrix);d.prepend(i.globalUniforms.uniforms.projectionMatrix),this.shader.uniforms.translationMatrix=d.toArray(!0),this.shader.uniforms.uColor=te.shared.setValue(t.tintRgb).premultiply(t.worldAlpha,c).toArray(this.shader.uniforms.uColor),this.shader.uniforms.uSampler=a,this.renderer.shader.bind(this.shader);let u=!1;for(let f=0,m=0;f<o;f+=r,m+=1){let p=o-f;p>r&&(p=r),m>=l.length&&l.push(this._generateOneMoreBuffer(t));const g=l[m];g.uploadDynamic(e,f,p);const w=t._bufferUpdateIDs[m]||0;u=u||g._updateID<w,u&&(g._updateID=t._updateID,g.uploadStatic(e,f,p)),i.geometry.bind(g.geometry),h.drawElements(h.TRIANGLES,p*6,h.UNSIGNED_SHORT,0)}}generateBuffers(t){const e=[],s=t._maxSize,r=t._batchSize,i=t._properties;for(let o=0;o<s;o+=r)e.push(new wf(this.properties,i,r));return e}_generateOneMoreBuffer(t){const e=t._batchSize,s=t._properties;return new wf(this.properties,s,e)}uploadVertices(t,e,s,r,i,o){let l=0,a=0,c=0,h=0;for(let d=0;d<s;++d){const u=t[e+d],f=u._texture,m=u.scale.x,p=u.scale.y,g=f.trim,w=f.orig;g?(a=g.x-u.anchor.x*w.width,l=a+g.width,h=g.y-u.anchor.y*w.height,c=h+g.height):(l=w.width*(1-u.anchor.x),a=w.width*-u.anchor.x,c=w.height*(1-u.anchor.y),h=w.height*-u.anchor.y),r[o]=a*m,r[o+1]=h*p,r[o+i]=l*m,r[o+i+1]=h*p,r[o+i*2]=l*m,r[o+i*2+1]=c*p,r[o+i*3]=a*m,r[o+i*3+1]=c*p,o+=i*4}}uploadPosition(t,e,s,r,i,o){for(let l=0;l<s;l++){const a=t[e+l].position;r[o]=a.x,r[o+1]=a.y,r[o+i]=a.x,r[o+i+1]=a.y,r[o+i*2]=a.x,r[o+i*2+1]=a.y,r[o+i*3]=a.x,r[o+i*3+1]=a.y,o+=i*4}}uploadRotation(t,e,s,r,i,o){for(let l=0;l<s;l++){const a=t[e+l].rotation;r[o]=a,r[o+i]=a,r[o+i*2]=a,r[o+i*3]=a,o+=i*4}}uploadUvs(t,e,s,r,i,o){for(let l=0;l<s;++l){const a=t[e+l]._texture._uvs;a?(r[o]=a.x0,r[o+1]=a.y0,r[o+i]=a.x1,r[o+i+1]=a.y1,r[o+i*2]=a.x2,r[o+i*2+1]=a.y2,r[o+i*3]=a.x3,r[o+i*3+1]=a.y3,o+=i*4):(r[o]=0,r[o+1]=0,r[o+i]=0,r[o+i+1]=0,r[o+i*2]=0,r[o+i*2+1]=0,r[o+i*3]=0,r[o+i*3+1]=0,o+=i*4)}}uploadTint(t,e,s,r,i,o){for(let l=0;l<s;++l){const a=t[e+l],c=te.shared.setValue(a._tintRGB).toPremultiplied(a.alpha,a.texture.baseTexture.alphaMode>0);r[o]=c,r[o+i]=c,r[o+i*2]=c,r[o+i*3]=c,o+=i*4}}destroy(){super.destroy(),this.shader&&(this.shader.destroy(),this.shader=null),this.tempMatrix=null}}Up.extension={name:"particle",type:ot.RendererPlugin};pt.add(Up);var zo=(n=>(n[n.LINEAR_VERTICAL=0]="LINEAR_VERTICAL",n[n.LINEAR_HORIZONTAL=1]="LINEAR_HORIZONTAL",n))(zo||{});const Ua={willReadFrequently:!0},ln=class xt{static get experimentalLetterSpacingSupported(){let t=xt._experimentalLetterSpacingSupported;if(t!==void 0){const e=ht.ADAPTER.getCanvasRenderingContext2D().prototype;t=xt._experimentalLetterSpacingSupported="letterSpacing"in e||"textLetterSpacing"in e}return t}constructor(t,e,s,r,i,o,l,a,c){this.text=t,this.style=e,this.width=s,this.height=r,this.lines=i,this.lineWidths=o,this.lineHeight=l,this.maxLineWidth=a,this.fontProperties=c}static measureText(t,e,s,r=xt._canvas){s=s??e.wordWrap;const i=e.toFontString(),o=xt.measureFont(i);o.fontSize===0&&(o.fontSize=e.fontSize,o.ascent=e.fontSize);const l=r.getContext("2d",Ua);l.font=i;const a=(s?xt.wordWrap(t,e,r):t).split(/(?:\r\n|\r|\n)/),c=new Array(a.length);let h=0;for(let m=0;m<a.length;m++){const p=xt._measureText(a[m],e.letterSpacing,l);c[m]=p,h=Math.max(h,p)}let d=h+e.strokeThickness;e.dropShadow&&(d+=e.dropShadowDistance);const u=e.lineHeight||o.fontSize+e.strokeThickness;let f=Math.max(u,o.fontSize+e.strokeThickness*2)+e.leading+(a.length-1)*(u+e.leading);return e.dropShadow&&(f+=e.dropShadowDistance),new xt(t,e,d,f,a,c,u+e.leading,h,o)}static _measureText(t,e,s){let r=!1;xt.experimentalLetterSpacingSupported&&(xt.experimentalLetterSpacing?(s.letterSpacing=`${e}px`,s.textLetterSpacing=`${e}px`,r=!0):(s.letterSpacing="0px",s.textLetterSpacing="0px"));let i=s.measureText(t).width;return i>0&&(r?i-=e:i+=(xt.graphemeSegmenter(t).length-1)*e),i}static wordWrap(t,e,s=xt._canvas){const r=s.getContext("2d",Ua);let i=0,o="",l="";const a=Object.create(null),{letterSpacing:c,whiteSpace:h}=e,d=xt.collapseSpaces(h),u=xt.collapseNewlines(h);let f=!d;const m=e.wordWrapWidth+c,p=xt.tokenize(t);for(let g=0;g<p.length;g++){let w=p[g];if(xt.isNewline(w)){if(!u){l+=xt.addLine(o),f=!d,o="",i=0;continue}w=" "}if(d){const y=xt.isBreakingSpace(w),b=xt.isBreakingSpace(o[o.length-1]);if(y&&b)continue}const x=xt.getFromCache(w,c,a,r);if(x>m)if(o!==""&&(l+=xt.addLine(o),o="",i=0),xt.canBreakWords(w,e.breakWords)){const y=xt.wordWrapSplit(w);for(let b=0;b<y.length;b++){let _=y[b],E=_,S=1;for(;y[b+S];){const C=y[b+S];if(!xt.canBreakChars(E,C,w,b,e.breakWords))_+=C;else break;E=C,S++}b+=S-1;const T=xt.getFromCache(_,c,a,r);T+i>m&&(l+=xt.addLine(o),f=!1,o="",i=0),o+=_,i+=T}}else{o.length>0&&(l+=xt.addLine(o),o="",i=0);const y=g===p.length-1;l+=xt.addLine(w,!y),f=!1,o="",i=0}else x+i>m&&(f=!1,l+=xt.addLine(o),o="",i=0),(o.length>0||!xt.isBreakingSpace(w)||f)&&(o+=w,i+=x)}return l+=xt.addLine(o,!1),l}static addLine(t,e=!0){return t=xt.trimRight(t),t=e?`${t}
`:t,t}static getFromCache(t,e,s,r){let i=s[t];return typeof i!="number"&&(i=xt._measureText(t,e,r)+e,s[t]=i),i}static collapseSpaces(t){return t==="normal"||t==="pre-line"}static collapseNewlines(t){return t==="normal"}static trimRight(t){if(typeof t!="string")return"";for(let e=t.length-1;e>=0;e--){const s=t[e];if(!xt.isBreakingSpace(s))break;t=t.slice(0,-1)}return t}static isNewline(t){return typeof t!="string"?!1:xt._newlines.includes(t.charCodeAt(0))}static isBreakingSpace(t,e){return typeof t!="string"?!1:xt._breakingSpaces.includes(t.charCodeAt(0))}static tokenize(t){const e=[];let s="";if(typeof t!="string")return e;for(let r=0;r<t.length;r++){const i=t[r],o=t[r+1];if(xt.isBreakingSpace(i,o)||xt.isNewline(i)){s!==""&&(e.push(s),s=""),e.push(i);continue}s+=i}return s!==""&&e.push(s),e}static canBreakWords(t,e){return e}static canBreakChars(t,e,s,r,i){return!0}static wordWrapSplit(t){return xt.graphemeSegmenter(t)}static measureFont(t){if(xt._fonts[t])return xt._fonts[t];const e={ascent:0,descent:0,fontSize:0},s=xt._canvas,r=xt._context;r.font=t;const i=xt.METRICS_STRING+xt.BASELINE_SYMBOL,o=Math.ceil(r.measureText(i).width);let l=Math.ceil(r.measureText(xt.BASELINE_SYMBOL).width);const a=Math.ceil(xt.HEIGHT_MULTIPLIER*l);if(l=l*xt.BASELINE_MULTIPLIER|0,o===0||a===0)return xt._fonts[t]=e,e;s.width=o,s.height=a,r.fillStyle="#f00",r.fillRect(0,0,o,a),r.font=t,r.textBaseline="alphabetic",r.fillStyle="#000",r.fillText(i,0,l);const c=r.getImageData(0,0,o,a).data,h=c.length,d=o*4;let u=0,f=0,m=!1;for(u=0;u<l;++u){for(let p=0;p<d;p+=4)if(c[f+p]!==255){m=!0;break}if(!m)f+=d;else break}for(e.ascent=l-u,f=h-d,m=!1,u=a;u>l;--u){for(let p=0;p<d;p+=4)if(c[f+p]!==255){m=!0;break}if(!m)f-=d;else break}return e.descent=u-l,e.fontSize=e.ascent+e.descent,xt._fonts[t]=e,e}static clearMetrics(t=""){t?delete xt._fonts[t]:xt._fonts={}}static get _canvas(){var t;if(!xt.__canvas){let e;try{const s=new OffscreenCanvas(0,0);if((t=s.getContext("2d",Ua))!=null&&t.measureText)return xt.__canvas=s,s;e=ht.ADAPTER.createCanvas()}catch{e=ht.ADAPTER.createCanvas()}e.width=e.height=10,xt.__canvas=e}return xt.__canvas}static get _context(){return xt.__context||(xt.__context=xt._canvas.getContext("2d",Ua)),xt.__context}};ln.METRICS_STRING="|Ã‰qÃ…",ln.BASELINE_SYMBOL="M",ln.BASELINE_MULTIPLIER=1.4,ln.HEIGHT_MULTIPLIER=2,ln.graphemeSegmenter=(()=>{if(typeof(Intl==null?void 0:Intl.Segmenter)=="function"){const n=new Intl.Segmenter;return t=>[...n.segment(t)].map(e=>e.segment)}return n=>[...n]})(),ln.experimentalLetterSpacing=!1,ln._fonts={},ln._newlines=[10,13],ln._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];let er=ln;const uE=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],Xp=class $i{constructor(t){this.styleID=0,this.reset(),Gl(this,t,t)}clone(){const t={};return Gl(t,this,$i.defaultStyle),new $i(t)}reset(){Gl(this,$i.defaultStyle,$i.defaultStyle)}get align(){return this._align}set align(t){this._align!==t&&(this._align=t,this.styleID++)}get breakWords(){return this._breakWords}set breakWords(t){this._breakWords!==t&&(this._breakWords=t,this.styleID++)}get dropShadow(){return this._dropShadow}set dropShadow(t){this._dropShadow!==t&&(this._dropShadow=t,this.styleID++)}get dropShadowAlpha(){return this._dropShadowAlpha}set dropShadowAlpha(t){this._dropShadowAlpha!==t&&(this._dropShadowAlpha=t,this.styleID++)}get dropShadowAngle(){return this._dropShadowAngle}set dropShadowAngle(t){this._dropShadowAngle!==t&&(this._dropShadowAngle=t,this.styleID++)}get dropShadowBlur(){return this._dropShadowBlur}set dropShadowBlur(t){this._dropShadowBlur!==t&&(this._dropShadowBlur=t,this.styleID++)}get dropShadowColor(){return this._dropShadowColor}set dropShadowColor(t){const e=Xl(t);this._dropShadowColor!==e&&(this._dropShadowColor=e,this.styleID++)}get dropShadowDistance(){return this._dropShadowDistance}set dropShadowDistance(t){this._dropShadowDistance!==t&&(this._dropShadowDistance=t,this.styleID++)}get fill(){return this._fill}set fill(t){const e=Xl(t);this._fill!==e&&(this._fill=e,this.styleID++)}get fillGradientType(){return this._fillGradientType}set fillGradientType(t){this._fillGradientType!==t&&(this._fillGradientType=t,this.styleID++)}get fillGradientStops(){return this._fillGradientStops}set fillGradientStops(t){fE(this._fillGradientStops,t)||(this._fillGradientStops=t,this.styleID++)}get fontFamily(){return this._fontFamily}set fontFamily(t){this.fontFamily!==t&&(this._fontFamily=t,this.styleID++)}get fontSize(){return this._fontSize}set fontSize(t){this._fontSize!==t&&(this._fontSize=t,this.styleID++)}get fontStyle(){return this._fontStyle}set fontStyle(t){this._fontStyle!==t&&(this._fontStyle=t,this.styleID++)}get fontVariant(){return this._fontVariant}set fontVariant(t){this._fontVariant!==t&&(this._fontVariant=t,this.styleID++)}get fontWeight(){return this._fontWeight}set fontWeight(t){this._fontWeight!==t&&(this._fontWeight=t,this.styleID++)}get letterSpacing(){return this._letterSpacing}set letterSpacing(t){this._letterSpacing!==t&&(this._letterSpacing=t,this.styleID++)}get lineHeight(){return this._lineHeight}set lineHeight(t){this._lineHeight!==t&&(this._lineHeight=t,this.styleID++)}get leading(){return this._leading}set leading(t){this._leading!==t&&(this._leading=t,this.styleID++)}get lineJoin(){return this._lineJoin}set lineJoin(t){this._lineJoin!==t&&(this._lineJoin=t,this.styleID++)}get miterLimit(){return this._miterLimit}set miterLimit(t){this._miterLimit!==t&&(this._miterLimit=t,this.styleID++)}get padding(){return this._padding}set padding(t){this._padding!==t&&(this._padding=t,this.styleID++)}get stroke(){return this._stroke}set stroke(t){const e=Xl(t);this._stroke!==e&&(this._stroke=e,this.styleID++)}get strokeThickness(){return this._strokeThickness}set strokeThickness(t){this._strokeThickness!==t&&(this._strokeThickness=t,this.styleID++)}get textBaseline(){return this._textBaseline}set textBaseline(t){this._textBaseline!==t&&(this._textBaseline=t,this.styleID++)}get trim(){return this._trim}set trim(t){this._trim!==t&&(this._trim=t,this.styleID++)}get whiteSpace(){return this._whiteSpace}set whiteSpace(t){this._whiteSpace!==t&&(this._whiteSpace=t,this.styleID++)}get wordWrap(){return this._wordWrap}set wordWrap(t){this._wordWrap!==t&&(this._wordWrap=t,this.styleID++)}get wordWrapWidth(){return this._wordWrapWidth}set wordWrapWidth(t){this._wordWrapWidth!==t&&(this._wordWrapWidth=t,this.styleID++)}toFontString(){const t=typeof this.fontSize=="number"?`${this.fontSize}px`:this.fontSize;let e=this.fontFamily;Array.isArray(this.fontFamily)||(e=this.fontFamily.split(","));for(let s=e.length-1;s>=0;s--){let r=e[s].trim();!/([\"\'])[^\'\"]+\1/.test(r)&&!uE.includes(r)&&(r=`"${r}"`),e[s]=r}return`${this.fontStyle} ${this.fontVariant} ${this.fontWeight} ${t} ${e.join(",")}`}};Xp.defaultStyle={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fillGradientType:zo.LINEAR_VERTICAL,fillGradientStops:[],fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",leading:0,letterSpacing:0,lineHeight:0,lineJoin:"miter",miterLimit:10,padding:0,stroke:"black",strokeThickness:0,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100};let mr=Xp;function Xl(n){const t=te.shared,e=s=>{const r=t.setValue(s);return r.alpha===1?r.toHex():r.toRgbaString()};return Array.isArray(n)?n.map(e):e(n)}function fE(n,t){if(!Array.isArray(n)||!Array.isArray(t)||n.length!==t.length)return!1;for(let e=0;e<n.length;++e)if(n[e]!==t[e])return!1;return!0}function Gl(n,t,e){for(const s in e)Array.isArray(t[s])?n[s]=t[s].slice():n[s]=t[s]}const mE={texture:!0,children:!1,baseTexture:!0},Gp=class zc extends Wr{constructor(t,e,s){let r=!1;s||(s=ht.ADAPTER.createCanvas(),r=!0),s.width=3,s.height=3;const i=mt.from(s);i.orig=new vt,i.trim=new vt,super(i),this._ownCanvas=r,this.canvas=s,this.context=s.getContext("2d",{willReadFrequently:!0}),this._resolution=zc.defaultResolution??ht.RESOLUTION,this._autoResolution=zc.defaultAutoResolution,this._text=null,this._style=null,this._styleListener=null,this._font="",this.text=t,this.style=e,this.localStyleID=-1}static get experimentalLetterSpacing(){return er.experimentalLetterSpacing}static set experimentalLetterSpacing(t){Pt("7.1.0","Text.experimentalLetterSpacing is deprecated, use TextMetrics.experimentalLetterSpacing"),er.experimentalLetterSpacing=t}updateText(t){const e=this._style;if(this.localStyleID!==e.styleID&&(this.dirty=!0,this.localStyleID=e.styleID),!this.dirty&&t)return;this._font=this._style.toFontString();const s=this.context,r=er.measureText(this._text||" ",this._style,this._style.wordWrap,this.canvas),i=r.width,o=r.height,l=r.lines,a=r.lineHeight,c=r.lineWidths,h=r.maxLineWidth,d=r.fontProperties;this.canvas.width=Math.ceil(Math.ceil(Math.max(1,i)+e.padding*2)*this._resolution),this.canvas.height=Math.ceil(Math.ceil(Math.max(1,o)+e.padding*2)*this._resolution),s.scale(this._resolution,this._resolution),s.clearRect(0,0,this.canvas.width,this.canvas.height),s.font=this._font,s.lineWidth=e.strokeThickness,s.textBaseline=e.textBaseline,s.lineJoin=e.lineJoin,s.miterLimit=e.miterLimit;let u,f;const m=e.dropShadow?2:1;for(let p=0;p<m;++p){const g=e.dropShadow&&p===0,w=g?Math.ceil(Math.max(1,o)+e.padding*2):0,x=w*this._resolution;if(g){s.fillStyle="black",s.strokeStyle="black";const b=e.dropShadowColor,_=e.dropShadowBlur*this._resolution,E=e.dropShadowDistance*this._resolution;s.shadowColor=te.shared.setValue(b).setAlpha(e.dropShadowAlpha).toRgbaString(),s.shadowBlur=_,s.shadowOffsetX=Math.cos(e.dropShadowAngle)*E,s.shadowOffsetY=Math.sin(e.dropShadowAngle)*E+x}else s.fillStyle=this._generateFillStyle(e,l,r),s.strokeStyle=e.stroke,s.shadowColor="black",s.shadowBlur=0,s.shadowOffsetX=0,s.shadowOffsetY=0;let y=(a-d.fontSize)/2;a-d.fontSize<0&&(y=0);for(let b=0;b<l.length;b++)u=e.strokeThickness/2,f=e.strokeThickness/2+b*a+d.ascent+y,e.align==="right"?u+=h-c[b]:e.align==="center"&&(u+=(h-c[b])/2),e.stroke&&e.strokeThickness&&this.drawLetterSpacing(l[b],u+e.padding,f+e.padding-w,!0),e.fill&&this.drawLetterSpacing(l[b],u+e.padding,f+e.padding-w)}this.updateTexture()}drawLetterSpacing(t,e,s,r=!1){const i=this._style.letterSpacing;let o=!1;if(er.experimentalLetterSpacingSupported&&(er.experimentalLetterSpacing?(this.context.letterSpacing=`${i}px`,this.context.textLetterSpacing=`${i}px`,o=!0):(this.context.letterSpacing="0px",this.context.textLetterSpacing="0px")),i===0||o){r?this.context.strokeText(t,e,s):this.context.fillText(t,e,s);return}let l=e;const a=er.graphemeSegmenter(t);let c=this.context.measureText(t).width,h=0;for(let d=0;d<a.length;++d){const u=a[d];r?this.context.strokeText(u,l,s):this.context.fillText(u,l,s);let f="";for(let m=d+1;m<a.length;++m)f+=a[m];h=this.context.measureText(f).width,l+=c-h+i,c=h}}updateTexture(){const t=this.canvas;if(this._style.trim){const o=R1(t);o.data&&(t.width=o.width,t.height=o.height,this.context.putImageData(o.data,0,0))}const e=this._texture,s=this._style,r=s.trim?0:s.padding,i=e.baseTexture;e.trim.width=e._frame.width=t.width/this._resolution,e.trim.height=e._frame.height=t.height/this._resolution,e.trim.x=-r,e.trim.y=-r,e.orig.width=e._frame.width-r*2,e.orig.height=e._frame.height-r*2,this._onTextureUpdate(),i.setRealSize(t.width,t.height,this._resolution),e.updateUvs(),this.dirty=!1}_render(t){this._autoResolution&&this._resolution!==t.resolution&&(this._resolution=t.resolution,this.dirty=!0),this.updateText(!0),super._render(t)}updateTransform(){this.updateText(!0),super.updateTransform()}getBounds(t,e){return this.updateText(!0),this._textureID===-1&&(t=!1),super.getBounds(t,e)}getLocalBounds(t){return this.updateText(!0),super.getLocalBounds.call(this,t)}_calculateBounds(){this.calculateVertices(),this._bounds.addQuad(this.vertexData)}_generateFillStyle(t,e,s){const r=t.fill;if(Array.isArray(r)){if(r.length===1)return r[0]}else return r;let i;const o=t.dropShadow?t.dropShadowDistance:0,l=t.padding||0,a=this.canvas.width/this._resolution-o-l*2,c=this.canvas.height/this._resolution-o-l*2,h=r.slice(),d=t.fillGradientStops.slice();if(!d.length){const u=h.length+1;for(let f=1;f<u;++f)d.push(f/u)}if(h.unshift(r[0]),d.unshift(0),h.push(r[r.length-1]),d.push(1),t.fillGradientType===zo.LINEAR_VERTICAL){i=this.context.createLinearGradient(a/2,l,a/2,c+l);const u=s.fontProperties.fontSize+t.strokeThickness;for(let f=0;f<e.length;f++){const m=s.lineHeight*(f-1)+u,p=s.lineHeight*f;let g=p;f>0&&m>p&&(g=(p+m)/2);const w=p+u,x=s.lineHeight*(f+1);let y=w;f+1<e.length&&x<w&&(y=(w+x)/2);const b=(y-g)/c;for(let _=0;_<h.length;_++){let E=0;typeof d[_]=="number"?E=d[_]:E=_/h.length;let S=Math.min(1,Math.max(0,g/c+E*b));S=Number(S.toFixed(5)),i.addColorStop(S,h[_])}}}else{i=this.context.createLinearGradient(l,c/2,a+l,c/2);const u=h.length+1;let f=1;for(let m=0;m<h.length;m++){let p;typeof d[m]=="number"?p=d[m]:p=f/u,i.addColorStop(p,h[m]),f++}}return i}destroy(t){typeof t=="boolean"&&(t={children:t}),t=Object.assign({},mE,t),super.destroy(t),this._ownCanvas&&(this.canvas.height=this.canvas.width=0),this.context=null,this.canvas=null,this._style=null}get width(){return this.updateText(!0),Math.abs(this.scale.x)*this._texture.orig.width}set width(t){this.updateText(!0);const e=lr(this.scale.x)||1;this.scale.x=e*t/this._texture.orig.width,this._width=t}get height(){return this.updateText(!0),Math.abs(this.scale.y)*this._texture.orig.height}set height(t){this.updateText(!0);const e=lr(this.scale.y)||1;this.scale.y=e*t/this._texture.orig.height,this._height=t}get style(){return this._style}set style(t){t=t||{},t instanceof mr?this._style=t:this._style=new mr(t),this.localStyleID=-1,this.dirty=!0}get text(){return this._text}set text(t){t=String(t??""),this._text!==t&&(this._text=t,this.dirty=!0)}get resolution(){return this._resolution}set resolution(t){this._autoResolution=!1,this._resolution!==t&&(this._resolution=t,this.dirty=!0)}};Gp.defaultAutoResolution=!0;let Yp=Gp;class pE{constructor(t){this.maxItemsPerFrame=t,this.itemsLeft=0}beginFrame(){this.itemsLeft=this.maxItemsPerFrame}allowedToUpload(){return this.itemsLeft-- >0}}function gE(n,t){var s;let e=!1;if((s=n==null?void 0:n._textures)!=null&&s.length){for(let r=0;r<n._textures.length;r++)if(n._textures[r]instanceof mt){const i=n._textures[r].baseTexture;t.includes(i)||(t.push(i),e=!0)}}return e}function xE(n,t){if(n.baseTexture instanceof _t){const e=n.baseTexture;return t.includes(e)||t.push(e),!0}return!1}function bE(n,t){if(n._texture&&n._texture instanceof mt){const e=n._texture.baseTexture;return t.includes(e)||t.push(e),!0}return!1}function yE(n,t){return t instanceof Yp?(t.updateText(!0),!0):!1}function wE(n,t){if(t instanceof mr){const e=t.toFontString();return er.measureFont(e),!0}return!1}function vE(n,t){if(n instanceof Yp){t.includes(n.style)||t.push(n.style),t.includes(n)||t.push(n);const e=n._texture.baseTexture;return t.includes(e)||t.push(e),!0}return!1}function _E(n,t){return n instanceof mr?(t.includes(n)||t.push(n),!0):!1}const $p=class Wp{constructor(t){this.limiter=new pE(Wp.uploadsPerFrame),this.renderer=t,this.uploadHookHelper=null,this.queue=[],this.addHooks=[],this.uploadHooks=[],this.completes=[],this.ticking=!1,this.delayedTick=()=>{this.queue&&this.prepareItems()},this.registerFindHook(vE),this.registerFindHook(_E),this.registerFindHook(gE),this.registerFindHook(xE),this.registerFindHook(bE),this.registerUploadHook(yE),this.registerUploadHook(wE)}upload(t){return new Promise(e=>{t&&this.add(t),this.queue.length?(this.completes.push(e),this.ticking||(this.ticking=!0,gs.system.addOnce(this.tick,this,Ur.UTILITY))):e()})}tick(){setTimeout(this.delayedTick,0)}prepareItems(){for(this.limiter.beginFrame();this.queue.length&&this.limiter.allowedToUpload();){const t=this.queue[0];let e=!1;if(t&&!t._destroyed){for(let s=0,r=this.uploadHooks.length;s<r;s++)if(this.uploadHooks[s](this.uploadHookHelper,t)){this.queue.shift(),e=!0;break}}e||this.queue.shift()}if(this.queue.length)gs.system.addOnce(this.tick,this,Ur.UTILITY);else{this.ticking=!1;const t=this.completes.slice(0);this.completes.length=0;for(let e=0,s=t.length;e<s;e++)t[e]()}}registerFindHook(t){return t&&this.addHooks.push(t),this}registerUploadHook(t){return t&&this.uploadHooks.push(t),this}add(t){for(let e=0,s=this.addHooks.length;e<s&&!this.addHooks[e](t,this.queue);e++);if(t instanceof ts)for(let e=t.children.length-1;e>=0;e--)this.add(t.children[e]);return this}destroy(){this.ticking&&gs.system.remove(this.tick,this),this.ticking=!1,this.addHooks=null,this.uploadHooks=null,this.renderer=null,this.completes=null,this.queue=null,this.limiter=null,this.uploadHookHelper=null}};$p.uploadsPerFrame=4;let Hc=$p;Object.defineProperties(ht,{UPLOADS_PER_FRAME:{get(){return Hc.uploadsPerFrame},set(n){Pt("7.1.0","settings.UPLOADS_PER_FRAME is deprecated, use prepare.BasePrepare.uploadsPerFrame"),Hc.uploadsPerFrame=n}}});function zp(n,t){return t instanceof _t?(t._glTextures[n.CONTEXT_UID]||n.texture.bind(t),!0):!1}function EE(n,t){if(!(t instanceof Oh))return!1;const{geometry:e}=t;t.finishPoly(),e.updateBatches();const{batches:s}=e;for(let r=0;r<s.length;r++){const{texture:i}=s[r].style;i&&zp(n,i.baseTexture)}return e.batchable||n.geometry.bind(e,t._resolveDirectShader(n)),!0}function SE(n,t){return n instanceof Oh?(t.push(n),!0):!1}class Hp extends Hc{constructor(t){super(t),this.uploadHookHelper=this.renderer,this.registerFindHook(SE),this.registerUploadHook(zp),this.registerUploadHook(EE)}}Hp.extension={name:"prepare",type:ot.RendererSystem};pt.add(Hp);var TE=`#version 300 es
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

in vec2 vTextureCoord;

out vec4 fragmentColor;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    vec2 unclamped = coord;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    vec4 texSample = texture(uSampler, coord, unclamped == coord ? 0.0f : -32.0f);// lod-bias very negative to force lod 0

    fragmentColor = texSample * uColor;
}
`,AE=`#version 300 es
#define SHADER_NAME Tiling-Sprite-300

precision lowp float;

in vec2 aVertexPosition;
in vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

out vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`,CE=`#version 100
#ifdef GL_EXT_shader_texture_lod
    #extension GL_EXT_shader_texture_lod : enable
#endif
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    vec2 unclamped = coord;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    #ifdef GL_EXT_shader_texture_lod
        vec4 texSample = unclamped == coord
            ? texture2D(uSampler, coord) 
            : texture2DLodEXT(uSampler, coord, 0);
    #else
        vec4 texSample = texture2D(uSampler, coord);
    #endif

    gl_FragColor = texSample * uColor;
}
`,vf=`#version 100
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`,kE=`#version 100
#define SHADER_NAME Tiling-Sprite-Simple-100

precision lowp float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;

void main(void)
{
    vec4 texSample = texture2D(uSampler, vTextureCoord);
    gl_FragColor = texSample * uColor;
}
`;const Xa=new Zt;class qp extends Yo{constructor(t){super(t),t.runners.contextChange.add(this),this.quad=new Qm,this.state=yn.for2d()}contextChange(){const t=this.renderer,e={globals:t.globalUniforms};this.simpleShader=gn.from(vf,kE,e),this.shader=t.context.webGLVersion>1?gn.from(AE,TE,e):gn.from(vf,CE,e)}render(t){const e=this.renderer,s=this.quad;let r=s.vertices;r[0]=r[6]=t._width*-t.anchor.x,r[1]=r[3]=t._height*-t.anchor.y,r[2]=r[4]=t._width*(1-t.anchor.x),r[5]=r[7]=t._height*(1-t.anchor.y);const i=t.uvRespectAnchor?t.anchor.x:0,o=t.uvRespectAnchor?t.anchor.y:0;r=s.uvs,r[0]=r[6]=-i,r[1]=r[3]=-o,r[2]=r[4]=1-i,r[5]=r[7]=1-o,s.invalidate();const l=t._texture,a=l.baseTexture,c=a.alphaMode>0,h=t.tileTransform.localTransform,d=t.uvMatrix;let u=a.isPowerOfTwo&&l.frame.width===a.width&&l.frame.height===a.height;u&&(a._glTextures[e.CONTEXT_UID]?u=a.wrapMode!==hr.CLAMP:a.wrapMode===hr.CLAMP&&(a.wrapMode=hr.REPEAT));const f=u?this.simpleShader:this.shader,m=l.width,p=l.height,g=t._width,w=t._height;Xa.set(h.a*m/g,h.b*m/w,h.c*p/g,h.d*p/w,h.tx/g,h.ty/w),Xa.invert(),u?Xa.prepend(d.mapCoord):(f.uniforms.uMapCoord=d.mapCoord.toArray(!0),f.uniforms.uClampFrame=d.uClampFrame,f.uniforms.uClampOffset=d.uClampOffset),f.uniforms.uTransform=Xa.toArray(!0),f.uniforms.uColor=te.shared.setValue(t.tint).premultiply(t.worldAlpha,c).toArray(f.uniforms.uColor),f.uniforms.translationMatrix=t.transform.worldTransform.toArray(!0),f.uniforms.uSampler=l,e.shader.bind(f),e.geometry.bind(s),this.state.blendMode=jm(t.blendMode,c),e.state.set(this.state),e.geometry.draw(this.renderer.gl.TRIANGLES,6,0)}}qp.extension={name:"tilingSprite",type:ot.RendererPlugin};pt.add(qp);const Kp=class Wi{constructor(t,e,s){this.linkedSheets=[],(t instanceof _t||t instanceof mt)&&(t={texture:t,data:e,resolutionFilename:s});const{texture:r,data:i,resolutionFilename:o=null,cachePrefix:l=""}=t;this.cachePrefix=l,this._texture=r instanceof mt?r:null,this.baseTexture=r instanceof _t?r:this._texture.baseTexture,this.textures={},this.animations={},this.data=i;const a=this.baseTexture.resource;this.resolution=this._updateResolution(o||(a?a.url:null)),this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}_updateResolution(t=null){const{scale:e}=this.data.meta;let s=Dn(t,null);return s===null&&(s=typeof e=="number"?e:parseFloat(e??"1")),s!==1&&this.baseTexture.setResolution(s),s}parse(){return new Promise(t=>{this._callback=t,this._batchIndex=0,this._frameKeys.length<=Wi.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()})}_processFrames(t){let e=t;const s=Wi.BATCH_SIZE;for(;e-t<s&&e<this._frameKeys.length;){const r=this._frameKeys[e],i=this._frames[r],o=i.frame;if(o){let l=null,a=null;const c=i.trimmed!==!1&&i.sourceSize?i.sourceSize:i.frame,h=new vt(0,0,Math.floor(c.w)/this.resolution,Math.floor(c.h)/this.resolution);i.rotated?l=new vt(Math.floor(o.x)/this.resolution,Math.floor(o.y)/this.resolution,Math.floor(o.h)/this.resolution,Math.floor(o.w)/this.resolution):l=new vt(Math.floor(o.x)/this.resolution,Math.floor(o.y)/this.resolution,Math.floor(o.w)/this.resolution,Math.floor(o.h)/this.resolution),i.trimmed!==!1&&i.spriteSourceSize&&(a=new vt(Math.floor(i.spriteSourceSize.x)/this.resolution,Math.floor(i.spriteSourceSize.y)/this.resolution,Math.floor(o.w)/this.resolution,Math.floor(o.h)/this.resolution)),this.textures[r]=new mt(this.baseTexture,l,h,a,i.rotated?2:0,i.anchor,i.borders),mt.addToCache(this.textures[r],this.cachePrefix+r.toString())}e++}}_processAnimations(){const t=this.data.animations||{};for(const e in t){this.animations[e]=[];for(let s=0;s<t[e].length;s++){const r=t[e][s];this.animations[e].push(this.textures[r])}}}_parseComplete(){const t=this._callback;this._callback=null,this._batchIndex=0,t.call(this,this.textures)}_nextBatch(){this._processFrames(this._batchIndex*Wi.BATCH_SIZE),this._batchIndex++,setTimeout(()=>{this._batchIndex*Wi.BATCH_SIZE<this._frameKeys.length?this._nextBatch():(this._processAnimations(),this._parseComplete())},0)}destroy(t=!1){var e;for(const s in this.textures)this.textures[s].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,t&&((e=this._texture)==null||e.destroy(),this.baseTexture.destroy()),this._texture=null,this.baseTexture=null,this.linkedSheets=[]}};Kp.BATCH_SIZE=1e3;let _f=Kp;const IE=["jpg","png","jpeg","avif","webp","s3tc","s3tc_sRGB","etc","etc1","pvrtc","atc","astc","bptc"];function Zp(n,t,e){const s={};if(n.forEach(r=>{s[r]=t}),Object.keys(t.textures).forEach(r=>{s[`${t.cachePrefix}${r}`]=t.textures[r]}),!e){const r=re.dirname(n[0]);t.linkedSheets.forEach((i,o)=>{Object.assign(s,Zp([`${r}/${t.data.meta.related_multi_packs[o]}`],i,!0))})}return s}const RE={extension:ot.Asset,cache:{test:n=>n instanceof _f,getCacheableAssets:(n,t)=>Zp(n,t,!1)},resolver:{test:n=>{const t=n.split("?")[0].split("."),e=t.pop(),s=t.pop();return e==="json"&&IE.includes(s)},parse:n=>{var e;const t=n.split(".");return{resolution:parseFloat(((e=ht.RETINA_PREFIX.exec(n))==null?void 0:e[1])??"1"),format:t[t.length-2],src:n}}},loader:{name:"spritesheetLoader",extension:{type:ot.LoadParser,priority:_s.Normal},async testParse(n,t){return re.extname(t.src).toLowerCase()===".json"&&!!n.frames},async parse(n,t,e){var h,d;const{texture:s,imageFilename:r,cachePrefix:i}=(t==null?void 0:t.data)??{};let o=re.dirname(t.src);o&&o.lastIndexOf("/")!==o.length-1&&(o+="/");let l;if(s&&s.baseTexture)l=s;else{const u=Uc(o+(r??n.meta.image),t.src);l=(await e.load([u]))[u]}const a=new _f({texture:l.baseTexture,data:n,resolutionFilename:t.src,cachePrefix:i});await a.parse();const c=(h=n==null?void 0:n.meta)==null?void 0:h.related_multi_packs;if(Array.isArray(c)){const u=[];for(const m of c){if(typeof m!="string")continue;let p=o+m;(d=t.data)!=null&&d.ignoreMultiPack||(p=Uc(p,t.src),u.push(e.load({src:p,data:{ignoreMultiPack:!0}})))}const f=await Promise.all(u);a.linkedSheets=f,f.forEach(m=>{m.linkedSheets=[a].concat(a.linkedSheets.filter(p=>p!==m))})}return a},unload(n){n.destroy(!0)}}};pt.add(RE);class So{constructor(){this.info=[],this.common=[],this.page=[],this.char=[],this.kerning=[],this.distanceField=[]}}class ro{static test(t){return typeof t=="string"&&t.startsWith("info face=")}static parse(t){const e=t.match(/^[a-z]+\s+.+$/gm),s={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[],distanceField:[]};for(const i in e){const o=e[i].match(/^[a-z]+/gm)[0],l=e[i].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),a={};for(const c in l){const h=l[c].split("="),d=h[0],u=h[1].replace(/"/gm,""),f=parseFloat(u),m=isNaN(f)?u:f;a[d]=m}s[o].push(a)}const r=new So;return s.info.forEach(i=>r.info.push({face:i.face,size:parseInt(i.size,10)})),s.common.forEach(i=>r.common.push({lineHeight:parseInt(i.lineHeight,10)})),s.page.forEach(i=>r.page.push({id:parseInt(i.id,10),file:i.file})),s.char.forEach(i=>r.char.push({id:parseInt(i.id,10),page:parseInt(i.page,10),x:parseInt(i.x,10),y:parseInt(i.y,10),width:parseInt(i.width,10),height:parseInt(i.height,10),xoffset:parseInt(i.xoffset,10),yoffset:parseInt(i.yoffset,10),xadvance:parseInt(i.xadvance,10)})),s.kerning.forEach(i=>r.kerning.push({first:parseInt(i.first,10),second:parseInt(i.second,10),amount:parseInt(i.amount,10)})),s.distanceField.forEach(i=>r.distanceField.push({distanceRange:parseInt(i.distanceRange,10),fieldType:i.fieldType})),r}}class qc{static test(t){const e=t;return typeof t!="string"&&"getElementsByTagName"in t&&e.getElementsByTagName("page").length&&e.getElementsByTagName("info")[0].getAttribute("face")!==null}static parse(t){const e=new So,s=t.getElementsByTagName("info"),r=t.getElementsByTagName("common"),i=t.getElementsByTagName("page"),o=t.getElementsByTagName("char"),l=t.getElementsByTagName("kerning"),a=t.getElementsByTagName("distanceField");for(let c=0;c<s.length;c++)e.info.push({face:s[c].getAttribute("face"),size:parseInt(s[c].getAttribute("size"),10)});for(let c=0;c<r.length;c++)e.common.push({lineHeight:parseInt(r[c].getAttribute("lineHeight"),10)});for(let c=0;c<i.length;c++)e.page.push({id:parseInt(i[c].getAttribute("id"),10)||0,file:i[c].getAttribute("file")});for(let c=0;c<o.length;c++){const h=o[c];e.char.push({id:parseInt(h.getAttribute("id"),10),page:parseInt(h.getAttribute("page"),10)||0,x:parseInt(h.getAttribute("x"),10),y:parseInt(h.getAttribute("y"),10),width:parseInt(h.getAttribute("width"),10),height:parseInt(h.getAttribute("height"),10),xoffset:parseInt(h.getAttribute("xoffset"),10),yoffset:parseInt(h.getAttribute("yoffset"),10),xadvance:parseInt(h.getAttribute("xadvance"),10)})}for(let c=0;c<l.length;c++)e.kerning.push({first:parseInt(l[c].getAttribute("first"),10),second:parseInt(l[c].getAttribute("second"),10),amount:parseInt(l[c].getAttribute("amount"),10)});for(let c=0;c<a.length;c++)e.distanceField.push({fieldType:a[c].getAttribute("fieldType"),distanceRange:parseInt(a[c].getAttribute("distanceRange"),10)});return e}}class Kc{static test(t){return typeof t=="string"&&t.includes("<font>")?qc.test(ht.ADAPTER.parseXML(t)):!1}static parse(t){return qc.parse(ht.ADAPTER.parseXML(t))}}const Yl=[ro,qc,Kc];function ME(n){for(let t=0;t<Yl.length;t++)if(Yl[t].test(n))return Yl[t];return null}function PE(n,t,e,s,r,i){const o=e.fill;if(Array.isArray(o)){if(o.length===1)return o[0]}else return o;let l;const a=e.dropShadow?e.dropShadowDistance:0,c=e.padding||0,h=n.width/s-a-c*2,d=n.height/s-a-c*2,u=o.slice(),f=e.fillGradientStops.slice();if(!f.length){const m=u.length+1;for(let p=1;p<m;++p)f.push(p/m)}if(u.unshift(o[0]),f.unshift(0),u.push(o[o.length-1]),f.push(1),e.fillGradientType===zo.LINEAR_VERTICAL){l=t.createLinearGradient(h/2,c,h/2,d+c);let m=0;const p=(i.fontProperties.fontSize+e.strokeThickness)/d;for(let g=0;g<r.length;g++){const w=i.lineHeight*g;for(let x=0;x<u.length;x++){let y=0;typeof f[x]=="number"?y=f[x]:y=x/u.length;const b=w/d+y*p;let _=Math.max(m,b);_=Math.min(_,1),l.addColorStop(_,u[x]),m=_}}}else{l=t.createLinearGradient(c,d/2,h+c,d/2);const m=u.length+1;let p=1;for(let g=0;g<u.length;g++){let w;typeof f[g]=="number"?w=f[g]:w=p/m,l.addColorStop(w,u[g]),p++}}return l}function NE(n,t,e,s,r,i,o){const l=e.text,a=e.fontProperties;t.translate(s,r),t.scale(i,i);const c=o.strokeThickness/2,h=-(o.strokeThickness/2);if(t.font=o.toFontString(),t.lineWidth=o.strokeThickness,t.textBaseline=o.textBaseline,t.lineJoin=o.lineJoin,t.miterLimit=o.miterLimit,t.fillStyle=PE(n,t,o,i,[l],e),t.strokeStyle=o.stroke,o.dropShadow){const d=o.dropShadowColor,u=o.dropShadowBlur*i,f=o.dropShadowDistance*i;t.shadowColor=te.shared.setValue(d).setAlpha(o.dropShadowAlpha).toRgbaString(),t.shadowBlur=u,t.shadowOffsetX=Math.cos(o.dropShadowAngle)*f,t.shadowOffsetY=Math.sin(o.dropShadowAngle)*f}else t.shadowColor="black",t.shadowBlur=0,t.shadowOffsetX=0,t.shadowOffsetY=0;o.stroke&&o.strokeThickness&&t.strokeText(l,c,h+e.lineHeight-a.descent),o.fill&&t.fillText(l,c,h+e.lineHeight-a.descent),t.setTransform(1,0,0,1,0,0),t.fillStyle="rgba(0, 0, 0, 0)"}function io(n){return n.codePointAt?n.codePointAt(0):n.charCodeAt(0)}function Qp(n){return Array.from?Array.from(n):n.split("")}function FE(n){typeof n=="string"&&(n=[n]);const t=[];for(let e=0,s=n.length;e<s;e++){const r=n[e];if(Array.isArray(r)){if(r.length!==2)throw new Error(`[BitmapFont]: Invalid character range length, expecting 2 got ${r.length}.`);const i=r[0].charCodeAt(0),o=r[1].charCodeAt(0);if(o<i)throw new Error("[BitmapFont]: Invalid character range.");for(let l=i,a=o;l<=a;l++)t.push(String.fromCharCode(l))}else t.push(...Qp(r))}if(t.length===0)throw new Error("[BitmapFont]: Empty set when resolving characters.");return t}const Wn=class cn{constructor(t,e,s){var h;const[r]=t.info,[i]=t.common,[o]=t.page,[l]=t.distanceField,a=Dn(o.file),c={};this._ownsTextures=s,this.font=r.face,this.size=r.size,this.lineHeight=i.lineHeight/a,this.chars={},this.pageTextures=c;for(let d=0;d<t.page.length;d++){const{id:u,file:f}=t.page[d];c[u]=e instanceof Array?e[d]:e[f],l!=null&&l.fieldType&&l.fieldType!=="none"&&(c[u].baseTexture.alphaMode=Qe.NO_PREMULTIPLIED_ALPHA,c[u].baseTexture.mipmap=Zs.OFF)}for(let d=0;d<t.char.length;d++){const{id:u,page:f}=t.char[d];let{x:m,y:p,width:g,height:w,xoffset:x,yoffset:y,xadvance:b}=t.char[d];m/=a,p/=a,g/=a,w/=a,x/=a,y/=a,b/=a;const _=new vt(m+c[f].frame.x/a,p+c[f].frame.y/a,g,w);this.chars[u]={xOffset:x,yOffset:y,xAdvance:b,kerning:{},texture:new mt(c[f].baseTexture,_),page:f}}for(let d=0;d<t.kerning.length;d++){let{first:u,second:f,amount:m}=t.kerning[d];u/=a,f/=a,m/=a,this.chars[f]&&(this.chars[f].kerning[u]=m)}this.distanceFieldRange=l==null?void 0:l.distanceRange,this.distanceFieldType=((h=l==null?void 0:l.fieldType)==null?void 0:h.toLowerCase())??"none"}destroy(){for(const t in this.chars)this.chars[t].texture.destroy(),this.chars[t].texture=null;for(const t in this.pageTextures)this._ownsTextures&&this.pageTextures[t].destroy(!0),this.pageTextures[t]=null;this.chars=null,this.pageTextures=null}static install(t,e,s){let r;if(t instanceof So)r=t;else{const o=ME(t);if(!o)throw new Error("Unrecognized data format for font.");r=o.parse(t)}e instanceof mt&&(e=[e]);const i=new cn(r,e,s);return cn.available[i.font]=i,i}static uninstall(t){const e=cn.available[t];if(!e)throw new Error(`No font found named '${t}'`);e.destroy(),delete cn.available[t]}static from(t,e,s){if(!t)throw new Error("[BitmapFont] Property `name` is required.");const{chars:r,padding:i,resolution:o,textureWidth:l,textureHeight:a,...c}=Object.assign({},cn.defaultOptions,s),h=FE(r),d=e instanceof mr?e:new mr(e),u=l,f=new So;f.info[0]={face:d.fontFamily,size:d.fontSize},f.common[0]={lineHeight:d.fontSize};let m=0,p=0,g,w,x,y=0;const b=[];for(let E=0;E<h.length;E++){g||(g=ht.ADAPTER.createCanvas(),g.width=l,g.height=a,w=g.getContext("2d"),x=new _t(g,{resolution:o,...c}),b.push(new mt(x)),f.page.push({id:b.length-1,file:""}));const S=h[E],T=er.measureText(S,d,!1,g),C=T.width,A=Math.ceil(T.height),R=Math.ceil((d.fontStyle==="italic"?2:1)*C);if(p>=a-A*o){if(p===0)throw new Error(`[BitmapFont] textureHeight ${a}px is too small (fontFamily: '${d.fontFamily}', fontSize: ${d.fontSize}px, char: '${S}')`);--E,g=null,w=null,x=null,p=0,m=0,y=0;continue}if(y=Math.max(A+T.fontProperties.descent,y),R*o+m>=u){if(m===0)throw new Error(`[BitmapFont] textureWidth ${l}px is too small (fontFamily: '${d.fontFamily}', fontSize: ${d.fontSize}px, char: '${S}')`);--E,p+=y*o,p=Math.ceil(p),m=0,y=0;continue}NE(g,w,T,m,p,o,d);const M=io(T.text);f.char.push({id:M,page:b.length-1,x:m/o,y:p/o,width:R,height:A,xoffset:0,yoffset:0,xadvance:C-(d.dropShadow?d.dropShadowDistance:0)-(d.stroke?d.strokeThickness:0)}),m+=(R+2*i)*o,m=Math.ceil(m)}if(!(s!=null&&s.skipKerning))for(let E=0,S=h.length;E<S;E++){const T=h[E];for(let C=0;C<S;C++){const A=h[C],R=w.measureText(T).width,M=w.measureText(A).width,I=w.measureText(T+A).width-(R+M);I&&f.kerning.push({first:io(T),second:io(A),amount:I})}}const _=new cn(f,b,!0);return cn.available[t]!==void 0&&cn.uninstall(t),cn.available[t]=_,_}};Wn.ALPHA=[["a","z"],["A","Z"]," "],Wn.NUMERIC=[["0","9"]],Wn.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "],Wn.ASCII=[[" ","~"]],Wn.defaultOptions={resolution:1,textureWidth:512,textureHeight:512,padding:4,chars:Wn.ALPHANUMERIC},Wn.available={};let zn=Wn;var DE=`// Pixi texture info\r
varying vec2 vTextureCoord;\r
uniform sampler2D uSampler;\r
\r
// Tint\r
uniform vec4 uColor;\r
\r
// on 2D applications fwidth is screenScale / glyphAtlasScale * distanceFieldRange\r
uniform float uFWidth;\r
\r
void main(void) {\r
\r
  // To stack MSDF and SDF we need a non-pre-multiplied-alpha texture.\r
  vec4 texColor = texture2D(uSampler, vTextureCoord);\r
\r
  // MSDF\r
  float median = texColor.r + texColor.g + texColor.b -\r
                  min(texColor.r, min(texColor.g, texColor.b)) -\r
                  max(texColor.r, max(texColor.g, texColor.b));\r
  // SDF\r
  median = min(median, texColor.a);\r
\r
  float screenPxDistance = uFWidth * (median - 0.5);\r
  float alpha = clamp(screenPxDistance + 0.5, 0.0, 1.0);\r
  if (median < 0.01) {\r
    alpha = 0.0;\r
  } else if (median > 0.99) {\r
    alpha = 1.0;\r
  }\r
\r
  // Gamma correction for coverage-like alpha\r
  float luma = dot(uColor.rgb, vec3(0.299, 0.587, 0.114));\r
  float gamma = mix(1.0, 1.0 / 2.2, luma);\r
  float coverage = pow(uColor.a * alpha, gamma);  \r
\r
  // NPM Textures, NPM outputs\r
  gl_FragColor = vec4(uColor.rgb, coverage);\r
}\r
`,BE=`// Mesh material default fragment\r
attribute vec2 aVertexPosition;\r
attribute vec2 aTextureCoord;\r
\r
uniform mat3 projectionMatrix;\r
uniform mat3 translationMatrix;\r
uniform mat3 uTextureMatrix;\r
\r
varying vec2 vTextureCoord;\r
\r
void main(void)\r
{\r
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\r
\r
    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;\r
}\r
`;const Ef=[],Sf=[],Tf=[],LE=class Jp extends ts{constructor(t,e={}){super();const{align:s,tint:r,maxWidth:i,letterSpacing:o,fontName:l,fontSize:a}=Object.assign({},Jp.styleDefaults,e);if(!zn.available[l])throw new Error(`Missing BitmapFont "${l}"`);this._activePagesMeshData=[],this._textWidth=0,this._textHeight=0,this._align=s,this._tintColor=new te(r),this._font=void 0,this._fontName=l,this._fontSize=a,this.text=t,this._maxWidth=i,this._maxLineHeight=0,this._letterSpacing=o,this._anchor=new Mn(()=>{this.dirty=!0},this,0,0),this._roundPixels=ht.ROUND_PIXELS,this.dirty=!0,this._resolution=ht.RESOLUTION,this._autoResolution=!0,this._textureCache={}}updateText(){var R;const t=zn.available[this._fontName],e=this.fontSize,s=e/t.size,r=new Xt,i=[],o=[],l=[],a=this._text.replace(/(?:\r\n|\r)/g,`
`)||" ",c=Qp(a),h=this._maxWidth*t.size/e,d=t.distanceFieldType==="none"?Ef:Sf;let u=null,f=0,m=0,p=0,g=-1,w=0,x=0,y=0,b=0;for(let M=0;M<c.length;M++){const I=c[M],N=io(I);if(/(?:\s)/.test(I)&&(g=M,w=f,b++),I==="\r"||I===`
`){o.push(f),l.push(-1),m=Math.max(m,f),++p,++x,r.x=0,r.y+=t.lineHeight,u=null,b=0;continue}const F=t.chars[N];if(!F)continue;u&&F.kerning[u]&&(r.x+=F.kerning[u]);const B=Tf.pop()||{texture:mt.EMPTY,line:0,charCode:0,prevSpaces:0,position:new Xt};B.texture=F.texture,B.line=p,B.charCode=N,B.position.x=Math.round(r.x+F.xOffset+this._letterSpacing/2),B.position.y=Math.round(r.y+F.yOffset),B.prevSpaces=b,i.push(B),f=B.position.x+Math.max(F.xAdvance-F.xOffset,F.texture.orig.width),r.x+=F.xAdvance+this._letterSpacing,y=Math.max(y,F.yOffset+F.texture.height),u=N,g!==-1&&h>0&&r.x>h&&(++x,di(i,1+g-x,1+M-g),M=g,g=-1,o.push(w),l.push(i.length>0?i[i.length-1].prevSpaces:0),m=Math.max(m,w),p++,r.x=0,r.y+=t.lineHeight,u=null,b=0)}const _=c[c.length-1];_!=="\r"&&_!==`
`&&(/(?:\s)/.test(_)&&(f=w),o.push(f),m=Math.max(m,f),l.push(-1));const E=[];for(let M=0;M<=p;M++){let I=0;this._align==="right"?I=m-o[M]:this._align==="center"?I=(m-o[M])/2:this._align==="justify"&&(I=l[M]<0?0:(m-o[M])/l[M]),E.push(I)}const S=i.length,T={},C=[],A=this._activePagesMeshData;d.push(...A);for(let M=0;M<S;M++){const I=i[M].texture,N=I.baseTexture.uid;if(!T[N]){let F=d.pop();if(!F){const Y=new Vp;let O,V;t.distanceFieldType==="none"?(O=new Wc(mt.EMPTY),V=dt.NORMAL):(O=new Wc(mt.EMPTY,{program:Pn.from(BE,DE),uniforms:{uFWidth:0}}),V=dt.NORMAL_NPM);const j=new $c(Y,O);j.blendMode=V,F={index:0,indexCount:0,vertexCount:0,uvsCount:0,total:0,mesh:j,vertices:null,uvs:null,indices:null}}F.index=0,F.indexCount=0,F.vertexCount=0,F.uvsCount=0,F.total=0;const{_textureCache:B}=this;B[N]=B[N]||new mt(I.baseTexture),F.mesh.texture=B[N],F.mesh.tint=this._tintColor.value,C.push(F),T[N]=F}T[N].total++}for(let M=0;M<A.length;M++)C.includes(A[M])||this.removeChild(A[M].mesh);for(let M=0;M<C.length;M++)C[M].mesh.parent!==this&&this.addChild(C[M].mesh);this._activePagesMeshData=C;for(const M in T){const I=T[M],N=I.total;if(!(((R=I.indices)==null?void 0:R.length)>6*N)||I.vertices.length<$c.BATCHABLE_SIZE*2)I.vertices=new Float32Array(4*2*N),I.uvs=new Float32Array(4*2*N),I.indices=new Uint16Array(6*N);else{const F=I.total,B=I.vertices;for(let Y=F*4*2;Y<B.length;Y++)B[Y]=0}I.mesh.size=6*N}for(let M=0;M<S;M++){const I=i[M];let N=I.position.x+E[I.line]*(this._align==="justify"?I.prevSpaces:1);this._roundPixels&&(N=Math.round(N));const F=N*s,B=I.position.y*s,Y=I.texture,O=T[Y.baseTexture.uid],V=Y.frame,j=Y._uvs,X=O.index++;O.indices[X*6+0]=0+X*4,O.indices[X*6+1]=1+X*4,O.indices[X*6+2]=2+X*4,O.indices[X*6+3]=0+X*4,O.indices[X*6+4]=2+X*4,O.indices[X*6+5]=3+X*4,O.vertices[X*8+0]=F,O.vertices[X*8+1]=B,O.vertices[X*8+2]=F+V.width*s,O.vertices[X*8+3]=B,O.vertices[X*8+4]=F+V.width*s,O.vertices[X*8+5]=B+V.height*s,O.vertices[X*8+6]=F,O.vertices[X*8+7]=B+V.height*s,O.uvs[X*8+0]=j.x0,O.uvs[X*8+1]=j.y0,O.uvs[X*8+2]=j.x1,O.uvs[X*8+3]=j.y1,O.uvs[X*8+4]=j.x2,O.uvs[X*8+5]=j.y2,O.uvs[X*8+6]=j.x3,O.uvs[X*8+7]=j.y3}this._textWidth=m*s,this._textHeight=(r.y+t.lineHeight)*s;for(const M in T){const I=T[M];if(this.anchor.x!==0||this.anchor.y!==0){let Y=0;const O=this._textWidth*this.anchor.x,V=this._textHeight*this.anchor.y;for(let j=0;j<I.total;j++)I.vertices[Y++]-=O,I.vertices[Y++]-=V,I.vertices[Y++]-=O,I.vertices[Y++]-=V,I.vertices[Y++]-=O,I.vertices[Y++]-=V,I.vertices[Y++]-=O,I.vertices[Y++]-=V}this._maxLineHeight=y*s;const N=I.mesh.geometry.getBuffer("aVertexPosition"),F=I.mesh.geometry.getBuffer("aTextureCoord"),B=I.mesh.geometry.getIndex();N.data=I.vertices,F.data=I.uvs,B.data=I.indices,N.update(),F.update(),B.update()}for(let M=0;M<i.length;M++)Tf.push(i[M]);this._font=t,this.dirty=!1}updateTransform(){this.validate(),this.containerUpdateTransform()}_render(t){this._autoResolution&&this._resolution!==t.resolution&&(this._resolution=t.resolution,this.dirty=!0);const{distanceFieldRange:e,distanceFieldType:s,size:r}=zn.available[this._fontName];if(s!=="none"){const{a:i,b:o,c:l,d:a}=this.worldTransform,c=Math.sqrt(i*i+o*o),h=Math.sqrt(l*l+a*a),d=(Math.abs(c)+Math.abs(h))/2,u=this.fontSize/r,f=t._view.resolution;for(const m of this._activePagesMeshData)m.mesh.shader.uniforms.uFWidth=d*e*u*f}super._render(t)}getLocalBounds(){return this.validate(),super.getLocalBounds()}validate(){const t=zn.available[this._fontName];if(!t)throw new Error(`Missing BitmapFont "${this._fontName}"`);this._font!==t&&(this.dirty=!0),this.dirty&&this.updateText()}get tint(){return this._tintColor.value}set tint(t){if(this.tint!==t){this._tintColor.setValue(t);for(let e=0;e<this._activePagesMeshData.length;e++)this._activePagesMeshData[e].mesh.tint=t}}get align(){return this._align}set align(t){this._align!==t&&(this._align=t,this.dirty=!0)}get fontName(){return this._fontName}set fontName(t){if(!zn.available[t])throw new Error(`Missing BitmapFont "${t}"`);this._fontName!==t&&(this._fontName=t,this.dirty=!0)}get fontSize(){return this._fontSize??zn.available[this._fontName].size}set fontSize(t){this._fontSize!==t&&(this._fontSize=t,this.dirty=!0)}get anchor(){return this._anchor}set anchor(t){typeof t=="number"?this._anchor.set(t):this._anchor.copyFrom(t)}get text(){return this._text}set text(t){t=String(t??""),this._text!==t&&(this._text=t,this.dirty=!0)}get maxWidth(){return this._maxWidth}set maxWidth(t){this._maxWidth!==t&&(this._maxWidth=t,this.dirty=!0)}get maxLineHeight(){return this.validate(),this._maxLineHeight}get textWidth(){return this.validate(),this._textWidth}get letterSpacing(){return this._letterSpacing}set letterSpacing(t){this._letterSpacing!==t&&(this._letterSpacing=t,this.dirty=!0)}get roundPixels(){return this._roundPixels}set roundPixels(t){t!==this._roundPixels&&(this._roundPixels=t,this.dirty=!0)}get textHeight(){return this.validate(),this._textHeight}get resolution(){return this._resolution}set resolution(t){this._autoResolution=!1,this._resolution!==t&&(this._resolution=t,this.dirty=!0)}destroy(t){const{_textureCache:e}=this,s=zn.available[this._fontName].distanceFieldType==="none"?Ef:Sf;s.push(...this._activePagesMeshData);for(const r of this._activePagesMeshData)this.removeChild(r.mesh);this._activePagesMeshData=[],s.filter(r=>e[r.mesh.texture.baseTexture.uid]).forEach(r=>{r.mesh.texture=mt.EMPTY});for(const r in e)e[r].destroy(),delete e[r];this._font=null,this._tintColor=null,this._textureCache=null,super.destroy(t)}};LE.styleDefaults={align:"left",tint:16777215,maxWidth:0,letterSpacing:0};const OE=[".xml",".fnt"],jE={extension:{type:ot.LoadParser,priority:_s.Normal},name:"loadBitmapFont",test(n){return OE.includes(re.extname(n).toLowerCase())},async testParse(n){return ro.test(n)||Kc.test(n)},async parse(n,t,e){const s=ro.test(n)?ro.parse(n):Kc.parse(n),{src:r}=t,{page:i}=s,o=[];for(let c=0;c<i.length;++c){const h=i[c].file;let d=re.join(re.dirname(r),h);d=Uc(d,r),o.push(d)}const l=await e.load(o),a=o.map(c=>l[c]);return zn.install(s,a,!0)},async load(n,t){return(await ht.ADAPTER.fetch(n)).text()},unload(n){n.destroy()}};pt.add(jE);const Zc=class ni extends mr{constructor(){super(...arguments),this._fonts=[],this._overrides=[],this._stylesheet="",this.fontsDirty=!1}static from(t){return new ni(Object.keys(ni.defaultOptions).reduce((e,s)=>({...e,[s]:t[s]}),{}))}cleanFonts(){this._fonts.length>0&&(this._fonts.forEach(t=>{URL.revokeObjectURL(t.src),t.refs--,t.refs===0&&(t.fontFace&&document.fonts.delete(t.fontFace),delete ni.availableFonts[t.originalUrl])}),this.fontFamily="Arial",this._fonts.length=0,this.styleID++,this.fontsDirty=!0)}loadFont(t,e={}){const{availableFonts:s}=ni;if(s[t]){const r=s[t];return this._fonts.push(r),r.refs++,this.styleID++,this.fontsDirty=!0,Promise.resolve()}return ht.ADAPTER.fetch(t).then(r=>r.blob()).then(async r=>new Promise((i,o)=>{const l=URL.createObjectURL(r),a=new FileReader;a.onload=()=>i([l,a.result]),a.onerror=o,a.readAsDataURL(r)})).then(async([r,i])=>{const o=Object.assign({family:re.basename(t,re.extname(t)),weight:"normal",style:"normal",display:"auto",src:r,dataSrc:i,refs:1,originalUrl:t,fontFace:null},e);s[t]=o,this._fonts.push(o),this.styleID++;const l=new FontFace(o.family,`url(${o.src})`,{weight:o.weight,style:o.style,display:o.display});o.fontFace=l,await l.load(),document.fonts.add(l),await document.fonts.ready,this.styleID++,this.fontsDirty=!0})}addOverride(...t){const e=t.filter(s=>!this._overrides.includes(s));e.length>0&&(this._overrides.push(...e),this.styleID++)}removeOverride(...t){const e=t.filter(s=>this._overrides.includes(s));e.length>0&&(this._overrides=this._overrides.filter(s=>!e.includes(s)),this.styleID++)}toCSS(t){return[`transform: scale(${t})`,"transform-origin: top left","display: inline-block",`color: ${this.normalizeColor(this.fill)}`,`font-size: ${this.fontSize}px`,`font-family: ${this.fontFamily}`,`font-weight: ${this.fontWeight}`,`font-style: ${this.fontStyle}`,`font-variant: ${this.fontVariant}`,`letter-spacing: ${this.letterSpacing}px`,`text-align: ${this.align}`,`padding: ${this.padding}px`,`white-space: ${this.whiteSpace}`,...this.lineHeight?[`line-height: ${this.lineHeight}px`]:[],...this.wordWrap?[`word-wrap: ${this.breakWords?"break-all":"break-word"}`,`max-width: ${this.wordWrapWidth}px`]:[],...this.strokeThickness?[`-webkit-text-stroke-width: ${this.strokeThickness}px`,`-webkit-text-stroke-color: ${this.normalizeColor(this.stroke)}`,`text-stroke-width: ${this.strokeThickness}px`,`text-stroke-color: ${this.normalizeColor(this.stroke)}`,"paint-order: stroke"]:[],...this.dropShadow?[this.dropShadowToCSS()]:[],...this._overrides].join(";")}toGlobalCSS(){return this._fonts.reduce((t,e)=>`${t}
            @font-face {
                font-family: "${e.family}";
                src: url('${e.dataSrc}');
                font-weight: ${e.weight};
                font-style: ${e.style};
                font-display: ${e.display};
            }`,this._stylesheet)}get stylesheet(){return this._stylesheet}set stylesheet(t){this._stylesheet!==t&&(this._stylesheet=t,this.styleID++)}normalizeColor(t){return Array.isArray(t)&&(t=Qa(t)),typeof t=="number"?S1(t):t}dropShadowToCSS(){let t=this.normalizeColor(this.dropShadowColor);const e=this.dropShadowAlpha,s=Math.round(Math.cos(this.dropShadowAngle)*this.dropShadowDistance),r=Math.round(Math.sin(this.dropShadowAngle)*this.dropShadowDistance);t.startsWith("#")&&e<1&&(t+=(e*255|0).toString(16).padStart(2,"0"));const i=`${s}px ${r}px`;return this.dropShadowBlur>0?`text-shadow: ${i} ${this.dropShadowBlur}px ${t}`:`text-shadow: ${i} ${t}`}reset(){Object.assign(this,ni.defaultOptions)}onBeforeDraw(){const{fontsDirty:t}=this;return this.fontsDirty=!1,this.isSafari&&this._fonts.length>0&&t?new Promise(e=>setTimeout(e,100)):Promise.resolve()}get isSafari(){const{userAgent:t}=ht.ADAPTER.getNavigator();return/^((?!chrome|android).)*safari/i.test(t)}set fillGradientStops(t){console.warn("[HTMLTextStyle] fillGradientStops is not supported by HTMLText")}get fillGradientStops(){return super.fillGradientStops}set fillGradientType(t){console.warn("[HTMLTextStyle] fillGradientType is not supported by HTMLText")}get fillGradientType(){return super.fillGradientType}set miterLimit(t){console.warn("[HTMLTextStyle] miterLimit is not supported by HTMLText")}get miterLimit(){return super.miterLimit}set trim(t){console.warn("[HTMLTextStyle] trim is not supported by HTMLText")}get trim(){return super.trim}set textBaseline(t){console.warn("[HTMLTextStyle] textBaseline is not supported by HTMLText")}get textBaseline(){return super.textBaseline}set leading(t){console.warn("[HTMLTextStyle] leading is not supported by HTMLText")}get leading(){return super.leading}set lineJoin(t){console.warn("[HTMLTextStyle] lineJoin is not supported by HTMLText")}get lineJoin(){return super.lineJoin}};Zc.availableFonts={},Zc.defaultOptions={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",letterSpacing:0,lineHeight:0,padding:0,stroke:"black",strokeThickness:0,whiteSpace:"normal",wordWrap:!1,wordWrapWidth:100};let $l=Zc;const Ga=class ri extends Wr{constructor(t="",e={}){super(mt.EMPTY),this._text=null,this._style=null,this._autoResolution=!0,this.localStyleID=-1,this.dirty=!1,this._updateID=0,this.ownsStyle=!1;const s=new Image,r=mt.from(s,{scaleMode:ht.SCALE_MODE,resourceOptions:{autoLoad:!1}});r.orig=new vt,r.trim=new vt,this.texture=r;const i="http://www.w3.org/2000/svg",o="http://www.w3.org/1999/xhtml",l=document.createElementNS(i,"svg"),a=document.createElementNS(i,"foreignObject"),c=document.createElementNS(o,"div"),h=document.createElementNS(o,"style");a.setAttribute("width","10000"),a.setAttribute("height","10000"),a.style.overflow="hidden",l.appendChild(a),this.maxWidth=ri.defaultMaxWidth,this.maxHeight=ri.defaultMaxHeight,this._domElement=c,this._styleElement=h,this._svgRoot=l,this._foreignObject=a,this._foreignObject.appendChild(h),this._foreignObject.appendChild(c),this._image=s,this._loadImage=new Image,this._autoResolution=ri.defaultAutoResolution,this._resolution=ri.defaultResolution??ht.RESOLUTION,this.text=t,this.style=e}measureText(t){var h,d;const{text:e,style:s,resolution:r}=Object.assign({text:this._text,style:this._style,resolution:this._resolution},t);Object.assign(this._domElement,{innerHTML:e,style:s.toCSS(r)}),this._styleElement.textContent=s.toGlobalCSS(),document.body.appendChild(this._svgRoot);const i=this._domElement.getBoundingClientRect();this._svgRoot.remove();const{width:o,height:l}=i;(o>this.maxWidth||l>this.maxHeight)&&console.warn("[HTMLText] Large expanse of text, increase HTMLText.maxWidth or HTMLText.maxHeight property.");const a=Math.min(this.maxWidth,Math.ceil(o)),c=Math.min(this.maxHeight,Math.ceil(l));return this._svgRoot.setAttribute("width",a.toString()),this._svgRoot.setAttribute("height",c.toString()),e!==this._text&&(this._domElement.innerHTML=this._text),s!==this._style&&(Object.assign(this._domElement,{style:(h=this._style)==null?void 0:h.toCSS(r)}),this._styleElement.textContent=(d=this._style)==null?void 0:d.toGlobalCSS()),{width:a+s.padding*2,height:c+s.padding*2}}async updateText(t=!0){const{style:e,_image:s,_loadImage:r}=this;if(this.localStyleID!==e.styleID&&(this.dirty=!0,this.localStyleID=e.styleID),!this.dirty&&t)return;const{width:i,height:o}=this.measureText();s.width=r.width=Math.ceil(Math.max(1,i)),s.height=r.height=Math.ceil(Math.max(1,o)),this._updateID++;const l=this._updateID;await new Promise(a=>{r.onload=async()=>{if(l<this._updateID){a();return}await e.onBeforeDraw(),s.src=r.src,r.onload=null,r.src="",this.updateTexture(),a()};const c=new XMLSerializer().serializeToString(this._svgRoot);r.src=`data:image/svg+xml;charset=utf8,${encodeURIComponent(c)}`})}get source(){return this._image}updateTexture(){const{style:t,texture:e,_image:s,resolution:r}=this,{padding:i}=t,{baseTexture:o}=e;e.trim.width=e._frame.width=s.width/r,e.trim.height=e._frame.height=s.height/r,e.trim.x=-i,e.trim.y=-i,e.orig.width=e._frame.width-i*2,e.orig.height=e._frame.height-i*2,this._onTextureUpdate(),o.setRealSize(s.width,s.height,r),this.dirty=!1}_render(t){this._autoResolution&&this._resolution!==t.resolution&&(this._resolution=t.resolution,this.dirty=!0),this.updateText(!0),super._render(t)}_renderCanvas(t){this._autoResolution&&this._resolution!==t.resolution&&(this._resolution=t.resolution,this.dirty=!0),this.updateText(!0),super._renderCanvas(t)}getLocalBounds(t){return this.updateText(!0),super.getLocalBounds(t)}_calculateBounds(){this.updateText(!0),this.calculateVertices(),this._bounds.addQuad(this.vertexData)}_onStyleChange(){this.dirty=!0}destroy(t){var s,r,i,o,l;typeof t=="boolean"&&(t={children:t}),t=Object.assign({},ri.defaultDestroyOptions,t),super.destroy(t);const e=null;this.ownsStyle&&((s=this._style)==null||s.cleanFonts()),this._style=e,(r=this._svgRoot)==null||r.remove(),this._svgRoot=e,(i=this._domElement)==null||i.remove(),this._domElement=e,(o=this._foreignObject)==null||o.remove(),this._foreignObject=e,(l=this._styleElement)==null||l.remove(),this._styleElement=e,this._loadImage.src="",this._loadImage.onload=null,this._loadImage=e,this._image.src="",this._image=e}get width(){return this.updateText(!0),Math.abs(this.scale.x)*this._image.width/this.resolution}set width(t){this.updateText(!0);const e=lr(this.scale.x)||1;this.scale.x=e*t/this._image.width/this.resolution,this._width=t}get height(){return this.updateText(!0),Math.abs(this.scale.y)*this._image.height/this.resolution}set height(t){this.updateText(!0);const e=lr(this.scale.y)||1;this.scale.y=e*t/this._image.height/this.resolution,this._height=t}get style(){return this._style}set style(t){this._style!==t&&(t=t||{},t instanceof $l?(this.ownsStyle=!1,this._style=t):t instanceof mr?(console.warn("[HTMLText] Cloning TextStyle, if this is not what you want, use HTMLTextStyle"),this.ownsStyle=!0,this._style=$l.from(t)):(this.ownsStyle=!0,this._style=new $l(t)),this.localStyleID=-1,this.dirty=!0)}get text(){return this._text}set text(t){t=String(t===""||t===null||t===void 0?" ":t),t=this.sanitiseText(t),this._text!==t&&(this._text=t,this.dirty=!0)}get resolution(){return this._resolution}set resolution(t){this._autoResolution=!1,this._resolution!==t&&(this._resolution=t,this.dirty=!0)}sanitiseText(t){return t.replace(/<br>/gi,"<br/>").replace(/<hr>/gi,"<hr/>").replace(/&nbsp;/gi,"&#160;")}};Ga.defaultDestroyOptions={texture:!0,children:!1,baseTexture:!0},Ga.defaultMaxWidth=2024,Ga.defaultMaxHeight=2024,Ga.defaultAutoResolution=!0;var Rt=(n=>(n[n.Region=0]="Region",n[n.BoundingBox=1]="BoundingBox",n[n.Mesh=2]="Mesh",n[n.LinkedMesh=3]="LinkedMesh",n[n.Path=4]="Path",n[n.Point=5]="Point",n[n.Clipping=6]="Clipping",n))(Rt||{});class To{constructor(t,e=new Array,s=0,r=new DataView(t.buffer)){this.strings=e,this.index=s,this.buffer=r}readByte(){return this.buffer.getInt8(this.index++)}readUnsignedByte(){return this.buffer.getUint8(this.index++)}readShort(){const t=this.buffer.getInt16(this.index);return this.index+=2,t}readInt32(){const t=this.buffer.getInt32(this.index);return this.index+=4,t}readInt(t){let e=this.readByte(),s=e&127;return e&128&&(e=this.readByte(),s|=(e&127)<<7,e&128&&(e=this.readByte(),s|=(e&127)<<14,e&128&&(e=this.readByte(),s|=(e&127)<<21,e&128&&(e=this.readByte(),s|=(e&127)<<28)))),t?s:s>>>1^-(s&1)}readStringRef(){const t=this.readInt(!0);return t==0?null:this.strings[t-1]}readString(){let t=this.readInt(!0);switch(t){case 0:return null;case 1:return""}t--;let e="";for(let s=0;s<t;){const r=this.readUnsignedByte();switch(r>>4){case 12:case 13:e+=String.fromCharCode((r&31)<<6|this.readByte()&63),s+=2;break;case 14:e+=String.fromCharCode((r&15)<<12|(this.readByte()&63)<<6|this.readByte()&63),s+=3;break;default:e+=String.fromCharCode(r),s++}}return e}readFloat(){const t=this.buffer.getFloat32(this.index);return this.index+=4,t}readBoolean(){return this.readByte()!=0}}var k=(n=>(n[n.setup=0]="setup",n[n.first=1]="first",n[n.replace=2]="replace",n[n.add=3]="add",n))(k||{}),It=(n=>(n[n.mixIn=0]="mixIn",n[n.mixOut=1]="mixOut",n))(It||{}),me=(n=>(n[n.Fixed=0]="Fixed",n[n.Percent=1]="Percent",n))(me||{}),_e=(n=>(n[n.Tangent=0]="Tangent",n[n.Chain=1]="Chain",n[n.ChainScale=2]="ChainScale",n))(_e||{}),wt=(n=>(n[n.Normal=0]="Normal",n[n.OnlyTranslation=1]="OnlyTranslation",n[n.NoRotationOrReflection=2]="NoRotationOrReflection",n[n.NoScale=3]="NoScale",n[n.NoScaleOrReflection=4]="NoScaleOrReflection",n))(wt||{});function Af(n){switch(n.toLowerCase()){case"nearest":return ls.Nearest;case"linear":return ls.Linear;case"mipmap":return ls.MipMap;case"mipmapnearestnearest":return ls.MipMapNearestNearest;case"mipmaplinearnearest":return ls.MipMapLinearNearest;case"mipmapnearestlinear":return ls.MipMapNearestLinear;case"mipmaplinearlinear":return ls.MipMapLinearLinear;default:throw new Error(`Unknown texture filter ${n}`)}}var ls=(n=>(n[n.Nearest=9728]="Nearest",n[n.Linear=9729]="Linear",n[n.MipMap=9987]="MipMap",n[n.MipMapNearestNearest=9984]="MipMapNearestNearest",n[n.MipMapLinearNearest=9985]="MipMapLinearNearest",n[n.MipMapNearestLinear=9986]="MipMapNearestLinear",n[n.MipMapLinearLinear=9987]="MipMapLinearLinear",n))(ls||{}),Fr=(n=>(n[n.MirroredRepeat=33648]="MirroredRepeat",n[n.ClampToEdge=33071]="ClampToEdge",n[n.Repeat=10497]="Repeat",n))(Fr||{});class Qc{constructor(){this.size=null,this.names=null,this.values=null,this.renderObject=null}get width(){const t=this.texture;return t.trim?t.trim.width:t.orig.width}get height(){const t=this.texture;return t.trim?t.trim.height:t.orig.height}get u(){return this.texture._uvs.x0}get v(){return this.texture._uvs.y0}get u2(){return this.texture._uvs.x2}get v2(){return this.texture._uvs.y2}get offsetX(){const t=this.texture;return t.trim?t.trim.x:0}get offsetY(){return this.spineOffsetY}get pixiOffsetY(){const t=this.texture;return t.trim?t.trim.y:0}get spineOffsetY(){const t=this.texture;return this.originalHeight-this.height-(t.trim?t.trim.y:0)}get originalWidth(){return this.texture.orig.width}get originalHeight(){return this.texture.orig.height}get x(){return this.texture.frame.x}get y(){return this.texture.frame.y}get rotate(){return this.texture.rotate!==0}get degrees(){return(360-this.texture.rotate*45)%360}}class VE{constructor(){this.x=0,this.y=0,this.width=0,this.height=0,this.offsetX=0,this.offsetY=0,this.originalWidth=0,this.originalHeight=0,this.rotate=0,this.index=0}}class Jc{constructor(t,e,s){this.pages=new Array,this.regions=new Array,t&&this.addSpineAtlas(t,e,s)}addTexture(t,e){const s=this.pages;let r=null;for(let o=0;o<s.length;o++)if(s[o].baseTexture===e.baseTexture){r=s[o];break}if(r===null){r=new Cf,r.name="texturePage";const o=e.baseTexture;r.width=o.realWidth,r.height=o.realHeight,r.baseTexture=o,r.minFilter=r.magFilter=ls.Nearest,r.uWrap=Fr.ClampToEdge,r.vWrap=Fr.ClampToEdge,s.push(r)}const i=new kf;return i.name=t,i.page=r,i.texture=e,i.index=-1,this.regions.push(i),i}addTextureHash(t,e){for(const s in t)t.hasOwnProperty(s)&&this.addTexture(e&&s.indexOf(".")!==-1?s.substr(0,s.lastIndexOf(".")):s,t[s])}addSpineAtlas(t,e,s){return this.load(t,e,s)}load(t,e,s){if(e==null)throw new Error("textureLoader cannot be null.");const r=new UE(t),i=new Array(4);let o=null;const l={};let a=null;l.size=()=>{o.width=parseInt(i[1]),o.height=parseInt(i[2])},l.format=()=>{},l.filter=()=>{o.minFilter=Af(i[1]),o.magFilter=Af(i[2])},l.repeat=()=>{i[1].indexOf("x")!=-1&&(o.uWrap=Fr.Repeat),i[1].indexOf("y")!=-1&&(o.vWrap=Fr.Repeat)},l.pma=()=>{o.pma=i[1]=="true"};const c={};c.xy=()=>{a.x=parseInt(i[1]),a.y=parseInt(i[2])},c.size=()=>{a.width=parseInt(i[1]),a.height=parseInt(i[2])},c.bounds=()=>{a.x=parseInt(i[1]),a.y=parseInt(i[2]),a.width=parseInt(i[3]),a.height=parseInt(i[4])},c.offset=()=>{a.offsetX=parseInt(i[1]),a.offsetY=parseInt(i[2])},c.orig=()=>{a.originalWidth=parseInt(i[1]),a.originalHeight=parseInt(i[2])},c.offsets=()=>{a.offsetX=parseInt(i[1]),a.offsetY=parseInt(i[2]),a.originalWidth=parseInt(i[3]),a.originalHeight=parseInt(i[4])},c.rotate=()=>{const u=i[1];let f=0;u.toLocaleLowerCase()=="true"?f=6:u.toLocaleLowerCase()=="false"?f=0:f=(720-parseFloat(u))%360/45,a.rotate=f},c.index=()=>{a.index=parseInt(i[1])};let h=r.readLine();for(;h!=null&&h.trim().length==0;)h=r.readLine();for(;!(h==null||h.trim().length==0||r.readEntry(i,h)==0);)h=r.readLine();const d=()=>{for(;;){if(h==null)return s&&s(this);if(h.trim().length==0)o=null,h=r.readLine();else if(o===null){for(o=new Cf,o.name=h.trim();r.readEntry(i,h=r.readLine())!=0;){const u=l[i[0]];u&&u()}this.pages.push(o),e(o.name,u=>{if(u===null)return this.pages.splice(this.pages.indexOf(o),1),s&&s(null);o.baseTexture=u,o.pma&&(u.alphaMode=Qe.PMA),u.valid||u.setSize(o.width,o.height),o.setFilters(),(!o.width||!o.height)&&(o.width=u.realWidth,o.height=u.realHeight,(!o.width||!o.height)&&console.log(`ERROR spine atlas page ${o.name}: meshes wont work if you dont specify size in atlas (http://www.html5gamedevs.com/topic/18888-pixi-spines-and-meshes/?p=107121)`)),d()});break}else{a=new VE;const u=new kf;u.name=h,u.page=o;let f=null,m=null;for(;;){const b=r.readEntry(i,h=r.readLine());if(b==0)break;const _=c[i[0]];if(_)_();else{f==null&&(f=[],m=[]),f.push(i[0]);const E=[];for(let S=0;S<b;S++)E.push(parseInt(i[S+1]));m.push(E)}}a.originalWidth==0&&a.originalHeight==0&&(a.originalWidth=a.width,a.originalHeight=a.height);const p=o.baseTexture.resolution;a.x/=p,a.y/=p,a.width/=p,a.height/=p,a.originalWidth/=p,a.originalHeight/=p,a.offsetX/=p,a.offsetY/=p;const g=a.rotate%4!==0,w=new vt(a.x,a.y,g?a.height:a.width,g?a.width:a.height),x=new vt(0,0,a.originalWidth,a.originalHeight),y=new vt(a.offsetX,a.originalHeight-a.height-a.offsetY,a.width,a.height);u.texture=new mt(u.page.baseTexture,w,x,y,a.rotate),u.index=a.index,u.texture.updateUvs(),this.regions.push(u)}}};d()}findRegion(t){for(let e=0;e<this.regions.length;e++)if(this.regions[e].name==t)return this.regions[e];return null}dispose(){for(let t=0;t<this.pages.length;t++)this.pages[t].baseTexture.dispose()}}class UE{constructor(t){this.index=0,this.lines=t.split(/\r\n|\r|\n/)}readLine(){return this.index>=this.lines.length?null:this.lines[this.index++]}readEntry(t,e){if(e==null||(e=e.trim(),e.length==0))return 0;const s=e.indexOf(":");if(s==-1)return 0;t[0]=e.substr(0,s).trim();for(let r=1,i=s+1;;r++){const o=e.indexOf(",",i);if(o==-1)return t[r]=e.substr(i).trim(),r;if(t[r]=e.substr(i,o-i).trim(),i=o+1,r==4)return 4}}}class Cf{constructor(){this.minFilter=ls.Nearest,this.magFilter=ls.Nearest,this.uWrap=Fr.ClampToEdge,this.vWrap=Fr.ClampToEdge}setFilters(){const t=this.baseTexture,e=this.minFilter;e==ls.Linear?t.scaleMode=ps.LINEAR:this.minFilter==ls.Nearest?t.scaleMode=ps.NEAREST:(t.mipmap=Zs.POW2,e==ls.MipMapNearestNearest?t.scaleMode=ps.NEAREST:t.scaleMode=ps.LINEAR)}}class kf extends Qc{}class tg{constructor(){this.array=new Array}add(t){const e=this.contains(t);return this.array[t|0]=t|0,!e}contains(t){return this.array[t|0]!=null}remove(t){this.array[t|0]=void 0}clear(){this.array.length=0}}class eg{constructor(){this.entries={},this.size=0}add(t){const e=this.entries[t];return this.entries[t]=!0,e?!1:(this.size++,!0)}addAll(t){const e=this.size;for(let s=0,r=t.length;s<r;s++)this.add(t[s]);return e!=this.size}contains(t){return this.entries[t]}clear(){this.entries={},this.size=0}}const zr=class{constructor(n=0,t=0,e=0,s=0){this.r=n,this.g=t,this.b=e,this.a=s}set(n,t,e,s){return this.r=n,this.g=t,this.b=e,this.a=s,this.clamp()}setFromColor(n){return this.r=n.r,this.g=n.g,this.b=n.b,this.a=n.a,this}setFromString(n){return n=n.charAt(0)=="#"?n.substr(1):n,this.r=parseInt(n.substr(0,2),16)/255,this.g=parseInt(n.substr(2,2),16)/255,this.b=parseInt(n.substr(4,2),16)/255,this.a=n.length!=8?1:parseInt(n.substr(6,2),16)/255,this}add(n,t,e,s){return this.r+=n,this.g+=t,this.b+=e,this.a+=s,this.clamp()}clamp(){return this.r<0?this.r=0:this.r>1&&(this.r=1),this.g<0?this.g=0:this.g>1&&(this.g=1),this.b<0?this.b=0:this.b>1&&(this.b=1),this.a<0?this.a=0:this.a>1&&(this.a=1),this}static rgba8888ToColor(n,t){n.r=((t&4278190080)>>>24)/255,n.g=((t&16711680)>>>16)/255,n.b=((t&65280)>>>8)/255,n.a=(t&255)/255}static rgb888ToColor(n,t){n.r=((t&16711680)>>>16)/255,n.g=((t&65280)>>>8)/255,n.b=(t&255)/255}static fromString(n){return new zr().setFromString(n)}};let et=zr;et.WHITE=new zr(1,1,1,1);et.RED=new zr(1,0,0,1);et.GREEN=new zr(0,1,0,1);et.BLUE=new zr(0,0,1,1);et.MAGENTA=new zr(1,0,1,1);const Nn=class{static clamp(n,t,e){return n<t?t:n>e?e:n}static cosDeg(n){return Math.cos(n*Nn.degRad)}static sinDeg(n){return Math.sin(n*Nn.degRad)}static signum(n){return Math.sign(n)}static toInt(n){return n>0?Math.floor(n):Math.ceil(n)}static cbrt(n){const t=Math.pow(Math.abs(n),.3333333333333333);return n<0?-t:t}static randomTriangular(n,t){return Nn.randomTriangularWith(n,t,(n+t)*.5)}static randomTriangularWith(n,t,e){const s=Math.random(),r=t-n;return s<=(e-n)/r?n+Math.sqrt(s*r*(e-n)):t-Math.sqrt((1-s)*r*(t-e))}static isPowerOfTwo(n){return n&&(n&n-1)===0}};let P=Nn;P.PI=3.1415927;P.PI2=Nn.PI*2;P.radiansToDegrees=180/Nn.PI;P.radDeg=Nn.radiansToDegrees;P.degreesToRadians=Nn.PI/180;P.degRad=Nn.degreesToRadians;class XE{apply(t,e,s){return t+(e-t)*this.applyInternal(s)}}class GE extends XE{constructor(t){super(),this.power=2,this.power=t}applyInternal(t){return t<=.5?Math.pow(t*2,this.power)/2:Math.pow((t-1)*2,this.power)/(this.power%2==0?-2:2)+1}}class sg extends GE{applyInternal(t){return Math.pow(t-1,this.power)*(this.power%2==0?-1:1)+1}}const ii=class{static arrayCopy(n,t,e,s,r){for(let i=t,o=s;i<t+r;i++,o++)e[o]=n[i]}static arrayFill(n,t,e,s){for(let r=t;r<e;r++)n[r]=s}static setArraySize(n,t,e=0){const s=n.length;if(s==t)return n;if(n.length=t,s<t)for(let r=s;r<t;r++)n[r]=e;return n}static ensureArrayCapacity(n,t,e=0){return n.length>=t?n:ii.setArraySize(n,t,e)}static newArray(n,t){const e=new Array(n);for(let s=0;s<n;s++)e[s]=t;return e}static newFloatArray(n){if(ii.SUPPORTS_TYPED_ARRAYS)return new Float32Array(n);const t=new Array(n);for(let e=0;e<t.length;e++)t[e]=0;return t}static newShortArray(n){if(ii.SUPPORTS_TYPED_ARRAYS)return new Int16Array(n);const t=new Array(n);for(let e=0;e<t.length;e++)t[e]=0;return t}static toFloatArray(n){return ii.SUPPORTS_TYPED_ARRAYS?new Float32Array(n):n}static toSinglePrecision(n){return ii.SUPPORTS_TYPED_ARRAYS?Math.fround(n):n}static webkit602BugfixHelper(n,t){}static contains(n,t,e=!0){for(let s=0;s<n.length;s++)if(n[s]==t)return!0;return!1}static enumValue(n,t){return n[t[0].toUpperCase()+t.slice(1)]}};let $=ii;$.SUPPORTS_TYPED_ARRAYS=typeof Float32Array<"u";class Ho{constructor(t){this.items=new Array,this.instantiator=t}obtain(){return this.items.length>0?this.items.pop():this.instantiator()}free(t){t.reset&&t.reset(),this.items.push(t)}freeAll(t){for(let e=0;e<t.length;e++)this.free(t[e])}clear(){this.items.length=0}}class oa{constructor(t=0,e=0){this.x=t,this.y=e}set(t,e){return this.x=t,this.y=e,this}length(){const t=this.x,e=this.y;return Math.sqrt(t*t+e*e)}normalize(){const t=this.length();return t!=0&&(this.x/=t,this.y/=t),this}}class jh{constructor(){this.minX=0,this.minY=0,this.maxX=0,this.maxY=0,this.boundingBoxes=new Array,this.polygons=new Array,this.polygonPool=new Ho(()=>$.newFloatArray(16))}update(t,e){if(!t)throw new Error("skeleton cannot be null.");const s=this.boundingBoxes,r=this.polygons,i=this.polygonPool,o=t.slots,l=o.length;s.length=0,i.freeAll(r),r.length=0;for(let a=0;a<l;a++){const c=o[a];if(!c.bone.active)continue;const h=c.getAttachment();if(h!=null&&h.type===Rt.BoundingBox){const d=h;s.push(d);let u=i.obtain();u.length!=d.worldVerticesLength&&(u=$.newFloatArray(d.worldVerticesLength)),r.push(u),d.computeWorldVertices(c,0,d.worldVerticesLength,u,0,2)}}e?this.aabbCompute():(this.minX=Number.POSITIVE_INFINITY,this.minY=Number.POSITIVE_INFINITY,this.maxX=Number.NEGATIVE_INFINITY,this.maxY=Number.NEGATIVE_INFINITY)}aabbCompute(){let t=Number.POSITIVE_INFINITY,e=Number.POSITIVE_INFINITY,s=Number.NEGATIVE_INFINITY,r=Number.NEGATIVE_INFINITY;const i=this.polygons;for(let o=0,l=i.length;o<l;o++){const a=i[o],c=a;for(let h=0,d=a.length;h<d;h+=2){const u=c[h],f=c[h+1];t=Math.min(t,u),e=Math.min(e,f),s=Math.max(s,u),r=Math.max(r,f)}}this.minX=t,this.minY=e,this.maxX=s,this.maxY=r}aabbContainsPoint(t,e){return t>=this.minX&&t<=this.maxX&&e>=this.minY&&e<=this.maxY}aabbIntersectsSegment(t,e,s,r){const i=this.minX,o=this.minY,l=this.maxX,a=this.maxY;if(t<=i&&s<=i||e<=o&&r<=o||t>=l&&s>=l||e>=a&&r>=a)return!1;const c=(r-e)/(s-t);let h=c*(i-t)+e;if(h>o&&h<a||(h=c*(l-t)+e,h>o&&h<a))return!0;let d=(o-e)/c+t;return d>i&&d<l||(d=(a-e)/c+t,d>i&&d<l)}aabbIntersectsSkeleton(t){return this.minX<t.maxX&&this.maxX>t.minX&&this.minY<t.maxY&&this.maxY>t.minY}containsPoint(t,e){const s=this.polygons;for(let r=0,i=s.length;r<i;r++)if(this.containsPointPolygon(s[r],t,e))return this.boundingBoxes[r];return null}containsPointPolygon(t,e,s){const r=t,i=t.length;let o=i-2,l=!1;for(let a=0;a<i;a+=2){const c=r[a+1],h=r[o+1];if(c<s&&h>=s||h<s&&c>=s){const d=r[a];d+(s-c)/(h-c)*(r[o]-d)<e&&(l=!l)}o=a}return l}intersectsSegment(t,e,s,r){const i=this.polygons;for(let o=0,l=i.length;o<l;o++)if(this.intersectsSegmentPolygon(i[o],t,e,s,r))return this.boundingBoxes[o];return null}intersectsSegmentPolygon(t,e,s,r,i){const o=t,l=t.length,a=e-r,c=s-i,h=e*i-s*r;let d=o[l-2],u=o[l-1];for(let f=0;f<l;f+=2){const m=o[f],p=o[f+1],g=d*p-u*m,w=d-m,x=u-p,y=a*x-c*w,b=(h*w-a*g)/y;if((b>=d&&b<=m||b>=m&&b<=d)&&(b>=e&&b<=r||b>=r&&b<=e)){const _=(h*x-c*g)/y;if((_>=u&&_<=p||_>=p&&_<=u)&&(_>=s&&_<=i||_>=i&&_<=s))return!0}d=m,u=p}return!1}getPolygon(t){if(!t)throw new Error("boundingBox cannot be null.");const e=this.boundingBoxes.indexOf(t);return e==-1?null:this.polygons[e]}getWidth(){return this.maxX-this.minX}getHeight(){return this.maxY-this.minY}}const YE={yDown:!0,FAIL_ON_NON_EXISTING_SKIN:!1,GLOBAL_AUTO_UPDATE:!0,GLOBAL_DELAY_LIMIT:0},Yn=[0,0,0];class $E extends Wr{constructor(){super(...arguments),this.region=null,this.attachment=null}}class WE extends cE{constructor(t,e,s,r,i){super(t,e,s,r,i),this.region=null,this.attachment=null}}const ng=class extends ts{constructor(n){if(super(),!n)throw new Error("The spineData param is required.");if(typeof n=="string")throw new Error('spineData param cant be string. Please use spine.Spine.fromAtlas("YOUR_RESOURCE_NAME") from now on.');this.spineData=n,this.createSkeleton(n),this.slotContainers=[],this.tempClipContainers=[];for(let t=0,e=this.skeleton.slots.length;t<e;t++){const s=this.skeleton.slots[t],r=s.getAttachment(),i=this.newContainer();if(this.slotContainers.push(i),this.addChild(i),this.tempClipContainers.push(null),!!r)if(r.type===Rt.Region){const o=r.name,l=this.createSprite(s,r,o);s.currentSprite=l,s.currentSpriteName=o,i.addChild(l)}else if(r.type===Rt.Mesh){const o=this.createMesh(s,r);s.currentMesh=o,s.currentMeshId=r.id,s.currentMeshName=r.name,i.addChild(o)}else r.type===Rt.Clipping&&(this.createGraphics(s,r),i.addChild(s.clippingContainer),i.addChild(s.currentGraphics))}this.tintRgb=new Float32Array([1,1,1]),this.autoUpdate=!0,this.visible=!0}get debug(){return this._debug}set debug(n){var t;n!=this._debug&&((t=this._debug)==null||t.unregisterSpine(this),n==null||n.registerSpine(this),this._debug=n)}get autoUpdate(){return this._autoUpdate}set autoUpdate(n){n!==this._autoUpdate&&(this._autoUpdate=n,this.updateTransform=n?ng.prototype.autoUpdateTransform:ts.prototype.updateTransform)}get tint(){return Qa(this.tintRgb)}set tint(n){this.tintRgb=E1(n,this.tintRgb)}get delayLimit(){return(typeof this.localDelayLimit<"u"?this.localDelayLimit:YE.GLOBAL_DELAY_LIMIT)||Number.MAX_VALUE}update(n){var c;const t=this.delayLimit;if(n>t&&(n=t),this.state.update(n),this.state.apply(this.skeleton),!this.skeleton)return;this.skeleton.updateWorldTransform();const e=this.skeleton.slots,s=this.color;let r=null,i=null;s?(r=s.light,i=s.dark):r=this.tintRgb;for(let h=0,d=e.length;h<d;h++){const u=e[h],f=u.getAttachment(),m=this.slotContainers[h];if(!f){m.visible=!1;continue}let p=null;f.sequence&&f.sequence.apply(u,f);let g=f.region;const w=f.color;switch(f!=null&&f.type){case Rt.Region:if(m.transform.setFromMatrix(u.bone.matrix),g=f.region,u.currentMesh&&(u.currentMesh.visible=!1,u.currentMesh=null,u.currentMeshId=void 0,u.currentMeshName=void 0),!g){u.currentSprite&&(u.currentSprite.renderable=!1);break}if(!u.currentSpriteName||u.currentSpriteName!==f.name){const b=f.name;if(u.currentSprite&&(u.currentSprite.visible=!1),u.sprites=u.sprites||{},u.sprites[b]!==void 0)u.sprites[b].visible=!0;else{const _=this.createSprite(u,f,b);m.addChild(_)}u.currentSprite=u.sprites[b],u.currentSpriteName=b}u.currentSprite.renderable=!0,u.hackRegion||this.setSpriteRegion(f,u.currentSprite,g),u.currentSprite.color?p=u.currentSprite.color:(Yn[0]=r[0]*u.color.r*w.r,Yn[1]=r[1]*u.color.g*w.g,Yn[2]=r[2]*u.color.b*w.b,u.currentSprite.tint=Qa(Yn)),u.currentSprite.blendMode=u.blendMode;break;case Rt.Mesh:if(u.currentSprite){u.currentSprite.visible=!1,u.currentSprite=null,u.currentSpriteName=void 0;const b=new Go;b._parentID=-1,b._worldID=m.transform._worldID,m.transform=b}if(!g){u.currentMesh&&(u.currentMesh.renderable=!1);break}const y=f.id;if(u.currentMeshId===void 0||u.currentMeshId!==y){const b=y;if(u.currentMesh&&(u.currentMesh.visible=!1),u.meshes=u.meshes||{},u.meshes[b]!==void 0)u.meshes[b].visible=!0;else{const _=this.createMesh(u,f);m.addChild(_)}u.currentMesh=u.meshes[b],u.currentMeshName=f.name,u.currentMeshId=b}u.currentMesh.renderable=!0,f.computeWorldVerticesOld(u,u.currentMesh.vertices),u.currentMesh.color?p=u.currentMesh.color:(Yn[0]=r[0]*u.color.r*w.r,Yn[1]=r[1]*u.color.g*w.g,Yn[2]=r[2]*u.color.b*w.b,u.currentMesh.tint=Qa(Yn)),u.currentMesh.blendMode=u.blendMode,u.hackRegion||this.setMeshRegion(f,u.currentMesh,g);break;case Rt.Clipping:u.currentGraphics||(this.createGraphics(u,f),m.addChild(u.clippingContainer),m.addChild(u.currentGraphics)),this.updateGraphics(u,f),m.alpha=1,m.visible=!0;continue;default:m.visible=!1;continue}if(m.visible=!0,p){let x=u.color.r*w.r,y=u.color.g*w.g,b=u.color.b*w.b;p.setLight(r[0]*x+i[0]*(1-x),r[1]*y+i[1]*(1-y),r[2]*b+i[2]*(1-b)),u.darkColor?(x=u.darkColor.r,y=u.darkColor.g,b=u.darkColor.b):(x=0,y=0,b=0),p.setDark(r[0]*x+i[0]*(1-x),r[1]*y+i[1]*(1-y),r[2]*b+i[2]*(1-b))}m.alpha=u.color.a}const o=this.skeleton.drawOrder;let l=null,a=null;for(let h=0,d=o.length;h<d;h++){const u=e[o[h].data.index],f=this.slotContainers[o[h].data.index];if(a||f.parent!==null&&f.parent!==this&&(f.parent.removeChild(f),f.parent=this),u.currentGraphics&&u.getAttachment())a=u.clippingContainer,l=u.getAttachment(),a.children.length=0,this.children[h]=f,l.endSlot===u.data&&(l.endSlot=null);else if(a){let m=this.tempClipContainers[h];m||(m=this.tempClipContainers[h]=this.newContainer(),m.visible=!1),this.children[h]=m,f.parent=null,a.addChild(f),l.endSlot==u.data&&(a.renderable=!0,a=null,l=null)}else this.children[h]=f}(c=this._debug)==null||c.renderDebug(this)}setSpriteRegion(n,t,e){t.attachment===n&&t.region===e||(t.region=e,t.attachment=n,t.texture=e.texture,t.rotation=n.rotation*P.degRad,t.position.x=n.x,t.position.y=n.y,t.alpha=n.color.a,e.size?(t.scale.x=e.size.width/e.originalWidth,t.scale.y=-e.size.height/e.originalHeight):(t.scale.x=n.scaleX*n.width/e.originalWidth,t.scale.y=-n.scaleY*n.height/e.originalHeight))}setMeshRegion(n,t,e){t.attachment===n&&t.region===e||(t.region=e,t.attachment=n,t.texture=e.texture,e.texture.updateUvs(),t.uvBuffer.update(n.regionUVs))}autoUpdateTransform(){{this.lastTime=this.lastTime||Date.now();const n=(Date.now()-this.lastTime)*.001;this.lastTime=Date.now(),this.update(n)}ts.prototype.updateTransform.call(this)}createSprite(n,t,e){let s=t.region;n.hackAttachment===t&&(s=n.hackRegion);const r=s?s.texture:null,i=this.newSprite(r);return i.anchor.set(.5),s&&this.setSpriteRegion(t,i,t.region),n.sprites=n.sprites||{},n.sprites[e]=i,i}createMesh(n,t){let e=t.region;n.hackAttachment===t&&(e=n.hackRegion,n.hackAttachment=null,n.hackRegion=null);const s=this.newMesh(e?e.texture:null,new Float32Array(t.regionUVs.length),t.regionUVs,new Uint16Array(t.triangles),Ws.TRIANGLES);return typeof s._canvasPadding<"u"&&(s._canvasPadding=1.5),s.alpha=t.color.a,s.region=t.region,e&&this.setMeshRegion(t,s,e),n.meshes=n.meshes||{},n.meshes[t.id]=s,s}createGraphics(n,t){const e=this.newGraphics(),s=new dr([]);return e.clear(),e.beginFill(16777215,1),e.drawPolygon(s),e.renderable=!1,n.currentGraphics=e,n.clippingContainer=this.newContainer(),n.clippingContainer.mask=n.currentGraphics,e}updateGraphics(n,t){const e=n.currentGraphics.geometry,s=e.graphicsData[0].shape.points,r=t.worldVerticesLength;s.length=r,t.computeWorldVertices(n,0,r,s,0,2),e.invalidate()}hackTextureBySlotIndex(n,t=null,e=null){const s=this.skeleton.slots[n];if(!s)return!1;const r=s.getAttachment();let i=r.region;return t?(i=new Qc,i.texture=t,i.size=e,s.hackRegion=i,s.hackAttachment=r):(s.hackRegion=null,s.hackAttachment=null),s.currentSprite?this.setSpriteRegion(r,s.currentSprite,i):s.currentMesh&&this.setMeshRegion(r,s.currentMesh,i),!0}hackTextureBySlotName(n,t=null,e=null){const s=this.skeleton.findSlotIndex(n);return s==-1?!1:this.hackTextureBySlotIndex(s,t,e)}hackTextureAttachment(n,t,e,s=null){const r=this.skeleton.findSlotIndex(n),i=this.skeleton.getAttachmentByName(n,t);i.region.texture=e;const o=this.skeleton.slots[r];if(!o)return!1;const l=o.getAttachment();if(t===l.name){let a=i.region;return e?(a=new Qc,a.texture=e,a.size=s,o.hackRegion=a,o.hackAttachment=l):(o.hackRegion=null,o.hackAttachment=null),o.currentSprite&&o.currentSprite.region!=a?(this.setSpriteRegion(l,o.currentSprite,a),o.currentSprite.region=a):o.currentMesh&&o.currentMesh.region!=a&&this.setMeshRegion(l,o.currentMesh,a),!0}return!1}newContainer(){return new ts}newSprite(n){return new $E(n)}newGraphics(){return new Oh}newMesh(n,t,e,s,r){return new WE(n,t,e,s,r)}transformHack(){return 1}hackAttachmentGroups(n,t,e){if(!n)return;const s=[],r=[];for(let i=0,o=this.skeleton.slots.length;i<o;i++){const l=this.skeleton.slots[i],a=l.currentSpriteName||l.currentMeshName||"",c=l.currentSprite||l.currentMesh;a.endsWith(n)?(c.parentGroup=t,r.push(c)):e&&c&&(c.parentGroup=e,s.push(c))}return[s,r]}destroy(n){this.debug=null;for(let t=0,e=this.skeleton.slots.length;t<e;t++){const s=this.skeleton.slots[t];for(const r in s.meshes)s.meshes[r].destroy(n);s.meshes=null;for(const r in s.sprites)s.sprites[r].destroy(n);s.sprites=null}for(let t=0,e=this.slotContainers.length;t<e;t++)this.slotContainers[t].destroy(n);this.spineData=null,this.skeleton=null,this.slotContainers=null,this.stateData=null,this.state=null,this.tempClipContainers=null,super.destroy(n)}};let _i=ng;_i.clippingPolygon=[];Object.defineProperty(_i.prototype,"visible",{get(){return this._visible},set(n){n!==this._visible&&(this._visible=n,n&&(this.lastTime=0))}});const zE={extension:ot.Asset,loader:{extension:{type:ot.LoadParser,priority:_s.Normal},test(n){return cs(n,".atlas")},async load(n){return await(await ht.ADAPTER.fetch(n)).text()},testParse(n,t){const e=cs(t.src,".atlas"),s=typeof n=="string";return Promise.resolve(e&&s)},async parse(n,t,e){const s=t.data;let r=re.dirname(t.src);r&&r.lastIndexOf("/")!==r.length-1&&(r+="/");let i=null,o=null;const l=new Promise((h,d)=>{i=h,o=d});let a;const c=h=>{h||o(`Something went terribly wrong loading a spine .atlas file
Most likely your texture failed to load.`),i(a)};if(s.image||s.images){const h=Object.assign(s.image?{default:s.image}:{},s.images);a=new Jc(n,(d,u)=>{const f=h[d]||h.default;f&&f.baseTexture?u(f.baseTexture):u(f)},c)}else a=new Jc(n,rg(e,r,s.imageMetadata),c);return await l},unload(n){n.dispose()}}},rg=(n,t,e)=>async(s,r)=>{const i=re.normalize([...t.split(re.sep),s].join(re.sep)),o=await n.load({src:i,data:e});r(o.baseTexture)};pt.add(zE);function If(n){return n.hasOwnProperty("bones")}function HE(n){return n instanceof ArrayBuffer}class qE{constructor(){}installLoader(){const t=this,e={extension:ot.Asset,loader:{extension:{type:ot.LoadParser,priority:_s.Normal},test(s){return cs(s,".skel")},async load(s){return await(await ht.ADAPTER.fetch(s)).arrayBuffer()},testParse(s,r){var a;const i=cs(r.src,".json")&&If(s),o=cs(r.src,".skel")&&HE(s),l=((a=r.data)==null?void 0:a.spineAtlas)===!1;return Promise.resolve(i&&!l||o)},async parse(s,r,i){const o=re.extname(r.src).toLowerCase(),l=re.basename(r.src,o);let a=re.dirname(r.src);a&&a.lastIndexOf("/")!==a.length-1&&(a+="/");const c=cs(r.src,".json")&&If(s);let h=null,d=s;c?h=t.createJsonParser():(h=t.createBinaryParser(),d=new Uint8Array(s));const u=r.data||{},f=(u==null?void 0:u.spineSkeletonScale)??null;f&&(h.scale=f);const m=u.spineAtlas;if(m&&m.pages)return t.parseData(h,m,d);const p=u.atlasRawData;if(p){let x=null,y=null;const b=new Promise((S,T)=>{x=S,y=T}),_=new Jc(p,rg(i,a,u.imageMetadata),S=>{S||y(`Something went terribly wrong loading a spine .atlas file
Most likely your texture failed to load.`),x(_)}),E=await b;return t.parseData(h,E,d)}let g=u.spineAtlasFile;g||(g=`${a+l}.atlas`);const w=await i.load({src:g,data:u,alias:u.spineAtlasAlias});return t.parseData(h,w,d)}}};return pt.add(e),e}}let Vh=class{constructor(t){if(t==null)throw new Error("name cannot be null.");this.name=t}};const ig=class extends Vh{constructor(t){super(t),this.id=(ig.nextID++&65535)<<11,this.worldVerticesLength=0,this.deformAttachment=this}computeWorldVerticesOld(t,e){this.computeWorldVertices(t,0,this.worldVerticesLength,e,0,2)}computeWorldVertices(t,e,s,r,i,o){s=i+(s>>1)*o;const l=t.bone.skeleton,a=t.deform;let c=this.vertices;const h=this.bones;if(h==null){a.length>0&&(c=a);const m=t.bone.matrix,p=m.tx,g=m.ty,w=m.a,x=m.c,y=m.b,b=m.d;for(let _=e,E=i;E<s;_+=2,E+=o){const S=c[_],T=c[_+1];r[E]=S*w+T*x+p,r[E+1]=S*y+T*b+g}return}let d=0,u=0;for(let m=0;m<e;m+=2){const p=h[d];d+=p+1,u+=p}const f=l.bones;if(a.length==0)for(let m=i,p=u*3;m<s;m+=o){let g=0,w=0,x=h[d++];for(x+=d;d<x;d++,p+=3){const y=f[h[d]].matrix,b=c[p],_=c[p+1],E=c[p+2];g+=(b*y.a+_*y.c+y.tx)*E,w+=(b*y.b+_*y.d+y.ty)*E}r[m]=g,r[m+1]=w}else{const m=a;for(let p=i,g=u*3,w=u<<1;p<s;p+=o){let x=0,y=0,b=h[d++];for(b+=d;d<b;d++,g+=3,w+=2){const _=f[h[d]].matrix,E=c[g]+m[w],S=c[g+1]+m[w+1],T=c[g+2];x+=(E*_.a+S*_.c+_.tx)*T,y+=(E*_.b+S*_.d+_.ty)*T}r[p]=x,r[p+1]=y}}}copyTo(t){this.bones!=null?(t.bones=new Array(this.bones.length),$.arrayCopy(this.bones,0,t.bones,0,this.bones.length)):t.bones=null,this.vertices!=null?(t.vertices=$.newFloatArray(this.vertices.length),$.arrayCopy(this.vertices,0,t.vertices,0,this.vertices.length)):t.vertices=null,t.worldVerticesLength=this.worldVerticesLength,t.deformAttachment=this.deformAttachment}};let xr=ig;xr.nextID=0;let ag=class og extends xr{constructor(t){super(t),this.type=Rt.BoundingBox,this.color=new et(1,1,1,1)}copy(){const t=new og(this.name);return this.copyTo(t),t.color.setFromColor(this.color),t}},lg=class cg extends xr{constructor(t){super(t),this.type=Rt.Clipping,this.color=new et(.2275,.2275,.8078,1)}copy(){const t=new cg(this.name);return this.copyTo(t),t.endSlot=this.endSlot,t.color.setFromColor(this.color),t}},qo=class th extends xr{constructor(t){super(t),this.type=Rt.Mesh,this.color=new et(1,1,1,1),this.tempColor=new et(0,0,0,0)}getParentMesh(){return this.parentMesh}setParentMesh(t){this.parentMesh=t,t!=null&&(this.bones=t.bones,this.vertices=t.vertices,this.worldVerticesLength=t.worldVerticesLength,this.regionUVs=t.regionUVs,this.triangles=t.triangles,this.hullLength=t.hullLength,this.worldVerticesLength=t.worldVerticesLength)}copy(){if(this.parentMesh!=null)return this.newLinkedMesh();const t=new th(this.name);return t.region=this.region,t.path=this.path,t.color.setFromColor(this.color),this.copyTo(t),t.regionUVs=new Float32Array(this.regionUVs.length),$.arrayCopy(this.regionUVs,0,t.regionUVs,0,this.regionUVs.length),t.triangles=new Array(this.triangles.length),$.arrayCopy(this.triangles,0,t.triangles,0,this.triangles.length),t.hullLength=this.hullLength,this.edges!=null&&(t.edges=new Array(this.edges.length),$.arrayCopy(this.edges,0,t.edges,0,this.edges.length)),t.width=this.width,t.height=this.height,t}newLinkedMesh(){const t=new th(this.name);return t.region=this.region,t.path=this.path,t.color.setFromColor(this.color),t.deformAttachment=this.deformAttachment,t.setParentMesh(this.parentMesh!=null?this.parentMesh:this),t}},la=class hg extends xr{constructor(t){super(t),this.type=Rt.Path,this.closed=!1,this.constantSpeed=!1,this.color=new et(1,1,1,1)}copy(){const t=new hg(this.name);return this.copyTo(t),t.lengths=new Array(this.lengths.length),$.arrayCopy(this.lengths,0,t.lengths,0,this.lengths.length),t.closed=closed,t.constantSpeed=this.constantSpeed,t.color.setFromColor(this.color),t}},dg=class ug extends xr{constructor(t){super(t),this.type=Rt.Point,this.color=new et(.38,.94,0,1)}computeWorldPosition(t,e){const s=t.matrix;return e.x=this.x*s.a+this.y*s.c+t.worldX,e.y=this.x*s.b+this.y*s.d+t.worldY,e}computeWorldRotation(t){const e=t.matrix,s=P.cosDeg(this.rotation),r=P.sinDeg(this.rotation),i=s*e.a+r*e.c,o=s*e.b+r*e.d;return Math.atan2(o,i)*P.radDeg}copy(){const t=new ug(this.name);return t.x=this.x,t.y=this.y,t.rotation=this.rotation,t.color.setFromColor(this.color),t}},Uh=class{constructor(t,e){if(this.deform=new Array,t==null)throw new Error("data cannot be null.");if(e==null)throw new Error("bone cannot be null.");this.data=t,this.bone=e,this.color=new et,this.darkColor=t.darkColor==null?null:new et,this.setToSetupPose(),this.blendMode=this.data.blendMode}getAttachment(){return this.attachment}setAttachment(t){this.attachment!=t&&(this.attachment=t,this.attachmentTime=this.bone.skeleton.time,this.deform.length=0)}setAttachmentTime(t){this.attachmentTime=this.bone.skeleton.time-t}getAttachmentTime(){return this.bone.skeleton.time-this.attachmentTime}setToSetupPose(){this.color.setFromColor(this.data.color),this.darkColor!=null&&this.darkColor.setFromColor(this.data.darkColor),this.data.attachmentName==null?this.attachment=null:(this.attachment=null,this.setAttachment(this.bone.skeleton.getAttachment(this.data.index,this.data.attachmentName)))}};const De=class extends Vh{constructor(t){super(t),this.type=Rt.Region,this.x=0,this.y=0,this.scaleX=1,this.scaleY=1,this.rotation=0,this.width=0,this.height=0,this.color=new et(1,1,1,1),this.offset=$.newFloatArray(8),this.uvs=$.newFloatArray(8),this.tempColor=new et(1,1,1,1)}updateOffset(){const t=this.width/this.region.originalWidth*this.scaleX,e=this.height/this.region.originalHeight*this.scaleY,s=-this.width/2*this.scaleX+this.region.offsetX*t,r=-this.height/2*this.scaleY+this.region.offsetY*e,i=s+this.region.width*t,o=r+this.region.height*e,l=this.rotation*Math.PI/180,a=Math.cos(l),c=Math.sin(l),h=s*a+this.x,d=s*c,u=r*a+this.y,f=r*c,m=i*a+this.x,p=i*c,g=o*a+this.y,w=o*c,x=this.offset;x[De.OX1]=h-f,x[De.OY1]=u+d,x[De.OX2]=h-w,x[De.OY2]=g+d,x[De.OX3]=m-w,x[De.OY3]=g+p,x[De.OX4]=m-f,x[De.OY4]=u+p}setRegion(t){this.region=t;const e=this.uvs;t.rotate?(e[2]=t.u,e[3]=t.v2,e[4]=t.u,e[5]=t.v,e[6]=t.u2,e[7]=t.v,e[0]=t.u2,e[1]=t.v2):(e[0]=t.u,e[1]=t.v2,e[2]=t.u,e[3]=t.v,e[4]=t.u2,e[5]=t.v,e[6]=t.u2,e[7]=t.v2)}computeWorldVertices(t,e,s,r){const i=this.offset,o=t instanceof Uh?t.bone.matrix:t.matrix,l=o.tx,a=o.ty,c=o.a,h=o.c,d=o.b,u=o.d;let f=0,m=0;f=i[De.OX1],m=i[De.OY1],e[s]=f*c+m*h+l,e[s+1]=f*d+m*u+a,s+=r,f=i[De.OX2],m=i[De.OY2],e[s]=f*c+m*h+l,e[s+1]=f*d+m*u+a,s+=r,f=i[De.OX3],m=i[De.OY3],e[s]=f*c+m*h+l,e[s+1]=f*d+m*u+a,s+=r,f=i[De.OX4],m=i[De.OY4],e[s]=f*c+m*h+l,e[s+1]=f*d+m*u+a}copy(){const t=new De(this.name);return t.region=this.region,t.rendererObject=this.rendererObject,t.path=this.path,t.x=this.x,t.y=this.y,t.scaleX=this.scaleX,t.scaleY=this.scaleY,t.rotation=this.rotation,t.width=this.width,t.height=this.height,$.arrayCopy(this.uvs,0,t.uvs,0,8),$.arrayCopy(this.offset,0,t.offset,0,8),t.color.setFromColor(this.color),t}};let Tt=De;Tt.OX1=0;Tt.OY1=1;Tt.OX2=2;Tt.OY2=3;Tt.OX3=4;Tt.OY3=5;Tt.OX4=6;Tt.OY4=7;Tt.X1=0;Tt.Y1=1;Tt.C1R=2;Tt.C1G=3;Tt.C1B=4;Tt.C1A=5;Tt.U1=6;Tt.V1=7;Tt.X2=8;Tt.Y2=9;Tt.C2R=10;Tt.C2G=11;Tt.C2B=12;Tt.C2A=13;Tt.U2=14;Tt.V2=15;Tt.X3=16;Tt.Y3=17;Tt.C3R=18;Tt.C3G=19;Tt.C3B=20;Tt.C3A=21;Tt.U3=22;Tt.V3=23;Tt.X4=24;Tt.Y4=25;Tt.C4R=26;Tt.C4G=27;Tt.C4B=28;Tt.C4A=29;Tt.U4=30;Tt.V4=31;let KE=class{constructor(t,e){this.jitterX=0,this.jitterY=0,this.jitterX=t,this.jitterY=e}begin(t){}transform(t,e,s,r){t.x+=P.randomTriangular(-this.jitterX,this.jitterY),t.y+=P.randomTriangular(-this.jitterX,this.jitterY)}end(){}};const fg=class{constructor(t){this.centerX=0,this.centerY=0,this.radius=0,this.angle=0,this.worldX=0,this.worldY=0,this.radius=t}begin(t){this.worldX=t.x+this.centerX,this.worldY=t.y+this.centerY}transform(t,e,s,r){const i=this.angle*P.degreesToRadians,o=t.x-this.worldX,l=t.y-this.worldY,a=Math.sqrt(o*o+l*l);if(a<this.radius){const c=fg.interpolation.apply(0,i,(this.radius-a)/this.radius),h=Math.cos(c),d=Math.sin(c);t.x=h*o-d*l+this.worldX,t.y=d*o+h*l+this.worldY}}end(){}};let mg=fg;mg.interpolation=new sg(2);let Ee=class{constructor(t,e,s){if(t==null)throw new Error("name cannot be null.");if(e==null)throw new Error("timelines cannot be null.");this.name=t,this.timelines=e,this.timelineIds=[];for(let r=0;r<e.length;r++)this.timelineIds[e[r].getPropertyId()]=!0;this.duration=s}hasTimeline(t){return this.timelineIds[t]==!0}apply(t,e,s,r,i,o,l,a){if(t==null)throw new Error("skeleton cannot be null.");r&&this.duration!=0&&(s%=this.duration,e>0&&(e%=this.duration));const c=this.timelines;for(let h=0,d=c.length;h<d;h++)c[h].apply(t,e,s,i,o,l,a)}static binarySearch(t,e,s=1){let r=0,i=t.length/s-2;if(i==0)return s;let o=i>>>1;for(;;){if(t[(o+1)*s]<=e?r=o+1:i=o,r==i)return(r+1)*s;o=r+i>>>1}}static linearSearch(t,e,s){for(let r=0,i=t.length-s;r<=i;r+=s)if(t[r]>e)return r;return-1}};var pg=(n=>(n[n.rotate=0]="rotate",n[n.translate=1]="translate",n[n.scale=2]="scale",n[n.shear=3]="shear",n[n.attachment=4]="attachment",n[n.color=5]="color",n[n.deform=6]="deform",n[n.event=7]="event",n[n.drawOrder=8]="drawOrder",n[n.ikConstraint=9]="ikConstraint",n[n.transformConstraint=10]="transformConstraint",n[n.pathConstraintPosition=11]="pathConstraintPosition",n[n.pathConstraintSpacing=12]="pathConstraintSpacing",n[n.pathConstraintMix=13]="pathConstraintMix",n[n.twoColor=14]="twoColor",n))(pg||{});const ye=class{constructor(t){if(t<=0)throw new Error(`frameCount must be > 0: ${t}`);this.curves=$.newFloatArray((t-1)*ye.BEZIER_SIZE)}getFrameCount(){return this.curves.length/ye.BEZIER_SIZE+1}setLinear(t){this.curves[t*ye.BEZIER_SIZE]=ye.LINEAR}setStepped(t){this.curves[t*ye.BEZIER_SIZE]=ye.STEPPED}getCurveType(t){const e=t*ye.BEZIER_SIZE;if(e==this.curves.length)return ye.LINEAR;const s=this.curves[e];return s==ye.LINEAR?ye.LINEAR:s==ye.STEPPED?ye.STEPPED:ye.BEZIER}setCurve(t,e,s,r,i){const o=(-e*2+r)*.03,l=(-s*2+i)*.03,a=((e-r)*3+1)*.006,c=((s-i)*3+1)*.006;let h=o*2+a,d=l*2+c,u=e*.3+o+a*.16666667,f=s*.3+l+c*.16666667,m=t*ye.BEZIER_SIZE;const p=this.curves;p[m++]=ye.BEZIER;let g=u,w=f;for(let x=m+ye.BEZIER_SIZE-1;m<x;m+=2)p[m]=g,p[m+1]=w,u+=h,f+=d,h+=a,d+=c,g+=u,w+=f}getCurvePercent(t,e){e=P.clamp(e,0,1);const s=this.curves;let r=t*ye.BEZIER_SIZE;const i=s[r];if(i==ye.LINEAR)return e;if(i==ye.STEPPED)return 0;r++;let o=0;for(let a=r,c=r+ye.BEZIER_SIZE-1;r<c;r+=2)if(o=s[r],o>=e){let h,d;return r==a?(h=0,d=0):(h=s[r-2],d=s[r-1]),d+(s[r+1]-d)*(e-h)/(o-h)}const l=s[r-1];return l+(1-l)*(e-o)/(1-o)}};let hs=ye;hs.LINEAR=0;hs.STEPPED=1;hs.BEZIER=2;hs.BEZIER_SIZE=10*2-1;const Hn=class extends hs{constructor(t){super(t),this.frames=$.newFloatArray(t<<1)}getPropertyId(){return 0+this.boneIndex}setFrame(t,e,s){t<<=1,this.frames[t]=e,this.frames[t+Hn.ROTATION]=s}apply(t,e,s,r,i,o,l){const a=this.frames,c=t.bones[this.boneIndex];if(!c.active)return;if(s<a[0]){switch(o){case k.setup:c.rotation=c.data.rotation;return;case k.first:const p=c.data.rotation-c.rotation;c.rotation+=(p-(16384-(16384.499999999996-p/360|0))*360)*i}return}if(s>=a[a.length-Hn.ENTRIES]){let p=a[a.length+Hn.PREV_ROTATION];switch(o){case k.setup:c.rotation=c.data.rotation+p*i;break;case k.first:case k.replace:p+=c.data.rotation-c.rotation,p-=(16384-(16384.499999999996-p/360|0))*360;case k.add:c.rotation+=p*i}return}const h=Ee.binarySearch(a,s,Hn.ENTRIES),d=a[h+Hn.PREV_ROTATION],u=a[h],f=this.getCurvePercent((h>>1)-1,1-(s-u)/(a[h+Hn.PREV_TIME]-u));let m=a[h+Hn.ROTATION]-d;switch(m=d+(m-(16384-(16384.499999999996-m/360|0))*360)*f,o){case k.setup:c.rotation=c.data.rotation+(m-(16384-(16384.499999999996-m/360|0))*360)*i;break;case k.first:case k.replace:m+=c.data.rotation-c.rotation;case k.add:c.rotation+=(m-(16384-(16384.499999999996-m/360|0))*360)*i}}};let Ue=Hn;Ue.ENTRIES=2;Ue.PREV_TIME=-2;Ue.PREV_ROTATION=-1;Ue.ROTATION=1;const $e=class extends hs{constructor(t){super(t),this.frames=$.newFloatArray(t*$e.ENTRIES)}getPropertyId(){return(1<<24)+this.boneIndex}setFrame(t,e,s,r){t*=$e.ENTRIES,this.frames[t]=e,this.frames[t+$e.X]=s,this.frames[t+$e.Y]=r}apply(t,e,s,r,i,o,l){const a=this.frames,c=t.bones[this.boneIndex];if(!c.active)return;if(s<a[0]){switch(o){case k.setup:c.x=c.data.x,c.y=c.data.y;return;case k.first:c.x+=(c.data.x-c.x)*i,c.y+=(c.data.y-c.y)*i}return}let h=0,d=0;if(s>=a[a.length-$e.ENTRIES])h=a[a.length+$e.PREV_X],d=a[a.length+$e.PREV_Y];else{const u=Ee.binarySearch(a,s,$e.ENTRIES);h=a[u+$e.PREV_X],d=a[u+$e.PREV_Y];const f=a[u],m=this.getCurvePercent(u/$e.ENTRIES-1,1-(s-f)/(a[u+$e.PREV_TIME]-f));h+=(a[u+$e.X]-h)*m,d+=(a[u+$e.Y]-d)*m}switch(o){case k.setup:c.x=c.data.x+h*i,c.y=c.data.y+d*i;break;case k.first:case k.replace:c.x+=(c.data.x+h-c.x)*i,c.y+=(c.data.y+d-c.y)*i;break;case k.add:c.x+=h*i,c.y+=d*i}}};let xs=$e;xs.ENTRIES=3;xs.PREV_TIME=-3;xs.PREV_X=-2;xs.PREV_Y=-1;xs.X=1;xs.Y=2;let Xh=class Ds extends xs{constructor(t){super(t)}getPropertyId(){return(2<<24)+this.boneIndex}apply(t,e,s,r,i,o,l){const a=this.frames,c=t.bones[this.boneIndex];if(!c.active)return;if(s<a[0]){switch(o){case k.setup:c.scaleX=c.data.scaleX,c.scaleY=c.data.scaleY;return;case k.first:c.scaleX+=(c.data.scaleX-c.scaleX)*i,c.scaleY+=(c.data.scaleY-c.scaleY)*i}return}let h=0,d=0;if(s>=a[a.length-Ds.ENTRIES])h=a[a.length+Ds.PREV_X]*c.data.scaleX,d=a[a.length+Ds.PREV_Y]*c.data.scaleY;else{const u=Ee.binarySearch(a,s,Ds.ENTRIES);h=a[u+Ds.PREV_X],d=a[u+Ds.PREV_Y];const f=a[u],m=this.getCurvePercent(u/Ds.ENTRIES-1,1-(s-f)/(a[u+Ds.PREV_TIME]-f));h=(h+(a[u+Ds.X]-h)*m)*c.data.scaleX,d=(d+(a[u+Ds.Y]-d)*m)*c.data.scaleY}if(i==1)o==k.add?(c.scaleX+=h-c.data.scaleX,c.scaleY+=d-c.data.scaleY):(c.scaleX=h,c.scaleY=d);else{let u=0,f=0;if(l==It.mixOut)switch(o){case k.setup:u=c.data.scaleX,f=c.data.scaleY,c.scaleX=u+(Math.abs(h)*P.signum(u)-u)*i,c.scaleY=f+(Math.abs(d)*P.signum(f)-f)*i;break;case k.first:case k.replace:u=c.scaleX,f=c.scaleY,c.scaleX=u+(Math.abs(h)*P.signum(u)-u)*i,c.scaleY=f+(Math.abs(d)*P.signum(f)-f)*i;break;case k.add:u=c.scaleX,f=c.scaleY,c.scaleX=u+(Math.abs(h)*P.signum(u)-c.data.scaleX)*i,c.scaleY=f+(Math.abs(d)*P.signum(f)-c.data.scaleY)*i}else switch(o){case k.setup:u=Math.abs(c.data.scaleX)*P.signum(h),f=Math.abs(c.data.scaleY)*P.signum(d),c.scaleX=u+(h-u)*i,c.scaleY=f+(d-f)*i;break;case k.first:case k.replace:u=Math.abs(c.scaleX)*P.signum(h),f=Math.abs(c.scaleY)*P.signum(d),c.scaleX=u+(h-u)*i,c.scaleY=f+(d-f)*i;break;case k.add:u=P.signum(h),f=P.signum(d),c.scaleX=Math.abs(c.scaleX)*u+(h-Math.abs(c.data.scaleX)*u)*i,c.scaleY=Math.abs(c.scaleY)*f+(d-Math.abs(c.data.scaleY)*f)*i}}}},Gh=class Bs extends xs{constructor(t){super(t)}getPropertyId(){return(3<<24)+this.boneIndex}apply(t,e,s,r,i,o,l){const a=this.frames,c=t.bones[this.boneIndex];if(!c.active)return;if(s<a[0]){switch(o){case k.setup:c.shearX=c.data.shearX,c.shearY=c.data.shearY;return;case k.first:c.shearX+=(c.data.shearX-c.shearX)*i,c.shearY+=(c.data.shearY-c.shearY)*i}return}let h=0,d=0;if(s>=a[a.length-Bs.ENTRIES])h=a[a.length+Bs.PREV_X],d=a[a.length+Bs.PREV_Y];else{const u=Ee.binarySearch(a,s,Bs.ENTRIES);h=a[u+Bs.PREV_X],d=a[u+Bs.PREV_Y];const f=a[u],m=this.getCurvePercent(u/Bs.ENTRIES-1,1-(s-f)/(a[u+Bs.PREV_TIME]-f));h=h+(a[u+Bs.X]-h)*m,d=d+(a[u+Bs.Y]-d)*m}switch(o){case k.setup:c.shearX=c.data.shearX+h*i,c.shearY=c.data.shearY+d*i;break;case k.first:case k.replace:c.shearX+=(c.data.shearX+h-c.shearX)*i,c.shearY+=(c.data.shearY+d-c.shearY)*i;break;case k.add:c.shearX+=h*i,c.shearY+=d*i}}};const oe=class extends hs{constructor(t){super(t),this.frames=$.newFloatArray(t*oe.ENTRIES)}getPropertyId(){return(5<<24)+this.slotIndex}setFrame(t,e,s,r,i,o){t*=oe.ENTRIES,this.frames[t]=e,this.frames[t+oe.R]=s,this.frames[t+oe.G]=r,this.frames[t+oe.B]=i,this.frames[t+oe.A]=o}apply(t,e,s,r,i,o,l){const a=t.slots[this.slotIndex];if(!a.bone.active)return;const c=this.frames;if(s<c[0]){switch(o){case k.setup:a.color.setFromColor(a.data.color);return;case k.first:const m=a.color,p=a.data.color;m.add((p.r-m.r)*i,(p.g-m.g)*i,(p.b-m.b)*i,(p.a-m.a)*i)}return}let h=0,d=0,u=0,f=0;if(s>=c[c.length-oe.ENTRIES]){const m=c.length;h=c[m+oe.PREV_R],d=c[m+oe.PREV_G],u=c[m+oe.PREV_B],f=c[m+oe.PREV_A]}else{const m=Ee.binarySearch(c,s,oe.ENTRIES);h=c[m+oe.PREV_R],d=c[m+oe.PREV_G],u=c[m+oe.PREV_B],f=c[m+oe.PREV_A];const p=c[m],g=this.getCurvePercent(m/oe.ENTRIES-1,1-(s-p)/(c[m+oe.PREV_TIME]-p));h+=(c[m+oe.R]-h)*g,d+=(c[m+oe.G]-d)*g,u+=(c[m+oe.B]-u)*g,f+=(c[m+oe.A]-f)*g}if(i==1)a.color.set(h,d,u,f);else{const m=a.color;o==k.setup&&m.setFromColor(a.data.color),m.add((h-m.r)*i,(d-m.g)*i,(u-m.b)*i,(f-m.a)*i)}}};let es=oe;es.ENTRIES=5;es.PREV_TIME=-5;es.PREV_R=-4;es.PREV_G=-3;es.PREV_B=-2;es.PREV_A=-1;es.R=1;es.G=2;es.B=3;es.A=4;const Ft=class extends hs{constructor(t){super(t),this.frames=$.newFloatArray(t*Ft.ENTRIES)}getPropertyId(){return(14<<24)+this.slotIndex}setFrame(t,e,s,r,i,o,l,a,c){t*=Ft.ENTRIES,this.frames[t]=e,this.frames[t+Ft.R]=s,this.frames[t+Ft.G]=r,this.frames[t+Ft.B]=i,this.frames[t+Ft.A]=o,this.frames[t+Ft.R2]=l,this.frames[t+Ft.G2]=a,this.frames[t+Ft.B2]=c}apply(t,e,s,r,i,o,l){const a=t.slots[this.slotIndex];if(!a.bone.active)return;const c=this.frames;if(s<c[0]){switch(o){case k.setup:a.color.setFromColor(a.data.color),a.darkColor.setFromColor(a.data.darkColor);return;case k.first:const w=a.color,x=a.darkColor,y=a.data.color,b=a.data.darkColor;w.add((y.r-w.r)*i,(y.g-w.g)*i,(y.b-w.b)*i,(y.a-w.a)*i),x.add((b.r-x.r)*i,(b.g-x.g)*i,(b.b-x.b)*i,0)}return}let h=0,d=0,u=0,f=0,m=0,p=0,g=0;if(s>=c[c.length-Ft.ENTRIES]){const w=c.length;h=c[w+Ft.PREV_R],d=c[w+Ft.PREV_G],u=c[w+Ft.PREV_B],f=c[w+Ft.PREV_A],m=c[w+Ft.PREV_R2],p=c[w+Ft.PREV_G2],g=c[w+Ft.PREV_B2]}else{const w=Ee.binarySearch(c,s,Ft.ENTRIES);h=c[w+Ft.PREV_R],d=c[w+Ft.PREV_G],u=c[w+Ft.PREV_B],f=c[w+Ft.PREV_A],m=c[w+Ft.PREV_R2],p=c[w+Ft.PREV_G2],g=c[w+Ft.PREV_B2];const x=c[w],y=this.getCurvePercent(w/Ft.ENTRIES-1,1-(s-x)/(c[w+Ft.PREV_TIME]-x));h+=(c[w+Ft.R]-h)*y,d+=(c[w+Ft.G]-d)*y,u+=(c[w+Ft.B]-u)*y,f+=(c[w+Ft.A]-f)*y,m+=(c[w+Ft.R2]-m)*y,p+=(c[w+Ft.G2]-p)*y,g+=(c[w+Ft.B2]-g)*y}if(i==1)a.color.set(h,d,u,f),a.darkColor.set(m,p,g,1);else{const w=a.color,x=a.darkColor;o==k.setup&&(w.setFromColor(a.data.color),x.setFromColor(a.data.darkColor)),w.add((h-w.r)*i,(d-w.g)*i,(u-w.b)*i,(f-w.a)*i),x.add((m-x.r)*i,(p-x.g)*i,(g-x.b)*i,0)}}};let Se=Ft;Se.ENTRIES=8;Se.PREV_TIME=-8;Se.PREV_R=-7;Se.PREV_G=-6;Se.PREV_B=-5;Se.PREV_A=-4;Se.PREV_R2=-3;Se.PREV_G2=-2;Se.PREV_B2=-1;Se.R=1;Se.G=2;Se.B=3;Se.A=4;Se.R2=5;Se.G2=6;Se.B2=7;let Dr=class{constructor(t){this.frames=$.newFloatArray(t),this.attachmentNames=new Array(t)}getPropertyId(){return(4<<24)+this.slotIndex}getFrameCount(){return this.frames.length}setFrame(t,e,s){this.frames[t]=e,this.attachmentNames[t]=s}apply(t,e,s,r,i,o,l){const a=t.slots[this.slotIndex];if(!a.bone.active)return;if(l==It.mixOut){o==k.setup&&this.setAttachment(t,a,a.data.attachmentName);return}const c=this.frames;if(s<c[0]){(o==k.setup||o==k.first)&&this.setAttachment(t,a,a.data.attachmentName);return}let h=0;s>=c[c.length-1]?h=c.length-1:h=Ee.binarySearch(c,s,1)-1;const d=this.attachmentNames[h];t.slots[this.slotIndex].setAttachment(d==null?null:t.getAttachment(this.slotIndex,d))}setAttachment(t,e,s){e.setAttachment(s==null?null:t.getAttachment(this.slotIndex,s))}},Rf=null,Yh=class extends hs{constructor(t){super(t),this.frames=$.newFloatArray(t),this.frameVertices=new Array(t),Rf==null&&(Rf=$.newFloatArray(64))}getPropertyId(){return(6<<27)+Number(this.attachment.id)+this.slotIndex}setFrame(t,e,s){this.frames[t]=e,this.frameVertices[t]=s}apply(t,e,s,r,i,o,l){const a=t.slots[this.slotIndex];if(!a.bone.active)return;const c=a.getAttachment();if(!(c instanceof xr)||c.deformAttachment!=this.attachment)return;const h=a.deform;h.length==0&&(o=k.setup);const d=this.frameVertices,u=d[0].length,f=this.frames;if(s<f[0]){const b=c;switch(o){case k.setup:h.length=0;return;case k.first:if(i==1){h.length=0;break}const _=$.setArraySize(h,u);if(b.bones==null){const E=b.vertices;for(let S=0;S<u;S++)_[S]+=(E[S]-_[S])*i}else{i=1-i;for(let E=0;E<u;E++)_[E]*=i}}return}const m=$.setArraySize(h,u);if(s>=f[f.length-1]){const b=d[f.length-1];if(i==1)if(o==k.add){const _=c;if(_.bones==null){const E=_.vertices;for(let S=0;S<u;S++)m[S]+=b[S]-E[S]}else for(let E=0;E<u;E++)m[E]+=b[E]}else $.arrayCopy(b,0,m,0,u);else switch(o){case k.setup:{const E=c;if(E.bones==null){const S=E.vertices;for(let T=0;T<u;T++){const C=S[T];m[T]=C+(b[T]-C)*i}}else for(let S=0;S<u;S++)m[S]=b[S]*i;break}case k.first:case k.replace:for(let E=0;E<u;E++)m[E]+=(b[E]-m[E])*i;break;case k.add:const _=c;if(_.bones==null){const E=_.vertices;for(let S=0;S<u;S++)m[S]+=(b[S]-E[S])*i}else for(let E=0;E<u;E++)m[E]+=b[E]*i}return}const p=Ee.binarySearch(f,s),g=d[p-1],w=d[p],x=f[p],y=this.getCurvePercent(p-1,1-(s-x)/(f[p-1]-x));if(i==1)if(o==k.add){const b=c;if(b.bones==null){const _=b.vertices;for(let E=0;E<u;E++){const S=g[E];m[E]+=S+(w[E]-S)*y-_[E]}}else for(let _=0;_<u;_++){const E=g[_];m[_]+=E+(w[_]-E)*y}}else for(let b=0;b<u;b++){const _=g[b];m[b]=_+(w[b]-_)*y}else switch(o){case k.setup:{const _=c;if(_.bones==null){const E=_.vertices;for(let S=0;S<u;S++){const T=g[S],C=E[S];m[S]=C+(T+(w[S]-T)*y-C)*i}}else for(let E=0;E<u;E++){const S=g[E];m[E]=(S+(w[E]-S)*y)*i}break}case k.first:case k.replace:for(let _=0;_<u;_++){const E=g[_];m[_]+=(E+(w[_]-E)*y-m[_])*i}break;case k.add:const b=c;if(b.bones==null){const _=b.vertices;for(let E=0;E<u;E++){const S=g[E];m[E]+=(S+(w[E]-S)*y-_[E])*i}}else for(let _=0;_<u;_++){const E=g[_];m[_]+=(E+(w[_]-E)*y)*i}}}},Ko=class{constructor(t){this.frames=$.newFloatArray(t),this.events=new Array(t)}getPropertyId(){return 7<<24}getFrameCount(){return this.frames.length}setFrame(t,e){this.frames[t]=e.time,this.events[t]=e}apply(t,e,s,r,i,o,l){if(r==null)return;const a=this.frames,c=this.frames.length;if(e>s)this.apply(t,e,Number.MAX_VALUE,r,i,o,l),e=-1;else if(e>=a[c-1])return;if(s<a[0])return;let h=0;if(e<a[0])h=0;else{h=Ee.binarySearch(a,e);const d=a[h];for(;h>0&&a[h-1]==d;)h--}for(;h<c&&s>=a[h];h++)r.push(this.events[h])}},gi=class{constructor(t){this.frames=$.newFloatArray(t),this.drawOrders=new Array(t)}getPropertyId(){return 8<<24}getFrameCount(){return this.frames.length}setFrame(t,e,s){this.frames[t]=e,this.drawOrders[t]=s}apply(t,e,s,r,i,o,l){const a=t.drawOrder,c=t.slots;if(l==It.mixOut&&o==k.setup){$.arrayCopy(t.slots,0,t.drawOrder,0,t.slots.length);return}const h=this.frames;if(s<h[0]){(o==k.setup||o==k.first)&&$.arrayCopy(t.slots,0,t.drawOrder,0,t.slots.length);return}let d=0;s>=h[h.length-1]?d=h.length-1:d=Ee.binarySearch(h,s)-1;const u=this.drawOrders[d];if(u==null)$.arrayCopy(c,0,a,0,c.length);else for(let f=0,m=u.length;f<m;f++)a[f]=c[u[f]]}};const Ut=class extends hs{constructor(t){super(t),this.frames=$.newFloatArray(t*Ut.ENTRIES)}getPropertyId(){return(9<<24)+this.ikConstraintIndex}setFrame(t,e,s,r,i,o,l){t*=Ut.ENTRIES,this.frames[t]=e,this.frames[t+Ut.MIX]=s,this.frames[t+Ut.SOFTNESS]=r,this.frames[t+Ut.BEND_DIRECTION]=i,this.frames[t+Ut.COMPRESS]=o?1:0,this.frames[t+Ut.STRETCH]=l?1:0}apply(t,e,s,r,i,o,l){const a=this.frames,c=t.ikConstraints[this.ikConstraintIndex];if(!c.active)return;if(s<a[0]){switch(o){case k.setup:c.mix=c.data.mix,c.softness=c.data.softness,c.bendDirection=c.data.bendDirection,c.compress=c.data.compress,c.stretch=c.data.stretch;return;case k.first:c.mix+=(c.data.mix-c.mix)*i,c.softness+=(c.data.softness-c.softness)*i,c.bendDirection=c.data.bendDirection,c.compress=c.data.compress,c.stretch=c.data.stretch}return}if(s>=a[a.length-Ut.ENTRIES]){o==k.setup?(c.mix=c.data.mix+(a[a.length+Ut.PREV_MIX]-c.data.mix)*i,c.softness=c.data.softness+(a[a.length+Ut.PREV_SOFTNESS]-c.data.softness)*i,l==It.mixOut?(c.bendDirection=c.data.bendDirection,c.compress=c.data.compress,c.stretch=c.data.stretch):(c.bendDirection=a[a.length+Ut.PREV_BEND_DIRECTION],c.compress=a[a.length+Ut.PREV_COMPRESS]!=0,c.stretch=a[a.length+Ut.PREV_STRETCH]!=0)):(c.mix+=(a[a.length+Ut.PREV_MIX]-c.mix)*i,c.softness+=(a[a.length+Ut.PREV_SOFTNESS]-c.softness)*i,l==It.mixIn&&(c.bendDirection=a[a.length+Ut.PREV_BEND_DIRECTION],c.compress=a[a.length+Ut.PREV_COMPRESS]!=0,c.stretch=a[a.length+Ut.PREV_STRETCH]!=0));return}const h=Ee.binarySearch(a,s,Ut.ENTRIES),d=a[h+Ut.PREV_MIX],u=a[h+Ut.PREV_SOFTNESS],f=a[h],m=this.getCurvePercent(h/Ut.ENTRIES-1,1-(s-f)/(a[h+Ut.PREV_TIME]-f));o==k.setup?(c.mix=c.data.mix+(d+(a[h+Ut.MIX]-d)*m-c.data.mix)*i,c.softness=c.data.softness+(u+(a[h+Ut.SOFTNESS]-u)*m-c.data.softness)*i,l==It.mixOut?(c.bendDirection=c.data.bendDirection,c.compress=c.data.compress,c.stretch=c.data.stretch):(c.bendDirection=a[h+Ut.PREV_BEND_DIRECTION],c.compress=a[h+Ut.PREV_COMPRESS]!=0,c.stretch=a[h+Ut.PREV_STRETCH]!=0)):(c.mix+=(d+(a[h+Ut.MIX]-d)*m-c.mix)*i,c.softness+=(u+(a[h+Ut.SOFTNESS]-u)*m-c.softness)*i,l==It.mixIn&&(c.bendDirection=a[h+Ut.PREV_BEND_DIRECTION],c.compress=a[h+Ut.PREV_COMPRESS]!=0,c.stretch=a[h+Ut.PREV_STRETCH]!=0))}};let Ge=Ut;Ge.ENTRIES=6;Ge.PREV_TIME=-6;Ge.PREV_MIX=-5;Ge.PREV_SOFTNESS=-4;Ge.PREV_BEND_DIRECTION=-3;Ge.PREV_COMPRESS=-2;Ge.PREV_STRETCH=-1;Ge.MIX=1;Ge.SOFTNESS=2;Ge.BEND_DIRECTION=3;Ge.COMPRESS=4;Ge.STRETCH=5;const le=class extends hs{constructor(t){super(t),this.frames=$.newFloatArray(t*le.ENTRIES)}getPropertyId(){return(10<<24)+this.transformConstraintIndex}setFrame(t,e,s,r,i,o){t*=le.ENTRIES,this.frames[t]=e,this.frames[t+le.ROTATE]=s,this.frames[t+le.TRANSLATE]=r,this.frames[t+le.SCALE]=i,this.frames[t+le.SHEAR]=o}apply(t,e,s,r,i,o,l){const a=this.frames,c=t.transformConstraints[this.transformConstraintIndex];if(!c.active)return;if(s<a[0]){const m=c.data;switch(o){case k.setup:c.rotateMix=m.rotateMix,c.translateMix=m.translateMix,c.scaleMix=m.scaleMix,c.shearMix=m.shearMix;return;case k.first:c.rotateMix+=(m.rotateMix-c.rotateMix)*i,c.translateMix+=(m.translateMix-c.translateMix)*i,c.scaleMix+=(m.scaleMix-c.scaleMix)*i,c.shearMix+=(m.shearMix-c.shearMix)*i}return}let h=0,d=0,u=0,f=0;if(s>=a[a.length-le.ENTRIES]){const m=a.length;h=a[m+le.PREV_ROTATE],d=a[m+le.PREV_TRANSLATE],u=a[m+le.PREV_SCALE],f=a[m+le.PREV_SHEAR]}else{const m=Ee.binarySearch(a,s,le.ENTRIES);h=a[m+le.PREV_ROTATE],d=a[m+le.PREV_TRANSLATE],u=a[m+le.PREV_SCALE],f=a[m+le.PREV_SHEAR];const p=a[m],g=this.getCurvePercent(m/le.ENTRIES-1,1-(s-p)/(a[m+le.PREV_TIME]-p));h+=(a[m+le.ROTATE]-h)*g,d+=(a[m+le.TRANSLATE]-d)*g,u+=(a[m+le.SCALE]-u)*g,f+=(a[m+le.SHEAR]-f)*g}if(o==k.setup){const m=c.data;c.rotateMix=m.rotateMix+(h-m.rotateMix)*i,c.translateMix=m.translateMix+(d-m.translateMix)*i,c.scaleMix=m.scaleMix+(u-m.scaleMix)*i,c.shearMix=m.shearMix+(f-m.shearMix)*i}else c.rotateMix+=(h-c.rotateMix)*i,c.translateMix+=(d-c.translateMix)*i,c.scaleMix+=(u-c.scaleMix)*i,c.shearMix+=(f-c.shearMix)*i}};let ss=le;ss.ENTRIES=5;ss.PREV_TIME=-5;ss.PREV_ROTATE=-4;ss.PREV_TRANSLATE=-3;ss.PREV_SCALE=-2;ss.PREV_SHEAR=-1;ss.ROTATE=1;ss.TRANSLATE=2;ss.SCALE=3;ss.SHEAR=4;const Ls=class extends hs{constructor(t){super(t),this.frames=$.newFloatArray(t*Ls.ENTRIES)}getPropertyId(){return(11<<24)+this.pathConstraintIndex}setFrame(t,e,s){t*=Ls.ENTRIES,this.frames[t]=e,this.frames[t+Ls.VALUE]=s}apply(t,e,s,r,i,o,l){const a=this.frames,c=t.pathConstraints[this.pathConstraintIndex];if(!c.active)return;if(s<a[0]){switch(o){case k.setup:c.position=c.data.position;return;case k.first:c.position+=(c.data.position-c.position)*i}return}let h=0;if(s>=a[a.length-Ls.ENTRIES])h=a[a.length+Ls.PREV_VALUE];else{const d=Ee.binarySearch(a,s,Ls.ENTRIES);h=a[d+Ls.PREV_VALUE];const u=a[d],f=this.getCurvePercent(d/Ls.ENTRIES-1,1-(s-u)/(a[d+Ls.PREV_TIME]-u));h+=(a[d+Ls.VALUE]-h)*f}o==k.setup?c.position=c.data.position+(h-c.data.position)*i:c.position+=(h-c.position)*i}};let xn=Ls;xn.ENTRIES=2;xn.PREV_TIME=-2;xn.PREV_VALUE=-1;xn.VALUE=1;let $h=class qn extends xn{constructor(t){super(t)}getPropertyId(){return(12<<24)+this.pathConstraintIndex}apply(t,e,s,r,i,o,l){const a=this.frames,c=t.pathConstraints[this.pathConstraintIndex];if(!c.active)return;if(s<a[0]){switch(o){case k.setup:c.spacing=c.data.spacing;return;case k.first:c.spacing+=(c.data.spacing-c.spacing)*i}return}let h=0;if(s>=a[a.length-qn.ENTRIES])h=a[a.length+qn.PREV_VALUE];else{const d=Ee.binarySearch(a,s,qn.ENTRIES);h=a[d+qn.PREV_VALUE];const u=a[d],f=this.getCurvePercent(d/qn.ENTRIES-1,1-(s-u)/(a[d+qn.PREV_TIME]-u));h+=(a[d+qn.VALUE]-h)*f}o==k.setup?c.spacing=c.data.spacing+(h-c.data.spacing)*i:c.spacing+=(h-c.spacing)*i}};const We=class extends hs{constructor(t){super(t),this.frames=$.newFloatArray(t*We.ENTRIES)}getPropertyId(){return(13<<24)+this.pathConstraintIndex}setFrame(t,e,s,r){t*=We.ENTRIES,this.frames[t]=e,this.frames[t+We.ROTATE]=s,this.frames[t+We.TRANSLATE]=r}apply(t,e,s,r,i,o,l){const a=this.frames,c=t.pathConstraints[this.pathConstraintIndex];if(!c.active)return;if(s<a[0]){switch(o){case k.setup:c.rotateMix=c.data.rotateMix,c.translateMix=c.data.translateMix;return;case k.first:c.rotateMix+=(c.data.rotateMix-c.rotateMix)*i,c.translateMix+=(c.data.translateMix-c.translateMix)*i}return}let h=0,d=0;if(s>=a[a.length-We.ENTRIES])h=a[a.length+We.PREV_ROTATE],d=a[a.length+We.PREV_TRANSLATE];else{const u=Ee.binarySearch(a,s,We.ENTRIES);h=a[u+We.PREV_ROTATE],d=a[u+We.PREV_TRANSLATE];const f=a[u],m=this.getCurvePercent(u/We.ENTRIES-1,1-(s-f)/(a[u+We.PREV_TIME]-f));h+=(a[u+We.ROTATE]-h)*m,d+=(a[u+We.TRANSLATE]-d)*m}o==k.setup?(c.rotateMix=c.data.rotateMix+(h-c.data.rotateMix)*i,c.translateMix=c.data.translateMix+(d-c.data.translateMix)*i):(c.rotateMix+=(h-c.rotateMix)*i,c.translateMix+=(d-c.translateMix)*i)}};let Qs=We;Qs.ENTRIES=3;Qs.PREV_TIME=-3;Qs.PREV_ROTATE=-2;Qs.PREV_TRANSLATE=-1;Qs.ROTATE=1;Qs.TRANSLATE=2;const ce=class{constructor(t){this.tracks=new Array,this.timeScale=1,this.unkeyedState=0,this.events=new Array,this.listeners=new Array,this.queue=new Wh(this),this.propertyIDs=new tg,this.animationsChanged=!1,this.trackEntryPool=new Ho(()=>new Zo),this.data=t}update(t){t*=this.timeScale;const e=this.tracks;for(let s=0,r=e.length;s<r;s++){const i=e[s];if(i==null)continue;i.animationLast=i.nextAnimationLast,i.trackLast=i.nextTrackLast;let o=t*i.timeScale;if(i.delay>0){if(i.delay-=o,i.delay>0)continue;o=-i.delay,i.delay=0}let l=i.next;if(l!=null){const a=i.trackLast-l.delay;if(a>=0){for(l.delay=0,l.trackTime+=i.timeScale==0?0:(a/i.timeScale+t)*l.timeScale,i.trackTime+=o,this.setCurrent(s,l,!0);l.mixingFrom!=null;)l.mixTime+=t,l=l.mixingFrom;continue}}else if(i.trackLast>=i.trackEnd&&i.mixingFrom==null){e[s]=null,this.queue.end(i),this.disposeNext(i);continue}if(i.mixingFrom!=null&&this.updateMixingFrom(i,t)){let a=i.mixingFrom;for(i.mixingFrom=null,a!=null&&(a.mixingTo=null);a!=null;)this.queue.end(a),a=a.mixingFrom}i.trackTime+=o}this.queue.drain()}updateMixingFrom(t,e){const s=t.mixingFrom;if(s==null)return!0;const r=this.updateMixingFrom(s,e);return s.animationLast=s.nextAnimationLast,s.trackLast=s.nextTrackLast,t.mixTime>0&&t.mixTime>=t.mixDuration?((s.totalAlpha==0||t.mixDuration==0)&&(t.mixingFrom=s.mixingFrom,s.mixingFrom!=null&&(s.mixingFrom.mixingTo=t),t.interruptAlpha=s.interruptAlpha,this.queue.end(s)),r):(s.trackTime+=e*s.timeScale,t.mixTime+=e,!1)}apply(t){if(t==null)throw new Error("skeleton cannot be null.");this.animationsChanged&&this._animationsChanged();const e=this.events,s=this.tracks;let r=!1;for(let l=0,a=s.length;l<a;l++){const c=s[l];if(c==null||c.delay>0)continue;r=!0;const h=l==0?k.first:c.mixBlend;let d=c.alpha;c.mixingFrom!=null?d*=this.applyMixingFrom(c,t,h):c.trackTime>=c.trackEnd&&c.next==null&&(d=0);const u=c.animationLast,f=c.getAnimationTime(),m=c.animation.timelines.length,p=c.animation.timelines;if(l==0&&d==1||h==k.add)for(let g=0;g<m;g++){const w=p[g];w instanceof Dr?this.applyAttachmentTimeline(w,t,f,h,!0):w.apply(t,u,f,e,d,h,It.mixIn)}else{const g=c.timelineMode,w=c.timelinesRotation.length==0;w&&$.setArraySize(c.timelinesRotation,m<<1,null);const x=c.timelinesRotation;for(let y=0;y<m;y++){const b=p[y],_=g[y]==ce.SUBSEQUENT?h:k.setup;b instanceof Ue?this.applyRotateTimeline(b,t,f,d,_,x,y<<1,w):b instanceof Dr?this.applyAttachmentTimeline(b,t,f,h,!0):b.apply(t,u,f,e,d,_,It.mixIn)}}this.queueEvents(c,f),e.length=0,c.nextAnimationLast=f,c.nextTrackLast=c.trackTime}const i=this.unkeyedState+ce.SETUP,o=t.slots;for(let l=0,a=t.slots.length;l<a;l++){const c=o[l];if(c.attachmentState==i){const h=c.data.attachmentName;c.setAttachment(h==null?null:t.getAttachment(c.data.index,h))}}return this.unkeyedState+=2,this.queue.drain(),r}applyMixingFrom(t,e,s){const r=t.mixingFrom;r.mixingFrom!=null&&this.applyMixingFrom(r,e,s);let i=0;t.mixDuration==0?(i=1,s==k.first&&(s=k.setup)):(i=t.mixTime/t.mixDuration,i>1&&(i=1),s!=k.first&&(s=r.mixBlend));const o=i<r.eventThreshold?this.events:null,l=i<r.attachmentThreshold,a=i<r.drawOrderThreshold,c=r.animationLast,h=r.getAnimationTime(),d=r.animation.timelines.length,u=r.animation.timelines,f=r.alpha*t.interruptAlpha,m=f*(1-i);if(s==k.add)for(let p=0;p<d;p++)u[p].apply(e,c,h,o,m,s,It.mixOut);else{const p=r.timelineMode,g=r.timelineHoldMix,w=r.timelinesRotation.length==0;w&&$.setArraySize(r.timelinesRotation,d<<1,null);const x=r.timelinesRotation;r.totalAlpha=0;for(let y=0;y<d;y++){const b=u[y];let _=It.mixOut,E,S=0;switch(p[y]){case ce.SUBSEQUENT:if(!a&&b instanceof gi)continue;E=s,S=m;break;case ce.FIRST:E=k.setup,S=m;break;case ce.HOLD_SUBSEQUENT:E=s,S=f;break;case ce.HOLD_FIRST:E=k.setup,S=f;break;default:E=k.setup;const T=g[y];S=f*Math.max(0,1-T.mixTime/T.mixDuration);break}r.totalAlpha+=S,b instanceof Ue?this.applyRotateTimeline(b,e,h,S,E,x,y<<1,w):b instanceof Dr?this.applyAttachmentTimeline(b,e,h,E,l):(a&&b instanceof gi&&E==k.setup&&(_=It.mixIn),b.apply(e,c,h,o,S,E,_))}}return t.mixDuration>0&&this.queueEvents(r,h),this.events.length=0,r.nextAnimationLast=h,r.nextTrackLast=r.trackTime,i}applyAttachmentTimeline(t,e,s,r,i){const o=e.slots[t.slotIndex];if(!o.bone.active)return;const l=t.frames;if(s<l[0])(r==k.setup||r==k.first)&&this.setAttachment(e,o,o.data.attachmentName,i);else{let a;s>=l[l.length-1]?a=l.length-1:a=Ee.binarySearch(l,s)-1,this.setAttachment(e,o,t.attachmentNames[a],i)}o.attachmentState<=this.unkeyedState&&(o.attachmentState=this.unkeyedState+ce.SETUP)}setAttachment(t,e,s,r){e.setAttachment(s==null?null:t.getAttachment(e.data.index,s)),r&&(e.attachmentState=this.unkeyedState+ce.CURRENT)}applyRotateTimeline(t,e,s,r,i,o,l,a){if(a&&(o[l]=0),r==1){t.apply(e,0,s,null,1,i,It.mixIn);return}const c=t,h=c.frames,d=e.bones[c.boneIndex];if(!d.active)return;let u=0,f=0;if(s<h[0])switch(i){case k.setup:d.rotation=d.data.rotation;default:return;case k.first:u=d.rotation,f=d.data.rotation}else if(u=i==k.setup?d.data.rotation:d.rotation,s>=h[h.length-Ue.ENTRIES])f=d.data.rotation+h[h.length+Ue.PREV_ROTATION];else{const g=Ee.binarySearch(h,s,Ue.ENTRIES),w=h[g+Ue.PREV_ROTATION],x=h[g],y=c.getCurvePercent((g>>1)-1,1-(s-x)/(h[g+Ue.PREV_TIME]-x));f=h[g+Ue.ROTATION]-w,f-=(16384-(16384.499999999996-f/360|0))*360,f=w+f*y+d.data.rotation,f-=(16384-(16384.499999999996-f/360|0))*360}let m=0,p=f-u;if(p-=(16384-(16384.499999999996-p/360|0))*360,p==0)m=o[l];else{let g=0,w=0;a?(g=0,w=p):(g=o[l],w=o[l+1]);const x=p>0;let y=g>=0;P.signum(w)!=P.signum(p)&&Math.abs(w)<=90&&(Math.abs(g)>180&&(g+=360*P.signum(g)),y=x),m=p+g-g%360,y!=x&&(m+=360*P.signum(g)),o[l]=m}o[l+1]=p,u+=m*r,d.rotation=u-(16384-(16384.499999999996-u/360|0))*360}queueEvents(t,e){const s=t.animationStart,r=t.animationEnd,i=r-s,o=t.trackLast%i,l=this.events;let a=0;const c=l.length;for(;a<c;a++){const d=l[a];if(d.time<o)break;d.time>r||this.queue.event(t,d)}let h=!1;for(t.loop?h=i==0||o>t.trackTime%i:h=e>=r&&t.animationLast<r,h&&this.queue.complete(t);a<c;a++)l[a].time<s||this.queue.event(t,l[a])}clearTracks(){const t=this.queue.drainDisabled;this.queue.drainDisabled=!0;for(let e=0,s=this.tracks.length;e<s;e++)this.clearTrack(e);this.tracks.length=0,this.queue.drainDisabled=t,this.queue.drain()}clearTrack(t){if(t>=this.tracks.length)return;const e=this.tracks[t];if(e==null)return;this.queue.end(e),this.disposeNext(e);let s=e;for(;;){const r=s.mixingFrom;if(r==null)break;this.queue.end(r),s.mixingFrom=null,s.mixingTo=null,s=r}this.tracks[e.trackIndex]=null,this.queue.drain()}setCurrent(t,e,s){const r=this.expandToIndex(t);this.tracks[t]=e,r!=null&&(s&&this.queue.interrupt(r),e.mixingFrom=r,r.mixingTo=e,e.mixTime=0,r.mixingFrom!=null&&r.mixDuration>0&&(e.interruptAlpha*=Math.min(1,r.mixTime/r.mixDuration)),r.timelinesRotation.length=0),this.queue.start(e)}setAnimation(t,e,s){const r=this.data.skeletonData.findAnimation(e);if(r==null)throw new Error(`Animation not found: ${e}`);return this.setAnimationWith(t,r,s)}setAnimationWith(t,e,s){if(e==null)throw new Error("animation cannot be null.");let r=!0,i=this.expandToIndex(t);i!=null&&(i.nextTrackLast==-1?(this.tracks[t]=i.mixingFrom,this.queue.interrupt(i),this.queue.end(i),this.disposeNext(i),i=i.mixingFrom,r=!1):this.disposeNext(i));const o=this.trackEntry(t,e,s,i);return this.setCurrent(t,o,r),this.queue.drain(),o}addAnimation(t,e,s,r){const i=this.data.skeletonData.findAnimation(e);if(i==null)throw new Error(`Animation not found: ${e}`);return this.addAnimationWith(t,i,s,r)}addAnimationWith(t,e,s,r){if(e==null)throw new Error("animation cannot be null.");let i=this.expandToIndex(t);if(i!=null)for(;i.next!=null;)i=i.next;const o=this.trackEntry(t,e,s,i);if(i==null)this.setCurrent(t,o,!0),this.queue.drain();else if(i.next=o,r<=0){const l=i.animationEnd-i.animationStart;l!=0?(i.loop?r+=l*(1+(i.trackTime/l|0)):r+=Math.max(l,i.trackTime),r-=this.data.getMix(i.animation,e)):r=i.trackTime}return o.delay=r,o}setEmptyAnimation(t,e){const s=this.setAnimationWith(t,ce.emptyAnimation,!1);return s.mixDuration=e,s.trackEnd=e,s}addEmptyAnimation(t,e,s){s<=0&&(s-=e);const r=this.addAnimationWith(t,ce.emptyAnimation,!1,s);return r.mixDuration=e,r.trackEnd=e,r}setEmptyAnimations(t){const e=this.queue.drainDisabled;this.queue.drainDisabled=!0;for(let s=0,r=this.tracks.length;s<r;s++){const i=this.tracks[s];i!=null&&this.setEmptyAnimation(i.trackIndex,t)}this.queue.drainDisabled=e,this.queue.drain()}expandToIndex(t){return t<this.tracks.length?this.tracks[t]:($.ensureArrayCapacity(this.tracks,t+1,null),this.tracks.length=t+1,null)}trackEntry(t,e,s,r){const i=this.trackEntryPool.obtain();return i.trackIndex=t,i.animation=e,i.loop=s,i.holdPrevious=!1,i.eventThreshold=0,i.attachmentThreshold=0,i.drawOrderThreshold=0,i.animationStart=0,i.animationEnd=e.duration,i.animationLast=-1,i.nextAnimationLast=-1,i.delay=0,i.trackTime=0,i.trackLast=-1,i.nextTrackLast=-1,i.trackEnd=Number.MAX_VALUE,i.timeScale=1,i.alpha=1,i.interruptAlpha=1,i.mixTime=0,i.mixDuration=r==null?0:this.data.getMix(r.animation,e),i.mixBlend=k.replace,i}disposeNext(t){let e=t.next;for(;e!=null;)this.queue.dispose(e),e=e.next;t.next=null}_animationsChanged(){this.animationsChanged=!1,this.propertyIDs.clear();for(let t=0,e=this.tracks.length;t<e;t++){let s=this.tracks[t];if(s!=null){for(;s.mixingFrom!=null;)s=s.mixingFrom;do(s.mixingFrom==null||s.mixBlend!=k.add)&&this.computeHold(s),s=s.mixingTo;while(s!=null)}}}computeHold(t){const e=t.mixingTo,s=t.animation.timelines,r=t.animation.timelines.length,i=$.setArraySize(t.timelineMode,r);t.timelineHoldMix.length=0;const o=$.setArraySize(t.timelineHoldMix,r),l=this.propertyIDs;if(e!=null&&e.holdPrevious){for(let a=0;a<r;a++)i[a]=l.add(s[a].getPropertyId())?ce.HOLD_FIRST:ce.HOLD_SUBSEQUENT;return}t:for(let a=0;a<r;a++){const c=s[a],h=c.getPropertyId();if(!l.add(h))i[a]=ce.SUBSEQUENT;else if(e==null||c instanceof Dr||c instanceof gi||c instanceof Ko||!e.animation.hasTimeline(h))i[a]=ce.FIRST;else{for(let d=e.mixingTo;d!=null;d=d.mixingTo)if(!d.animation.hasTimeline(h)){if(t.mixDuration>0){i[a]=ce.HOLD_MIX,o[a]=d;continue t}break}i[a]=ce.HOLD_FIRST}}}getCurrent(t){return t>=this.tracks.length?null:this.tracks[t]}addListener(t){if(t==null)throw new Error("listener cannot be null.");this.listeners.push(t)}removeListener(t){const e=this.listeners.indexOf(t);e>=0&&this.listeners.splice(e,1)}clearListeners(){this.listeners.length=0}clearListenerNotifications(){this.queue.clear()}setAnimationByName(t,e,s){ce.deprecatedWarning1||(ce.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: AnimationState.setAnimationByName is deprecated, please use setAnimation from now on.")),this.setAnimation(t,e,s)}addAnimationByName(t,e,s,r){ce.deprecatedWarning2||(ce.deprecatedWarning2=!0,console.warn("Spine Deprecation Warning: AnimationState.addAnimationByName is deprecated, please use addAnimation from now on.")),this.addAnimation(t,e,s,r)}hasAnimation(t){return this.data.skeletonData.findAnimation(t)!==null}hasAnimationByName(t){return ce.deprecatedWarning3||(ce.deprecatedWarning3=!0,console.warn("Spine Deprecation Warning: AnimationState.hasAnimationByName is deprecated, please use hasAnimation from now on.")),this.hasAnimation(t)}};let Es=ce;Es.emptyAnimation=new Ee("<empty>",[],0);Es.SUBSEQUENT=0;Es.FIRST=1;Es.HOLD_SUBSEQUENT=2;Es.HOLD_FIRST=3;Es.HOLD_MIX=4;Es.SETUP=1;Es.CURRENT=2;Es.deprecatedWarning1=!1;Es.deprecatedWarning2=!1;Es.deprecatedWarning3=!1;const Sn=class{constructor(){this.mixBlend=k.replace,this.timelineMode=new Array,this.timelineHoldMix=new Array,this.timelinesRotation=new Array}reset(){this.next=null,this.mixingFrom=null,this.mixingTo=null,this.animation=null,this.listener=null,this.timelineMode.length=0,this.timelineHoldMix.length=0,this.timelinesRotation.length=0}getAnimationTime(){if(this.loop){const t=this.animationEnd-this.animationStart;return t==0?this.animationStart:this.trackTime%t+this.animationStart}return Math.min(this.trackTime+this.animationStart,this.animationEnd)}setAnimationLast(t){this.animationLast=t,this.nextAnimationLast=t}isComplete(){return this.trackTime>=this.animationEnd-this.animationStart}resetRotationDirections(){this.timelinesRotation.length=0}get time(){return Sn.deprecatedWarning1||(Sn.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: TrackEntry.time is deprecated, please use trackTime from now on.")),this.trackTime}set time(t){Sn.deprecatedWarning1||(Sn.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: TrackEntry.time is deprecated, please use trackTime from now on.")),this.trackTime=t}get endTime(){return Sn.deprecatedWarning2||(Sn.deprecatedWarning2=!0,console.warn("Spine Deprecation Warning: TrackEntry.endTime is deprecated, please use trackEnd from now on.")),this.trackTime}set endTime(t){Sn.deprecatedWarning2||(Sn.deprecatedWarning2=!0,console.warn("Spine Deprecation Warning: TrackEntry.endTime is deprecated, please use trackEnd from now on.")),this.trackTime=t}loopsCount(){return Math.floor(this.trackTime/this.trackEnd)}};let Zo=Sn;Zo.deprecatedWarning1=!1;Zo.deprecatedWarning2=!1;const eh=class{constructor(t){this.objects=[],this.drainDisabled=!1,this.animState=t}start(t){this.objects.push(rs.start),this.objects.push(t),this.animState.animationsChanged=!0}interrupt(t){this.objects.push(rs.interrupt),this.objects.push(t)}end(t){this.objects.push(rs.end),this.objects.push(t),this.animState.animationsChanged=!0}dispose(t){this.objects.push(rs.dispose),this.objects.push(t)}complete(t){this.objects.push(rs.complete),this.objects.push(t)}event(t,e){this.objects.push(rs.event),this.objects.push(t),this.objects.push(e)}deprecateStuff(){return eh.deprecatedWarning1||(eh.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: onComplete, onStart, onEnd, onEvent art deprecated, please use listeners from now on. 'state.addListener({ complete: function(track, event) { } })'")),!0}drain(){if(this.drainDisabled)return;this.drainDisabled=!0;const t=this.objects,e=this.animState.listeners;for(let s=0;s<t.length;s+=2){const r=t[s],i=t[s+1];switch(r){case rs.start:i.listener!=null&&i.listener.start&&i.listener.start(i);for(let a=0;a<e.length;a++)e[a].start&&e[a].start(i);i.onStart&&this.deprecateStuff()&&i.onStart(i.trackIndex),this.animState.onStart&&this.deprecateStuff()&&this.deprecateStuff&&this.animState.onStart(i.trackIndex);break;case rs.interrupt:i.listener!=null&&i.listener.interrupt&&i.listener.interrupt(i);for(let a=0;a<e.length;a++)e[a].interrupt&&e[a].interrupt(i);break;case rs.end:i.listener!=null&&i.listener.end&&i.listener.end(i);for(let a=0;a<e.length;a++)e[a].end&&e[a].end(i);i.onEnd&&this.deprecateStuff()&&i.onEnd(i.trackIndex),this.animState.onEnd&&this.deprecateStuff()&&this.animState.onEnd(i.trackIndex);case rs.dispose:i.listener!=null&&i.listener.dispose&&i.listener.dispose(i);for(let a=0;a<e.length;a++)e[a].dispose&&e[a].dispose(i);this.animState.trackEntryPool.free(i);break;case rs.complete:i.listener!=null&&i.listener.complete&&i.listener.complete(i);for(let a=0;a<e.length;a++)e[a].complete&&e[a].complete(i);const o=P.toInt(i.loopsCount());i.onComplete&&this.deprecateStuff()&&i.onComplete(i.trackIndex,o),this.animState.onComplete&&this.deprecateStuff()&&this.animState.onComplete(i.trackIndex,o);break;case rs.event:const l=t[s+++2];i.listener!=null&&i.listener.event&&i.listener.event(i,l);for(let a=0;a<e.length;a++)e[a].event&&e[a].event(i,l);i.onEvent&&this.deprecateStuff()&&i.onEvent(i.trackIndex,l),this.animState.onEvent&&this.deprecateStuff()&&this.animState.onEvent(i.trackIndex,l);break}}this.clear(),this.drainDisabled=!1}clear(){this.objects.length=0}};let Wh=eh;Wh.deprecatedWarning1=!1;var rs=(n=>(n[n.start=0]="start",n[n.interrupt=1]="interrupt",n[n.end=2]="end",n[n.dispose=3]="dispose",n[n.complete=4]="complete",n[n.event=5]="event",n))(rs||{});let ZE=class{start(t){}interrupt(t){}end(t){}dispose(t){}complete(t){}event(t,e){}};const sh=class{constructor(t){if(this.animationToMixTime={},this.defaultMix=0,t==null)throw new Error("skeletonData cannot be null.");this.skeletonData=t}setMix(t,e,s){const r=this.skeletonData.findAnimation(t);if(r==null)throw new Error(`Animation not found: ${t}`);const i=this.skeletonData.findAnimation(e);if(i==null)throw new Error(`Animation not found: ${e}`);this.setMixWith(r,i,s)}setMixByName(t,e,s){sh.deprecatedWarning1||(sh.deprecatedWarning1=!0,console.warn("Deprecation Warning: AnimationStateData.setMixByName is deprecated, please use setMix from now on.")),this.setMix(t,e,s)}setMixWith(t,e,s){if(t==null)throw new Error("from cannot be null.");if(e==null)throw new Error("to cannot be null.");const r=`${t.name}.${e.name}`;this.animationToMixTime[r]=s}getMix(t,e){const s=`${t.name}.${e.name}`,r=this.animationToMixTime[s];return r===void 0?this.defaultMix:r}};let zh=sh;zh.deprecatedWarning1=!1;let Hh=class{constructor(t){this.atlas=t}newRegionAttachment(t,e,s){const r=this.atlas.findRegion(s);if(r==null)throw new Error(`Region not found in atlas: ${s} (region attachment: ${e})`);const i=new Tt(e);return i.region=r,i}newMeshAttachment(t,e,s){const r=this.atlas.findRegion(s);if(r==null)throw new Error(`Region not found in atlas: ${s} (mesh attachment: ${e})`);const i=new qo(e);return i.region=r,i}newBoundingBoxAttachment(t,e){return new ag(e)}newPathAttachment(t,e){return new la(e)}newPointAttachment(t,e){return new dg(e)}newClippingAttachment(t,e){return new lg(e)}},nh=class{constructor(t,e,s){if(this.matrix=new Zt,this.children=new Array,this.x=0,this.y=0,this.rotation=0,this.scaleX=0,this.scaleY=0,this.shearX=0,this.shearY=0,this.ax=0,this.ay=0,this.arotation=0,this.ascaleX=0,this.ascaleY=0,this.ashearX=0,this.ashearY=0,this.appliedValid=!1,this.sorted=!1,this.active=!1,t==null)throw new Error("data cannot be null.");if(e==null)throw new Error("skeleton cannot be null.");this.data=t,this.skeleton=e,this.parent=s,this.setToSetupPose()}get worldX(){return this.matrix.tx}get worldY(){return this.matrix.ty}isActive(){return this.active}update(){this.updateWorldTransformWith(this.x,this.y,this.rotation,this.scaleX,this.scaleY,this.shearX,this.shearY)}updateWorldTransform(){this.updateWorldTransformWith(this.x,this.y,this.rotation,this.scaleX,this.scaleY,this.shearX,this.shearY)}updateWorldTransformWith(t,e,s,r,i,o,l){this.ax=t,this.ay=e,this.arotation=s,this.ascaleX=r,this.ascaleY=i,this.ashearX=o,this.ashearY=l,this.appliedValid=!0;const a=this.parent,c=this.matrix,h=this.skeleton.scaleX,d=-this.skeleton.scaleY;if(a==null){const g=this.skeleton,w=s+90+l;c.a=P.cosDeg(s+o)*r*h,c.c=P.cosDeg(w)*i*h,c.b=P.sinDeg(s+o)*r*d,c.d=P.sinDeg(w)*i*d,c.tx=t*h+g.x,c.ty=e*d+g.y;return}let u=a.matrix.a,f=a.matrix.c,m=a.matrix.b,p=a.matrix.d;switch(c.tx=u*t+f*e+a.matrix.tx,c.ty=m*t+p*e+a.matrix.ty,this.data.transformMode){case wt.Normal:{const g=s+90+l,w=P.cosDeg(s+o)*r,x=P.cosDeg(g)*i,y=P.sinDeg(s+o)*r,b=P.sinDeg(g)*i;c.a=u*w+f*y,c.c=u*x+f*b,c.b=m*w+p*y,c.d=m*x+p*b;return}case wt.OnlyTranslation:{const g=s+90+l;c.a=P.cosDeg(s+o)*r,c.c=P.cosDeg(g)*i,c.b=P.sinDeg(s+o)*r,c.d=P.sinDeg(g)*i;break}case wt.NoRotationOrReflection:{let g=u*u+m*m,w=0;g>1e-4?(g=Math.abs(u*p-f*m)/g,u/=this.skeleton.scaleX,m/=this.skeleton.scaleY,f=m*g,p=u*g,w=Math.atan2(m,u)*P.radDeg):(u=0,m=0,w=90-Math.atan2(p,f)*P.radDeg);const x=s+o-w,y=s+l-w+90,b=P.cosDeg(x)*r,_=P.cosDeg(y)*i,E=P.sinDeg(x)*r,S=P.sinDeg(y)*i;c.a=u*b-f*E,c.c=u*_-f*S,c.b=m*b+p*E,c.d=m*_+p*S;break}case wt.NoScale:case wt.NoScaleOrReflection:{const g=P.cosDeg(s),w=P.sinDeg(s);let x=(u*g+f*w)/h,y=(m*g+p*w)/d,b=Math.sqrt(x*x+y*y);b>1e-5&&(b=1/b),x*=b,y*=b,b=Math.sqrt(x*x+y*y),this.data.transformMode==wt.NoScale&&u*p-f*m<0!=(this.skeleton.scaleX<0!=this.skeleton.scaleY>0)&&(b=-b);const _=Math.PI/2+Math.atan2(y,x),E=Math.cos(_)*b,S=Math.sin(_)*b,T=P.cosDeg(o)*r,C=P.cosDeg(90+l)*i,A=P.sinDeg(o)*r,R=P.sinDeg(90+l)*i;c.a=x*T+E*A,c.c=x*C+E*R,c.b=y*T+S*A,c.d=y*C+S*R;break}}c.a*=h,c.c*=h,c.b*=d,c.d*=d}setToSetupPose(){const t=this.data;this.x=t.x,this.y=t.y,this.rotation=t.rotation,this.scaleX=t.scaleX,this.scaleY=t.scaleY,this.shearX=t.shearX,this.shearY=t.shearY}getWorldRotationX(){return Math.atan2(this.matrix.b,this.matrix.a)*P.radDeg}getWorldRotationY(){return Math.atan2(this.matrix.d,this.matrix.c)*P.radDeg}getWorldScaleX(){const t=this.matrix;return Math.sqrt(t.a*t.a+t.c*t.c)}getWorldScaleY(){const t=this.matrix;return Math.sqrt(t.b*t.b+t.d*t.d)}updateAppliedTransform(){this.appliedValid=!0;const t=this.parent,e=this.matrix;if(t==null){this.ax=e.tx,this.ay=e.ty,this.arotation=Math.atan2(e.b,e.a)*P.radDeg,this.ascaleX=Math.sqrt(e.a*e.a+e.b*e.b),this.ascaleY=Math.sqrt(e.c*e.c+e.d*e.d),this.ashearX=0,this.ashearY=Math.atan2(e.a*e.c+e.b*e.d,e.a*e.d-e.b*e.c)*P.radDeg;return}const s=t.matrix,r=1/(s.a*s.d-s.b*s.c),i=e.tx-s.tx,o=e.ty-s.ty;this.ax=i*s.d*r-o*s.c*r,this.ay=o*s.a*r-i*s.b*r;const l=r*s.d,a=r*s.a,c=r*s.c,h=r*s.b,d=l*e.a-c*e.b,u=l*e.c-c*e.d,f=a*e.b-h*e.a,m=a*e.d-h*e.c;if(this.ashearX=0,this.ascaleX=Math.sqrt(d*d+f*f),this.ascaleX>1e-4){const p=d*m-u*f;this.ascaleY=p/this.ascaleX,this.ashearY=Math.atan2(d*u+f*m,p)*P.radDeg,this.arotation=Math.atan2(f,d)*P.radDeg}else this.ascaleX=0,this.ascaleY=Math.sqrt(u*u+m*m),this.ashearY=0,this.arotation=90-Math.atan2(m,u)*P.radDeg}worldToLocal(t){const e=this.matrix,s=e.a,r=e.c,i=e.b,o=e.d,l=1/(s*o-r*i),a=t.x-e.tx,c=t.y-e.ty;return t.x=a*o*l-c*r*l,t.y=c*s*l-a*i*l,t}localToWorld(t){const e=this.matrix,s=t.x,r=t.y;return t.x=s*e.a+r*e.c+e.tx,t.y=s*e.b+r*e.d+e.ty,t}worldToLocalRotation(t){const e=P.sinDeg(t),s=P.cosDeg(t),r=this.matrix;return Math.atan2(r.a*e-r.b*s,r.d*s-r.c*e)*P.radDeg}localToWorldRotation(t){const e=P.sinDeg(t),s=P.cosDeg(t),r=this.matrix;return Math.atan2(s*r.b+e*r.d,s*r.a+e*r.c)*P.radDeg}rotateWorld(t){const e=this.matrix,s=e.a,r=e.c,i=e.b,o=e.d,l=P.cosDeg(t),a=P.sinDeg(t);e.a=l*s-a*i,e.c=l*r-a*o,e.b=a*s+l*i,e.d=a*r+l*o,this.appliedValid=!1}},qh=class{constructor(t,e,s){if(this.x=0,this.y=0,this.rotation=0,this.scaleX=1,this.scaleY=1,this.shearX=0,this.shearY=0,this.transformMode=wt.Normal,this.skinRequired=!1,this.color=new et,t<0)throw new Error("index must be >= 0.");if(e==null)throw new Error("name cannot be null.");this.index=t,this.name=e,this.parent=s}},Qo=class{constructor(t,e,s){this.name=t,this.order=e,this.skinRequired=s}},Kh=class{constructor(t,e){if(e==null)throw new Error("data cannot be null.");this.time=t,this.data=e}},Zh=class{constructor(t){this.name=t}},gg=class{constructor(t,e){if(this.bendDirection=0,this.compress=!1,this.stretch=!1,this.mix=1,this.softness=0,this.active=!1,t==null)throw new Error("data cannot be null.");if(e==null)throw new Error("skeleton cannot be null.");this.data=t,this.mix=t.mix,this.softness=t.softness,this.bendDirection=t.bendDirection,this.compress=t.compress,this.stretch=t.stretch,this.bones=new Array;for(let s=0;s<t.bones.length;s++)this.bones.push(e.findBone(t.bones[s].name));this.target=e.findBone(t.target.name)}isActive(){return this.active}apply(){this.update()}update(){const t=this.target,e=this.bones;switch(e.length){case 1:this.apply1(e[0],t.worldX,t.worldY,this.compress,this.stretch,this.data.uniform,this.mix);break;case 2:this.apply2(e[0],e[1],t.worldX,t.worldY,this.bendDirection,this.stretch,this.softness,this.mix);break}}apply1(t,e,s,r,i,o,l){t.appliedValid||t.updateAppliedTransform();const a=t.parent.matrix,c=a.a;let h=a.c;const d=a.b;let u=a.d,f=-t.ashearX-t.arotation,m=0,p=0;switch(t.data.transformMode){case wt.OnlyTranslation:m=e-t.worldX,p=s-t.worldY;break;case wt.NoRotationOrReflection:const x=Math.abs(c*u-h*d)/(c*c+d*d),y=c/t.skeleton.scaleX,b=d/t.skeleton.scaleY;h=-b*x*t.skeleton.scaleX,u=y*x*t.skeleton.scaleY,f+=Math.atan2(b,y)*P.radDeg;default:const _=e-a.tx,E=s-a.ty,S=c*u-h*d;m=(_*u-E*h)/S-t.ax,p=(E*c-_*d)/S-t.ay}f+=Math.atan2(p,m)*P.radDeg,t.ascaleX<0&&(f+=180),f>180?f-=360:f<-180&&(f+=360);let g=t.ascaleX,w=t.ascaleY;if(r||i){switch(t.data.transformMode){case wt.NoScale:case wt.NoScaleOrReflection:m=e-t.worldX,p=s-t.worldY}const x=t.data.length*g,y=Math.sqrt(m*m+p*p);if(r&&y<x||i&&y>x&&x>1e-4){const b=(y/x-1)*l+1;g*=b,o&&(w*=b)}}t.updateWorldTransformWith(t.ax,t.ay,t.arotation+f*l,g,w,t.ashearX,t.ashearY)}apply2(t,e,s,r,i,o,l,a){if(a==0){e.updateWorldTransform();return}t.appliedValid||t.updateAppliedTransform(),e.appliedValid||e.updateAppliedTransform();const c=t.ax,h=t.ay;let d=t.ascaleX,u=d,f=t.ascaleY,m=e.ascaleX;const p=t.matrix;let g=0,w=0,x=0;d<0?(d=-d,g=180,x=-1):(g=0,x=1),f<0&&(f=-f,x=-x),m<0?(m=-m,w=180):w=0;const y=e.ax;let b=0,_=0,E=0,S=p.a,T=p.c,C=p.b,A=p.d;const R=Math.abs(d-f)<=1e-4;R?(b=e.ay,_=S*y+T*b+p.tx,E=C*y+A*b+p.ty):(b=0,_=S*y+p.tx,E=C*y+p.ty);const M=t.parent.matrix;S=M.a,T=M.c,C=M.b,A=M.d;const I=1/(S*A-T*C);let N=_-M.tx,F=E-M.ty;const B=(N*A-F*T)*I-c,Y=(F*S-N*C)*I-h,O=Math.sqrt(B*B+Y*Y);let V=e.data.length*m,j,X;if(O<1e-4){this.apply1(t,s,r,!1,o,!1,a),e.updateWorldTransformWith(y,b,0,e.ascaleX,e.ascaleY,e.ashearX,e.ashearY);return}N=s-M.tx,F=r-M.ty;let L=(N*A-F*T)*I-c,U=(F*S-N*C)*I-h,q=L*L+U*U;if(l!=0){l*=d*(m+1)/2;const Q=Math.sqrt(q),W=Q-O-V*d+l;if(W>0){let K=Math.min(1,W/(l*2))-1;K=(W-l*(1-K*K))/Q,L-=K*L,U-=K*U,q=L*L+U*U}}t:if(R){V*=d;let Q=(q-O*O-V*V)/(2*O*V);Q<-1?Q=-1:Q>1&&(Q=1,o&&(u*=(Math.sqrt(q)/(O+V)-1)*a+1)),X=Math.acos(Q)*i,S=O+V*Q,T=V*Math.sin(X),j=Math.atan2(U*S-L*T,L*S+U*T)}else{S=d*V,T=f*V;const Q=S*S,W=T*T,K=Math.atan2(U,L);C=W*O*O+Q*q-Q*W;const Z=-2*W*O,nt=W-Q;if(A=Z*Z-4*nt*C,A>=0){let ie=Math.sqrt(A);Z<0&&(ie=-ie),ie=-(Z+ie)/2;const Qt=ie/nt,Jt=C/ie,Ye=Math.abs(Qt)<Math.abs(Jt)?Qt:Jt;if(Ye*Ye<=q){F=Math.sqrt(q-Ye*Ye)*i,j=K-Math.atan2(F,Ye),X=Math.atan2(F/f,(Ye-O)/d);break t}}let gt=P.PI,rt=O-S,bt=rt*rt,Ct=0,jt=0,kt=O+S,ee=kt*kt,se=0;C=-S*O/(Q-W),C>=-1&&C<=1&&(C=Math.acos(C),N=S*Math.cos(C)+O,F=T*Math.sin(C),A=N*N+F*F,A<bt&&(gt=C,bt=A,rt=N,Ct=F),A>ee&&(jt=C,ee=A,kt=N,se=F)),q<=(bt+ee)/2?(j=K-Math.atan2(Ct*i,rt),X=gt*i):(j=K-Math.atan2(se*i,kt),X=jt*i)}const H=Math.atan2(b,y)*x;let J=t.arotation;j=(j-H)*P.radDeg+g-J,j>180?j-=360:j<-180&&(j+=360),t.updateWorldTransformWith(c,h,J+j*a,u,t.ascaleY,0,0),J=e.arotation,X=((X+H)*P.radDeg-e.ashearX)*x+w-J,X>180?X-=360:X<-180&&(X+=360),e.updateWorldTransformWith(y,b,J+X*a,e.ascaleX,e.ascaleY,e.ashearX,e.ashearY)}},Qh=class extends Qo{constructor(t){super(t,0,!1),this.bones=new Array,this.bendDirection=1,this.compress=!1,this.stretch=!1,this.uniform=!1,this.mix=1,this.softness=0}},Jh=class extends Qo{constructor(t){super(t,0,!1),this.bones=new Array}};var Oe=(n=>(n[n.Length=0]="Length",n[n.Fixed=1]="Fixed",n[n.Percent=2]="Percent",n))(Oe||{});const kr=class{constructor(t,e){if(this.position=0,this.spacing=0,this.rotateMix=0,this.translateMix=0,this.spaces=new Array,this.positions=new Array,this.world=new Array,this.curves=new Array,this.lengths=new Array,this.segments=new Array,this.active=!1,t==null)throw new Error("data cannot be null.");if(e==null)throw new Error("skeleton cannot be null.");this.data=t,this.bones=new Array;for(let s=0,r=t.bones.length;s<r;s++)this.bones.push(e.findBone(t.bones[s].name));this.target=e.findSlot(t.target.name),this.position=t.position,this.spacing=t.spacing,this.rotateMix=t.rotateMix,this.translateMix=t.translateMix}isActive(){return this.active}apply(){this.update()}update(){const t=this.target.getAttachment();if(!(t instanceof la))return;const e=this.rotateMix,s=this.translateMix,r=s>0,i=e>0;if(!r&&!i)return;const o=this.data,l=o.spacingMode,a=l==Oe.Length,c=o.rotateMode,h=c==_e.Tangent,d=c==_e.ChainScale,u=this.bones.length,f=h?u:u+1,m=this.bones,p=$.setArraySize(this.spaces,f);let g=null;const w=this.spacing;if(d||a){d&&(g=$.setArraySize(this.lengths,u));for(let S=0,T=f-1;S<T;){const C=m[S],A=C.data.length;if(A<kr.epsilon)d&&(g[S]=0),p[++S]=0;else{const R=A*C.matrix.a,M=A*C.matrix.b,I=Math.sqrt(R*R+M*M);d&&(g[S]=I),p[++S]=(a?A+w:w)*I/A}}}else for(let S=1;S<f;S++)p[S]=w;const x=this.computeWorldPositions(t,f,h,o.positionMode==me.Percent,l==Oe.Percent);let y=x[0],b=x[1],_=o.offsetRotation,E=!1;if(_==0)E=c==_e.Chain;else{E=!1;const S=this.target.bone.matrix;_*=S.a*S.d-S.b*S.c>0?P.degRad:-P.degRad}for(let S=0,T=3;S<u;S++,T+=3){const C=m[S],A=C.matrix;A.tx+=(y-A.tx)*s,A.ty+=(b-A.ty)*s;const R=x[T],M=x[T+1],I=R-y,N=M-b;if(d){const F=g[S];if(F!=0){const B=(Math.sqrt(I*I+N*N)/F-1)*e+1;A.a*=B,A.b*=B}}if(y=R,b=M,i){const F=A.a,B=A.c,Y=A.b,O=A.d;let V=0,j=0,X=0;if(h&&(h?V=x[T-1]:p[S+1]==0?V=x[T+2]:V=Math.atan2(N,I)),V-=Math.atan2(Y,F),E){j=Math.cos(V),X=Math.sin(V);const L=C.data.length;y+=(L*(j*F-X*Y)-I)*e,b+=(L*(X*F+j*Y)-N)*e}else V+=_;V>P.PI?V-=P.PI2:V<-P.PI&&(V+=P.PI2),V*=e,j=Math.cos(V),X=Math.sin(V),A.a=j*F-X*Y,A.c=j*B-X*O,A.b=X*F+j*Y,A.d=X*B+j*O}C.appliedValid=!1}}computeWorldPositions(t,e,s,r,i){const o=this.target;let l=this.position;const a=this.spaces,c=$.setArraySize(this.positions,e*3+2);let h=null;const d=t.closed;let u=t.worldVerticesLength,f=u/6,m=kr.NONE;if(!t.constantSpeed){const V=t.lengths;f-=d?1:2;const j=V[f];if(r&&(l*=j),i)for(let X=0;X<e;X++)a[X]*=j;h=$.setArraySize(this.world,8);for(let X=0,L=0,U=0;X<e;X++,L+=3){const q=a[X];l+=q;let H=l;if(d)H%=j,H<0&&(H+=j),U=0;else if(H<0){m!=kr.BEFORE&&(m=kr.BEFORE,t.computeWorldVertices(o,2,4,h,0,2)),this.addBeforePosition(H,h,0,c,L);continue}else if(H>j){m!=kr.AFTER&&(m=kr.AFTER,t.computeWorldVertices(o,u-6,4,h,0,2)),this.addAfterPosition(H-j,h,0,c,L);continue}for(;;U++){const J=V[U];if(!(H>J)){if(U==0)H/=J;else{const Q=V[U-1];H=(H-Q)/(J-Q)}break}}U!=m&&(m=U,d&&U==f?(t.computeWorldVertices(o,u-4,4,h,0,2),t.computeWorldVertices(o,0,4,h,4,2)):t.computeWorldVertices(o,U*6+2,8,h,0,2)),this.addCurvePosition(H,h[0],h[1],h[2],h[3],h[4],h[5],h[6],h[7],c,L,s||X>0&&q==0)}return c}d?(u+=2,h=$.setArraySize(this.world,u),t.computeWorldVertices(o,2,u-4,h,0,2),t.computeWorldVertices(o,0,2,h,u-4,2),h[u-2]=h[0],h[u-1]=h[1]):(f--,u-=4,h=$.setArraySize(this.world,u),t.computeWorldVertices(o,2,u,h,0,2));const p=$.setArraySize(this.curves,f);let g=0,w=h[0],x=h[1],y=0,b=0,_=0,E=0,S=0,T=0,C=0,A=0,R=0,M=0,I=0,N=0,F=0,B=0;for(let V=0,j=2;V<f;V++,j+=6)y=h[j],b=h[j+1],_=h[j+2],E=h[j+3],S=h[j+4],T=h[j+5],C=(w-y*2+_)*.1875,A=(x-b*2+E)*.1875,R=((y-_)*3-w+S)*.09375,M=((b-E)*3-x+T)*.09375,I=C*2+R,N=A*2+M,F=(y-w)*.75+C+R*.16666667,B=(b-x)*.75+A+M*.16666667,g+=Math.sqrt(F*F+B*B),F+=I,B+=N,I+=R,N+=M,g+=Math.sqrt(F*F+B*B),F+=I,B+=N,g+=Math.sqrt(F*F+B*B),F+=I+R,B+=N+M,g+=Math.sqrt(F*F+B*B),p[V]=g,w=S,x=T;if(r&&(l*=g),i)for(let V=0;V<e;V++)a[V]*=g;const Y=this.segments;let O=0;for(let V=0,j=0,X=0,L=0;V<e;V++,j+=3){const U=a[V];l+=U;let q=l;if(d)q%=g,q<0&&(q+=g),X=0;else if(q<0){this.addBeforePosition(q,h,0,c,j);continue}else if(q>g){this.addAfterPosition(q-g,h,u-4,c,j);continue}for(;;X++){const H=p[X];if(!(q>H)){if(X==0)q/=H;else{const J=p[X-1];q=(q-J)/(H-J)}break}}if(X!=m){m=X;let H=X*6;for(w=h[H],x=h[H+1],y=h[H+2],b=h[H+3],_=h[H+4],E=h[H+5],S=h[H+6],T=h[H+7],C=(w-y*2+_)*.03,A=(x-b*2+E)*.03,R=((y-_)*3-w+S)*.006,M=((b-E)*3-x+T)*.006,I=C*2+R,N=A*2+M,F=(y-w)*.3+C+R*.16666667,B=(b-x)*.3+A+M*.16666667,O=Math.sqrt(F*F+B*B),Y[0]=O,H=1;H<8;H++)F+=I,B+=N,I+=R,N+=M,O+=Math.sqrt(F*F+B*B),Y[H]=O;F+=I,B+=N,O+=Math.sqrt(F*F+B*B),Y[8]=O,F+=I+R,B+=N+M,O+=Math.sqrt(F*F+B*B),Y[9]=O,L=0}for(q*=O;;L++){const H=Y[L];if(!(q>H)){if(L==0)q/=H;else{const J=Y[L-1];q=L+(q-J)/(H-J)}break}}this.addCurvePosition(q*.1,w,x,y,b,_,E,S,T,c,j,s||V>0&&U==0)}return c}addBeforePosition(t,e,s,r,i){const o=e[s],l=e[s+1],a=e[s+2]-o,c=e[s+3]-l,h=Math.atan2(c,a);r[i]=o+t*Math.cos(h),r[i+1]=l+t*Math.sin(h),r[i+2]=h}addAfterPosition(t,e,s,r,i){const o=e[s+2],l=e[s+3],a=o-e[s],c=l-e[s+1],h=Math.atan2(c,a);r[i]=o+t*Math.cos(h),r[i+1]=l+t*Math.sin(h),r[i+2]=h}addCurvePosition(t,e,s,r,i,o,l,a,c,h,d,u){(t==0||isNaN(t))&&(t=1e-4);const f=t*t,m=f*t,p=1-t,g=p*p,w=g*p,x=p*t,y=x*3,b=p*y,_=y*t,E=e*w+r*b+o*_+a*m,S=s*w+i*b+l*_+c*m;h[d]=E,h[d+1]=S,u&&(h[d+2]=Math.atan2(S-(s*g+i*x*2+l*f),E-(e*g+r*x*2+o*f)))}};let Ei=kr;Ei.NONE=-1;Ei.BEFORE=-2;Ei.AFTER=-3;Ei.epsilon=1e-5;let xg=class{constructor(t,e){if(this.rotateMix=0,this.translateMix=0,this.scaleMix=0,this.shearMix=0,this.temp=new oa,this.active=!1,t==null)throw new Error("data cannot be null.");if(e==null)throw new Error("skeleton cannot be null.");this.data=t,this.rotateMix=t.rotateMix,this.translateMix=t.translateMix,this.scaleMix=t.scaleMix,this.shearMix=t.shearMix,this.bones=new Array;for(let s=0;s<t.bones.length;s++)this.bones.push(e.findBone(t.bones[s].name));this.target=e.findBone(t.target.name)}isActive(){return this.active}apply(){this.update()}update(){this.data.local?this.data.relative?this.applyRelativeLocal():this.applyAbsoluteLocal():this.data.relative?this.applyRelativeWorld():this.applyAbsoluteWorld()}applyAbsoluteWorld(){const t=this.rotateMix,e=this.translateMix,s=this.scaleMix,r=this.shearMix,i=this.target,o=i.matrix,l=o.a,a=o.c,c=o.b,h=o.d,d=l*h-a*c>0?P.degRad:-P.degRad,u=this.data.offsetRotation*d,f=this.data.offsetShearY*d,m=this.bones;for(let p=0,g=m.length;p<g;p++){const w=m[p];let x=!1;const y=w.matrix;if(t!=0){const b=y.a,_=y.c,E=y.b,S=y.d;let T=Math.atan2(c,l)-Math.atan2(E,b)+u;T>P.PI?T-=P.PI2:T<-P.PI&&(T+=P.PI2),T*=t;const C=Math.cos(T),A=Math.sin(T);y.a=C*b-A*E,y.c=C*_-A*S,y.b=A*b+C*E,y.d=A*_+C*S,x=!0}if(e!=0){const b=this.temp;i.localToWorld(b.set(this.data.offsetX,this.data.offsetY)),y.tx+=(b.x-y.tx)*e,y.ty+=(b.y-y.ty)*e,x=!0}if(s>0){let b=Math.sqrt(y.a*y.a+y.b*y.b),_=Math.sqrt(l*l+c*c);b>1e-5&&(b=(b+(_-b+this.data.offsetScaleX)*s)/b),y.a*=b,y.b*=b,b=Math.sqrt(y.c*y.c+y.d*y.d),_=Math.sqrt(a*a+h*h),b>1e-5&&(b=(b+(_-b+this.data.offsetScaleY)*s)/b),y.c*=b,y.d*=b,x=!0}if(r>0){const b=y.c,_=y.d,E=Math.atan2(_,b);let S=Math.atan2(h,a)-Math.atan2(c,l)-(E-Math.atan2(y.b,y.a));S>P.PI?S-=P.PI2:S<-P.PI&&(S+=P.PI2),S=E+(S+f)*r;const T=Math.sqrt(b*b+_*_);y.c=Math.cos(S)*T,y.d=Math.sin(S)*T,x=!0}x&&(w.appliedValid=!1)}}applyRelativeWorld(){const t=this.rotateMix,e=this.translateMix,s=this.scaleMix,r=this.shearMix,i=this.target,o=i.matrix,l=o.a,a=o.c,c=o.b,h=o.d,d=l*h-a*c>0?P.degRad:-P.degRad,u=this.data.offsetRotation*d,f=this.data.offsetShearY*d,m=this.bones;for(let p=0,g=m.length;p<g;p++){const w=m[p];let x=!1;const y=w.matrix;if(t!=0){const b=y.a,_=y.c,E=y.b,S=y.d;let T=Math.atan2(c,l)+u;T>P.PI?T-=P.PI2:T<-P.PI&&(T+=P.PI2),T*=t;const C=Math.cos(T),A=Math.sin(T);y.a=C*b-A*E,y.c=C*_-A*S,y.b=A*b+C*E,y.d=A*_+C*S,x=!0}if(e!=0){const b=this.temp;i.localToWorld(b.set(this.data.offsetX,this.data.offsetY)),y.tx+=b.x*e,y.ty+=b.y*e,x=!0}if(s>0){let b=(Math.sqrt(l*l+c*c)-1+this.data.offsetScaleX)*s+1;y.a*=b,y.b*=b,b=(Math.sqrt(a*a+h*h)-1+this.data.offsetScaleY)*s+1,y.c*=b,y.d*=b,x=!0}if(r>0){let b=Math.atan2(h,a)-Math.atan2(c,l);b>P.PI?b-=P.PI2:b<-P.PI&&(b+=P.PI2);const _=y.c,E=y.d;b=Math.atan2(E,_)+(b-P.PI/2+f)*r;const S=Math.sqrt(_*_+E*E);y.c=Math.cos(b)*S,y.d=Math.sin(b)*S,x=!0}x&&(w.appliedValid=!1)}}applyAbsoluteLocal(){const t=this.rotateMix,e=this.translateMix,s=this.scaleMix,r=this.shearMix,i=this.target;i.appliedValid||i.updateAppliedTransform();const o=this.bones;for(let l=0,a=o.length;l<a;l++){const c=o[l];c.appliedValid||c.updateAppliedTransform();let h=c.arotation;if(t!=0){let g=i.arotation-h+this.data.offsetRotation;g-=(16384-(16384.499999999996-g/360|0))*360,h+=g*t}let d=c.ax,u=c.ay;e!=0&&(d+=(i.ax-d+this.data.offsetX)*e,u+=(i.ay-u+this.data.offsetY)*e);let f=c.ascaleX,m=c.ascaleY;s>0&&(f>1e-5&&(f=(f+(i.ascaleX-f+this.data.offsetScaleX)*s)/f),m>1e-5&&(m=(m+(i.ascaleY-m+this.data.offsetScaleY)*s)/m));const p=c.ashearY;if(r>0){let g=i.ashearY-p+this.data.offsetShearY;g-=(16384-(16384.499999999996-g/360|0))*360,c.shearY+=g*r}c.updateWorldTransformWith(d,u,h,f,m,c.ashearX,p)}}applyRelativeLocal(){const t=this.rotateMix,e=this.translateMix,s=this.scaleMix,r=this.shearMix,i=this.target;i.appliedValid||i.updateAppliedTransform();const o=this.bones;for(let l=0,a=o.length;l<a;l++){const c=o[l];c.appliedValid||c.updateAppliedTransform();let h=c.arotation;t!=0&&(h+=(i.arotation+this.data.offsetRotation)*t);let d=c.ax,u=c.ay;e!=0&&(d+=(i.ax+this.data.offsetX)*e,u+=(i.ay+this.data.offsetY)*e);let f=c.ascaleX,m=c.ascaleY;s>0&&(f>1e-5&&(f*=(i.ascaleX-1+this.data.offsetScaleX)*s+1),m>1e-5&&(m*=(i.ascaleY-1+this.data.offsetScaleY)*s+1));let p=c.ashearY;r>0&&(p+=(i.ashearY+this.data.offsetShearY)*r),c.updateWorldTransformWith(d,u,h,f,m,c.ashearX,p)}}};const zi=class{constructor(t){if(this._updateCache=new Array,this.updateCacheReset=new Array,this.time=0,this.scaleX=1,this.scaleY=1,this.x=0,this.y=0,t==null)throw new Error("data cannot be null.");this.data=t,this.bones=new Array;for(let e=0;e<t.bones.length;e++){const s=t.bones[e];let r;if(s.parent==null)r=new nh(s,this,null);else{const i=this.bones[s.parent.index];r=new nh(s,this,i),i.children.push(r)}this.bones.push(r)}this.slots=new Array,this.drawOrder=new Array;for(let e=0;e<t.slots.length;e++){const s=t.slots[e],r=this.bones[s.boneData.index],i=new Uh(s,r);this.slots.push(i),this.drawOrder.push(i)}this.ikConstraints=new Array;for(let e=0;e<t.ikConstraints.length;e++){const s=t.ikConstraints[e];this.ikConstraints.push(new gg(s,this))}this.transformConstraints=new Array;for(let e=0;e<t.transformConstraints.length;e++){const s=t.transformConstraints[e];this.transformConstraints.push(new xg(s,this))}this.pathConstraints=new Array;for(let e=0;e<t.pathConstraints.length;e++){const s=t.pathConstraints[e];this.pathConstraints.push(new Ei(s,this))}this.color=new et(1,1,1,1),this.updateCache()}updateCache(){const t=this._updateCache;t.length=0,this.updateCacheReset.length=0;const e=this.bones;for(let h=0,d=e.length;h<d;h++){const u=e[h];u.sorted=u.data.skinRequired,u.active=!u.sorted}if(this.skin!=null){const h=this.skin.bones;for(let d=0,u=this.skin.bones.length;d<u;d++){let f=this.bones[h[d].index];do f.sorted=!1,f.active=!0,f=f.parent;while(f!=null)}}const s=this.ikConstraints,r=this.transformConstraints,i=this.pathConstraints,o=s.length,l=r.length,a=i.length,c=o+l+a;t:for(let h=0;h<c;h++){for(let d=0;d<o;d++){const u=s[d];if(u.data.order==h){this.sortIkConstraint(u);continue t}}for(let d=0;d<l;d++){const u=r[d];if(u.data.order==h){this.sortTransformConstraint(u);continue t}}for(let d=0;d<a;d++){const u=i[d];if(u.data.order==h){this.sortPathConstraint(u);continue t}}}for(let h=0,d=e.length;h<d;h++)this.sortBone(e[h])}sortIkConstraint(t){if(t.active=t.target.isActive()&&(!t.data.skinRequired||this.skin!=null&&$.contains(this.skin.constraints,t.data,!0)),!t.active)return;const e=t.target;this.sortBone(e);const s=t.bones,r=s[0];if(this.sortBone(r),s.length>1){const i=s[s.length-1];this._updateCache.indexOf(i)>-1||this.updateCacheReset.push(i)}this._updateCache.push(t),this.sortReset(r.children),s[s.length-1].sorted=!0}sortPathConstraint(t){if(t.active=t.target.bone.isActive()&&(!t.data.skinRequired||this.skin!=null&&$.contains(this.skin.constraints,t.data,!0)),!t.active)return;const e=t.target,s=e.data.index,r=e.bone;this.skin!=null&&this.sortPathConstraintAttachment(this.skin,s,r),this.data.defaultSkin!=null&&this.data.defaultSkin!=this.skin&&this.sortPathConstraintAttachment(this.data.defaultSkin,s,r);for(let a=0,c=this.data.skins.length;a<c;a++)this.sortPathConstraintAttachment(this.data.skins[a],s,r);const i=e.getAttachment();i instanceof la&&this.sortPathConstraintAttachmentWith(i,r);const o=t.bones,l=o.length;for(let a=0;a<l;a++)this.sortBone(o[a]);this._updateCache.push(t);for(let a=0;a<l;a++)this.sortReset(o[a].children);for(let a=0;a<l;a++)o[a].sorted=!0}sortTransformConstraint(t){if(t.active=t.target.isActive()&&(!t.data.skinRequired||this.skin!=null&&$.contains(this.skin.constraints,t.data,!0)),!t.active)return;this.sortBone(t.target);const e=t.bones,s=e.length;if(t.data.local)for(let r=0;r<s;r++){const i=e[r];this.sortBone(i.parent),this._updateCache.indexOf(i)>-1||this.updateCacheReset.push(i)}else for(let r=0;r<s;r++)this.sortBone(e[r]);this._updateCache.push(t);for(let r=0;r<s;r++)this.sortReset(e[r].children);for(let r=0;r<s;r++)e[r].sorted=!0}sortPathConstraintAttachment(t,e,s){const r=t.attachments[e];if(r)for(const i in r)this.sortPathConstraintAttachmentWith(r[i],s)}sortPathConstraintAttachmentWith(t,e){if(!(t instanceof la))return;const s=t.bones;if(s==null)this.sortBone(e);else{const r=this.bones;let i=0;for(;i<s.length;){const o=s[i++];for(let l=i+o;i<l;i++){const a=s[i];this.sortBone(r[a])}}}}sortBone(t){if(t.sorted)return;const e=t.parent;e!=null&&this.sortBone(e),t.sorted=!0,this._updateCache.push(t)}sortReset(t){for(let e=0,s=t.length;e<s;e++){const r=t[e];r.active&&(r.sorted&&this.sortReset(r.children),r.sorted=!1)}}updateWorldTransform(){const t=this.updateCacheReset;for(let s=0,r=t.length;s<r;s++){const i=t[s];i.ax=i.x,i.ay=i.y,i.arotation=i.rotation,i.ascaleX=i.scaleX,i.ascaleY=i.scaleY,i.ashearX=i.shearX,i.ashearY=i.shearY,i.appliedValid=!0}const e=this._updateCache;for(let s=0,r=e.length;s<r;s++)e[s].update()}setToSetupPose(){this.setBonesToSetupPose(),this.setSlotsToSetupPose()}setBonesToSetupPose(){const t=this.bones;for(let i=0,o=t.length;i<o;i++)t[i].setToSetupPose();const e=this.ikConstraints;for(let i=0,o=e.length;i<o;i++){const l=e[i];l.mix=l.data.mix,l.softness=l.data.softness,l.bendDirection=l.data.bendDirection,l.compress=l.data.compress,l.stretch=l.data.stretch}const s=this.transformConstraints;for(let i=0,o=s.length;i<o;i++){const l=s[i],a=l.data;l.rotateMix=a.rotateMix,l.translateMix=a.translateMix,l.scaleMix=a.scaleMix,l.shearMix=a.shearMix}const r=this.pathConstraints;for(let i=0,o=r.length;i<o;i++){const l=r[i],a=l.data;l.position=a.position,l.spacing=a.spacing,l.rotateMix=a.rotateMix,l.translateMix=a.translateMix}}setSlotsToSetupPose(){const t=this.slots;$.arrayCopy(t,0,this.drawOrder,0,t.length);for(let e=0,s=t.length;e<s;e++)t[e].setToSetupPose()}getRootBone(){return this.bones.length==0?null:this.bones[0]}findBone(t){if(t==null)throw new Error("boneName cannot be null.");const e=this.bones;for(let s=0,r=e.length;s<r;s++){const i=e[s];if(i.data.name==t)return i}return null}findBoneIndex(t){if(t==null)throw new Error("boneName cannot be null.");const e=this.bones;for(let s=0,r=e.length;s<r;s++)if(e[s].data.name==t)return s;return-1}findSlot(t){if(t==null)throw new Error("slotName cannot be null.");const e=this.slots;for(let s=0,r=e.length;s<r;s++){const i=e[s];if(i.data.name==t)return i}return null}findSlotIndex(t){if(t==null)throw new Error("slotName cannot be null.");const e=this.slots;for(let s=0,r=e.length;s<r;s++)if(e[s].data.name==t)return s;return-1}setSkinByName(t){const e=this.data.findSkin(t);if(e==null)throw new Error(`Skin not found: ${t}`);this.setSkin(e)}setSkin(t){if(t!=this.skin){if(t!=null)if(this.skin!=null)t.attachAll(this,this.skin);else{const e=this.slots;for(let s=0,r=e.length;s<r;s++){const i=e[s],o=i.data.attachmentName;if(o!=null){const l=t.getAttachment(s,o);l!=null&&i.setAttachment(l)}}}this.skin=t,this.updateCache()}}getAttachmentByName(t,e){return this.getAttachment(this.data.findSlotIndex(t),e)}getAttachment(t,e){if(e==null)throw new Error("attachmentName cannot be null.");if(this.skin!=null){const s=this.skin.getAttachment(t,e);if(s!=null)return s}return this.data.defaultSkin!=null?this.data.defaultSkin.getAttachment(t,e):null}setAttachment(t,e){if(t==null)throw new Error("slotName cannot be null.");const s=this.slots;for(let r=0,i=s.length;r<i;r++){const o=s[r];if(o.data.name==t){let l=null;if(e!=null&&(l=this.getAttachment(r,e),l==null))throw new Error(`Attachment not found: ${e}, for slot: ${t}`);o.setAttachment(l);return}}throw new Error(`Slot not found: ${t}`)}findIkConstraint(t){if(t==null)throw new Error("constraintName cannot be null.");const e=this.ikConstraints;for(let s=0,r=e.length;s<r;s++){const i=e[s];if(i.data.name==t)return i}return null}findTransformConstraint(t){if(t==null)throw new Error("constraintName cannot be null.");const e=this.transformConstraints;for(let s=0,r=e.length;s<r;s++){const i=e[s];if(i.data.name==t)return i}return null}findPathConstraint(t){if(t==null)throw new Error("constraintName cannot be null.");const e=this.pathConstraints;for(let s=0,r=e.length;s<r;s++){const i=e[s];if(i.data.name==t)return i}return null}getBounds(t,e,s=new Array(2)){if(t==null)throw new Error("offset cannot be null.");if(e==null)throw new Error("size cannot be null.");const r=this.drawOrder;let i=Number.POSITIVE_INFINITY,o=Number.POSITIVE_INFINITY,l=Number.NEGATIVE_INFINITY,a=Number.NEGATIVE_INFINITY;for(let c=0,h=r.length;c<h;c++){const d=r[c];if(!d.bone.active)continue;let u=0,f=null;const m=d.getAttachment();if(m instanceof Tt)u=8,f=$.setArraySize(s,u,0),m.computeWorldVertices(d.bone,f,0,2);else if(m instanceof qo){const p=m;u=p.worldVerticesLength,f=$.setArraySize(s,u,0),p.computeWorldVertices(d,0,u,f,0,2)}if(f!=null)for(let p=0,g=f.length;p<g;p+=2){const w=f[p],x=f[p+1];i=Math.min(i,w),o=Math.min(o,x),l=Math.max(l,w),a=Math.max(a,x)}}t.set(i,o),e.set(l-i,a-o)}update(t){this.time+=t}get flipX(){return this.scaleX==-1}set flipX(t){zi.deprecatedWarning1||(zi.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: `Skeleton.flipX/flipY` was deprecated, please use scaleX/scaleY")),this.scaleX=t?1:-1}get flipY(){return this.scaleY==-1}set flipY(t){zi.deprecatedWarning1||(zi.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: `Skeleton.flipX/flipY` was deprecated, please use scaleX/scaleY")),this.scaleY=t?1:-1}};let td=zi;td.deprecatedWarning1=!1;let ed=class{constructor(){this.bones=new Array,this.slots=new Array,this.skins=new Array,this.events=new Array,this.animations=new Array,this.ikConstraints=new Array,this.transformConstraints=new Array,this.pathConstraints=new Array,this.fps=0}findBone(t){if(t==null)throw new Error("boneName cannot be null.");const e=this.bones;for(let s=0,r=e.length;s<r;s++){const i=e[s];if(i.name==t)return i}return null}findBoneIndex(t){if(t==null)throw new Error("boneName cannot be null.");const e=this.bones;for(let s=0,r=e.length;s<r;s++)if(e[s].name==t)return s;return-1}findSlot(t){if(t==null)throw new Error("slotName cannot be null.");const e=this.slots;for(let s=0,r=e.length;s<r;s++){const i=e[s];if(i.name==t)return i}return null}findSlotIndex(t){if(t==null)throw new Error("slotName cannot be null.");const e=this.slots;for(let s=0,r=e.length;s<r;s++)if(e[s].name==t)return s;return-1}findSkin(t){if(t==null)throw new Error("skinName cannot be null.");const e=this.skins;for(let s=0,r=e.length;s<r;s++){const i=e[s];if(i.name==t)return i}return null}findEvent(t){if(t==null)throw new Error("eventDataName cannot be null.");const e=this.events;for(let s=0,r=e.length;s<r;s++){const i=e[s];if(i.name==t)return i}return null}findAnimation(t){if(t==null)throw new Error("animationName cannot be null.");const e=this.animations;for(let s=0,r=e.length;s<r;s++){const i=e[s];if(i.name==t)return i}return null}findIkConstraint(t){if(t==null)throw new Error("constraintName cannot be null.");const e=this.ikConstraints;for(let s=0,r=e.length;s<r;s++){const i=e[s];if(i.name==t)return i}return null}findTransformConstraint(t){if(t==null)throw new Error("constraintName cannot be null.");const e=this.transformConstraints;for(let s=0,r=e.length;s<r;s++){const i=e[s];if(i.name==t)return i}return null}findPathConstraint(t){if(t==null)throw new Error("constraintName cannot be null.");const e=this.pathConstraints;for(let s=0,r=e.length;s<r;s++){const i=e[s];if(i.name==t)return i}return null}findPathConstraintIndex(t){if(t==null)throw new Error("pathConstraintName cannot be null.");const e=this.pathConstraints;for(let s=0,r=e.length;s<r;s++)if(e[s].name==t)return s;return-1}},sd=class{constructor(t,e,s){if(this.color=new et(1,1,1,1),t<0)throw new Error("index must be >= 0.");if(e==null)throw new Error("name cannot be null.");if(s==null)throw new Error("boneData cannot be null.");this.index=t,this.name=e,this.boneData=s}},nd=class extends Qo{constructor(t){super(t,0,!1),this.bones=new Array,this.rotateMix=0,this.translateMix=0,this.scaleMix=0,this.shearMix=0,this.offsetRotation=0,this.offsetX=0,this.offsetY=0,this.offsetScaleX=0,this.offsetScaleY=0,this.offsetShearY=0,this.relative=!1,this.local=!1}},rh=class{constructor(t,e,s){this.slotIndex=t,this.name=e,this.attachment=s}},Ao=class{constructor(t){if(this.attachments=new Array,this.bones=Array(),this.constraints=new Array,t==null)throw new Error("name cannot be null.");this.name=t}setAttachment(t,e,s){if(s==null)throw new Error("attachment cannot be null.");const r=this.attachments;t>=r.length&&(r.length=t+1),r[t]||(r[t]={}),r[t][e]=s}addSkin(t){for(let s=0;s<t.bones.length;s++){const r=t.bones[s];let i=!1;for(let o=0;o<this.bones.length;o++)if(this.bones[o]==r){i=!0;break}i||this.bones.push(r)}for(let s=0;s<t.constraints.length;s++){const r=t.constraints[s];let i=!1;for(let o=0;o<this.constraints.length;o++)if(this.constraints[o]==r){i=!0;break}i||this.constraints.push(r)}const e=t.getAttachments();for(let s=0;s<e.length;s++){const r=e[s];this.setAttachment(r.slotIndex,r.name,r.attachment)}}copySkin(t){for(let s=0;s<t.bones.length;s++){const r=t.bones[s];let i=!1;for(let o=0;o<this.bones.length;o++)if(this.bones[o]==r){i=!0;break}i||this.bones.push(r)}for(let s=0;s<t.constraints.length;s++){const r=t.constraints[s];let i=!1;for(let o=0;o<this.constraints.length;o++)if(this.constraints[o]==r){i=!0;break}i||this.constraints.push(r)}const e=t.getAttachments();for(let s=0;s<e.length;s++){const r=e[s];r.attachment!=null&&(r.attachment instanceof qo?(r.attachment=r.attachment.newLinkedMesh(),this.setAttachment(r.slotIndex,r.name,r.attachment)):(r.attachment=r.attachment.copy(),this.setAttachment(r.slotIndex,r.name,r.attachment)))}}getAttachment(t,e){const s=this.attachments[t];return s?s[e]:null}removeAttachment(t,e){const s=this.attachments[t];s&&(s[e]=null)}getAttachments(){const t=new Array;for(let e=0;e<this.attachments.length;e++){const s=this.attachments[e];if(s)for(const r in s){const i=s[r];i&&t.push(new rh(e,r,i))}}return t}getAttachmentsForSlot(t,e){const s=this.attachments[t];if(s)for(const r in s){const i=s[r];i&&e.push(new rh(t,r,i))}}clear(){this.attachments.length=0,this.bones.length=0,this.constraints.length=0}attachAll(t,e){let s=0;for(let r=0;r<t.slots.length;r++){const i=t.slots[r],o=i.getAttachment();if(o&&s<e.attachments.length){const l=e.attachments[s];for(const a in l){const c=l[a];if(o==c){const h=this.getAttachment(s,a);h!=null&&i.setAttachment(h);break}}}s++}}};const ge=class{constructor(n){this.scale=1,this.linkedMeshes=new Array,this.attachmentLoader=n}readSkeletonData(n){const t=this.scale,e=new ed;e.name="";const s=new To(n);e.hash=s.readString(),e.version=s.readString(),e.version==="3.8.75"&&console.error("Unsupported skeleton data, 3.8.75 is deprecated, please export with a newer version of Spine."),e.x=s.readFloat(),e.y=s.readFloat(),e.width=s.readFloat(),e.height=s.readFloat();const r=s.readBoolean();r&&(e.fps=s.readFloat(),e.imagesPath=s.readString(),e.audioPath=s.readString());let i=0;i=s.readInt(!0);for(let l=0;l<i;l++)s.strings.push(s.readString());i=s.readInt(!0);for(let l=0;l<i;l++){const a=s.readString(),c=l==0?null:e.bones[s.readInt(!0)],h=new qh(l,a,c);h.rotation=s.readFloat(),h.x=s.readFloat()*t,h.y=s.readFloat()*t,h.scaleX=s.readFloat(),h.scaleY=s.readFloat(),h.shearX=s.readFloat(),h.shearY=s.readFloat(),h.length=s.readFloat()*t,h.transformMode=ge.TransformModeValues[s.readInt(!0)],h.skinRequired=s.readBoolean(),r&&et.rgba8888ToColor(h.color,s.readInt32()),e.bones.push(h)}i=s.readInt(!0);for(let l=0;l<i;l++){const a=s.readString(),c=e.bones[s.readInt(!0)],h=new sd(l,a,c);et.rgba8888ToColor(h.color,s.readInt32());const d=s.readInt32();d!=-1&&et.rgb888ToColor(h.darkColor=new et,d),h.attachmentName=s.readStringRef(),h.blendMode=ge.BlendModeValues[s.readInt(!0)],e.slots.push(h)}i=s.readInt(!0);for(let l=0,a;l<i;l++){const c=new Qh(s.readString());c.order=s.readInt(!0),c.skinRequired=s.readBoolean(),a=s.readInt(!0);for(let h=0;h<a;h++)c.bones.push(e.bones[s.readInt(!0)]);c.target=e.bones[s.readInt(!0)],c.mix=s.readFloat(),c.softness=s.readFloat()*t,c.bendDirection=s.readByte(),c.compress=s.readBoolean(),c.stretch=s.readBoolean(),c.uniform=s.readBoolean(),e.ikConstraints.push(c)}i=s.readInt(!0);for(let l=0,a;l<i;l++){const c=new nd(s.readString());c.order=s.readInt(!0),c.skinRequired=s.readBoolean(),a=s.readInt(!0);for(let h=0;h<a;h++)c.bones.push(e.bones[s.readInt(!0)]);c.target=e.bones[s.readInt(!0)],c.local=s.readBoolean(),c.relative=s.readBoolean(),c.offsetRotation=s.readFloat(),c.offsetX=s.readFloat()*t,c.offsetY=s.readFloat()*t,c.offsetScaleX=s.readFloat(),c.offsetScaleY=s.readFloat(),c.offsetShearY=s.readFloat(),c.rotateMix=s.readFloat(),c.translateMix=s.readFloat(),c.scaleMix=s.readFloat(),c.shearMix=s.readFloat(),e.transformConstraints.push(c)}i=s.readInt(!0);for(let l=0,a;l<i;l++){const c=new Jh(s.readString());c.order=s.readInt(!0),c.skinRequired=s.readBoolean(),a=s.readInt(!0);for(let h=0;h<a;h++)c.bones.push(e.bones[s.readInt(!0)]);c.target=e.slots[s.readInt(!0)],c.positionMode=ge.PositionModeValues[s.readInt(!0)],c.spacingMode=ge.SpacingModeValues[s.readInt(!0)],c.rotateMode=ge.RotateModeValues[s.readInt(!0)],c.offsetRotation=s.readFloat(),c.position=s.readFloat(),c.positionMode==me.Fixed&&(c.position*=t),c.spacing=s.readFloat(),(c.spacingMode==Oe.Length||c.spacingMode==Oe.Fixed)&&(c.spacing*=t),c.rotateMix=s.readFloat(),c.translateMix=s.readFloat(),e.pathConstraints.push(c)}const o=this.readSkin(s,e,!0,r);o!=null&&(e.defaultSkin=o,e.skins.push(o));{let l=e.skins.length;for($.setArraySize(e.skins,i=l+s.readInt(!0));l<i;l++)e.skins[l]=this.readSkin(s,e,!1,r)}i=this.linkedMeshes.length;for(let l=0;l<i;l++){const a=this.linkedMeshes[l],c=a.skin==null?e.defaultSkin:e.findSkin(a.skin);if(c==null)throw new Error(`Skin not found: ${a.skin}`);const h=c.getAttachment(a.slotIndex,a.parent);if(h==null)throw new Error(`Parent mesh not found: ${a.parent}`);a.mesh.deformAttachment=a.inheritDeform?h:a.mesh,a.mesh.setParentMesh(h)}this.linkedMeshes.length=0,i=s.readInt(!0);for(let l=0;l<i;l++){const a=new Zh(s.readStringRef());a.intValue=s.readInt(!1),a.floatValue=s.readFloat(),a.stringValue=s.readString(),a.audioPath=s.readString(),a.audioPath!=null&&(a.volume=s.readFloat(),a.balance=s.readFloat()),e.events.push(a)}i=s.readInt(!0);for(let l=0;l<i;l++)e.animations.push(this.readAnimation(s,s.readString(),e));return e}readSkin(n,t,e,s){let r=null,i=0;if(e){if(i=n.readInt(!0),i==0)return null;r=new Ao("default")}else{r=new Ao(n.readStringRef()),r.bones.length=n.readInt(!0);for(let o=0,l=r.bones.length;o<l;o++)r.bones[o]=t.bones[n.readInt(!0)];for(let o=0,l=n.readInt(!0);o<l;o++)r.constraints.push(t.ikConstraints[n.readInt(!0)]);for(let o=0,l=n.readInt(!0);o<l;o++)r.constraints.push(t.transformConstraints[n.readInt(!0)]);for(let o=0,l=n.readInt(!0);o<l;o++)r.constraints.push(t.pathConstraints[n.readInt(!0)]);i=n.readInt(!0)}for(let o=0;o<i;o++){const l=n.readInt(!0);for(let a=0,c=n.readInt(!0);a<c;a++){const h=n.readStringRef(),d=this.readAttachment(n,t,r,l,h,s);d!=null&&r.setAttachment(l,h,d)}}return r}readAttachment(n,t,e,s,r,i){const o=this.scale;let l=n.readStringRef();l==null&&(l=r);const a=n.readByte();switch(ge.AttachmentTypeValues[a]){case Rt.Region:{let h=n.readStringRef();const d=n.readFloat(),u=n.readFloat(),f=n.readFloat(),m=n.readFloat(),p=n.readFloat(),g=n.readFloat(),w=n.readFloat(),x=n.readInt32();h==null&&(h=l);const y=this.attachmentLoader.newRegionAttachment(e,l,h);return y==null?null:(y.path=h,y.x=u*o,y.y=f*o,y.scaleX=m,y.scaleY=p,y.rotation=d,y.width=g*o,y.height=w*o,et.rgba8888ToColor(y.color,x),y)}case Rt.BoundingBox:{const h=n.readInt(!0),d=this.readVertices(n,h),u=i?n.readInt32():0,f=this.attachmentLoader.newBoundingBoxAttachment(e,l);return f==null?null:(f.worldVerticesLength=h<<1,f.vertices=d.vertices,f.bones=d.bones,i&&et.rgba8888ToColor(f.color,u),f)}case Rt.Mesh:{let h=n.readStringRef();const d=n.readInt32(),u=n.readInt(!0),f=this.readFloatArray(n,u<<1,1),m=this.readShortArray(n),p=this.readVertices(n,u),g=n.readInt(!0);let w=null,x=0,y=0;i&&(w=this.readShortArray(n),x=n.readFloat(),y=n.readFloat()),h==null&&(h=l);const b=this.attachmentLoader.newMeshAttachment(e,l,h);return b==null?null:(b.path=h,et.rgba8888ToColor(b.color,d),b.bones=p.bones,b.vertices=p.vertices,b.worldVerticesLength=u<<1,b.triangles=m,b.regionUVs=new Float32Array(f),b.hullLength=g<<1,i&&(b.edges=w,b.width=x*o,b.height=y*o),b)}case Rt.LinkedMesh:{let h=n.readStringRef();const d=n.readInt32(),u=n.readStringRef(),f=n.readStringRef(),m=n.readBoolean();let p=0,g=0;i&&(p=n.readFloat(),g=n.readFloat()),h==null&&(h=l);const w=this.attachmentLoader.newMeshAttachment(e,l,h);return w==null?null:(w.path=h,et.rgba8888ToColor(w.color,d),i&&(w.width=p*o,w.height=g*o),this.linkedMeshes.push(new QE(w,u,s,f,m)),w)}case Rt.Path:{const h=n.readBoolean(),d=n.readBoolean(),u=n.readInt(!0),f=this.readVertices(n,u),m=$.newArray(u/3,0);for(let w=0,x=m.length;w<x;w++)m[w]=n.readFloat()*o;const p=i?n.readInt32():0,g=this.attachmentLoader.newPathAttachment(e,l);return g==null?null:(g.closed=h,g.constantSpeed=d,g.worldVerticesLength=u<<1,g.vertices=f.vertices,g.bones=f.bones,g.lengths=m,i&&et.rgba8888ToColor(g.color,p),g)}case Rt.Point:{const h=n.readFloat(),d=n.readFloat(),u=n.readFloat(),f=i?n.readInt32():0,m=this.attachmentLoader.newPointAttachment(e,l);return m==null?null:(m.x=d*o,m.y=u*o,m.rotation=h,i&&et.rgba8888ToColor(m.color,f),m)}case Rt.Clipping:{const h=n.readInt(!0),d=n.readInt(!0),u=this.readVertices(n,d),f=i?n.readInt32():0,m=this.attachmentLoader.newClippingAttachment(e,l);return m==null?null:(m.endSlot=t.slots[h],m.worldVerticesLength=d<<1,m.vertices=u.vertices,m.bones=u.bones,i&&et.rgba8888ToColor(m.color,f),m)}}return null}readVertices(n,t){const e=t<<1,s=new JE,r=this.scale;if(!n.readBoolean())return s.vertices=this.readFloatArray(n,e,r),s;const i=new Array,o=new Array;for(let l=0;l<t;l++){const a=n.readInt(!0);o.push(a);for(let c=0;c<a;c++)o.push(n.readInt(!0)),i.push(n.readFloat()*r),i.push(n.readFloat()*r),i.push(n.readFloat())}return s.vertices=$.toFloatArray(i),s.bones=o,s}readFloatArray(n,t,e){const s=new Array(t);if(e==1)for(let r=0;r<t;r++)s[r]=n.readFloat();else for(let r=0;r<t;r++)s[r]=n.readFloat()*e;return s}readShortArray(n){const t=n.readInt(!0),e=new Array(t);for(let s=0;s<t;s++)e[s]=n.readShort();return e}readAnimation(n,t,e){const s=new Array,r=this.scale;let i=0;const o=new et,l=new et;for(let h=0,d=n.readInt(!0);h<d;h++){const u=n.readInt(!0);for(let f=0,m=n.readInt(!0);f<m;f++){const p=n.readByte(),g=n.readInt(!0);switch(p){case ge.SLOT_ATTACHMENT:{const w=new Dr(g);w.slotIndex=u;for(let x=0;x<g;x++)w.setFrame(x,n.readFloat(),n.readStringRef());s.push(w),i=Math.max(i,w.frames[g-1]);break}case ge.SLOT_COLOR:{const w=new es(g);w.slotIndex=u;for(let x=0;x<g;x++){const y=n.readFloat();et.rgba8888ToColor(o,n.readInt32()),w.setFrame(x,y,o.r,o.g,o.b,o.a),x<g-1&&this.readCurve(n,x,w)}s.push(w),i=Math.max(i,w.frames[(g-1)*es.ENTRIES]);break}case ge.SLOT_TWO_COLOR:{const w=new Se(g);w.slotIndex=u;for(let x=0;x<g;x++){const y=n.readFloat();et.rgba8888ToColor(o,n.readInt32()),et.rgb888ToColor(l,n.readInt32()),w.setFrame(x,y,o.r,o.g,o.b,o.a,l.r,l.g,l.b),x<g-1&&this.readCurve(n,x,w)}s.push(w),i=Math.max(i,w.frames[(g-1)*Se.ENTRIES]);break}}}}for(let h=0,d=n.readInt(!0);h<d;h++){const u=n.readInt(!0);for(let f=0,m=n.readInt(!0);f<m;f++){const p=n.readByte(),g=n.readInt(!0);switch(p){case ge.BONE_ROTATE:{const w=new Ue(g);w.boneIndex=u;for(let x=0;x<g;x++)w.setFrame(x,n.readFloat(),n.readFloat()),x<g-1&&this.readCurve(n,x,w);s.push(w),i=Math.max(i,w.frames[(g-1)*Ue.ENTRIES]);break}case ge.BONE_TRANSLATE:case ge.BONE_SCALE:case ge.BONE_SHEAR:{let w,x=1;p==ge.BONE_SCALE?w=new Xh(g):p==ge.BONE_SHEAR?w=new Gh(g):(w=new xs(g),x=r),w.boneIndex=u;for(let y=0;y<g;y++)w.setFrame(y,n.readFloat(),n.readFloat()*x,n.readFloat()*x),y<g-1&&this.readCurve(n,y,w);s.push(w),i=Math.max(i,w.frames[(g-1)*xs.ENTRIES]);break}}}}for(let h=0,d=n.readInt(!0);h<d;h++){const u=n.readInt(!0),f=n.readInt(!0),m=new Ge(f);m.ikConstraintIndex=u;for(let p=0;p<f;p++)m.setFrame(p,n.readFloat(),n.readFloat(),n.readFloat()*r,n.readByte(),n.readBoolean(),n.readBoolean()),p<f-1&&this.readCurve(n,p,m);s.push(m),i=Math.max(i,m.frames[(f-1)*Ge.ENTRIES])}for(let h=0,d=n.readInt(!0);h<d;h++){const u=n.readInt(!0),f=n.readInt(!0),m=new ss(f);m.transformConstraintIndex=u;for(let p=0;p<f;p++)m.setFrame(p,n.readFloat(),n.readFloat(),n.readFloat(),n.readFloat(),n.readFloat()),p<f-1&&this.readCurve(n,p,m);s.push(m),i=Math.max(i,m.frames[(f-1)*ss.ENTRIES])}for(let h=0,d=n.readInt(!0);h<d;h++){const u=n.readInt(!0),f=e.pathConstraints[u];for(let m=0,p=n.readInt(!0);m<p;m++){const g=n.readByte(),w=n.readInt(!0);switch(g){case ge.PATH_POSITION:case ge.PATH_SPACING:{let x,y=1;g==ge.PATH_SPACING?(x=new $h(w),(f.spacingMode==Oe.Length||f.spacingMode==Oe.Fixed)&&(y=r)):(x=new xn(w),f.positionMode==me.Fixed&&(y=r)),x.pathConstraintIndex=u;for(let b=0;b<w;b++)x.setFrame(b,n.readFloat(),n.readFloat()*y),b<w-1&&this.readCurve(n,b,x);s.push(x),i=Math.max(i,x.frames[(w-1)*xn.ENTRIES]);break}case ge.PATH_MIX:{const x=new Qs(w);x.pathConstraintIndex=u;for(let y=0;y<w;y++)x.setFrame(y,n.readFloat(),n.readFloat(),n.readFloat()),y<w-1&&this.readCurve(n,y,x);s.push(x),i=Math.max(i,x.frames[(w-1)*Qs.ENTRIES]);break}}}}for(let h=0,d=n.readInt(!0);h<d;h++){const u=e.skins[n.readInt(!0)];for(let f=0,m=n.readInt(!0);f<m;f++){const p=n.readInt(!0);for(let g=0,w=n.readInt(!0);g<w;g++){const x=u.getAttachment(p,n.readStringRef()),y=x.bones!=null,b=x.vertices,_=y?b.length/3*2:b.length,E=n.readInt(!0),S=new Yh(E);S.slotIndex=p,S.attachment=x;for(let T=0;T<E;T++){const C=n.readFloat();let A,R=n.readInt(!0);if(R==0)A=y?$.newFloatArray(_):b;else{A=$.newFloatArray(_);const M=n.readInt(!0);if(R+=M,r==1)for(let I=M;I<R;I++)A[I]=n.readFloat();else for(let I=M;I<R;I++)A[I]=n.readFloat()*r;if(!y)for(let I=0,N=A.length;I<N;I++)A[I]+=b[I]}S.setFrame(T,C,A),T<E-1&&this.readCurve(n,T,S)}s.push(S),i=Math.max(i,S.frames[E-1])}}}const a=n.readInt(!0);if(a>0){const h=new gi(a),d=e.slots.length;for(let u=0;u<a;u++){const f=n.readFloat(),m=n.readInt(!0),p=$.newArray(d,0);for(let y=d-1;y>=0;y--)p[y]=-1;const g=$.newArray(d-m,0);let w=0,x=0;for(let y=0;y<m;y++){const b=n.readInt(!0);for(;w!=b;)g[x++]=w++;p[w+n.readInt(!0)]=w++}for(;w<d;)g[x++]=w++;for(let y=d-1;y>=0;y--)p[y]==-1&&(p[y]=g[--x]);h.setFrame(u,f,p)}s.push(h),i=Math.max(i,h.frames[a-1])}const c=n.readInt(!0);if(c>0){const h=new Ko(c);for(let d=0;d<c;d++){const u=n.readFloat(),f=e.events[n.readInt(!0)],m=new Kh(u,f);m.intValue=n.readInt(!1),m.floatValue=n.readFloat(),m.stringValue=n.readBoolean()?n.readString():f.stringValue,m.data.audioPath!=null&&(m.volume=n.readFloat(),m.balance=n.readFloat()),h.setFrame(d,m)}s.push(h),i=Math.max(i,h.frames[c-1])}return new Ee(t,s,i)}readCurve(n,t,e){switch(n.readByte()){case ge.CURVE_STEPPED:e.setStepped(t);break;case ge.CURVE_BEZIER:this.setCurve(e,t,n.readFloat(),n.readFloat(),n.readFloat(),n.readFloat());break}}setCurve(n,t,e,s,r,i){n.setCurve(t,e,s,r,i)}};let Te=ge;Te.AttachmentTypeValues=[0,1,2,3,4,5,6];Te.TransformModeValues=[wt.Normal,wt.OnlyTranslation,wt.NoRotationOrReflection,wt.NoScale,wt.NoScaleOrReflection];Te.PositionModeValues=[me.Fixed,me.Percent];Te.SpacingModeValues=[Oe.Length,Oe.Fixed,Oe.Percent];Te.RotateModeValues=[_e.Tangent,_e.Chain,_e.ChainScale];Te.BlendModeValues=[dt.NORMAL,dt.ADD,dt.MULTIPLY,dt.SCREEN];Te.BONE_ROTATE=0;Te.BONE_TRANSLATE=1;Te.BONE_SCALE=2;Te.BONE_SHEAR=3;Te.SLOT_ATTACHMENT=0;Te.SLOT_COLOR=1;Te.SLOT_TWO_COLOR=2;Te.PATH_POSITION=0;Te.PATH_SPACING=1;Te.PATH_MIX=2;Te.CURVE_LINEAR=0;Te.CURVE_STEPPED=1;Te.CURVE_BEZIER=2;let QE=class{constructor(t,e,s,r,i){this.mesh=t,this.skin=e,this.slotIndex=s,this.parent=r,this.inheritDeform=i}},JE=class{constructor(t=null,e=null){this.bones=t,this.vertices=e}},tS=class extends jh{},bg=class ai{constructor(t){this.scale=1,this.linkedMeshes=new Array,this.attachmentLoader=t}readSkeletonData(t){const e=this.scale,s=new ed,r=typeof t=="string"?JSON.parse(t):t,i=r.skeleton;if(i!=null){if(s.hash=i.hash,s.version=i.spine,s.version.substr(0,3)!=="3.8"){const o=`Spine 3.8 loader cant load version ${i.spine}. Please configure your pixi-spine bundle`;console.error(o)}s.version==="3.8.75"&&console.error("Unsupported skeleton data, 3.8.75 is deprecated, please export with a newer version of Spine."),s.x=i.x,s.y=i.y,s.width=i.width,s.height=i.height,s.fps=i.fps,s.imagesPath=i.images}if(r.bones)for(let o=0;o<r.bones.length;o++){const l=r.bones[o];let a=null;const c=this.getValue(l,"parent",null);if(c!=null&&(a=s.findBone(c),a==null))throw new Error(`Parent bone not found: ${c}`);const h=new qh(s.bones.length,l.name,a);h.length=this.getValue(l,"length",0)*e,h.x=this.getValue(l,"x",0)*e,h.y=this.getValue(l,"y",0)*e,h.rotation=this.getValue(l,"rotation",0),h.scaleX=this.getValue(l,"scaleX",1),h.scaleY=this.getValue(l,"scaleY",1),h.shearX=this.getValue(l,"shearX",0),h.shearY=this.getValue(l,"shearY",0),h.transformMode=ai.transformModeFromString(this.getValue(l,"transform","normal")),h.skinRequired=this.getValue(l,"skin",!1),s.bones.push(h)}if(r.slots)for(let o=0;o<r.slots.length;o++){const l=r.slots[o],a=l.name,c=l.bone,h=s.findBone(c);if(h==null)throw new Error(`Slot bone not found: ${c}`);const d=new sd(s.slots.length,a,h),u=this.getValue(l,"color",null);u!=null&&d.color.setFromString(u);const f=this.getValue(l,"dark",null);f!=null&&(d.darkColor=new et(1,1,1,1),d.darkColor.setFromString(f)),d.attachmentName=this.getValue(l,"attachment",null),d.blendMode=ai.blendModeFromString(this.getValue(l,"blend","normal")),s.slots.push(d)}if(r.ik)for(let o=0;o<r.ik.length;o++){const l=r.ik[o],a=new Qh(l.name);a.order=this.getValue(l,"order",0),a.skinRequired=this.getValue(l,"skin",!1);for(let h=0;h<l.bones.length;h++){const d=l.bones[h],u=s.findBone(d);if(u==null)throw new Error(`IK bone not found: ${d}`);a.bones.push(u)}const c=l.target;if(a.target=s.findBone(c),a.target==null)throw new Error(`IK target bone not found: ${c}`);a.mix=this.getValue(l,"mix",1),a.softness=this.getValue(l,"softness",0)*e,a.bendDirection=this.getValue(l,"bendPositive",!0)?1:-1,a.compress=this.getValue(l,"compress",!1),a.stretch=this.getValue(l,"stretch",!1),a.uniform=this.getValue(l,"uniform",!1),s.ikConstraints.push(a)}if(r.transform)for(let o=0;o<r.transform.length;o++){const l=r.transform[o],a=new nd(l.name);a.order=this.getValue(l,"order",0),a.skinRequired=this.getValue(l,"skin",!1);for(let h=0;h<l.bones.length;h++){const d=l.bones[h],u=s.findBone(d);if(u==null)throw new Error(`Transform constraint bone not found: ${d}`);a.bones.push(u)}const c=l.target;if(a.target=s.findBone(c),a.target==null)throw new Error(`Transform constraint target bone not found: ${c}`);a.local=this.getValue(l,"local",!1),a.relative=this.getValue(l,"relative",!1),a.offsetRotation=this.getValue(l,"rotation",0),a.offsetX=this.getValue(l,"x",0)*e,a.offsetY=this.getValue(l,"y",0)*e,a.offsetScaleX=this.getValue(l,"scaleX",0),a.offsetScaleY=this.getValue(l,"scaleY",0),a.offsetShearY=this.getValue(l,"shearY",0),a.rotateMix=this.getValue(l,"rotateMix",1),a.translateMix=this.getValue(l,"translateMix",1),a.scaleMix=this.getValue(l,"scaleMix",1),a.shearMix=this.getValue(l,"shearMix",1),s.transformConstraints.push(a)}if(r.path)for(let o=0;o<r.path.length;o++){const l=r.path[o],a=new Jh(l.name);a.order=this.getValue(l,"order",0),a.skinRequired=this.getValue(l,"skin",!1);for(let h=0;h<l.bones.length;h++){const d=l.bones[h],u=s.findBone(d);if(u==null)throw new Error(`Transform constraint bone not found: ${d}`);a.bones.push(u)}const c=l.target;if(a.target=s.findSlot(c),a.target==null)throw new Error(`Path target slot not found: ${c}`);a.positionMode=ai.positionModeFromString(this.getValue(l,"positionMode","percent")),a.spacingMode=ai.spacingModeFromString(this.getValue(l,"spacingMode","length")),a.rotateMode=ai.rotateModeFromString(this.getValue(l,"rotateMode","tangent")),a.offsetRotation=this.getValue(l,"rotation",0),a.position=this.getValue(l,"position",0),a.positionMode==me.Fixed&&(a.position*=e),a.spacing=this.getValue(l,"spacing",0),(a.spacingMode==Oe.Length||a.spacingMode==Oe.Fixed)&&(a.spacing*=e),a.rotateMix=this.getValue(l,"rotateMix",1),a.translateMix=this.getValue(l,"translateMix",1),s.pathConstraints.push(a)}if(r.skins)for(let o=0;o<r.skins.length;o++){const l=r.skins[o],a=new Ao(l.name);if(l.bones)for(let c=0;c<l.bones.length;c++){const h=s.findBone(l.bones[c]);if(h==null)throw new Error(`Skin bone not found: ${l.bones[o]}`);a.bones.push(h)}if(l.ik)for(let c=0;c<l.ik.length;c++){const h=s.findIkConstraint(l.ik[c]);if(h==null)throw new Error(`Skin IK constraint not found: ${l.ik[o]}`);a.constraints.push(h)}if(l.transform)for(let c=0;c<l.transform.length;c++){const h=s.findTransformConstraint(l.transform[c]);if(h==null)throw new Error(`Skin transform constraint not found: ${l.transform[o]}`);a.constraints.push(h)}if(l.path)for(let c=0;c<l.path.length;c++){const h=s.findPathConstraint(l.path[c]);if(h==null)throw new Error(`Skin path constraint not found: ${l.path[o]}`);a.constraints.push(h)}for(const c in l.attachments){const h=s.findSlot(c);if(h==null)throw new Error(`Slot not found: ${c}`);const d=l.attachments[c];for(const u in d){const f=this.readAttachment(d[u],a,h.index,u,s);f!=null&&a.setAttachment(h.index,u,f)}}s.skins.push(a),a.name=="default"&&(s.defaultSkin=a)}for(let o=0,l=this.linkedMeshes.length;o<l;o++){const a=this.linkedMeshes[o],c=a.skin==null?s.defaultSkin:s.findSkin(a.skin);if(c==null)throw new Error(`Skin not found: ${a.skin}`);const h=c.getAttachment(a.slotIndex,a.parent);if(h==null)throw new Error(`Parent mesh not found: ${a.parent}`);a.mesh.deformAttachment=a.inheritDeform?h:a.mesh,a.mesh.setParentMesh(h)}if(this.linkedMeshes.length=0,r.events)for(const o in r.events){const l=r.events[o],a=new Zh(o);a.intValue=this.getValue(l,"int",0),a.floatValue=this.getValue(l,"float",0),a.stringValue=this.getValue(l,"string",""),a.audioPath=this.getValue(l,"audio",null),a.audioPath!=null&&(a.volume=this.getValue(l,"volume",1),a.balance=this.getValue(l,"balance",0)),s.events.push(a)}if(r.animations)for(const o in r.animations){const l=r.animations[o];this.readAnimation(l,o,s)}return s}readAttachment(t,e,s,r,i){const o=this.scale;switch(r=this.getValue(t,"name",r),this.getValue(t,"type","region")){case"region":{const a=this.getValue(t,"path",r),c=this.attachmentLoader.newRegionAttachment(e,r,a);if(c==null)return null;c.path=a,c.x=this.getValue(t,"x",0)*o,c.y=this.getValue(t,"y",0)*o,c.scaleX=this.getValue(t,"scaleX",1),c.scaleY=this.getValue(t,"scaleY",1),c.rotation=this.getValue(t,"rotation",0),c.width=t.width*o,c.height=t.height*o;const h=this.getValue(t,"color",null);return h!=null&&c.color.setFromString(h),c}case"boundingbox":{const a=this.attachmentLoader.newBoundingBoxAttachment(e,r);if(a==null)return null;this.readVertices(t,a,t.vertexCount<<1);const c=this.getValue(t,"color",null);return c!=null&&a.color.setFromString(c),a}case"mesh":case"linkedmesh":{const a=this.getValue(t,"path",r),c=this.attachmentLoader.newMeshAttachment(e,r,a);if(c==null)return null;c.path=a;const h=this.getValue(t,"color",null);h!=null&&c.color.setFromString(h),c.width=this.getValue(t,"width",0)*o,c.height=this.getValue(t,"height",0)*o;const d=this.getValue(t,"parent",null);if(d!=null)return this.linkedMeshes.push(new eS(c,this.getValue(t,"skin",null),s,d,this.getValue(t,"deform",!0))),c;const u=t.uvs;return this.readVertices(t,c,u.length),c.triangles=t.triangles,c.regionUVs=new Float32Array(u),c.edges=this.getValue(t,"edges",null),c.hullLength=this.getValue(t,"hull",0)*2,c}case"path":{const a=this.attachmentLoader.newPathAttachment(e,r);if(a==null)return null;a.closed=this.getValue(t,"closed",!1),a.constantSpeed=this.getValue(t,"constantSpeed",!0);const c=t.vertexCount;this.readVertices(t,a,c<<1);const h=$.newArray(c/3,0);for(let u=0;u<t.lengths.length;u++)h[u]=t.lengths[u]*o;a.lengths=h;const d=this.getValue(t,"color",null);return d!=null&&a.color.setFromString(d),a}case"point":{const a=this.attachmentLoader.newPointAttachment(e,r);if(a==null)return null;a.x=this.getValue(t,"x",0)*o,a.y=this.getValue(t,"y",0)*o,a.rotation=this.getValue(t,"rotation",0);const c=this.getValue(t,"color",null);return c!=null&&a.color.setFromString(c),a}case"clipping":{const a=this.attachmentLoader.newClippingAttachment(e,r);if(a==null)return null;const c=this.getValue(t,"end",null);if(c!=null){const u=i.findSlot(c);if(u==null)throw new Error(`Clipping end slot not found: ${c}`);a.endSlot=u}const h=t.vertexCount;this.readVertices(t,a,h<<1);const d=this.getValue(t,"color",null);return d!=null&&a.color.setFromString(d),a}}return null}readVertices(t,e,s){const r=this.scale;e.worldVerticesLength=s;const i=t.vertices;if(s==i.length){const a=$.toFloatArray(i);if(r!=1)for(let c=0,h=i.length;c<h;c++)a[c]*=r;e.vertices=a;return}const o=new Array,l=new Array;for(let a=0,c=i.length;a<c;){const h=i[a++];l.push(h);for(let d=a+h*4;a<d;a+=4)l.push(i[a]),o.push(i[a+1]*r),o.push(i[a+2]*r),o.push(i[a+3])}e.bones=l,e.vertices=$.toFloatArray(o)}readAnimation(t,e,s){const r=this.scale,i=new Array;let o=0;if(t.slots)for(const a in t.slots){const c=t.slots[a],h=s.findSlotIndex(a);if(h==-1)throw new Error(`Slot not found: ${a}`);for(const d in c){const u=c[d];if(d=="attachment"){const f=new Dr(u.length);f.slotIndex=h;let m=0;for(let p=0;p<u.length;p++){const g=u[p];f.setFrame(m++,this.getValue(g,"time",0),g.name)}i.push(f),o=Math.max(o,f.frames[f.getFrameCount()-1])}else if(d=="color"){const f=new es(u.length);f.slotIndex=h;let m=0;for(let p=0;p<u.length;p++){const g=u[p],w=new et;w.setFromString(g.color||"ffffffff"),f.setFrame(m,this.getValue(g,"time",0),w.r,w.g,w.b,w.a),this.readCurve(g,f,m),m++}i.push(f),o=Math.max(o,f.frames[(f.getFrameCount()-1)*es.ENTRIES])}else if(d=="twoColor"){const f=new Se(u.length);f.slotIndex=h;let m=0;for(let p=0;p<u.length;p++){const g=u[p],w=new et,x=new et;w.setFromString(g.light),x.setFromString(g.dark),f.setFrame(m,this.getValue(g,"time",0),w.r,w.g,w.b,w.a,x.r,x.g,x.b),this.readCurve(g,f,m),m++}i.push(f),o=Math.max(o,f.frames[(f.getFrameCount()-1)*Se.ENTRIES])}else throw new Error(`Invalid timeline type for a slot: ${d} (${a})`)}}if(t.bones)for(const a in t.bones){const c=t.bones[a],h=s.findBoneIndex(a);if(h==-1)throw new Error(`Bone not found: ${a}`);for(const d in c){const u=c[d];if(d==="rotate"){const f=new Ue(u.length);f.boneIndex=h;let m=0;for(let p=0;p<u.length;p++){const g=u[p];f.setFrame(m,this.getValue(g,"time",0),this.getValue(g,"angle",0)),this.readCurve(g,f,m),m++}i.push(f),o=Math.max(o,f.frames[(f.getFrameCount()-1)*Ue.ENTRIES])}else if(d==="translate"||d==="scale"||d==="shear"){let f=null,m=1,p=0;d==="scale"?(f=new Xh(u.length),p=1):d==="shear"?f=new Gh(u.length):(f=new xs(u.length),m=r),f.boneIndex=h;let g=0;for(let w=0;w<u.length;w++){const x=u[w],y=this.getValue(x,"x",p),b=this.getValue(x,"y",p);f.setFrame(g,this.getValue(x,"time",0),y*m,b*m),this.readCurve(x,f,g),g++}i.push(f),o=Math.max(o,f.frames[(f.getFrameCount()-1)*xs.ENTRIES])}else throw new Error(`Invalid timeline type for a bone: ${d} (${a})`)}}if(t.ik)for(const a in t.ik){const c=t.ik[a],h=s.findIkConstraint(a),d=new Ge(c.length);d.ikConstraintIndex=s.ikConstraints.indexOf(h);let u=0;for(let f=0;f<c.length;f++){const m=c[f];d.setFrame(u,this.getValue(m,"time",0),this.getValue(m,"mix",1),this.getValue(m,"softness",0)*r,this.getValue(m,"bendPositive",!0)?1:-1,this.getValue(m,"compress",!1),this.getValue(m,"stretch",!1)),this.readCurve(m,d,u),u++}i.push(d),o=Math.max(o,d.frames[(d.getFrameCount()-1)*Ge.ENTRIES])}if(t.transform)for(const a in t.transform){const c=t.transform[a],h=s.findTransformConstraint(a),d=new ss(c.length);d.transformConstraintIndex=s.transformConstraints.indexOf(h);let u=0;for(let f=0;f<c.length;f++){const m=c[f];d.setFrame(u,this.getValue(m,"time",0),this.getValue(m,"rotateMix",1),this.getValue(m,"translateMix",1),this.getValue(m,"scaleMix",1),this.getValue(m,"shearMix",1)),this.readCurve(m,d,u),u++}i.push(d),o=Math.max(o,d.frames[(d.getFrameCount()-1)*ss.ENTRIES])}if(t.path)for(const a in t.path){const c=t.path[a],h=s.findPathConstraintIndex(a);if(h==-1)throw new Error(`Path constraint not found: ${a}`);const d=s.pathConstraints[h];for(const u in c){const f=c[u];if(u==="position"||u==="spacing"){let m=null,p=1;u==="spacing"?(m=new $h(f.length),(d.spacingMode==Oe.Length||d.spacingMode==Oe.Fixed)&&(p=r)):(m=new xn(f.length),d.positionMode==me.Fixed&&(p=r)),m.pathConstraintIndex=h;let g=0;for(let w=0;w<f.length;w++){const x=f[w];m.setFrame(g,this.getValue(x,"time",0),this.getValue(x,u,0)*p),this.readCurve(x,m,g),g++}i.push(m),o=Math.max(o,m.frames[(m.getFrameCount()-1)*xn.ENTRIES])}else if(u==="mix"){const m=new Qs(f.length);m.pathConstraintIndex=h;let p=0;for(let g=0;g<f.length;g++){const w=f[g];m.setFrame(p,this.getValue(w,"time",0),this.getValue(w,"rotateMix",1),this.getValue(w,"translateMix",1)),this.readCurve(w,m,p),p++}i.push(m),o=Math.max(o,m.frames[(m.getFrameCount()-1)*Qs.ENTRIES])}}}if(t.deform)for(const a in t.deform){const c=t.deform[a],h=s.findSkin(a);if(h!=null)for(const d in c){const u=c[d],f=s.findSlotIndex(d);if(f==-1)throw new Error(`Slot not found: ${u.name}`);for(const m in u){const p=u[m],g=h.getAttachment(f,m);if(g==null)throw new Error(`Deform attachment not found: ${p.name}`);const w=g.bones!=null,x=g.vertices,y=w?x.length/3*2:x.length,b=new Yh(p.length);b.slotIndex=f,b.attachment=g;let _=0;for(let E=0;E<p.length;E++){const S=p[E];let T;const C=this.getValue(S,"vertices",null);if(C==null)T=w?$.newFloatArray(y):x;else{T=$.newFloatArray(y);const A=this.getValue(S,"offset",0);if($.arrayCopy(C,0,T,A,C.length),r!=1)for(let R=A,M=R+C.length;R<M;R++)T[R]*=r;if(!w)for(let R=0;R<y;R++)T[R]+=x[R]}b.setFrame(_,this.getValue(S,"time",0),T),this.readCurve(S,b,_),_++}i.push(b),o=Math.max(o,b.frames[b.getFrameCount()-1])}}}let l=t.drawOrder;if(l==null&&(l=t.draworder),l!=null){const a=new gi(l.length),c=s.slots.length;let h=0;for(let d=0;d<l.length;d++){const u=l[d];let f=null;const m=this.getValue(u,"offsets",null);if(m!=null){f=$.newArray(c,-1);const p=$.newArray(c-m.length,0);let g=0,w=0;for(let x=0;x<m.length;x++){const y=m[x],b=s.findSlotIndex(y.slot);if(b==-1)throw new Error(`Slot not found: ${y.slot}`);for(;g!=b;)p[w++]=g++;f[g+y.offset]=g++}for(;g<c;)p[w++]=g++;for(let x=c-1;x>=0;x--)f[x]==-1&&(f[x]=p[--w])}a.setFrame(h++,this.getValue(u,"time",0),f)}i.push(a),o=Math.max(o,a.frames[a.getFrameCount()-1])}if(t.events){const a=new Ko(t.events.length);let c=0;for(let h=0;h<t.events.length;h++){const d=t.events[h],u=s.findEvent(d.name);if(u==null)throw new Error(`Event not found: ${d.name}`);const f=new Kh($.toSinglePrecision(this.getValue(d,"time",0)),u);f.intValue=this.getValue(d,"int",u.intValue),f.floatValue=this.getValue(d,"float",u.floatValue),f.stringValue=this.getValue(d,"string",u.stringValue),f.data.audioPath!=null&&(f.volume=this.getValue(d,"volume",1),f.balance=this.getValue(d,"balance",0)),a.setFrame(c++,f)}i.push(a),o=Math.max(o,a.frames[a.getFrameCount()-1])}if(isNaN(o))throw new Error("Error while parsing animation, duration is NaN");s.animations.push(new Ee(e,i,o))}readCurve(t,e,s){if(t.hasOwnProperty("curve"))if(t.curve==="stepped")e.setStepped(s);else{const r=t.curve;e.setCurve(s,r,this.getValue(t,"c2",0),this.getValue(t,"c3",1),this.getValue(t,"c4",1))}}getValue(t,e,s){return t[e]!==void 0?t[e]:s}static blendModeFromString(t){if(t=t.toLowerCase(),t=="normal")return dt.NORMAL;if(t=="additive")return dt.ADD;if(t=="multiply")return dt.MULTIPLY;if(t=="screen")return dt.SCREEN;throw new Error(`Unknown blend mode: ${t}`)}static positionModeFromString(t){if(t=t.toLowerCase(),t=="fixed")return me.Fixed;if(t=="percent")return me.Percent;throw new Error(`Unknown position mode: ${t}`)}static spacingModeFromString(t){if(t=t.toLowerCase(),t=="length")return Oe.Length;if(t=="fixed")return Oe.Fixed;if(t=="percent")return Oe.Percent;throw new Error(`Unknown position mode: ${t}`)}static rotateModeFromString(t){if(t=t.toLowerCase(),t=="tangent")return _e.Tangent;if(t=="chain")return _e.Chain;if(t=="chainscale")return _e.ChainScale;throw new Error(`Unknown rotate mode: ${t}`)}static transformModeFromString(t){if(t=t.toLowerCase(),t=="normal")return wt.Normal;if(t=="onlytranslation")return wt.OnlyTranslation;if(t=="norotationorreflection")return wt.NoRotationOrReflection;if(t=="noscale")return wt.NoScale;if(t=="noscaleorreflection")return wt.NoScaleOrReflection;throw new Error(`Unknown transform mode: ${t}`)}},eS=class{constructor(t,e,s,r,i){this.mesh=t,this.skin=e,this.slotIndex=s,this.parent=r,this.inheritDeform=i}},sS=class extends _i{createSkeleton(t){this.skeleton=new td(t),this.skeleton.updateWorldTransform(),this.stateData=new zh(t),this.state=new Es(this.stateData)}};const nS=Object.freeze(Object.defineProperty({__proto__:null,Animation:Ee,AnimationState:Es,AnimationStateAdapter:ZE,AnimationStateData:zh,AtlasAttachmentLoader:Hh,Attachment:Vh,AttachmentTimeline:Dr,Bone:nh,BoneData:qh,BoundingBoxAttachment:ag,ClippingAttachment:lg,ColorTimeline:es,ConstraintData:Qo,CurveTimeline:hs,DeformTimeline:Yh,DrawOrderTimeline:gi,Event:Kh,EventData:Zh,EventQueue:Wh,EventTimeline:Ko,EventType:rs,IkConstraint:gg,IkConstraintData:Qh,IkConstraintTimeline:Ge,JitterEffect:KE,MeshAttachment:qo,PathAttachment:la,PathConstraint:Ei,PathConstraintData:Jh,PathConstraintMixTimeline:Qs,PathConstraintPositionTimeline:xn,PathConstraintSpacingTimeline:$h,PointAttachment:dg,RegionAttachment:Tt,RotateTimeline:Ue,ScaleTimeline:Xh,ShearTimeline:Gh,Skeleton:td,SkeletonBinary:Te,SkeletonBounds:tS,SkeletonData:ed,SkeletonJson:bg,Skin:Ao,SkinEntry:rh,Slot:Uh,SlotData:sd,SpacingMode:Oe,Spine:sS,SwirlEffect:mg,TimelineType:pg,TrackEntry:Zo,TransformConstraint:xg,TransformConstraintData:nd,TransformConstraintTimeline:ss,TranslateTimeline:xs,TwoColorTimeline:Se,VertexAttachment:xr},Symbol.toStringTag,{value:"Module"}));let rd=class{constructor(t){if(t==null)throw new Error("name cannot be null.");this.name=t}};const yg=class extends rd{constructor(t){super(t),this.id=(yg.nextID++&65535)<<11,this.worldVerticesLength=0}computeWorldVerticesOld(t,e){this.computeWorldVertices(t,0,this.worldVerticesLength,e,0,2)}computeWorldVertices(t,e,s,r,i,o){s=i+(s>>1)*o;const l=t.bone.skeleton,a=t.attachmentVertices;let c=this.vertices;const h=this.bones;if(h==null){a.length>0&&(c=a);const m=t.bone.matrix,p=m.tx,g=m.ty,w=m.a,x=m.c,y=m.b,b=m.d;for(let _=e,E=i;E<s;_+=2,E+=o){const S=c[_],T=c[_+1];r[E]=S*w+T*x+p,r[E+1]=S*y+T*b+g}return}let d=0,u=0;for(let m=0;m<e;m+=2){const p=h[d];d+=p+1,u+=p}const f=l.bones;if(a.length==0)for(let m=i,p=u*3;m<s;m+=o){let g=0,w=0,x=h[d++];for(x+=d;d<x;d++,p+=3){const y=f[h[d]].matrix,b=c[p],_=c[p+1],E=c[p+2];g+=(b*y.a+_*y.c+y.tx)*E,w+=(b*y.b+_*y.d+y.ty)*E}r[m]=g,r[m+1]=w}else{const m=a;for(let p=i,g=u*3,w=u<<1;p<s;p+=o){let x=0,y=0,b=h[d++];for(b+=d;d<b;d++,g+=3,w+=2){const _=f[h[d]].matrix,E=c[g]+m[w],S=c[g+1]+m[w+1],T=c[g+2];x+=(E*_.a+S*_.c+_.tx)*T,y+=(E*_.b+S*_.d+_.ty)*T}r[p]=x,r[p+1]=y}}}applyDeform(t){return this==t}};let br=yg;br.nextID=0;let wg=class extends br{constructor(t){super(t),this.type=Rt.BoundingBox,this.color=new et(1,1,1,1)}},vg=class extends br{constructor(t){super(t),this.type=Rt.Clipping,this.color=new et(.2275,.2275,.8078,1)}},id=class extends br{constructor(t){super(t),this.type=Rt.Mesh,this.color=new et(1,1,1,1),this.inheritDeform=!1,this.tempColor=new et(0,0,0,0)}applyDeform(t){return this==t||this.inheritDeform&&this.parentMesh==t}getParentMesh(){return this.parentMesh}setParentMesh(t){this.parentMesh=t,t!=null&&(this.bones=t.bones,this.vertices=t.vertices,this.worldVerticesLength=t.worldVerticesLength,this.regionUVs=t.regionUVs,this.triangles=t.triangles,this.hullLength=t.hullLength,this.worldVerticesLength=t.worldVerticesLength)}},ca=class extends br{constructor(t){super(t),this.type=Rt.Path,this.closed=!1,this.constantSpeed=!1,this.color=new et(1,1,1,1)}},_g=class extends br{constructor(t){super(t),this.type=Rt.Point,this.color=new et(.38,.94,0,1)}computeWorldPosition(t,e){const s=t.matrix;return e.x=this.x*s.a+this.y*s.c+t.worldX,e.y=this.x*s.b+this.y*s.d+t.worldY,e}computeWorldRotation(t){const e=t.matrix,s=P.cosDeg(this.rotation),r=P.sinDeg(this.rotation),i=s*e.a+r*e.c,o=s*e.b+r*e.d;return Math.atan2(o,i)*P.radDeg}},ad=class{constructor(t,e){if(this.attachmentVertices=new Array,t==null)throw new Error("data cannot be null.");if(e==null)throw new Error("bone cannot be null.");this.data=t,this.bone=e,this.color=new et,this.darkColor=t.darkColor==null?null:new et,this.setToSetupPose(),this.blendMode=this.data.blendMode}getAttachment(){return this.attachment}setAttachment(t){this.attachment!=t&&(this.attachment=t,this.attachmentTime=this.bone.skeleton.time,this.attachmentVertices.length=0)}setAttachmentTime(t){this.attachmentTime=this.bone.skeleton.time-t}getAttachmentTime(){return this.bone.skeleton.time-this.attachmentTime}setToSetupPose(){this.color.setFromColor(this.data.color),this.darkColor!=null&&this.darkColor.setFromColor(this.data.darkColor),this.data.attachmentName==null?this.attachment=null:(this.attachment=null,this.setAttachment(this.bone.skeleton.getAttachment(this.data.index,this.data.attachmentName)))}};const je=class extends rd{constructor(t){super(t),this.type=Rt.Region,this.x=0,this.y=0,this.scaleX=1,this.scaleY=1,this.rotation=0,this.width=0,this.height=0,this.color=new et(1,1,1,1),this.offset=$.newFloatArray(8),this.uvs=$.newFloatArray(8),this.tempColor=new et(1,1,1,1)}updateOffset(){const t=this.width/this.region.originalWidth*this.scaleX,e=this.height/this.region.originalHeight*this.scaleY,s=-this.width/2*this.scaleX+this.region.offsetX*t,r=-this.height/2*this.scaleY+this.region.offsetY*e,i=s+this.region.width*t,o=r+this.region.height*e,l=this.rotation*Math.PI/180,a=Math.cos(l),c=Math.sin(l),h=s*a+this.x,d=s*c,u=r*a+this.y,f=r*c,m=i*a+this.x,p=i*c,g=o*a+this.y,w=o*c,x=this.offset;x[je.OX1]=h-f,x[je.OY1]=u+d,x[je.OX2]=h-w,x[je.OY2]=g+d,x[je.OX3]=m-w,x[je.OY3]=g+p,x[je.OX4]=m-f,x[je.OY4]=u+p}setRegion(t){this.region=t;const e=this.uvs;t.rotate?(e[2]=t.u,e[3]=t.v2,e[4]=t.u,e[5]=t.v,e[6]=t.u2,e[7]=t.v,e[0]=t.u2,e[1]=t.v2):(e[0]=t.u,e[1]=t.v2,e[2]=t.u,e[3]=t.v,e[4]=t.u2,e[5]=t.v,e[6]=t.u2,e[7]=t.v2)}computeWorldVertices(t,e,s,r){const i=this.offset,o=t instanceof ad?t.bone.matrix:t.matrix,l=o.tx,a=o.ty,c=o.a,h=o.c,d=o.b,u=o.d;let f=0,m=0;f=i[je.OX1],m=i[je.OY1],e[s]=f*c+m*h+l,e[s+1]=f*d+m*u+a,s+=r,f=i[je.OX2],m=i[je.OY2],e[s]=f*c+m*h+l,e[s+1]=f*d+m*u+a,s+=r,f=i[je.OX3],m=i[je.OY3],e[s]=f*c+m*h+l,e[s+1]=f*d+m*u+a,s+=r,f=i[je.OX4],m=i[je.OY4],e[s]=f*c+m*h+l,e[s+1]=f*d+m*u+a}};let At=je;At.OX1=0;At.OY1=1;At.OX2=2;At.OY2=3;At.OX3=4;At.OY3=5;At.OX4=6;At.OY4=7;At.X1=0;At.Y1=1;At.C1R=2;At.C1G=3;At.C1B=4;At.C1A=5;At.U1=6;At.V1=7;At.X2=8;At.Y2=9;At.C2R=10;At.C2G=11;At.C2B=12;At.C2A=13;At.U2=14;At.V2=15;At.X3=16;At.Y3=17;At.C3R=18;At.C3G=19;At.C3B=20;At.C3A=21;At.U3=22;At.V3=23;At.X4=24;At.Y4=25;At.C4R=26;At.C4G=27;At.C4B=28;At.C4A=29;At.U4=30;At.V4=31;class rS{constructor(t,e){this.jitterX=0,this.jitterY=0,this.jitterX=t,this.jitterY=e}begin(t){}transform(t,e,s,r){t.x+=P.randomTriangular(-this.jitterX,this.jitterY),t.y+=P.randomTriangular(-this.jitterX,this.jitterY)}end(){}}const Eg=class{constructor(n){this.centerX=0,this.centerY=0,this.radius=0,this.angle=0,this.worldX=0,this.worldY=0,this.radius=n}begin(n){this.worldX=n.x+this.centerX,this.worldY=n.y+this.centerY}transform(n,t,e,s){const r=this.angle*P.degreesToRadians,i=n.x-this.worldX,o=n.y-this.worldY,l=Math.sqrt(i*i+o*o);if(l<this.radius){const a=Eg.interpolation.apply(0,r,(this.radius-l)/this.radius),c=Math.cos(a),h=Math.sin(a);n.x=c*i-h*o+this.worldX,n.y=h*i+c*o+this.worldY}}end(){}};let Sg=Eg;Sg.interpolation=new sg(2);let Ne=class{constructor(t,e,s){if(t==null)throw new Error("name cannot be null.");if(e==null)throw new Error("timelines cannot be null.");this.name=t,this.timelines=e,this.duration=s}apply(t,e,s,r,i,o,l,a){if(t==null)throw new Error("skeleton cannot be null.");r&&this.duration!=0&&(s%=this.duration,e>0&&(e%=this.duration));const c=this.timelines;for(let h=0,d=c.length;h<d;h++)c[h].apply(t,e,s,i,o,l,a)}static binarySearch(t,e,s=1){let r=0,i=t.length/s-2;if(i==0)return s;let o=i>>>1;for(;;){if(t[(o+1)*s]<=e?r=o+1:i=o,r==i)return(r+1)*s;o=r+i>>>1}}static linearSearch(t,e,s){for(let r=0,i=t.length-s;r<=i;r+=s)if(t[r]>e)return r;return-1}};var Tg=(n=>(n[n.rotate=0]="rotate",n[n.translate=1]="translate",n[n.scale=2]="scale",n[n.shear=3]="shear",n[n.attachment=4]="attachment",n[n.color=5]="color",n[n.deform=6]="deform",n[n.event=7]="event",n[n.drawOrder=8]="drawOrder",n[n.ikConstraint=9]="ikConstraint",n[n.transformConstraint=10]="transformConstraint",n[n.pathConstraintPosition=11]="pathConstraintPosition",n[n.pathConstraintSpacing=12]="pathConstraintSpacing",n[n.pathConstraintMix=13]="pathConstraintMix",n[n.twoColor=14]="twoColor",n))(Tg||{});const we=class{constructor(n){if(n<=0)throw new Error(`frameCount must be > 0: ${n}`);this.curves=$.newFloatArray((n-1)*we.BEZIER_SIZE)}getFrameCount(){return this.curves.length/we.BEZIER_SIZE+1}setLinear(n){this.curves[n*we.BEZIER_SIZE]=we.LINEAR}setStepped(n){this.curves[n*we.BEZIER_SIZE]=we.STEPPED}getCurveType(n){const t=n*we.BEZIER_SIZE;if(t==this.curves.length)return we.LINEAR;const e=this.curves[t];return e==we.LINEAR?we.LINEAR:e==we.STEPPED?we.STEPPED:we.BEZIER}setCurve(n,t,e,s,r){const i=(-t*2+s)*.03,o=(-e*2+r)*.03,l=((t-s)*3+1)*.006,a=((e-r)*3+1)*.006;let c=i*2+l,h=o*2+a,d=t*.3+i+l*.16666667,u=e*.3+o+a*.16666667,f=n*we.BEZIER_SIZE;const m=this.curves;m[f++]=we.BEZIER;let p=d,g=u;for(let w=f+we.BEZIER_SIZE-1;f<w;f+=2)m[f]=p,m[f+1]=g,d+=c,u+=h,c+=l,h+=a,p+=d,g+=u}getCurvePercent(n,t){t=P.clamp(t,0,1);const e=this.curves;let s=n*we.BEZIER_SIZE;const r=e[s];if(r==we.LINEAR)return t;if(r==we.STEPPED)return 0;s++;let i=0;for(let l=s,a=s+we.BEZIER_SIZE-1;s<a;s+=2)if(i=e[s],i>=t){let c,h;return s==l?(c=0,h=0):(c=e[s-2],h=e[s-1]),h+(e[s+1]-h)*(t-c)/(i-c)}const o=e[s-1];return o+(1-o)*(t-i)/(1-i)}};let ds=we;ds.LINEAR=0;ds.STEPPED=1;ds.BEZIER=2;ds.BEZIER_SIZE=10*2-1;const Kn=class extends ds{constructor(n){super(n),this.frames=$.newFloatArray(n<<1)}getPropertyId(){return 0+this.boneIndex}setFrame(n,t,e){n<<=1,this.frames[n]=t,this.frames[n+Kn.ROTATION]=e}apply(n,t,e,s,r,i,o){const l=this.frames,a=n.bones[this.boneIndex];if(e<l[0]){switch(i){case k.setup:a.rotation=a.data.rotation;return;case k.first:const m=a.data.rotation-a.rotation;a.rotation+=(m-(16384-(16384.499999999996-m/360|0))*360)*r}return}if(e>=l[l.length-Kn.ENTRIES]){let m=l[l.length+Kn.PREV_ROTATION];switch(i){case k.setup:a.rotation=a.data.rotation+m*r;break;case k.first:case k.replace:m+=a.data.rotation-a.rotation,m-=(16384-(16384.499999999996-m/360|0))*360;case k.add:a.rotation+=m*r}return}const c=Ne.binarySearch(l,e,Kn.ENTRIES),h=l[c+Kn.PREV_ROTATION],d=l[c],u=this.getCurvePercent((c>>1)-1,1-(e-d)/(l[c+Kn.PREV_TIME]-d));let f=l[c+Kn.ROTATION]-h;switch(f=h+(f-(16384-(16384.499999999996-f/360|0))*360)*u,i){case k.setup:a.rotation=a.data.rotation+(f-(16384-(16384.499999999996-f/360|0))*360)*r;break;case k.first:case k.replace:f+=a.data.rotation-a.rotation;case k.add:a.rotation+=(f-(16384-(16384.499999999996-f/360|0))*360)*r}}};let Ke=Kn;Ke.ENTRIES=2;Ke.PREV_TIME=-2;Ke.PREV_ROTATION=-1;Ke.ROTATION=1;const ze=class extends ds{constructor(n){super(n),this.frames=$.newFloatArray(n*ze.ENTRIES)}getPropertyId(){return(1<<24)+this.boneIndex}setFrame(n,t,e,s){n*=ze.ENTRIES,this.frames[n]=t,this.frames[n+ze.X]=e,this.frames[n+ze.Y]=s}apply(n,t,e,s,r,i,o){const l=this.frames,a=n.bones[this.boneIndex];if(e<l[0]){switch(i){case k.setup:a.x=a.data.x,a.y=a.data.y;return;case k.first:a.x+=(a.data.x-a.x)*r,a.y+=(a.data.y-a.y)*r}return}let c=0,h=0;if(e>=l[l.length-ze.ENTRIES])c=l[l.length+ze.PREV_X],h=l[l.length+ze.PREV_Y];else{const d=Ne.binarySearch(l,e,ze.ENTRIES);c=l[d+ze.PREV_X],h=l[d+ze.PREV_Y];const u=l[d],f=this.getCurvePercent(d/ze.ENTRIES-1,1-(e-u)/(l[d+ze.PREV_TIME]-u));c+=(l[d+ze.X]-c)*f,h+=(l[d+ze.Y]-h)*f}switch(i){case k.setup:a.x=a.data.x+c*r,a.y=a.data.y+h*r;break;case k.first:case k.replace:a.x+=(a.data.x+c-a.x)*r,a.y+=(a.data.y+h-a.y)*r;break;case k.add:a.x+=c*r,a.y+=h*r}}};let Js=ze;Js.ENTRIES=3;Js.PREV_TIME=-3;Js.PREV_X=-2;Js.PREV_Y=-1;Js.X=1;Js.Y=2;let Ag=class Os extends Js{constructor(t){super(t)}getPropertyId(){return(2<<24)+this.boneIndex}apply(t,e,s,r,i,o,l){const a=this.frames,c=t.bones[this.boneIndex];if(s<a[0]){switch(o){case k.setup:c.scaleX=c.data.scaleX,c.scaleY=c.data.scaleY;return;case k.first:c.scaleX+=(c.data.scaleX-c.scaleX)*i,c.scaleY+=(c.data.scaleY-c.scaleY)*i}return}let h=0,d=0;if(s>=a[a.length-Os.ENTRIES])h=a[a.length+Os.PREV_X]*c.data.scaleX,d=a[a.length+Os.PREV_Y]*c.data.scaleY;else{const u=Ne.binarySearch(a,s,Os.ENTRIES);h=a[u+Os.PREV_X],d=a[u+Os.PREV_Y];const f=a[u],m=this.getCurvePercent(u/Os.ENTRIES-1,1-(s-f)/(a[u+Os.PREV_TIME]-f));h=(h+(a[u+Os.X]-h)*m)*c.data.scaleX,d=(d+(a[u+Os.Y]-d)*m)*c.data.scaleY}if(i==1)o==k.add?(c.scaleX+=h-c.data.scaleX,c.scaleY+=d-c.data.scaleY):(c.scaleX=h,c.scaleY=d);else{let u=0,f=0;if(l==It.mixOut)switch(o){case k.setup:u=c.data.scaleX,f=c.data.scaleY,c.scaleX=u+(Math.abs(h)*P.signum(u)-u)*i,c.scaleY=f+(Math.abs(d)*P.signum(f)-f)*i;break;case k.first:case k.replace:u=c.scaleX,f=c.scaleY,c.scaleX=u+(Math.abs(h)*P.signum(u)-u)*i,c.scaleY=f+(Math.abs(d)*P.signum(f)-f)*i;break;case k.add:u=c.scaleX,f=c.scaleY,c.scaleX=u+(Math.abs(h)*P.signum(u)-c.data.scaleX)*i,c.scaleY=f+(Math.abs(d)*P.signum(f)-c.data.scaleY)*i}else switch(o){case k.setup:u=Math.abs(c.data.scaleX)*P.signum(h),f=Math.abs(c.data.scaleY)*P.signum(d),c.scaleX=u+(h-u)*i,c.scaleY=f+(d-f)*i;break;case k.first:case k.replace:u=Math.abs(c.scaleX)*P.signum(h),f=Math.abs(c.scaleY)*P.signum(d),c.scaleX=u+(h-u)*i,c.scaleY=f+(d-f)*i;break;case k.add:u=P.signum(h),f=P.signum(d),c.scaleX=Math.abs(c.scaleX)*u+(h-Math.abs(c.data.scaleX)*u)*i,c.scaleY=Math.abs(c.scaleY)*f+(d-Math.abs(c.data.scaleY)*f)*i}}}},Cg=class js extends Js{constructor(t){super(t)}getPropertyId(){return(3<<24)+this.boneIndex}apply(t,e,s,r,i,o,l){const a=this.frames,c=t.bones[this.boneIndex];if(s<a[0]){switch(o){case k.setup:c.shearX=c.data.shearX,c.shearY=c.data.shearY;return;case k.first:c.shearX+=(c.data.shearX-c.shearX)*i,c.shearY+=(c.data.shearY-c.shearY)*i}return}let h=0,d=0;if(s>=a[a.length-js.ENTRIES])h=a[a.length+js.PREV_X],d=a[a.length+js.PREV_Y];else{const u=Ne.binarySearch(a,s,js.ENTRIES);h=a[u+js.PREV_X],d=a[u+js.PREV_Y];const f=a[u],m=this.getCurvePercent(u/js.ENTRIES-1,1-(s-f)/(a[u+js.PREV_TIME]-f));h=h+(a[u+js.X]-h)*m,d=d+(a[u+js.Y]-d)*m}switch(o){case k.setup:c.shearX=c.data.shearX+h*i,c.shearY=c.data.shearY+d*i;break;case k.first:case k.replace:c.shearX+=(c.data.shearX+h-c.shearX)*i,c.shearY+=(c.data.shearY+d-c.shearY)*i;break;case k.add:c.shearX+=h*i,c.shearY+=d*i}}};const he=class extends ds{constructor(n){super(n),this.frames=$.newFloatArray(n*he.ENTRIES)}getPropertyId(){return(5<<24)+this.slotIndex}setFrame(n,t,e,s,r,i){n*=he.ENTRIES,this.frames[n]=t,this.frames[n+he.R]=e,this.frames[n+he.G]=s,this.frames[n+he.B]=r,this.frames[n+he.A]=i}apply(n,t,e,s,r,i,o){const l=n.slots[this.slotIndex],a=this.frames;if(e<a[0]){switch(i){case k.setup:l.color.setFromColor(l.data.color);return;case k.first:const f=l.color,m=l.data.color;f.add((m.r-f.r)*r,(m.g-f.g)*r,(m.b-f.b)*r,(m.a-f.a)*r)}return}let c=0,h=0,d=0,u=0;if(e>=a[a.length-he.ENTRIES]){const f=a.length;c=a[f+he.PREV_R],h=a[f+he.PREV_G],d=a[f+he.PREV_B],u=a[f+he.PREV_A]}else{const f=Ne.binarySearch(a,e,he.ENTRIES);c=a[f+he.PREV_R],h=a[f+he.PREV_G],d=a[f+he.PREV_B],u=a[f+he.PREV_A];const m=a[f],p=this.getCurvePercent(f/he.ENTRIES-1,1-(e-m)/(a[f+he.PREV_TIME]-m));c+=(a[f+he.R]-c)*p,h+=(a[f+he.G]-h)*p,d+=(a[f+he.B]-d)*p,u+=(a[f+he.A]-u)*p}if(r==1)l.color.set(c,h,d,u);else{const f=l.color;i==k.setup&&f.setFromColor(l.data.color),f.add((c-f.r)*r,(h-f.g)*r,(d-f.b)*r,(u-f.a)*r)}}};let bs=he;bs.ENTRIES=5;bs.PREV_TIME=-5;bs.PREV_R=-4;bs.PREV_G=-3;bs.PREV_B=-2;bs.PREV_A=-1;bs.R=1;bs.G=2;bs.B=3;bs.A=4;const Dt=class extends ds{constructor(n){super(n),this.frames=$.newFloatArray(n*Dt.ENTRIES)}getPropertyId(){return(14<<24)+this.slotIndex}setFrame(n,t,e,s,r,i,o,l,a){n*=Dt.ENTRIES,this.frames[n]=t,this.frames[n+Dt.R]=e,this.frames[n+Dt.G]=s,this.frames[n+Dt.B]=r,this.frames[n+Dt.A]=i,this.frames[n+Dt.R2]=o,this.frames[n+Dt.G2]=l,this.frames[n+Dt.B2]=a}apply(n,t,e,s,r,i,o){const l=n.slots[this.slotIndex],a=this.frames;if(e<a[0]){switch(i){case k.setup:l.color.setFromColor(l.data.color),l.darkColor.setFromColor(l.data.darkColor);return;case k.first:const g=l.color,w=l.darkColor,x=l.data.color,y=l.data.darkColor;g.add((x.r-g.r)*r,(x.g-g.g)*r,(x.b-g.b)*r,(x.a-g.a)*r),w.add((y.r-w.r)*r,(y.g-w.g)*r,(y.b-w.b)*r,0)}return}let c=0,h=0,d=0,u=0,f=0,m=0,p=0;if(e>=a[a.length-Dt.ENTRIES]){const g=a.length;c=a[g+Dt.PREV_R],h=a[g+Dt.PREV_G],d=a[g+Dt.PREV_B],u=a[g+Dt.PREV_A],f=a[g+Dt.PREV_R2],m=a[g+Dt.PREV_G2],p=a[g+Dt.PREV_B2]}else{const g=Ne.binarySearch(a,e,Dt.ENTRIES);c=a[g+Dt.PREV_R],h=a[g+Dt.PREV_G],d=a[g+Dt.PREV_B],u=a[g+Dt.PREV_A],f=a[g+Dt.PREV_R2],m=a[g+Dt.PREV_G2],p=a[g+Dt.PREV_B2];const w=a[g],x=this.getCurvePercent(g/Dt.ENTRIES-1,1-(e-w)/(a[g+Dt.PREV_TIME]-w));c+=(a[g+Dt.R]-c)*x,h+=(a[g+Dt.G]-h)*x,d+=(a[g+Dt.B]-d)*x,u+=(a[g+Dt.A]-u)*x,f+=(a[g+Dt.R2]-f)*x,m+=(a[g+Dt.G2]-m)*x,p+=(a[g+Dt.B2]-p)*x}if(r==1)l.color.set(c,h,d,u),l.darkColor.set(f,m,p,1);else{const g=l.color,w=l.darkColor;i==k.setup&&(g.setFromColor(l.data.color),w.setFromColor(l.data.darkColor)),g.add((c-g.r)*r,(h-g.g)*r,(d-g.b)*r,(u-g.a)*r),w.add((f-w.r)*r,(m-w.g)*r,(p-w.b)*r,0)}}};let Pe=Dt;Pe.ENTRIES=8;Pe.PREV_TIME=-8;Pe.PREV_R=-7;Pe.PREV_G=-6;Pe.PREV_B=-5;Pe.PREV_A=-4;Pe.PREV_R2=-3;Pe.PREV_G2=-2;Pe.PREV_B2=-1;Pe.R=1;Pe.G=2;Pe.B=3;Pe.A=4;Pe.R2=5;Pe.G2=6;Pe.B2=7;let Co=class{constructor(t){this.frames=$.newFloatArray(t),this.attachmentNames=new Array(t)}getPropertyId(){return(4<<24)+this.slotIndex}getFrameCount(){return this.frames.length}setFrame(t,e,s){this.frames[t]=e,this.attachmentNames[t]=s}apply(t,e,s,r,i,o,l){const a=t.slots[this.slotIndex];if(l==It.mixOut&&o==k.setup){const u=a.data.attachmentName;a.setAttachment(u==null?null:t.getAttachment(this.slotIndex,u));return}const c=this.frames;if(s<c[0]){if(o==k.setup||o==k.first){const u=a.data.attachmentName;a.setAttachment(u==null?null:t.getAttachment(this.slotIndex,u))}return}let h=0;s>=c[c.length-1]?h=c.length-1:h=Ne.binarySearch(c,s,1)-1;const d=this.attachmentNames[h];t.slots[this.slotIndex].setAttachment(d==null?null:t.getAttachment(this.slotIndex,d))}},Mf=null,kg=class extends ds{constructor(t){super(t),this.frames=$.newFloatArray(t),this.frameVertices=new Array(t),Mf==null&&(Mf=$.newFloatArray(64))}getPropertyId(){return(6<<27)+Number(this.attachment.id)+this.slotIndex}setFrame(t,e,s){this.frames[t]=e,this.frameVertices[t]=s}apply(t,e,s,r,i,o,l){const a=t.slots[this.slotIndex],c=a.getAttachment();if(!(c instanceof br)||!c.applyDeform(this.attachment))return;const h=a.attachmentVertices;h.length==0&&(o=k.setup);const d=this.frameVertices,u=d[0].length,f=this.frames;if(s<f[0]){const b=c;switch(o){case k.setup:h.length=0;return;case k.first:if(i==1){h.length=0;break}const _=$.setArraySize(h,u);if(b.bones==null){const E=b.vertices;for(let S=0;S<u;S++)_[S]+=(E[S]-_[S])*i}else{i=1-i;for(let E=0;E<u;E++)_[E]*=i}}return}const m=$.setArraySize(h,u);if(s>=f[f.length-1]){const b=d[f.length-1];if(i==1)if(o==k.add){const _=c;if(_.bones==null){const E=_.vertices;for(let S=0;S<u;S++)m[S]+=b[S]-E[S]}else for(let E=0;E<u;E++)m[E]+=b[E]}else $.arrayCopy(b,0,m,0,u);else switch(o){case k.setup:{const E=c;if(E.bones==null){const S=E.vertices;for(let T=0;T<u;T++){const C=S[T];m[T]=C+(b[T]-C)*i}}else for(let S=0;S<u;S++)m[S]=b[S]*i;break}case k.first:case k.replace:for(let E=0;E<u;E++)m[E]+=(b[E]-m[E])*i;case k.add:const _=c;if(_.bones==null){const E=_.vertices;for(let S=0;S<u;S++)m[S]+=(b[S]-E[S])*i}else for(let E=0;E<u;E++)m[E]+=b[E]*i}return}const p=Ne.binarySearch(f,s),g=d[p-1],w=d[p],x=f[p],y=this.getCurvePercent(p-1,1-(s-x)/(f[p-1]-x));if(i==1)if(o==k.add){const b=c;if(b.bones==null){const _=b.vertices;for(let E=0;E<u;E++){const S=g[E];m[E]+=S+(w[E]-S)*y-_[E]}}else for(let _=0;_<u;_++){const E=g[_];m[_]+=E+(w[_]-E)*y}}else for(let b=0;b<u;b++){const _=g[b];m[b]=_+(w[b]-_)*y}else switch(o){case k.setup:{const _=c;if(_.bones==null){const E=_.vertices;for(let S=0;S<u;S++){const T=g[S],C=E[S];m[S]=C+(T+(w[S]-T)*y-C)*i}}else for(let E=0;E<u;E++){const S=g[E];m[E]=(S+(w[E]-S)*y)*i}break}case k.first:case k.replace:for(let _=0;_<u;_++){const E=g[_];m[_]+=(E+(w[_]-E)*y-m[_])*i}break;case k.add:const b=c;if(b.bones==null){const _=b.vertices;for(let E=0;E<u;E++){const S=g[E];m[E]+=(S+(w[E]-S)*y-_[E])*i}}else for(let _=0;_<u;_++){const E=g[_];m[_]+=(E+(w[_]-E)*y)*i}}}},Ig=class{constructor(t){this.frames=$.newFloatArray(t),this.events=new Array(t)}getPropertyId(){return 7<<24}getFrameCount(){return this.frames.length}setFrame(t,e){this.frames[t]=e.time,this.events[t]=e}apply(t,e,s,r,i,o,l){if(r==null)return;const a=this.frames,c=this.frames.length;if(e>s)this.apply(t,e,Number.MAX_VALUE,r,i,o,l),e=-1;else if(e>=a[c-1])return;if(s<a[0])return;let h=0;if(e<a[0])h=0;else{h=Ne.binarySearch(a,e);const d=a[h];for(;h>0&&a[h-1]==d;)h--}for(;h<c&&s>=a[h];h++)r.push(this.events[h])}},ko=class{constructor(t){this.frames=$.newFloatArray(t),this.drawOrders=new Array(t)}getPropertyId(){return 8<<24}getFrameCount(){return this.frames.length}setFrame(t,e,s){this.frames[t]=e,this.drawOrders[t]=s}apply(t,e,s,r,i,o,l){const a=t.drawOrder,c=t.slots;if(l==It.mixOut&&o==k.setup){$.arrayCopy(t.slots,0,t.drawOrder,0,t.slots.length);return}const h=this.frames;if(s<h[0]){(o==k.setup||o==k.first)&&$.arrayCopy(t.slots,0,t.drawOrder,0,t.slots.length);return}let d=0;s>=h[h.length-1]?d=h.length-1:d=Ne.binarySearch(h,s)-1;const u=this.drawOrders[d];if(u==null)$.arrayCopy(c,0,a,0,c.length);else for(let f=0,m=u.length;f<m;f++)a[f]=c[u[f]]}};const Kt=class extends ds{constructor(n){super(n),this.frames=$.newFloatArray(n*Kt.ENTRIES)}getPropertyId(){return(9<<24)+this.ikConstraintIndex}setFrame(n,t,e,s,r,i){n*=Kt.ENTRIES,this.frames[n]=t,this.frames[n+Kt.MIX]=e,this.frames[n+Kt.BEND_DIRECTION]=s,this.frames[n+Kt.COMPRESS]=r?1:0,this.frames[n+Kt.STRETCH]=i?1:0}apply(n,t,e,s,r,i,o){const l=this.frames,a=n.ikConstraints[this.ikConstraintIndex];if(e<l[0]){switch(i){case k.setup:a.mix=a.data.mix,a.bendDirection=a.data.bendDirection,a.compress=a.data.compress,a.stretch=a.data.stretch;return;case k.first:a.mix+=(a.data.mix-a.mix)*r,a.bendDirection=a.data.bendDirection,a.compress=a.data.compress,a.stretch=a.data.stretch}return}if(e>=l[l.length-Kt.ENTRIES]){i==k.setup?(a.mix=a.data.mix+(l[l.length+Kt.PREV_MIX]-a.data.mix)*r,o==It.mixOut?(a.bendDirection=a.data.bendDirection,a.compress=a.data.compress,a.stretch=a.data.stretch):(a.bendDirection=l[l.length+Kt.PREV_BEND_DIRECTION],a.compress=l[l.length+Kt.PREV_COMPRESS]!=0,a.stretch=l[l.length+Kt.PREV_STRETCH]!=0)):(a.mix+=(l[l.length+Kt.PREV_MIX]-a.mix)*r,o==It.mixIn&&(a.bendDirection=l[l.length+Kt.PREV_BEND_DIRECTION],a.compress=l[l.length+Kt.PREV_COMPRESS]!=0,a.stretch=l[l.length+Kt.PREV_STRETCH]!=0));return}const c=Ne.binarySearch(l,e,Kt.ENTRIES),h=l[c+Kt.PREV_MIX],d=l[c],u=this.getCurvePercent(c/Kt.ENTRIES-1,1-(e-d)/(l[c+Kt.PREV_TIME]-d));i==k.setup?(a.mix=a.data.mix+(h+(l[c+Kt.MIX]-h)*u-a.data.mix)*r,o==It.mixOut?(a.bendDirection=a.data.bendDirection,a.compress=a.data.compress,a.stretch=a.data.stretch):(a.bendDirection=l[c+Kt.PREV_BEND_DIRECTION],a.compress=l[c+Kt.PREV_COMPRESS]!=0,a.stretch=l[c+Kt.PREV_STRETCH]!=0)):(a.mix+=(h+(l[c+Kt.MIX]-h)*u-a.mix)*r,o==It.mixIn&&(a.bendDirection=l[c+Kt.PREV_BEND_DIRECTION],a.compress=l[c+Kt.PREV_COMPRESS]!=0,a.stretch=l[c+Kt.PREV_STRETCH]!=0))}};let ys=Kt;ys.ENTRIES=5;ys.PREV_TIME=-5;ys.PREV_MIX=-4;ys.PREV_BEND_DIRECTION=-3;ys.PREV_COMPRESS=-2;ys.PREV_STRETCH=-1;ys.MIX=1;ys.BEND_DIRECTION=2;ys.COMPRESS=3;ys.STRETCH=4;const de=class extends ds{constructor(n){super(n),this.frames=$.newFloatArray(n*de.ENTRIES)}getPropertyId(){return(10<<24)+this.transformConstraintIndex}setFrame(n,t,e,s,r,i){n*=de.ENTRIES,this.frames[n]=t,this.frames[n+de.ROTATE]=e,this.frames[n+de.TRANSLATE]=s,this.frames[n+de.SCALE]=r,this.frames[n+de.SHEAR]=i}apply(n,t,e,s,r,i,o){const l=this.frames,a=n.transformConstraints[this.transformConstraintIndex];if(e<l[0]){const f=a.data;switch(i){case k.setup:a.rotateMix=f.rotateMix,a.translateMix=f.translateMix,a.scaleMix=f.scaleMix,a.shearMix=f.shearMix;return;case k.first:a.rotateMix+=(f.rotateMix-a.rotateMix)*r,a.translateMix+=(f.translateMix-a.translateMix)*r,a.scaleMix+=(f.scaleMix-a.scaleMix)*r,a.shearMix+=(f.shearMix-a.shearMix)*r}return}let c=0,h=0,d=0,u=0;if(e>=l[l.length-de.ENTRIES]){const f=l.length;c=l[f+de.PREV_ROTATE],h=l[f+de.PREV_TRANSLATE],d=l[f+de.PREV_SCALE],u=l[f+de.PREV_SHEAR]}else{const f=Ne.binarySearch(l,e,de.ENTRIES);c=l[f+de.PREV_ROTATE],h=l[f+de.PREV_TRANSLATE],d=l[f+de.PREV_SCALE],u=l[f+de.PREV_SHEAR];const m=l[f],p=this.getCurvePercent(f/de.ENTRIES-1,1-(e-m)/(l[f+de.PREV_TIME]-m));c+=(l[f+de.ROTATE]-c)*p,h+=(l[f+de.TRANSLATE]-h)*p,d+=(l[f+de.SCALE]-d)*p,u+=(l[f+de.SHEAR]-u)*p}if(i==k.setup){const f=a.data;a.rotateMix=f.rotateMix+(c-f.rotateMix)*r,a.translateMix=f.translateMix+(h-f.translateMix)*r,a.scaleMix=f.scaleMix+(d-f.scaleMix)*r,a.shearMix=f.shearMix+(u-f.shearMix)*r}else a.rotateMix+=(c-a.rotateMix)*r,a.translateMix+=(h-a.translateMix)*r,a.scaleMix+=(d-a.scaleMix)*r,a.shearMix+=(u-a.shearMix)*r}};let ws=de;ws.ENTRIES=5;ws.PREV_TIME=-5;ws.PREV_ROTATE=-4;ws.PREV_TRANSLATE=-3;ws.PREV_SCALE=-2;ws.PREV_SHEAR=-1;ws.ROTATE=1;ws.TRANSLATE=2;ws.SCALE=3;ws.SHEAR=4;const Vs=class extends ds{constructor(n){super(n),this.frames=$.newFloatArray(n*Vs.ENTRIES)}getPropertyId(){return(11<<24)+this.pathConstraintIndex}setFrame(n,t,e){n*=Vs.ENTRIES,this.frames[n]=t,this.frames[n+Vs.VALUE]=e}apply(n,t,e,s,r,i,o){const l=this.frames,a=n.pathConstraints[this.pathConstraintIndex];if(e<l[0]){switch(i){case k.setup:a.position=a.data.position;return;case k.first:a.position+=(a.data.position-a.position)*r}return}let c=0;if(e>=l[l.length-Vs.ENTRIES])c=l[l.length+Vs.PREV_VALUE];else{const h=Ne.binarySearch(l,e,Vs.ENTRIES);c=l[h+Vs.PREV_VALUE];const d=l[h],u=this.getCurvePercent(h/Vs.ENTRIES-1,1-(e-d)/(l[h+Vs.PREV_TIME]-d));c+=(l[h+Vs.VALUE]-c)*u}i==k.setup?a.position=a.data.position+(c-a.data.position)*r:a.position+=(c-a.position)*r}};let pr=Vs;pr.ENTRIES=2;pr.PREV_TIME=-2;pr.PREV_VALUE=-1;pr.VALUE=1;let Rg=class Zn extends pr{constructor(t){super(t)}getPropertyId(){return(12<<24)+this.pathConstraintIndex}apply(t,e,s,r,i,o,l){const a=this.frames,c=t.pathConstraints[this.pathConstraintIndex];if(s<a[0]){switch(o){case k.setup:c.spacing=c.data.spacing;return;case k.first:c.spacing+=(c.data.spacing-c.spacing)*i}return}let h=0;if(s>=a[a.length-Zn.ENTRIES])h=a[a.length+Zn.PREV_VALUE];else{const d=Ne.binarySearch(a,s,Zn.ENTRIES);h=a[d+Zn.PREV_VALUE];const u=a[d],f=this.getCurvePercent(d/Zn.ENTRIES-1,1-(s-u)/(a[d+Zn.PREV_TIME]-u));h+=(a[d+Zn.VALUE]-h)*f}o==k.setup?c.spacing=c.data.spacing+(h-c.data.spacing)*i:c.spacing+=(h-c.spacing)*i}};const He=class extends ds{constructor(n){super(n),this.frames=$.newFloatArray(n*He.ENTRIES)}getPropertyId(){return(13<<24)+this.pathConstraintIndex}setFrame(n,t,e,s){n*=He.ENTRIES,this.frames[n]=t,this.frames[n+He.ROTATE]=e,this.frames[n+He.TRANSLATE]=s}apply(n,t,e,s,r,i,o){const l=this.frames,a=n.pathConstraints[this.pathConstraintIndex];if(e<l[0]){switch(i){case k.setup:a.rotateMix=a.data.rotateMix,a.translateMix=a.data.translateMix;return;case k.first:a.rotateMix+=(a.data.rotateMix-a.rotateMix)*r,a.translateMix+=(a.data.translateMix-a.translateMix)*r}return}let c=0,h=0;if(e>=l[l.length-He.ENTRIES])c=l[l.length+He.PREV_ROTATE],h=l[l.length+He.PREV_TRANSLATE];else{const d=Ne.binarySearch(l,e,He.ENTRIES);c=l[d+He.PREV_ROTATE],h=l[d+He.PREV_TRANSLATE];const u=l[d],f=this.getCurvePercent(d/He.ENTRIES-1,1-(e-u)/(l[d+He.PREV_TIME]-u));c+=(l[d+He.ROTATE]-c)*f,h+=(l[d+He.TRANSLATE]-h)*f}i==k.setup?(a.rotateMix=a.data.rotateMix+(c-a.data.rotateMix)*r,a.translateMix=a.data.translateMix+(h-a.data.translateMix)*r):(a.rotateMix+=(c-a.rotateMix)*r,a.translateMix+=(h-a.translateMix)*r)}};let Ln=He;Ln.ENTRIES=3;Ln.PREV_TIME=-3;Ln.PREV_ROTATE=-2;Ln.PREV_TRANSLATE=-1;Ln.ROTATE=1;Ln.TRANSLATE=2;const Be=class{constructor(t){this.tracks=new Array,this.events=new Array,this.listeners=new Array,this.queue=new od(this),this.propertyIDs=new tg,this.animationsChanged=!1,this.timeScale=1,this.trackEntryPool=new Ho(()=>new Jo),this.data=t}update(t){t*=this.timeScale;const e=this.tracks;for(let s=0,r=e.length;s<r;s++){const i=e[s];if(i==null)continue;i.animationLast=i.nextAnimationLast,i.trackLast=i.nextTrackLast;let o=t*i.timeScale;if(i.delay>0){if(i.delay-=o,i.delay>0)continue;o=-i.delay,i.delay=0}let l=i.next;if(l!=null){const a=i.trackLast-l.delay;if(a>=0){for(l.delay=0,l.trackTime=i.timeScale==0?0:(a/i.timeScale+t)*l.timeScale,i.trackTime+=o,this.setCurrent(s,l,!0);l.mixingFrom!=null;)l.mixTime+=t,l=l.mixingFrom;continue}}else if(i.trackLast>=i.trackEnd&&i.mixingFrom==null){e[s]=null,this.queue.end(i),this.disposeNext(i);continue}if(i.mixingFrom!=null&&this.updateMixingFrom(i,t)){let a=i.mixingFrom;for(i.mixingFrom=null,a!=null&&(a.mixingTo=null);a!=null;)this.queue.end(a),a=a.mixingFrom}i.trackTime+=o}this.queue.drain()}updateMixingFrom(t,e){const s=t.mixingFrom;if(s==null)return!0;const r=this.updateMixingFrom(s,e);return s.animationLast=s.nextAnimationLast,s.trackLast=s.nextTrackLast,t.mixTime>0&&t.mixTime>=t.mixDuration?((s.totalAlpha==0||t.mixDuration==0)&&(t.mixingFrom=s.mixingFrom,s.mixingFrom!=null&&(s.mixingFrom.mixingTo=t),t.interruptAlpha=s.interruptAlpha,this.queue.end(s)),r):(s.trackTime+=e*s.timeScale,t.mixTime+=e,!1)}apply(t){if(t==null)throw new Error("skeleton cannot be null.");this.animationsChanged&&this._animationsChanged();const e=this.events,s=this.tracks;let r=!1;for(let i=0,o=s.length;i<o;i++){const l=s[i];if(l==null||l.delay>0)continue;r=!0;const a=i==0?k.first:l.mixBlend;let c=l.alpha;l.mixingFrom!=null?c*=this.applyMixingFrom(l,t,a):l.trackTime>=l.trackEnd&&l.next==null&&(c=0);const h=l.animationLast,d=l.getAnimationTime(),u=l.animation.timelines.length,f=l.animation.timelines;if(i==0&&c==1||a==k.add)for(let m=0;m<u;m++)f[m].apply(t,h,d,e,c,a,It.mixIn);else{const m=l.timelineMode,p=l.timelinesRotation.length==0;p&&$.setArraySize(l.timelinesRotation,u<<1,null);const g=l.timelinesRotation;for(let w=0;w<u;w++){const x=f[w],y=m[w]==Be.SUBSEQUENT?a:k.setup;x instanceof Ke?this.applyRotateTimeline(x,t,d,c,y,g,w<<1,p):x.apply(t,h,d,e,c,y,It.mixIn)}}this.queueEvents(l,d),e.length=0,l.nextAnimationLast=d,l.nextTrackLast=l.trackTime}return this.queue.drain(),r}applyMixingFrom(t,e,s){const r=t.mixingFrom;r.mixingFrom!=null&&this.applyMixingFrom(r,e,s);let i=0;t.mixDuration==0?(i=1,s==k.first&&(s=k.setup)):(i=t.mixTime/t.mixDuration,i>1&&(i=1),s!=k.first&&(s=r.mixBlend));const o=i<r.eventThreshold?this.events:null,l=i<r.attachmentThreshold,a=i<r.drawOrderThreshold,c=r.animationLast,h=r.getAnimationTime(),d=r.animation.timelines.length,u=r.animation.timelines,f=r.alpha*t.interruptAlpha,m=f*(1-i);if(s==k.add)for(let p=0;p<d;p++)u[p].apply(e,c,h,o,m,s,It.mixOut);else{const p=r.timelineMode,g=r.timelineHoldMix,w=r.timelinesRotation.length==0;w&&$.setArraySize(r.timelinesRotation,d<<1,null);const x=r.timelinesRotation;r.totalAlpha=0;for(let y=0;y<d;y++){const b=u[y];let _=It.mixOut,E,S=0;switch(p[y]){case Be.SUBSEQUENT:if(!l&&b instanceof Co||!a&&b instanceof ko)continue;E=s,S=m;break;case Be.FIRST:E=k.setup,S=m;break;case Be.HOLD:E=k.setup,S=f;break;default:E=k.setup;const T=g[y];S=f*Math.max(0,1-T.mixTime/T.mixDuration);break}r.totalAlpha+=S,b instanceof Ke?this.applyRotateTimeline(b,e,h,S,E,x,y<<1,w):(E==k.setup&&(b instanceof Co?l&&(_=It.mixOut):b instanceof ko&&a&&(_=It.mixOut)),b.apply(e,c,h,o,S,E,_))}}return t.mixDuration>0&&this.queueEvents(r,h),this.events.length=0,r.nextAnimationLast=h,r.nextTrackLast=r.trackTime,i}applyRotateTimeline(t,e,s,r,i,o,l,a){if(a&&(o[l]=0),r==1){t.apply(e,0,s,null,1,i,It.mixIn);return}const c=t,h=c.frames,d=e.bones[c.boneIndex];let u=0,f=0;if(s<h[0])switch(i){case k.setup:d.rotation=d.data.rotation;default:return;case k.first:u=d.rotation,f=d.data.rotation}else if(u=i==k.setup?d.data.rotation:d.rotation,s>=h[h.length-Ke.ENTRIES])f=d.data.rotation+h[h.length+Ke.PREV_ROTATION];else{const g=Ne.binarySearch(h,s,Ke.ENTRIES),w=h[g+Ke.PREV_ROTATION],x=h[g],y=c.getCurvePercent((g>>1)-1,1-(s-x)/(h[g+Ke.PREV_TIME]-x));f=h[g+Ke.ROTATION]-w,f-=(16384-(16384.499999999996-f/360|0))*360,f=w+f*y+d.data.rotation,f-=(16384-(16384.499999999996-f/360|0))*360}let m=0,p=f-u;if(p-=(16384-(16384.499999999996-p/360|0))*360,p==0)m=o[l];else{let g=0,w=0;a?(g=0,w=p):(g=o[l],w=o[l+1]);const x=p>0;let y=g>=0;P.signum(w)!=P.signum(p)&&Math.abs(w)<=90&&(Math.abs(g)>180&&(g+=360*P.signum(g)),y=x),m=p+g-g%360,y!=x&&(m+=360*P.signum(g)),o[l]=m}o[l+1]=p,u+=m*r,d.rotation=u-(16384-(16384.499999999996-u/360|0))*360}queueEvents(t,e){const s=t.animationStart,r=t.animationEnd,i=r-s,o=t.trackLast%i,l=this.events;let a=0;const c=l.length;for(;a<c;a++){const d=l[a];if(d.time<o)break;d.time>r||this.queue.event(t,d)}let h=!1;for(t.loop?h=i==0||o>t.trackTime%i:h=e>=r&&t.animationLast<r,h&&this.queue.complete(t);a<c;a++)l[a].time<s||this.queue.event(t,l[a])}clearTracks(){const t=this.queue.drainDisabled;this.queue.drainDisabled=!0;for(let e=0,s=this.tracks.length;e<s;e++)this.clearTrack(e);this.tracks.length=0,this.queue.drainDisabled=t,this.queue.drain()}clearTrack(t){if(t>=this.tracks.length)return;const e=this.tracks[t];if(e==null)return;this.queue.end(e),this.disposeNext(e);let s=e;for(;;){const r=s.mixingFrom;if(r==null)break;this.queue.end(r),s.mixingFrom=null,s.mixingTo=null,s=r}this.tracks[e.trackIndex]=null,this.queue.drain()}setCurrent(t,e,s){const r=this.expandToIndex(t);this.tracks[t]=e,r!=null&&(s&&this.queue.interrupt(r),e.mixingFrom=r,r.mixingTo=e,e.mixTime=0,r.mixingFrom!=null&&r.mixDuration>0&&(e.interruptAlpha*=Math.min(1,r.mixTime/r.mixDuration)),r.timelinesRotation.length=0),this.queue.start(e)}setAnimation(t,e,s){const r=this.data.skeletonData.findAnimation(e);if(r==null)throw new Error(`Animation not found: ${e}`);return this.setAnimationWith(t,r,s)}setAnimationWith(t,e,s){if(e==null)throw new Error("animation cannot be null.");let r=!0,i=this.expandToIndex(t);i!=null&&(i.nextTrackLast==-1?(this.tracks[t]=i.mixingFrom,this.queue.interrupt(i),this.queue.end(i),this.disposeNext(i),i=i.mixingFrom,r=!1):this.disposeNext(i));const o=this.trackEntry(t,e,s,i);return this.setCurrent(t,o,r),this.queue.drain(),o}addAnimation(t,e,s,r){const i=this.data.skeletonData.findAnimation(e);if(i==null)throw new Error(`Animation not found: ${e}`);return this.addAnimationWith(t,i,s,r)}addAnimationWith(t,e,s,r){if(e==null)throw new Error("animation cannot be null.");let i=this.expandToIndex(t);if(i!=null)for(;i.next!=null;)i=i.next;const o=this.trackEntry(t,e,s,i);if(i==null)this.setCurrent(t,o,!0),this.queue.drain();else if(i.next=o,r<=0){const l=i.animationEnd-i.animationStart;l!=0?(i.loop?r+=l*(1+(i.trackTime/l|0)):r+=Math.max(l,i.trackTime),r-=this.data.getMix(i.animation,e)):r=i.trackTime}return o.delay=r,o}setEmptyAnimation(t,e){const s=this.setAnimationWith(t,Be.emptyAnimation,!1);return s.mixDuration=e,s.trackEnd=e,s}addEmptyAnimation(t,e,s){s<=0&&(s-=e);const r=this.addAnimationWith(t,Be.emptyAnimation,!1,s);return r.mixDuration=e,r.trackEnd=e,r}setEmptyAnimations(t){const e=this.queue.drainDisabled;this.queue.drainDisabled=!0;for(let s=0,r=this.tracks.length;s<r;s++){const i=this.tracks[s];i!=null&&this.setEmptyAnimation(i.trackIndex,t)}this.queue.drainDisabled=e,this.queue.drain()}expandToIndex(t){return t<this.tracks.length?this.tracks[t]:($.ensureArrayCapacity(this.tracks,t-this.tracks.length+1,null),this.tracks.length=t+1,null)}trackEntry(t,e,s,r){const i=this.trackEntryPool.obtain();return i.trackIndex=t,i.animation=e,i.loop=s,i.holdPrevious=!1,i.eventThreshold=0,i.attachmentThreshold=0,i.drawOrderThreshold=0,i.animationStart=0,i.animationEnd=e.duration,i.animationLast=-1,i.nextAnimationLast=-1,i.delay=0,i.trackTime=0,i.trackLast=-1,i.nextTrackLast=-1,i.trackEnd=Number.MAX_VALUE,i.timeScale=1,i.alpha=1,i.interruptAlpha=1,i.mixTime=0,i.mixDuration=r==null?0:this.data.getMix(r.animation,e),i}disposeNext(t){let e=t.next;for(;e!=null;)this.queue.dispose(e),e=e.next;t.next=null}_animationsChanged(){this.animationsChanged=!1,this.propertyIDs.clear();for(let t=0,e=this.tracks.length;t<e;t++){let s=this.tracks[t];if(s!=null){for(;s.mixingFrom!=null;)s=s.mixingFrom;do(s.mixingFrom==null||s.mixBlend!=k.add)&&this.setTimelineModes(s),s=s.mixingTo;while(s!=null)}}}setTimelineModes(t){const e=t.mixingTo,s=t.animation.timelines,r=t.animation.timelines.length,i=$.setArraySize(t.timelineMode,r);t.timelineHoldMix.length=0;const o=$.setArraySize(t.timelineHoldMix,r),l=this.propertyIDs;if(e!=null&&e.holdPrevious){for(let a=0;a<r;a++)l.add(s[a].getPropertyId()),i[a]=Be.HOLD;return}t:for(let a=0;a<r;a++){const c=s[a].getPropertyId();if(!l.add(c))i[a]=Be.SUBSEQUENT;else if(e==null||!this.hasTimeline(e,c))i[a]=Be.FIRST;else{for(let h=e.mixingTo;h!=null;h=h.mixingTo)if(!this.hasTimeline(h,c)){if(t.mixDuration>0){i[a]=Be.HOLD_MIX,o[a]=h;continue t}break}i[a]=Be.HOLD}}}hasTimeline(t,e){const s=t.animation.timelines;for(let r=0,i=s.length;r<i;r++)if(s[r].getPropertyId()==e)return!0;return!1}getCurrent(t){return t>=this.tracks.length?null:this.tracks[t]}addListener(t){if(t==null)throw new Error("listener cannot be null.");this.listeners.push(t)}removeListener(t){const e=this.listeners.indexOf(t);e>=0&&this.listeners.splice(e,1)}clearListeners(){this.listeners.length=0}clearListenerNotifications(){this.queue.clear()}setAnimationByName(t,e,s){Be.deprecatedWarning1||(Be.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: AnimationState.setAnimationByName is deprecated, please use setAnimation from now on.")),this.setAnimation(t,e,s)}addAnimationByName(t,e,s,r){Be.deprecatedWarning2||(Be.deprecatedWarning2=!0,console.warn("Spine Deprecation Warning: AnimationState.addAnimationByName is deprecated, please use addAnimation from now on.")),this.addAnimation(t,e,s,r)}hasAnimation(t){return this.data.skeletonData.findAnimation(t)!==null}hasAnimationByName(t){return Be.deprecatedWarning3||(Be.deprecatedWarning3=!0,console.warn("Spine Deprecation Warning: AnimationState.hasAnimationByName is deprecated, please use hasAnimation from now on.")),this.hasAnimation(t)}};let wn=Be;wn.emptyAnimation=new Ne("<empty>",[],0);wn.SUBSEQUENT=0;wn.FIRST=1;wn.HOLD=2;wn.HOLD_MIX=3;wn.deprecatedWarning1=!1;wn.deprecatedWarning2=!1;wn.deprecatedWarning3=!1;const Tn=class{constructor(){this.mixBlend=k.replace,this.timelineMode=new Array,this.timelineHoldMix=new Array,this.timelinesRotation=new Array}reset(){this.next=null,this.mixingFrom=null,this.mixingTo=null,this.animation=null,this.listener=null,this.timelineMode.length=0,this.timelineHoldMix.length=0,this.timelinesRotation.length=0}getAnimationTime(){if(this.loop){const t=this.animationEnd-this.animationStart;return t==0?this.animationStart:this.trackTime%t+this.animationStart}return Math.min(this.trackTime+this.animationStart,this.animationEnd)}setAnimationLast(t){this.animationLast=t,this.nextAnimationLast=t}isComplete(){return this.trackTime>=this.animationEnd-this.animationStart}resetRotationDirections(){this.timelinesRotation.length=0}get time(){return Tn.deprecatedWarning1||(Tn.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: TrackEntry.time is deprecated, please use trackTime from now on.")),this.trackTime}set time(t){Tn.deprecatedWarning1||(Tn.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: TrackEntry.time is deprecated, please use trackTime from now on.")),this.trackTime=t}get endTime(){return Tn.deprecatedWarning2||(Tn.deprecatedWarning2=!0,console.warn("Spine Deprecation Warning: TrackEntry.endTime is deprecated, please use trackEnd from now on.")),this.trackTime}set endTime(t){Tn.deprecatedWarning2||(Tn.deprecatedWarning2=!0,console.warn("Spine Deprecation Warning: TrackEntry.endTime is deprecated, please use trackEnd from now on.")),this.trackTime=t}loopsCount(){return Math.floor(this.trackTime/this.trackEnd)}};let Jo=Tn;Jo.deprecatedWarning1=!1;Jo.deprecatedWarning2=!1;const ih=class{constructor(n){this.objects=[],this.drainDisabled=!1,this.animState=n}start(n){this.objects.push(is.start),this.objects.push(n),this.animState.animationsChanged=!0}interrupt(n){this.objects.push(is.interrupt),this.objects.push(n)}end(n){this.objects.push(is.end),this.objects.push(n),this.animState.animationsChanged=!0}dispose(n){this.objects.push(is.dispose),this.objects.push(n)}complete(n){this.objects.push(is.complete),this.objects.push(n)}event(n,t){this.objects.push(is.event),this.objects.push(n),this.objects.push(t)}deprecateStuff(){return ih.deprecatedWarning1||(ih.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: onComplete, onStart, onEnd, onEvent art deprecated, please use listeners from now on. 'state.addListener({ complete: function(track, event) { } })'")),!0}drain(){if(this.drainDisabled)return;this.drainDisabled=!0;const n=this.objects,t=this.animState.listeners;for(let e=0;e<n.length;e+=2){const s=n[e],r=n[e+1];switch(s){case is.start:r.listener!=null&&r.listener.start&&r.listener.start(r);for(let l=0;l<t.length;l++)t[l].start&&t[l].start(r);r.onStart&&this.deprecateStuff()&&r.onStart(r.trackIndex),this.animState.onStart&&this.deprecateStuff()&&this.deprecateStuff&&this.animState.onStart(r.trackIndex);break;case is.interrupt:r.listener!=null&&r.listener.interrupt&&r.listener.interrupt(r);for(let l=0;l<t.length;l++)t[l].interrupt&&t[l].interrupt(r);break;case is.end:r.listener!=null&&r.listener.end&&r.listener.end(r);for(let l=0;l<t.length;l++)t[l].end&&t[l].end(r);r.onEnd&&this.deprecateStuff()&&r.onEnd(r.trackIndex),this.animState.onEnd&&this.deprecateStuff()&&this.animState.onEnd(r.trackIndex);case is.dispose:r.listener!=null&&r.listener.dispose&&r.listener.dispose(r);for(let l=0;l<t.length;l++)t[l].dispose&&t[l].dispose(r);this.animState.trackEntryPool.free(r);break;case is.complete:r.listener!=null&&r.listener.complete&&r.listener.complete(r);for(let l=0;l<t.length;l++)t[l].complete&&t[l].complete(r);const i=P.toInt(r.loopsCount());r.onComplete&&this.deprecateStuff()&&r.onComplete(r.trackIndex,i),this.animState.onComplete&&this.deprecateStuff()&&this.animState.onComplete(r.trackIndex,i);break;case is.event:const o=n[e+++2];r.listener!=null&&r.listener.event&&r.listener.event(r,o);for(let l=0;l<t.length;l++)t[l].event&&t[l].event(r,o);r.onEvent&&this.deprecateStuff()&&r.onEvent(r.trackIndex,o),this.animState.onEvent&&this.deprecateStuff()&&this.animState.onEvent(r.trackIndex,o);break}}this.clear(),this.drainDisabled=!1}clear(){this.objects.length=0}};let od=ih;od.deprecatedWarning1=!1;var is=(n=>(n[n.start=0]="start",n[n.interrupt=1]="interrupt",n[n.end=2]="end",n[n.dispose=3]="dispose",n[n.complete=4]="complete",n[n.event=5]="event",n))(is||{});class iS{start(t){}interrupt(t){}end(t){}dispose(t){}complete(t){}event(t,e){}}const ah=class{constructor(n){if(this.animationToMixTime={},this.defaultMix=0,n==null)throw new Error("skeletonData cannot be null.");this.skeletonData=n}setMix(n,t,e){const s=this.skeletonData.findAnimation(n);if(s==null)throw new Error(`Animation not found: ${n}`);const r=this.skeletonData.findAnimation(t);if(r==null)throw new Error(`Animation not found: ${t}`);this.setMixWith(s,r,e)}setMixByName(n,t,e){ah.deprecatedWarning1||(ah.deprecatedWarning1=!0,console.warn("Deprecation Warning: AnimationStateData.setMixByName is deprecated, please use setMix from now on.")),this.setMix(n,t,e)}setMixWith(n,t,e){if(n==null)throw new Error("from cannot be null.");if(t==null)throw new Error("to cannot be null.");const s=`${n.name}.${t.name}`;this.animationToMixTime[s]=e}getMix(n,t){const e=`${n.name}.${t.name}`,s=this.animationToMixTime[e];return s===void 0?this.defaultMix:s}};let ld=ah;ld.deprecatedWarning1=!1;let Mg=class{constructor(t){this.atlas=t}newRegionAttachment(t,e,s){const r=this.atlas.findRegion(s);if(r==null)throw new Error(`Region not found in atlas: ${s} (region attachment: ${e})`);const i=new At(e);return i.region=r,i}newMeshAttachment(t,e,s){const r=this.atlas.findRegion(s);if(r==null)throw new Error(`Region not found in atlas: ${s} (mesh attachment: ${e})`);const i=new id(e);return i.region=r,i}newBoundingBoxAttachment(t,e){return new wg(e)}newPathAttachment(t,e){return new ca(e)}newPointAttachment(t,e){return new _g(e)}newClippingAttachment(t,e){return new vg(e)}},oh=class{constructor(t,e,s){if(this.matrix=new Zt,this.children=new Array,this.x=0,this.y=0,this.rotation=0,this.scaleX=0,this.scaleY=0,this.shearX=0,this.shearY=0,this.ax=0,this.ay=0,this.arotation=0,this.ascaleX=0,this.ascaleY=0,this.ashearX=0,this.ashearY=0,this.appliedValid=!1,this.sorted=!1,this.active=!0,t==null)throw new Error("data cannot be null.");if(e==null)throw new Error("skeleton cannot be null.");this.data=t,this.skeleton=e,this.parent=s,this.setToSetupPose()}get worldX(){return this.matrix.tx}get worldY(){return this.matrix.ty}update(){this.updateWorldTransformWith(this.x,this.y,this.rotation,this.scaleX,this.scaleY,this.shearX,this.shearY)}updateWorldTransform(){this.updateWorldTransformWith(this.x,this.y,this.rotation,this.scaleX,this.scaleY,this.shearX,this.shearY)}updateWorldTransformWith(t,e,s,r,i,o,l){this.ax=t,this.ay=e,this.arotation=s,this.ascaleX=r,this.ascaleY=i,this.ashearX=o,this.ashearY=l,this.appliedValid=!0;const a=this.parent,c=this.matrix,h=this.skeleton.scaleX,d=-this.skeleton.scaleY;if(a==null){const g=this.skeleton,w=s+90+l;c.a=P.cosDeg(s+o)*r*h,c.c=P.cosDeg(w)*i*h,c.b=P.sinDeg(s+o)*r*d,c.d=P.sinDeg(w)*i*d,c.tx=t*h+g.x,c.ty=e*d+g.y;return}let u=a.matrix.a,f=a.matrix.c,m=a.matrix.b,p=a.matrix.d;switch(c.tx=u*t+f*e+a.matrix.tx,c.ty=m*t+p*e+a.matrix.ty,this.data.transformMode){case wt.Normal:{const g=s+90+l,w=P.cosDeg(s+o)*r,x=P.cosDeg(g)*i,y=P.sinDeg(s+o)*r,b=P.sinDeg(g)*i;c.a=u*w+f*y,c.c=u*x+f*b,c.b=m*w+p*y,c.d=m*x+p*b;return}case wt.OnlyTranslation:{const g=s+90+l;c.a=P.cosDeg(s+o)*r,c.c=P.cosDeg(g)*i,c.b=P.sinDeg(s+o)*r,c.d=P.sinDeg(g)*i;break}case wt.NoRotationOrReflection:{let g=u*u+m*m,w=0;g>1e-4?(g=Math.abs(u*p-f*m)/g,f=m*g,p=u*g,w=Math.atan2(m,u)*P.radDeg):(u=0,m=0,w=90-Math.atan2(p,f)*P.radDeg);const x=s+o-w,y=s+l-w+90,b=P.cosDeg(x)*r,_=P.cosDeg(y)*i,E=P.sinDeg(x)*r,S=P.sinDeg(y)*i;c.a=u*b-f*E,c.c=u*_-f*S,c.b=m*b+p*E,c.d=m*_+p*S;break}case wt.NoScale:case wt.NoScaleOrReflection:{const g=P.cosDeg(s),w=P.sinDeg(s);let x=(u*g+f*w)/h,y=(m*g+p*w)/d,b=Math.sqrt(x*x+y*y);b>1e-5&&(b=1/b),x*=b,y*=b,b=Math.sqrt(x*x+y*y),this.data.transformMode==wt.NoScale&&u*p-f*m<0!=(this.skeleton.scaleX<0!=this.skeleton.scaleY>0)&&(b=-b);const _=Math.PI/2+Math.atan2(y,x),E=Math.cos(_)*b,S=Math.sin(_)*b,T=P.cosDeg(o)*r,C=P.cosDeg(90+l)*i,A=P.sinDeg(o)*r,R=P.sinDeg(90+l)*i;c.a=x*T+E*A,c.c=x*C+E*R,c.b=y*T+S*A,c.d=y*C+S*R;break}}c.a*=h,c.c*=h,c.b*=d,c.d*=d}setToSetupPose(){const t=this.data;this.x=t.x,this.y=t.y,this.rotation=t.rotation,this.scaleX=t.scaleX,this.scaleY=t.scaleY,this.shearX=t.shearX,this.shearY=t.shearY}getWorldRotationX(){return Math.atan2(this.matrix.b,this.matrix.a)*P.radDeg}getWorldRotationY(){return Math.atan2(this.matrix.d,this.matrix.c)*P.radDeg}getWorldScaleX(){const t=this.matrix;return Math.sqrt(t.a*t.a+t.c*t.c)}getWorldScaleY(){const t=this.matrix;return Math.sqrt(t.b*t.b+t.d*t.d)}updateAppliedTransform(){this.appliedValid=!0;const t=this.parent,e=this.matrix;if(t==null){this.ax=e.tx,this.ay=e.ty,this.arotation=Math.atan2(e.b,e.a)*P.radDeg,this.ascaleX=Math.sqrt(e.a*e.a+e.b*e.b),this.ascaleY=Math.sqrt(e.c*e.c+e.d*e.d),this.ashearX=0,this.ashearY=Math.atan2(e.a*e.c+e.b*e.d,e.a*e.d-e.b*e.c)*P.radDeg;return}const s=t.matrix,r=1/(s.a*s.d-s.b*s.c),i=e.tx-s.tx,o=e.ty-s.ty;this.ax=i*s.d*r-o*s.c*r,this.ay=o*s.a*r-i*s.b*r;const l=r*s.d,a=r*s.a,c=r*s.c,h=r*s.b,d=l*e.a-c*e.b,u=l*e.c-c*e.d,f=a*e.b-h*e.a,m=a*e.d-h*e.c;if(this.ashearX=0,this.ascaleX=Math.sqrt(d*d+f*f),this.ascaleX>1e-4){const p=d*m-u*f;this.ascaleY=p/this.ascaleX,this.ashearY=Math.atan2(d*u+f*m,p)*P.radDeg,this.arotation=Math.atan2(f,d)*P.radDeg}else this.ascaleX=0,this.ascaleY=Math.sqrt(u*u+m*m),this.ashearY=0,this.arotation=90-Math.atan2(m,u)*P.radDeg}worldToLocal(t){const e=this.matrix,s=e.a,r=e.c,i=e.b,o=e.d,l=1/(s*o-r*i),a=t.x-e.tx,c=t.y-e.ty;return t.x=a*o*l-c*r*l,t.y=c*s*l-a*i*l,t}localToWorld(t){const e=this.matrix,s=t.x,r=t.y;return t.x=s*e.a+r*e.c+e.tx,t.y=s*e.b+r*e.d+e.ty,t}worldToLocalRotation(t){const e=P.sinDeg(t),s=P.cosDeg(t),r=this.matrix;return Math.atan2(r.a*e-r.b*s,r.d*s-r.c*e)*P.radDeg}localToWorldRotation(t){const e=P.sinDeg(t),s=P.cosDeg(t),r=this.matrix;return Math.atan2(s*r.b+e*r.d,s*r.a+e*r.c)*P.radDeg}rotateWorld(t){const e=this.matrix,s=e.a,r=e.c,i=e.b,o=e.d,l=P.cosDeg(t),a=P.sinDeg(t);e.a=l*s-a*i,e.c=l*r-a*o,e.b=a*s+l*i,e.d=a*r+l*o,this.appliedValid=!1}},Pg=class{constructor(t,e,s){if(this.x=0,this.y=0,this.rotation=0,this.scaleX=1,this.scaleY=1,this.shearX=0,this.shearY=0,this.transformMode=wt.Normal,t<0)throw new Error("index must be >= 0.");if(e==null)throw new Error("name cannot be null.");this.index=t,this.name=e,this.parent=s}},Ng=class{constructor(t,e){if(e==null)throw new Error("data cannot be null.");this.time=t,this.data=e}},Fg=class{constructor(t){this.name=t}},Dg=class{constructor(t,e){if(this.bendDirection=0,this.compress=!1,this.stretch=!1,this.mix=1,t==null)throw new Error("data cannot be null.");if(e==null)throw new Error("skeleton cannot be null.");this.data=t,this.mix=t.mix,this.bendDirection=t.bendDirection,this.compress=t.compress,this.stretch=t.stretch,this.bones=new Array;for(let s=0;s<t.bones.length;s++)this.bones.push(e.findBone(t.bones[s].name));this.target=e.findBone(t.target.name)}getOrder(){return this.data.order}apply(){this.update()}update(){const t=this.target,e=this.bones;switch(e.length){case 1:this.apply1(e[0],t.worldX,t.worldY,this.compress,this.stretch,this.data.uniform,this.mix);break;case 2:this.apply2(e[0],e[1],t.worldX,t.worldY,this.bendDirection,this.stretch,this.mix);break}}apply1(t,e,s,r,i,o,l){t.appliedValid||t.updateAppliedTransform();const a=t.parent.matrix,c=1/(a.a*a.d-a.b*a.c),h=e-a.tx,d=s-a.ty,u=(h*a.d-d*a.c)*c-t.ax,f=(d*a.a-h*a.b)*c-t.ay;let m=Math.atan2(f,u)*P.radDeg-t.ashearX-t.arotation;t.ascaleX<0&&(m+=180),m>180?m-=360:m<-180&&(m+=360);let p=t.ascaleX,g=t.ascaleY;if(r||i){const w=t.data.length*p,x=Math.sqrt(u*u+f*f);if(r&&x<w||i&&x>w&&w>1e-4){const y=(x/w-1)*l+1;p*=y,o&&(g*=y)}}t.updateWorldTransformWith(t.ax,t.ay,t.arotation+m*l,p,g,t.ashearX,t.ashearY)}apply2(t,e,s,r,i,o,l){if(l==0){e.updateWorldTransform();return}t.appliedValid||t.updateAppliedTransform(),e.appliedValid||e.updateAppliedTransform();const a=t.ax,c=t.ay;let h=t.ascaleX,d=h,u=t.ascaleY,f=e.ascaleX;const m=t.matrix;let p=0,g=0,w=0;h<0?(h=-h,p=180,w=-1):(p=0,w=1),u<0&&(u=-u,w=-w),f<0?(f=-f,g=180):g=0;const x=e.ax;let y=0,b=0,_=0,E=m.a,S=m.c,T=m.b,C=m.d;const A=Math.abs(h-u)<=1e-4;A?(y=e.ay,b=E*x+S*y+m.tx,_=T*x+C*y+m.ty):(y=0,b=E*x+m.tx,_=T*x+m.ty);const R=t.parent.matrix;E=R.a,S=R.c,T=R.b,C=R.d;const M=1/(E*C-S*T);let I=s-R.tx,N=r-R.ty;const F=(I*C-N*S)*M-a,B=(N*E-I*T)*M-c,Y=F*F+B*B;I=b-R.tx,N=_-R.ty;const O=(I*C-N*S)*M-a,V=(N*E-I*T)*M-c,j=Math.sqrt(O*O+V*V);let X=e.data.length*f,L=0,U=0;t:if(A){X*=h;let J=(Y-j*j-X*X)/(2*j*X);J<-1?J=-1:J>1&&(J=1,o&&j+X>1e-4&&(d*=(Math.sqrt(Y)/(j+X)-1)*l+1)),U=Math.acos(J)*i,E=j+X*J,S=X*Math.sin(U),L=Math.atan2(B*E-F*S,F*E+B*S)}else{E=h*X,S=u*X;const J=E*E,Q=S*S,W=Math.atan2(B,F);T=Q*j*j+J*Y-J*Q;const K=-2*Q*j,Z=Q-J;if(C=K*K-4*Z*T,C>=0){let se=Math.sqrt(C);K<0&&(se=-se),se=-(K+se)/2;const ie=se/Z,Qt=T/se,Jt=Math.abs(ie)<Math.abs(Qt)?ie:Qt;if(Jt*Jt<=Y){N=Math.sqrt(Y-Jt*Jt)*i,L=W-Math.atan2(N,Jt),U=Math.atan2(N/u,(Jt-j)/h);break t}}let nt=P.PI,gt=j-E,rt=gt*gt,bt=0,Ct=0,jt=j+E,kt=jt*jt,ee=0;T=-E*j/(J-Q),T>=-1&&T<=1&&(T=Math.acos(T),I=E*Math.cos(T)+j,N=S*Math.sin(T),C=I*I+N*N,C<rt&&(nt=T,rt=C,gt=I,bt=N),C>kt&&(Ct=T,kt=C,jt=I,ee=N)),Y<=(rt+kt)/2?(L=W-Math.atan2(bt*i,gt),U=nt*i):(L=W-Math.atan2(ee*i,jt),U=Ct*i)}const q=Math.atan2(y,x)*w;let H=t.arotation;L=(L-q)*P.radDeg+p-H,L>180?L-=360:L<-180&&(L+=360),t.updateWorldTransformWith(a,c,H+L*l,d,t.ascaleY,0,0),H=e.arotation,U=((U+q)*P.radDeg-e.ashearX)*w+g-H,U>180?U-=360:U<-180&&(U+=360),e.updateWorldTransformWith(x,y,H+U*l,e.ascaleX,e.ascaleY,e.ashearX,e.ashearY)}},Bg=class{constructor(t){this.order=0,this.bones=new Array,this.bendDirection=1,this.compress=!1,this.stretch=!1,this.uniform=!1,this.mix=1,this.name=t}},Lg=class{constructor(t){this.order=0,this.bones=new Array,this.name=t}};var Gs=(n=>(n[n.Length=0]="Length",n[n.Fixed=1]="Fixed",n[n.Percent=2]="Percent",n))(Gs||{});const Ir=class{constructor(t,e){if(this.position=0,this.spacing=0,this.rotateMix=0,this.translateMix=0,this.spaces=new Array,this.positions=new Array,this.world=new Array,this.curves=new Array,this.lengths=new Array,this.segments=new Array,t==null)throw new Error("data cannot be null.");if(e==null)throw new Error("skeleton cannot be null.");this.data=t,this.bones=new Array;for(let s=0,r=t.bones.length;s<r;s++)this.bones.push(e.findBone(t.bones[s].name));this.target=e.findSlot(t.target.name),this.position=t.position,this.spacing=t.spacing,this.rotateMix=t.rotateMix,this.translateMix=t.translateMix}apply(){this.update()}update(){const t=this.target.getAttachment();if(!(t instanceof ca))return;const e=this.rotateMix,s=this.translateMix,r=s>0,i=e>0;if(!r&&!i)return;const o=this.data,l=o.spacingMode,a=l==Gs.Length,c=o.rotateMode,h=c==_e.Tangent,d=c==_e.ChainScale,u=this.bones.length,f=h?u:u+1,m=this.bones,p=$.setArraySize(this.spaces,f);let g=null;const w=this.spacing;if(d||a){d&&(g=$.setArraySize(this.lengths,u));for(let S=0,T=f-1;S<T;){const C=m[S],A=C.data.length;if(A<Ir.epsilon)d&&(g[S]=0),p[++S]=0;else{const R=A*C.matrix.a,M=A*C.matrix.b,I=Math.sqrt(R*R+M*M);d&&(g[S]=I),p[++S]=(a?A+w:w)*I/A}}}else for(let S=1;S<f;S++)p[S]=w;const x=this.computeWorldPositions(t,f,h,o.positionMode==me.Percent,l==Gs.Percent);let y=x[0],b=x[1],_=o.offsetRotation,E=!1;if(_==0)E=c==_e.Chain;else{E=!1;const S=this.target.bone.matrix;_*=S.a*S.d-S.b*S.c>0?P.degRad:-P.degRad}for(let S=0,T=3;S<u;S++,T+=3){const C=m[S],A=C.matrix;A.tx+=(y-A.tx)*s,A.ty+=(b-A.ty)*s;const R=x[T],M=x[T+1],I=R-y,N=M-b;if(d){const F=g[S];if(F!=0){const B=(Math.sqrt(I*I+N*N)/F-1)*e+1;A.a*=B,A.b*=B}}if(y=R,b=M,i){const F=A.a,B=A.c,Y=A.b,O=A.d;let V=0,j=0,X=0;if(h&&(h?V=x[T-1]:p[S+1]==0?V=x[T+2]:V=Math.atan2(N,I)),V-=Math.atan2(Y,F),E){j=Math.cos(V),X=Math.sin(V);const L=C.data.length;y+=(L*(j*F-X*Y)-I)*e,b+=(L*(X*F+j*Y)-N)*e}else V+=_;V>P.PI?V-=P.PI2:V<-P.PI&&(V+=P.PI2),V*=e,j=Math.cos(V),X=Math.sin(V),A.a=j*F-X*Y,A.c=j*B-X*O,A.b=X*F+j*Y,A.d=X*B+j*O}C.appliedValid=!1}}computeWorldPositions(t,e,s,r,i){const o=this.target;let l=this.position;const a=this.spaces,c=$.setArraySize(this.positions,e*3+2);let h=null;const d=t.closed;let u=t.worldVerticesLength,f=u/6,m=Ir.NONE;if(!t.constantSpeed){const V=t.lengths;f-=d?1:2;const j=V[f];if(r&&(l*=j),i)for(let X=0;X<e;X++)a[X]*=j;h=$.setArraySize(this.world,8);for(let X=0,L=0,U=0;X<e;X++,L+=3){const q=a[X];l+=q;let H=l;if(d)H%=j,H<0&&(H+=j),U=0;else if(H<0){m!=Ir.BEFORE&&(m=Ir.BEFORE,t.computeWorldVertices(o,2,4,h,0,2)),this.addBeforePosition(H,h,0,c,L);continue}else if(H>j){m!=Ir.AFTER&&(m=Ir.AFTER,t.computeWorldVertices(o,u-6,4,h,0,2)),this.addAfterPosition(H-j,h,0,c,L);continue}for(;;U++){const J=V[U];if(!(H>J)){if(U==0)H/=J;else{const Q=V[U-1];H=(H-Q)/(J-Q)}break}}U!=m&&(m=U,d&&U==f?(t.computeWorldVertices(o,u-4,4,h,0,2),t.computeWorldVertices(o,0,4,h,4,2)):t.computeWorldVertices(o,U*6+2,8,h,0,2)),this.addCurvePosition(H,h[0],h[1],h[2],h[3],h[4],h[5],h[6],h[7],c,L,s||X>0&&q==0)}return c}d?(u+=2,h=$.setArraySize(this.world,u),t.computeWorldVertices(o,2,u-4,h,0,2),t.computeWorldVertices(o,0,2,h,u-4,2),h[u-2]=h[0],h[u-1]=h[1]):(f--,u-=4,h=$.setArraySize(this.world,u),t.computeWorldVertices(o,2,u,h,0,2));const p=$.setArraySize(this.curves,f);let g=0,w=h[0],x=h[1],y=0,b=0,_=0,E=0,S=0,T=0,C=0,A=0,R=0,M=0,I=0,N=0,F=0,B=0;for(let V=0,j=2;V<f;V++,j+=6)y=h[j],b=h[j+1],_=h[j+2],E=h[j+3],S=h[j+4],T=h[j+5],C=(w-y*2+_)*.1875,A=(x-b*2+E)*.1875,R=((y-_)*3-w+S)*.09375,M=((b-E)*3-x+T)*.09375,I=C*2+R,N=A*2+M,F=(y-w)*.75+C+R*.16666667,B=(b-x)*.75+A+M*.16666667,g+=Math.sqrt(F*F+B*B),F+=I,B+=N,I+=R,N+=M,g+=Math.sqrt(F*F+B*B),F+=I,B+=N,g+=Math.sqrt(F*F+B*B),F+=I+R,B+=N+M,g+=Math.sqrt(F*F+B*B),p[V]=g,w=S,x=T;if(r&&(l*=g),i)for(let V=0;V<e;V++)a[V]*=g;const Y=this.segments;let O=0;for(let V=0,j=0,X=0,L=0;V<e;V++,j+=3){const U=a[V];l+=U;let q=l;if(d)q%=g,q<0&&(q+=g),X=0;else if(q<0){this.addBeforePosition(q,h,0,c,j);continue}else if(q>g){this.addAfterPosition(q-g,h,u-4,c,j);continue}for(;;X++){const H=p[X];if(!(q>H)){if(X==0)q/=H;else{const J=p[X-1];q=(q-J)/(H-J)}break}}if(X!=m){m=X;let H=X*6;for(w=h[H],x=h[H+1],y=h[H+2],b=h[H+3],_=h[H+4],E=h[H+5],S=h[H+6],T=h[H+7],C=(w-y*2+_)*.03,A=(x-b*2+E)*.03,R=((y-_)*3-w+S)*.006,M=((b-E)*3-x+T)*.006,I=C*2+R,N=A*2+M,F=(y-w)*.3+C+R*.16666667,B=(b-x)*.3+A+M*.16666667,O=Math.sqrt(F*F+B*B),Y[0]=O,H=1;H<8;H++)F+=I,B+=N,I+=R,N+=M,O+=Math.sqrt(F*F+B*B),Y[H]=O;F+=I,B+=N,O+=Math.sqrt(F*F+B*B),Y[8]=O,F+=I+R,B+=N+M,O+=Math.sqrt(F*F+B*B),Y[9]=O,L=0}for(q*=O;;L++){const H=Y[L];if(!(q>H)){if(L==0)q/=H;else{const J=Y[L-1];q=L+(q-J)/(H-J)}break}}this.addCurvePosition(q*.1,w,x,y,b,_,E,S,T,c,j,s||V>0&&U==0)}return c}addBeforePosition(t,e,s,r,i){const o=e[s],l=e[s+1],a=e[s+2]-o,c=e[s+3]-l,h=Math.atan2(c,a);r[i]=o+t*Math.cos(h),r[i+1]=l+t*Math.sin(h),r[i+2]=h}addAfterPosition(t,e,s,r,i){const o=e[s+2],l=e[s+3],a=o-e[s],c=l-e[s+1],h=Math.atan2(c,a);r[i]=o+t*Math.cos(h),r[i+1]=l+t*Math.sin(h),r[i+2]=h}addCurvePosition(t,e,s,r,i,o,l,a,c,h,d,u){(t==0||isNaN(t))&&(t=1e-4);const f=t*t,m=f*t,p=1-t,g=p*p,w=g*p,x=p*t,y=x*3,b=p*y,_=y*t,E=e*w+r*b+o*_+a*m,S=s*w+i*b+l*_+c*m;h[d]=E,h[d+1]=S,u&&(h[d+2]=Math.atan2(S-(s*g+i*x*2+l*f),E-(e*g+r*x*2+o*f)))}getOrder(){return this.data.order}};let Si=Ir;Si.NONE=-1;Si.BEFORE=-2;Si.AFTER=-3;Si.epsilon=1e-5;let Og=class{constructor(t,e){if(this.rotateMix=0,this.translateMix=0,this.scaleMix=0,this.shearMix=0,this.temp=new oa,t==null)throw new Error("data cannot be null.");if(e==null)throw new Error("skeleton cannot be null.");this.data=t,this.rotateMix=t.rotateMix,this.translateMix=t.translateMix,this.scaleMix=t.scaleMix,this.shearMix=t.shearMix,this.bones=new Array;for(let s=0;s<t.bones.length;s++)this.bones.push(e.findBone(t.bones[s].name));this.target=e.findBone(t.target.name)}apply(){this.update()}update(){this.data.local?this.data.relative?this.applyRelativeLocal():this.applyAbsoluteLocal():this.data.relative?this.applyRelativeWorld():this.applyAbsoluteWorld()}applyAbsoluteWorld(){const t=this.rotateMix,e=this.translateMix,s=this.scaleMix,r=this.shearMix,i=this.target,o=i.matrix,l=o.a,a=o.c,c=o.b,h=o.d,d=l*h-a*c>0?P.degRad:-P.degRad,u=this.data.offsetRotation*d,f=this.data.offsetShearY*d,m=this.bones;for(let p=0,g=m.length;p<g;p++){const w=m[p];let x=!1;const y=w.matrix;if(t!=0){const b=y.a,_=y.c,E=y.b,S=y.d;let T=Math.atan2(c,l)-Math.atan2(E,b)+u;T>P.PI?T-=P.PI2:T<-P.PI&&(T+=P.PI2),T*=t;const C=Math.cos(T),A=Math.sin(T);y.a=C*b-A*E,y.c=C*_-A*S,y.b=A*b+C*E,y.d=A*_+C*S,x=!0}if(e!=0){const b=this.temp;i.localToWorld(b.set(this.data.offsetX,this.data.offsetY)),y.tx+=(b.x-y.tx)*e,y.ty+=(b.y-y.ty)*e,x=!0}if(s>0){let b=Math.sqrt(y.a*y.a+y.b*y.b),_=Math.sqrt(l*l+c*c);b>1e-5&&(b=(b+(_-b+this.data.offsetScaleX)*s)/b),y.a*=b,y.b*=b,b=Math.sqrt(y.c*y.c+y.d*y.d),_=Math.sqrt(a*a+h*h),b>1e-5&&(b=(b+(_-b+this.data.offsetScaleY)*s)/b),y.c*=b,y.d*=b,x=!0}if(r>0){const b=y.c,_=y.d,E=Math.atan2(_,b);let S=Math.atan2(h,a)-Math.atan2(c,l)-(E-Math.atan2(y.b,y.a));S>P.PI?S-=P.PI2:S<-P.PI&&(S+=P.PI2),S=E+(S+f)*r;const T=Math.sqrt(b*b+_*_);y.c=Math.cos(S)*T,y.d=Math.sin(S)*T,x=!0}x&&(w.appliedValid=!1)}}applyRelativeWorld(){const t=this.rotateMix,e=this.translateMix,s=this.scaleMix,r=this.shearMix,i=this.target,o=i.matrix,l=o.a,a=o.c,c=o.b,h=o.d,d=l*h-a*c>0?P.degRad:-P.degRad,u=this.data.offsetRotation*d,f=this.data.offsetShearY*d,m=this.bones;for(let p=0,g=m.length;p<g;p++){const w=m[p];let x=!1;const y=w.matrix;if(t!=0){const b=y.a,_=y.c,E=y.b,S=y.d;let T=Math.atan2(c,l)+u;T>P.PI?T-=P.PI2:T<-P.PI&&(T+=P.PI2),T*=t;const C=Math.cos(T),A=Math.sin(T);y.a=C*b-A*E,y.c=C*_-A*S,y.b=A*b+C*E,y.d=A*_+C*S,x=!0}if(e!=0){const b=this.temp;i.localToWorld(b.set(this.data.offsetX,this.data.offsetY)),y.tx+=b.x*e,y.ty+=b.y*e,x=!0}if(s>0){let b=(Math.sqrt(l*l+c*c)-1+this.data.offsetScaleX)*s+1;y.a*=b,y.b*=b,b=(Math.sqrt(a*a+h*h)-1+this.data.offsetScaleY)*s+1,y.c*=b,y.d*=b,x=!0}if(r>0){let b=Math.atan2(h,a)-Math.atan2(c,l);b>P.PI?b-=P.PI2:b<-P.PI&&(b+=P.PI2);const _=y.c,E=y.d;b=Math.atan2(E,_)+(b-P.PI/2+f)*r;const S=Math.sqrt(_*_+E*E);y.c=Math.cos(b)*S,y.d=Math.sin(b)*S,x=!0}x&&(w.appliedValid=!1)}}applyAbsoluteLocal(){const t=this.rotateMix,e=this.translateMix,s=this.scaleMix,r=this.shearMix,i=this.target;i.appliedValid||i.updateAppliedTransform();const o=this.bones;for(let l=0,a=o.length;l<a;l++){const c=o[l];c.appliedValid||c.updateAppliedTransform();let h=c.arotation;if(t!=0){let g=i.arotation-h+this.data.offsetRotation;g-=(16384-(16384.499999999996-g/360|0))*360,h+=g*t}let d=c.ax,u=c.ay;e!=0&&(d+=(i.ax-d+this.data.offsetX)*e,u+=(i.ay-u+this.data.offsetY)*e);let f=c.ascaleX,m=c.ascaleY;s>0&&(f>1e-5&&(f=(f+(i.ascaleX-f+this.data.offsetScaleX)*s)/f),m>1e-5&&(m=(m+(i.ascaleY-m+this.data.offsetScaleY)*s)/m));const p=c.ashearY;if(r>0){let g=i.ashearY-p+this.data.offsetShearY;g-=(16384-(16384.499999999996-g/360|0))*360,c.shearY+=g*r}c.updateWorldTransformWith(d,u,h,f,m,c.ashearX,p)}}applyRelativeLocal(){const t=this.rotateMix,e=this.translateMix,s=this.scaleMix,r=this.shearMix,i=this.target;i.appliedValid||i.updateAppliedTransform();const o=this.bones;for(let l=0,a=o.length;l<a;l++){const c=o[l];c.appliedValid||c.updateAppliedTransform();let h=c.arotation;t!=0&&(h+=(i.arotation+this.data.offsetRotation)*t);let d=c.ax,u=c.ay;e!=0&&(d+=(i.ax+this.data.offsetX)*e,u+=(i.ay+this.data.offsetY)*e);let f=c.ascaleX,m=c.ascaleY;s>0&&(f>1e-5&&(f*=(i.ascaleX-1+this.data.offsetScaleX)*s+1),m>1e-5&&(m*=(i.ascaleY-1+this.data.offsetScaleY)*s+1));let p=c.ashearY;r>0&&(p+=(i.ashearY+this.data.offsetShearY)*r),c.updateWorldTransformWith(d,u,h,f,m,c.ashearX,p)}}getOrder(){return this.data.order}};const Hi=class{constructor(t){if(this._updateCache=new Array,this.updateCacheReset=new Array,this.time=0,this.scaleX=1,this.scaleY=1,this.x=0,this.y=0,t==null)throw new Error("data cannot be null.");this.data=t,this.bones=new Array;for(let e=0;e<t.bones.length;e++){const s=t.bones[e];let r;if(s.parent==null)r=new oh(s,this,null);else{const i=this.bones[s.parent.index];r=new oh(s,this,i),i.children.push(r)}this.bones.push(r)}this.slots=new Array,this.drawOrder=new Array;for(let e=0;e<t.slots.length;e++){const s=t.slots[e],r=this.bones[s.boneData.index],i=new ad(s,r);this.slots.push(i),this.drawOrder.push(i)}this.ikConstraints=new Array;for(let e=0;e<t.ikConstraints.length;e++){const s=t.ikConstraints[e];this.ikConstraints.push(new Dg(s,this))}this.transformConstraints=new Array;for(let e=0;e<t.transformConstraints.length;e++){const s=t.transformConstraints[e];this.transformConstraints.push(new Og(s,this))}this.pathConstraints=new Array;for(let e=0;e<t.pathConstraints.length;e++){const s=t.pathConstraints[e];this.pathConstraints.push(new Si(s,this))}this.color=new et(1,1,1,1),this.updateCache()}updateCache(){const t=this._updateCache;t.length=0,this.updateCacheReset.length=0;const e=this.bones;for(let h=0,d=e.length;h<d;h++)e[h].sorted=!1;const s=this.ikConstraints,r=this.transformConstraints,i=this.pathConstraints,o=s.length,l=r.length,a=i.length,c=o+l+a;t:for(let h=0;h<c;h++){for(let d=0;d<o;d++){const u=s[d];if(u.data.order==h){this.sortIkConstraint(u);continue t}}for(let d=0;d<l;d++){const u=r[d];if(u.data.order==h){this.sortTransformConstraint(u);continue t}}for(let d=0;d<a;d++){const u=i[d];if(u.data.order==h){this.sortPathConstraint(u);continue t}}}for(let h=0,d=e.length;h<d;h++)this.sortBone(e[h])}sortIkConstraint(t){const e=t.target;this.sortBone(e);const s=t.bones,r=s[0];if(this.sortBone(r),s.length>1){const i=s[s.length-1];this._updateCache.indexOf(i)>-1||this.updateCacheReset.push(i)}this._updateCache.push(t),this.sortReset(r.children),s[s.length-1].sorted=!0}sortPathConstraint(t){const e=t.target,s=e.data.index,r=e.bone;this.skin!=null&&this.sortPathConstraintAttachment(this.skin,s,r),this.data.defaultSkin!=null&&this.data.defaultSkin!=this.skin&&this.sortPathConstraintAttachment(this.data.defaultSkin,s,r);for(let a=0,c=this.data.skins.length;a<c;a++)this.sortPathConstraintAttachment(this.data.skins[a],s,r);const i=e.getAttachment();i instanceof ca&&this.sortPathConstraintAttachmentWith(i,r);const o=t.bones,l=o.length;for(let a=0;a<l;a++)this.sortBone(o[a]);this._updateCache.push(t);for(let a=0;a<l;a++)this.sortReset(o[a].children);for(let a=0;a<l;a++)o[a].sorted=!0}sortTransformConstraint(t){this.sortBone(t.target);const e=t.bones,s=e.length;if(t.data.local)for(let r=0;r<s;r++){const i=e[r];this.sortBone(i.parent),this._updateCache.indexOf(i)>-1||this.updateCacheReset.push(i)}else for(let r=0;r<s;r++)this.sortBone(e[r]);this._updateCache.push(t);for(let r=0;r<s;r++)this.sortReset(e[r].children);for(let r=0;r<s;r++)e[r].sorted=!0}sortPathConstraintAttachment(t,e,s){const r=t.attachments[e];if(r)for(const i in r)this.sortPathConstraintAttachmentWith(r[i],s)}sortPathConstraintAttachmentWith(t,e){if(!(t instanceof ca))return;const s=t.bones;if(s==null)this.sortBone(e);else{const r=this.bones;let i=0;for(;i<s.length;){const o=s[i++];for(let l=i+o;i<l;i++){const a=s[i];this.sortBone(r[a])}}}}sortBone(t){if(t.sorted)return;const e=t.parent;e!=null&&this.sortBone(e),t.sorted=!0,this._updateCache.push(t)}sortReset(t){for(let e=0,s=t.length;e<s;e++){const r=t[e];r.sorted&&this.sortReset(r.children),r.sorted=!1}}updateWorldTransform(){const t=this.updateCacheReset;for(let s=0,r=t.length;s<r;s++){const i=t[s];i.ax=i.x,i.ay=i.y,i.arotation=i.rotation,i.ascaleX=i.scaleX,i.ascaleY=i.scaleY,i.ashearX=i.shearX,i.ashearY=i.shearY,i.appliedValid=!0}const e=this._updateCache;for(let s=0,r=e.length;s<r;s++)e[s].update()}setToSetupPose(){this.setBonesToSetupPose(),this.setSlotsToSetupPose()}setBonesToSetupPose(){const t=this.bones;for(let i=0,o=t.length;i<o;i++)t[i].setToSetupPose();const e=this.ikConstraints;for(let i=0,o=e.length;i<o;i++){const l=e[i];l.bendDirection=l.data.bendDirection,l.mix=l.data.mix}const s=this.transformConstraints;for(let i=0,o=s.length;i<o;i++){const l=s[i],a=l.data;l.rotateMix=a.rotateMix,l.translateMix=a.translateMix,l.scaleMix=a.scaleMix,l.shearMix=a.shearMix}const r=this.pathConstraints;for(let i=0,o=r.length;i<o;i++){const l=r[i],a=l.data;l.position=a.position,l.spacing=a.spacing,l.rotateMix=a.rotateMix,l.translateMix=a.translateMix}}setSlotsToSetupPose(){const t=this.slots;$.arrayCopy(t,0,this.drawOrder,0,t.length);for(let e=0,s=t.length;e<s;e++)t[e].setToSetupPose()}getRootBone(){return this.bones.length==0?null:this.bones[0]}findBone(t){if(t==null)throw new Error("boneName cannot be null.");const e=this.bones;for(let s=0,r=e.length;s<r;s++){const i=e[s];if(i.data.name==t)return i}return null}findBoneIndex(t){if(t==null)throw new Error("boneName cannot be null.");const e=this.bones;for(let s=0,r=e.length;s<r;s++)if(e[s].data.name==t)return s;return-1}findSlot(t){if(t==null)throw new Error("slotName cannot be null.");const e=this.slots;for(let s=0,r=e.length;s<r;s++){const i=e[s];if(i.data.name==t)return i}return null}findSlotIndex(t){if(t==null)throw new Error("slotName cannot be null.");const e=this.slots;for(let s=0,r=e.length;s<r;s++)if(e[s].data.name==t)return s;return-1}setSkinByName(t){const e=this.data.findSkin(t);if(e==null)throw new Error(`Skin not found: ${t}`);this.setSkin(e)}setSkin(t){if(t!=null)if(this.skin!=null)t.attachAll(this,this.skin);else{const e=this.slots;for(let s=0,r=e.length;s<r;s++){const i=e[s],o=i.data.attachmentName;if(o!=null){const l=t.getAttachment(s,o);l!=null&&i.setAttachment(l)}}}this.skin=t}getAttachmentByName(t,e){return this.getAttachment(this.data.findSlotIndex(t),e)}getAttachment(t,e){if(e==null)throw new Error("attachmentName cannot be null.");if(this.skin!=null){const s=this.skin.getAttachment(t,e);if(s!=null)return s}return this.data.defaultSkin!=null?this.data.defaultSkin.getAttachment(t,e):null}setAttachment(t,e){if(t==null)throw new Error("slotName cannot be null.");const s=this.slots;for(let r=0,i=s.length;r<i;r++){const o=s[r];if(o.data.name==t){let l=null;if(e!=null&&(l=this.getAttachment(r,e),l==null))throw new Error(`Attachment not found: ${e}, for slot: ${t}`);o.setAttachment(l);return}}throw new Error(`Slot not found: ${t}`)}findIkConstraint(t){if(t==null)throw new Error("constraintName cannot be null.");const e=this.ikConstraints;for(let s=0,r=e.length;s<r;s++){const i=e[s];if(i.data.name==t)return i}return null}findTransformConstraint(t){if(t==null)throw new Error("constraintName cannot be null.");const e=this.transformConstraints;for(let s=0,r=e.length;s<r;s++){const i=e[s];if(i.data.name==t)return i}return null}findPathConstraint(t){if(t==null)throw new Error("constraintName cannot be null.");const e=this.pathConstraints;for(let s=0,r=e.length;s<r;s++){const i=e[s];if(i.data.name==t)return i}return null}getBounds(t,e,s){if(t==null)throw new Error("offset cannot be null.");if(e==null)throw new Error("size cannot be null.");const r=this.drawOrder;let i=Number.POSITIVE_INFINITY,o=Number.POSITIVE_INFINITY,l=Number.NEGATIVE_INFINITY,a=Number.NEGATIVE_INFINITY;for(let c=0,h=r.length;c<h;c++){const d=r[c];let u=0,f=null;const m=d.getAttachment();if(m instanceof At)u=8,f=$.setArraySize(s,u,0),m.computeWorldVertices(d.bone,f,0,2);else if(m instanceof id){const p=m;u=p.worldVerticesLength,f=$.setArraySize(s,u,0),p.computeWorldVertices(d,0,u,f,0,2)}if(f!=null)for(let p=0,g=f.length;p<g;p+=2){const w=f[p],x=f[p+1];i=Math.min(i,w),o=Math.min(o,x),l=Math.max(l,w),a=Math.max(a,x)}}t.set(i,o),e.set(l-i,a-o)}update(t){this.time+=t}get flipX(){return this.scaleX==-1}set flipX(t){Hi.deprecatedWarning1||(Hi.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: `Skeleton.flipX/flipY` was deprecated, please use scaleX/scaleY")),this.scaleX=t?1:-1}get flipY(){return this.scaleY==-1}set flipY(t){Hi.deprecatedWarning1||(Hi.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: `Skeleton.flipX/flipY` was deprecated, please use scaleX/scaleY")),this.scaleY=t?1:-1}};let cd=Hi;cd.deprecatedWarning1=!1;let aS=class extends jh{},jg=class{constructor(){this.bones=new Array,this.slots=new Array,this.skins=new Array,this.events=new Array,this.animations=new Array,this.ikConstraints=new Array,this.transformConstraints=new Array,this.pathConstraints=new Array,this.fps=0}findBone(t){if(t==null)throw new Error("boneName cannot be null.");const e=this.bones;for(let s=0,r=e.length;s<r;s++){const i=e[s];if(i.name==t)return i}return null}findBoneIndex(t){if(t==null)throw new Error("boneName cannot be null.");const e=this.bones;for(let s=0,r=e.length;s<r;s++)if(e[s].name==t)return s;return-1}findSlot(t){if(t==null)throw new Error("slotName cannot be null.");const e=this.slots;for(let s=0,r=e.length;s<r;s++){const i=e[s];if(i.name==t)return i}return null}findSlotIndex(t){if(t==null)throw new Error("slotName cannot be null.");const e=this.slots;for(let s=0,r=e.length;s<r;s++)if(e[s].name==t)return s;return-1}findSkin(t){if(t==null)throw new Error("skinName cannot be null.");const e=this.skins;for(let s=0,r=e.length;s<r;s++){const i=e[s];if(i.name==t)return i}return null}findEvent(t){if(t==null)throw new Error("eventDataName cannot be null.");const e=this.events;for(let s=0,r=e.length;s<r;s++){const i=e[s];if(i.name==t)return i}return null}findAnimation(t){if(t==null)throw new Error("animationName cannot be null.");const e=this.animations;for(let s=0,r=e.length;s<r;s++){const i=e[s];if(i.name==t)return i}return null}findIkConstraint(t){if(t==null)throw new Error("constraintName cannot be null.");const e=this.ikConstraints;for(let s=0,r=e.length;s<r;s++){const i=e[s];if(i.name==t)return i}return null}findTransformConstraint(t){if(t==null)throw new Error("constraintName cannot be null.");const e=this.transformConstraints;for(let s=0,r=e.length;s<r;s++){const i=e[s];if(i.name==t)return i}return null}findPathConstraint(t){if(t==null)throw new Error("constraintName cannot be null.");const e=this.pathConstraints;for(let s=0,r=e.length;s<r;s++){const i=e[s];if(i.name==t)return i}return null}findPathConstraintIndex(t){if(t==null)throw new Error("pathConstraintName cannot be null.");const e=this.pathConstraints;for(let s=0,r=e.length;s<r;s++)if(e[s].name==t)return s;return-1}},Vg=class{constructor(t,e,s){if(this.color=new et(1,1,1,1),t<0)throw new Error("index must be >= 0.");if(e==null)throw new Error("name cannot be null.");if(s==null)throw new Error("boneData cannot be null.");this.index=t,this.name=e,this.boneData=s}},Ug=class{constructor(t){if(this.order=0,this.bones=new Array,this.rotateMix=0,this.translateMix=0,this.scaleMix=0,this.shearMix=0,this.offsetRotation=0,this.offsetX=0,this.offsetY=0,this.offsetScaleX=0,this.offsetScaleY=0,this.offsetShearY=0,this.relative=!1,this.local=!1,t==null)throw new Error("name cannot be null.");this.name=t}},Xg=class{constructor(t){if(this.attachments=new Array,t==null)throw new Error("name cannot be null.");this.name=t}addAttachment(t,e,s){if(s==null)throw new Error("attachment cannot be null.");const r=this.attachments;t>=r.length&&(r.length=t+1),r[t]||(r[t]={}),r[t][e]=s}getAttachment(t,e){const s=this.attachments[t];return s?s[e]:null}attachAll(t,e){let s=0;for(let r=0;r<t.slots.length;r++){const i=t.slots[r],o=i.getAttachment();if(o&&s<e.attachments.length){const l=e.attachments[s];for(const a in l){const c=l[a];if(o==c){const h=this.getAttachment(s,a);h!=null&&i.setAttachment(h);break}}}s++}}},Gg=class oi{constructor(t){this.scale=1,this.linkedMeshes=new Array,this.attachmentLoader=t}readSkeletonData(t){const e=this.scale,s=new jg,r=typeof t=="string"?JSON.parse(t):t,i=r.skeleton;if(i!=null&&(s.hash=i.hash,s.version=i.spine,s.width=i.width,s.height=i.height,s.fps=i.fps,s.imagesPath=i.images),r.bones)for(let o=0;o<r.bones.length;o++){const l=r.bones[o];let a=null;const c=this.getValue(l,"parent",null);if(c!=null&&(a=s.findBone(c),a==null))throw new Error(`Parent bone not found: ${c}`);const h=new Pg(s.bones.length,l.name,a);h.length=this.getValue(l,"length",0)*e,h.x=this.getValue(l,"x",0)*e,h.y=this.getValue(l,"y",0)*e,h.rotation=this.getValue(l,"rotation",0),h.scaleX=this.getValue(l,"scaleX",1),h.scaleY=this.getValue(l,"scaleY",1),h.shearX=this.getValue(l,"shearX",0),h.shearY=this.getValue(l,"shearY",0),h.transformMode=oi.transformModeFromString(this.getValue(l,"transform","normal")),s.bones.push(h)}if(r.slots)for(let o=0;o<r.slots.length;o++){const l=r.slots[o],a=l.name,c=l.bone,h=s.findBone(c);if(h==null)throw new Error(`Slot bone not found: ${c}`);const d=new Vg(s.slots.length,a,h),u=this.getValue(l,"color",null);u!=null&&d.color.setFromString(u);const f=this.getValue(l,"dark",null);f!=null&&(d.darkColor=new et(1,1,1,1),d.darkColor.setFromString(f)),d.attachmentName=this.getValue(l,"attachment",null),d.blendMode=oi.blendModeFromString(this.getValue(l,"blend","normal")),s.slots.push(d)}if(r.ik)for(let o=0;o<r.ik.length;o++){const l=r.ik[o],a=new Bg(l.name);a.order=this.getValue(l,"order",0);for(let h=0;h<l.bones.length;h++){const d=l.bones[h],u=s.findBone(d);if(u==null)throw new Error(`IK bone not found: ${d}`);a.bones.push(u)}const c=l.target;if(a.target=s.findBone(c),a.target==null)throw new Error(`IK target bone not found: ${c}`);a.bendDirection=this.getValue(l,"bendPositive",!0)?1:-1,a.mix=this.getValue(l,"mix",1),s.ikConstraints.push(a)}if(r.transform)for(let o=0;o<r.transform.length;o++){const l=r.transform[o],a=new Ug(l.name);a.order=this.getValue(l,"order",0);for(let h=0;h<l.bones.length;h++){const d=l.bones[h],u=s.findBone(d);if(u==null)throw new Error(`Transform constraint bone not found: ${d}`);a.bones.push(u)}const c=l.target;if(a.target=s.findBone(c),a.target==null)throw new Error(`Transform constraint target bone not found: ${c}`);a.local=this.getValue(l,"local",!1),a.relative=this.getValue(l,"relative",!1),a.offsetRotation=this.getValue(l,"rotation",0),a.offsetX=this.getValue(l,"x",0)*e,a.offsetY=this.getValue(l,"y",0)*e,a.offsetScaleX=this.getValue(l,"scaleX",0),a.offsetScaleY=this.getValue(l,"scaleY",0),a.offsetShearY=this.getValue(l,"shearY",0),a.rotateMix=this.getValue(l,"rotateMix",1),a.translateMix=this.getValue(l,"translateMix",1),a.scaleMix=this.getValue(l,"scaleMix",1),a.shearMix=this.getValue(l,"shearMix",1),s.transformConstraints.push(a)}if(r.path)for(let o=0;o<r.path.length;o++){const l=r.path[o],a=new Lg(l.name);a.order=this.getValue(l,"order",0);for(let h=0;h<l.bones.length;h++){const d=l.bones[h],u=s.findBone(d);if(u==null)throw new Error(`Transform constraint bone not found: ${d}`);a.bones.push(u)}const c=l.target;if(a.target=s.findSlot(c),a.target==null)throw new Error(`Path target slot not found: ${c}`);a.positionMode=oi.positionModeFromString(this.getValue(l,"positionMode","percent")),a.spacingMode=oi.spacingModeFromString(this.getValue(l,"spacingMode","length")),a.rotateMode=oi.rotateModeFromString(this.getValue(l,"rotateMode","tangent")),a.offsetRotation=this.getValue(l,"rotation",0),a.position=this.getValue(l,"position",0),a.positionMode==me.Fixed&&(a.position*=e),a.spacing=this.getValue(l,"spacing",0),(a.spacingMode==Gs.Length||a.spacingMode==Gs.Fixed)&&(a.spacing*=e),a.rotateMix=this.getValue(l,"rotateMix",1),a.translateMix=this.getValue(l,"translateMix",1),s.pathConstraints.push(a)}if(r.skins)for(const o in r.skins){const l=r.skins[o],a=new Xg(o);for(const c in l){const h=s.findSlotIndex(c);if(h==-1)throw new Error(`Slot not found: ${c}`);const d=l[c];for(const u in d){const f=this.readAttachment(d[u],a,h,u,s);f!=null&&a.addAttachment(h,u,f)}}s.skins.push(a),a.name=="default"&&(s.defaultSkin=a)}for(let o=0,l=this.linkedMeshes.length;o<l;o++){const a=this.linkedMeshes[o],c=a.skin==null?s.defaultSkin:s.findSkin(a.skin);if(c==null)throw new Error(`Skin not found: ${a.skin}`);const h=c.getAttachment(a.slotIndex,a.parent);if(h==null)throw new Error(`Parent mesh not found: ${a.parent}`);a.mesh.setParentMesh(h)}if(this.linkedMeshes.length=0,r.events)for(const o in r.events){const l=r.events[o],a=new Fg(o);a.intValue=this.getValue(l,"int",0),a.floatValue=this.getValue(l,"float",0),a.stringValue=this.getValue(l,"string",""),a.audioPath=this.getValue(l,"audio",null),a.audioPath!=null&&(a.volume=this.getValue(l,"volume",1),a.balance=this.getValue(l,"balance",0)),s.events.push(a)}if(r.animations)for(const o in r.animations){const l=r.animations[o];this.readAnimation(l,o,s)}return s}readAttachment(t,e,s,r,i){const o=this.scale;switch(r=this.getValue(t,"name",r),this.getValue(t,"type","region")){case"region":{const a=this.getValue(t,"path",r),c=this.attachmentLoader.newRegionAttachment(e,r,a);if(c==null)return null;c.path=a,c.x=this.getValue(t,"x",0)*o,c.y=this.getValue(t,"y",0)*o,c.scaleX=this.getValue(t,"scaleX",1),c.scaleY=this.getValue(t,"scaleY",1),c.rotation=this.getValue(t,"rotation",0),c.width=t.width*o,c.height=t.height*o;const h=this.getValue(t,"color",null);return h!=null&&c.color.setFromString(h),c}case"boundingbox":{const a=this.attachmentLoader.newBoundingBoxAttachment(e,r);if(a==null)return null;this.readVertices(t,a,t.vertexCount<<1);const c=this.getValue(t,"color",null);return c!=null&&a.color.setFromString(c),a}case"mesh":case"linkedmesh":{const a=this.getValue(t,"path",r),c=this.attachmentLoader.newMeshAttachment(e,r,a);if(c==null)return null;c.path=a;const h=this.getValue(t,"color",null);h!=null&&c.color.setFromString(h);const d=this.getValue(t,"parent",null);if(d!=null)return c.inheritDeform=this.getValue(t,"deform",!0),this.linkedMeshes.push(new oS(c,this.getValue(t,"skin",null),s,d)),c;const u=t.uvs;return this.readVertices(t,c,u.length),c.triangles=t.triangles,c.regionUVs=new Float32Array(u),c.hullLength=this.getValue(t,"hull",0)*2,c}case"path":{const a=this.attachmentLoader.newPathAttachment(e,r);if(a==null)return null;a.closed=this.getValue(t,"closed",!1),a.constantSpeed=this.getValue(t,"constantSpeed",!0);const c=t.vertexCount;this.readVertices(t,a,c<<1);const h=$.newArray(c/3,0);for(let u=0;u<t.lengths.length;u++)h[u]=t.lengths[u]*o;a.lengths=h;const d=this.getValue(t,"color",null);return d!=null&&a.color.setFromString(d),a}case"point":{const a=this.attachmentLoader.newPointAttachment(e,r);if(a==null)return null;a.x=this.getValue(t,"x",0)*o,a.y=this.getValue(t,"y",0)*o,a.rotation=this.getValue(t,"rotation",0);const c=this.getValue(t,"color",null);return c!=null&&a.color.setFromString(c),a}case"clipping":{const a=this.attachmentLoader.newClippingAttachment(e,r);if(a==null)return null;const c=this.getValue(t,"end",null);if(c!=null){const u=i.findSlot(c);if(u==null)throw new Error(`Clipping end slot not found: ${c}`);a.endSlot=u}const h=t.vertexCount;this.readVertices(t,a,h<<1);const d=this.getValue(t,"color",null);return d!=null&&a.color.setFromString(d),a}}return null}readVertices(t,e,s){const r=this.scale;e.worldVerticesLength=s;const i=t.vertices;if(s==i.length){const a=$.toFloatArray(i);if(r!=1)for(let c=0,h=i.length;c<h;c++)a[c]*=r;e.vertices=a;return}const o=new Array,l=new Array;for(let a=0,c=i.length;a<c;){const h=i[a++];l.push(h);for(let d=a+h*4;a<d;a+=4)l.push(i[a]),o.push(i[a+1]*r),o.push(i[a+2]*r),o.push(i[a+3])}e.bones=l,e.vertices=$.toFloatArray(o)}readAnimation(t,e,s){const r=this.scale,i=new Array;let o=0;if(t.slots)for(const a in t.slots){const c=t.slots[a],h=s.findSlotIndex(a);if(h==-1)throw new Error(`Slot not found: ${a}`);for(const d in c){const u=c[d];if(d=="attachment"){const f=new Co(u.length);f.slotIndex=h;let m=0;for(let p=0;p<u.length;p++){const g=u[p];f.setFrame(m++,g.time,g.name)}i.push(f),o=Math.max(o,f.frames[f.getFrameCount()-1])}else if(d=="color"){const f=new bs(u.length);f.slotIndex=h;let m=0;for(let p=0;p<u.length;p++){const g=u[p],w=new et;w.setFromString(g.color||"ffffffff"),f.setFrame(m,g.time,w.r,w.g,w.b,w.a),this.readCurve(g,f,m),m++}i.push(f),o=Math.max(o,f.frames[(f.getFrameCount()-1)*bs.ENTRIES])}else if(d=="twoColor"){const f=new Pe(u.length);f.slotIndex=h;let m=0;for(let p=0;p<u.length;p++){const g=u[p],w=new et,x=new et;w.setFromString(g.light),x.setFromString(g.dark),f.setFrame(m,g.time,w.r,w.g,w.b,w.a,x.r,x.g,x.b),this.readCurve(g,f,m),m++}i.push(f),o=Math.max(o,f.frames[(f.getFrameCount()-1)*Pe.ENTRIES])}else throw new Error(`Invalid timeline type for a slot: ${d} (${a})`)}}if(t.bones)for(const a in t.bones){const c=t.bones[a],h=s.findBoneIndex(a);if(h==-1)throw new Error(`Bone not found: ${a}`);for(const d in c){const u=c[d];if(d==="rotate"){const f=new Ke(u.length);f.boneIndex=h;let m=0;for(let p=0;p<u.length;p++){const g=u[p];f.setFrame(m,g.time,g.angle),this.readCurve(g,f,m),m++}i.push(f),o=Math.max(o,f.frames[(f.getFrameCount()-1)*Ke.ENTRIES])}else if(d==="translate"||d==="scale"||d==="shear"){let f=null,m=1;d==="scale"?f=new Ag(u.length):d==="shear"?f=new Cg(u.length):(f=new Js(u.length),m=r),f.boneIndex=h;let p=0;for(let g=0;g<u.length;g++){const w=u[g],x=this.getValue(w,"x",0),y=this.getValue(w,"y",0);f.setFrame(p,w.time,x*m,y*m),this.readCurve(w,f,p),p++}i.push(f),o=Math.max(o,f.frames[(f.getFrameCount()-1)*Js.ENTRIES])}else throw new Error(`Invalid timeline type for a bone: ${d} (${a})`)}}if(t.ik)for(const a in t.ik){const c=t.ik[a],h=s.findIkConstraint(a),d=new ys(c.length);d.ikConstraintIndex=s.ikConstraints.indexOf(h);let u=0;for(let f=0;f<c.length;f++){const m=c[f];d.setFrame(u,m.time,this.getValue(m,"mix",1),this.getValue(m,"bendPositive",!0)?1:-1,this.getValue(m,"compress",!1),this.getValue(m,"stretch",!1)),this.readCurve(m,d,u),u++}i.push(d),o=Math.max(o,d.frames[(d.getFrameCount()-1)*ys.ENTRIES])}if(t.transform)for(const a in t.transform){const c=t.transform[a],h=s.findTransformConstraint(a),d=new ws(c.length);d.transformConstraintIndex=s.transformConstraints.indexOf(h);let u=0;for(let f=0;f<c.length;f++){const m=c[f];d.setFrame(u,m.time,this.getValue(m,"rotateMix",1),this.getValue(m,"translateMix",1),this.getValue(m,"scaleMix",1),this.getValue(m,"shearMix",1)),this.readCurve(m,d,u),u++}i.push(d),o=Math.max(o,d.frames[(d.getFrameCount()-1)*ws.ENTRIES])}if(t.paths)for(const a in t.paths){const c=t.paths[a],h=s.findPathConstraintIndex(a);if(h==-1)throw new Error(`Path constraint not found: ${a}`);const d=s.pathConstraints[h];for(const u in c){const f=c[u];if(u==="position"||u==="spacing"){let m=null,p=1;u==="spacing"?(m=new Rg(f.length),(d.spacingMode==Gs.Length||d.spacingMode==Gs.Fixed)&&(p=r)):(m=new pr(f.length),d.positionMode==me.Fixed&&(p=r)),m.pathConstraintIndex=h;let g=0;for(let w=0;w<f.length;w++){const x=f[w];m.setFrame(g,x.time,this.getValue(x,u,0)*p),this.readCurve(x,m,g),g++}i.push(m),o=Math.max(o,m.frames[(m.getFrameCount()-1)*pr.ENTRIES])}else if(u==="mix"){const m=new Ln(f.length);m.pathConstraintIndex=h;let p=0;for(let g=0;g<f.length;g++){const w=f[g];m.setFrame(p,w.time,this.getValue(w,"rotateMix",1),this.getValue(w,"translateMix",1)),this.readCurve(w,m,p),p++}i.push(m),o=Math.max(o,m.frames[(m.getFrameCount()-1)*Ln.ENTRIES])}}}if(t.deform)for(const a in t.deform){const c=t.deform[a],h=s.findSkin(a);if(h!=null)for(const d in c){const u=c[d],f=s.findSlotIndex(d);if(f==-1)throw new Error(`Slot not found: ${u.name}`);for(const m in u){const p=u[m],g=h.getAttachment(f,m);if(g==null)throw new Error(`Deform attachment not found: ${p.name}`);const w=g.bones!=null,x=g.vertices,y=w?x.length/3*2:x.length,b=new kg(p.length);b.slotIndex=f,b.attachment=g;let _=0;for(let E=0;E<p.length;E++){const S=p[E];let T;const C=this.getValue(S,"vertices",null);if(C==null)T=w?$.newFloatArray(y):x;else{T=$.newFloatArray(y);const A=this.getValue(S,"offset",0);if($.arrayCopy(C,0,T,A,C.length),r!=1)for(let R=A,M=R+C.length;R<M;R++)T[R]*=r;if(!w)for(let R=0;R<y;R++)T[R]+=x[R]}b.setFrame(_,S.time,T),this.readCurve(S,b,_),_++}i.push(b),o=Math.max(o,b.frames[b.getFrameCount()-1])}}}let l=t.drawOrder;if(l==null&&(l=t.draworder),l!=null){const a=new ko(l.length),c=s.slots.length;let h=0;for(let d=0;d<l.length;d++){const u=l[d];let f=null;const m=this.getValue(u,"offsets",null);if(m!=null){f=$.newArray(c,-1);const p=$.newArray(c-m.length,0);let g=0,w=0;for(let x=0;x<m.length;x++){const y=m[x],b=s.findSlotIndex(y.slot);if(b==-1)throw new Error(`Slot not found: ${y.slot}`);for(;g!=b;)p[w++]=g++;f[g+y.offset]=g++}for(;g<c;)p[w++]=g++;for(let x=c-1;x>=0;x--)f[x]==-1&&(f[x]=p[--w])}a.setFrame(h++,u.time,f)}i.push(a),o=Math.max(o,a.frames[a.getFrameCount()-1])}if(t.events){const a=new Ig(t.events.length);let c=0;for(let h=0;h<t.events.length;h++){const d=t.events[h],u=s.findEvent(d.name);if(u==null)throw new Error(`Event not found: ${d.name}`);const f=new Ng($.toSinglePrecision(d.time),u);f.intValue=this.getValue(d,"int",u.intValue),f.floatValue=this.getValue(d,"float",u.floatValue),f.stringValue=this.getValue(d,"string",u.stringValue),f.data.audioPath!=null&&(f.volume=this.getValue(d,"volume",1),f.balance=this.getValue(d,"balance",0)),a.setFrame(c++,f)}i.push(a),o=Math.max(o,a.frames[a.getFrameCount()-1])}if(isNaN(o))throw new Error("Error while parsing animation, duration is NaN");s.animations.push(new Ne(e,i,o))}readCurve(t,e,s){if(t.curve){if(t.curve==="stepped")e.setStepped(s);else if(Object.prototype.toString.call(t.curve)==="[object Array]"){const r=t.curve;e.setCurve(s,r[0],r[1],r[2],r[3])}}}getValue(t,e,s){return t[e]!==void 0?t[e]:s}static blendModeFromString(t){if(t=t.toLowerCase(),t=="normal")return dt.NORMAL;if(t=="additive")return dt.ADD;if(t=="multiply")return dt.MULTIPLY;if(t=="screen")return dt.SCREEN;throw new Error(`Unknown blend mode: ${t}`)}static positionModeFromString(t){if(t=t.toLowerCase(),t=="fixed")return me.Fixed;if(t=="percent")return me.Percent;throw new Error(`Unknown position mode: ${t}`)}static spacingModeFromString(t){if(t=t.toLowerCase(),t=="length")return Gs.Length;if(t=="fixed")return Gs.Fixed;if(t=="percent")return Gs.Percent;throw new Error(`Unknown position mode: ${t}`)}static rotateModeFromString(t){if(t=t.toLowerCase(),t=="tangent")return _e.Tangent;if(t=="chain")return _e.Chain;if(t=="chainscale")return _e.ChainScale;throw new Error(`Unknown rotate mode: ${t}`)}static transformModeFromString(t){if(t=t.toLowerCase(),t=="normal")return wt.Normal;if(t=="onlytranslation")return wt.OnlyTranslation;if(t=="norotationorreflection")return wt.NoRotationOrReflection;if(t=="noscale")return wt.NoScale;if(t=="noscaleorreflection")return wt.NoScaleOrReflection;throw new Error(`Unknown transform mode: ${t}`)}},oS=class{constructor(t,e,s,r){this.mesh=t,this.skin=e,this.slotIndex=s,this.parent=r}},lS=class extends _i{createSkeleton(t){this.skeleton=new cd(t),this.skeleton.updateWorldTransform(),this.stateData=new ld(t),this.state=new wn(this.stateData)}};const cS=Object.freeze(Object.defineProperty({__proto__:null,Animation:Ne,AnimationState:wn,AnimationStateAdapter2:iS,AnimationStateData:ld,AtlasAttachmentLoader:Mg,Attachment:rd,AttachmentTimeline:Co,Bone:oh,BoneData:Pg,BoundingBoxAttachment:wg,ClippingAttachment:vg,ColorTimeline:bs,CurveTimeline:ds,DeformTimeline:kg,DrawOrderTimeline:ko,Event:Ng,EventData:Fg,EventQueue:od,EventTimeline:Ig,EventType:is,IkConstraint:Dg,IkConstraintData:Bg,IkConstraintTimeline:ys,JitterEffect:rS,MeshAttachment:id,PathAttachment:ca,PathConstraint:Si,PathConstraintData:Lg,PathConstraintMixTimeline:Ln,PathConstraintPositionTimeline:pr,PathConstraintSpacingTimeline:Rg,PointAttachment:_g,RegionAttachment:At,RotateTimeline:Ke,ScaleTimeline:Ag,ShearTimeline:Cg,Skeleton:cd,SkeletonBounds:aS,SkeletonData:jg,SkeletonJson:Gg,Skin:Xg,Slot:ad,SlotData:Vg,SpacingMode:Gs,Spine:lS,SwirlEffect:Sg,TimelineType:Tg,TrackEntry:Jo,TransformConstraint:Og,TransformConstraintData:Ug,TransformConstraintTimeline:ws,TranslateTimeline:Js,TwoColorTimeline:Pe,VertexAttachment:br},Symbol.toStringTag,{value:"Module"}));class hd{constructor(t){if(!t)throw new Error("name cannot be null.");this.name=t}}const Yg=class extends hd{constructor(n){super(n),this.id=Yg.nextID++,this.bones=null,this.vertices=[],this.worldVerticesLength=0,this.timelineAttachment=this}computeWorldVerticesOld(n,t){this.computeWorldVertices(n,0,this.worldVerticesLength,t,0,2)}computeWorldVertices(n,t,e,s,r,i){e=r+(e>>1)*i;const o=n.bone.skeleton,l=n.deform;let a=this.vertices;const c=this.bones;if(!c){l.length>0&&(a=l);const f=n.bone.matrix,m=f.tx,p=f.ty,g=f.a,w=f.c,x=f.b,y=f.d;for(let b=t,_=r;_<e;b+=2,_+=i){const E=a[b],S=a[b+1];s[_]=E*g+S*w+m,s[_+1]=E*x+S*y+p}return}let h=0,d=0;for(let f=0;f<t;f+=2){const m=c[h];h+=m+1,d+=m}const u=o.bones;if(l.length==0)for(let f=r,m=d*3;f<e;f+=i){let p=0,g=0,w=c[h++];for(w+=h;h<w;h++,m+=3){const x=u[c[h]].matrix,y=a[m],b=a[m+1],_=a[m+2];p+=(y*x.a+b*x.c+x.tx)*_,g+=(y*x.b+b*x.d+x.ty)*_}s[f]=p,s[f+1]=g}else{const f=l;for(let m=r,p=d*3,g=d<<1;m<e;m+=i){let w=0,x=0,y=c[h++];for(y+=h;h<y;h++,p+=3,g+=2){const b=u[c[h]].matrix,_=a[p]+f[g],E=a[p+1]+f[g+1],S=a[p+2];w+=(_*b.a+E*b.c+b.tx)*S,x+=(_*b.b+E*b.d+b.ty)*S}s[m]=w,s[m+1]=x}}}copyTo(n){this.bones?(n.bones=new Array(this.bones.length),$.arrayCopy(this.bones,0,n.bones,0,this.bones.length)):n.bones=null,this.vertices&&(n.vertices=$.newFloatArray(this.vertices.length),$.arrayCopy(this.vertices,0,n.vertices,0,this.vertices.length)),n.worldVerticesLength=this.worldVerticesLength,n.timelineAttachment=this.timelineAttachment}};let tn=Yg;tn.nextID=0;class tl extends tn{constructor(t){super(t),this.type=Rt.BoundingBox,this.color=new et(1,1,1,1)}copy(){const t=new tl(this.name);return this.copyTo(t),t.color.setFromColor(this.color),t}}class el extends tn{constructor(t){super(t),this.type=Rt.Clipping,this.endSlot=null,this.color=new et(.2275,.2275,.8078,1)}copy(){const t=new el(this.name);return this.copyTo(t),t.endSlot=this.endSlot,t.color.setFromColor(this.color),t}}class Xr extends tn{constructor(t,e){super(t),this.type=Rt.Mesh,this.region=null,this.triangles=[],this.color=new et(1,1,1,1),this.width=0,this.height=0,this.hullLength=0,this.edges=[],this.parentMesh=null,this.sequence=null,this.tempColor=new et(0,0,0,0),this.path=e}getParentMesh(){return this.parentMesh}setParentMesh(t){this.parentMesh=t,t&&(this.bones=t.bones,this.vertices=t.vertices,this.worldVerticesLength=t.worldVerticesLength,this.regionUVs=t.regionUVs,this.triangles=t.triangles,this.hullLength=t.hullLength,this.worldVerticesLength=t.worldVerticesLength)}copy(){if(this.parentMesh)return this.newLinkedMesh();const t=new Xr(this.name,this.path);return t.region=this.region,t.color.setFromColor(this.color),this.copyTo(t),t.regionUVs=new Float32Array(this.regionUVs.length),$.arrayCopy(this.regionUVs,0,t.regionUVs,0,this.regionUVs.length),t.triangles=new Array(this.triangles.length),$.arrayCopy(this.triangles,0,t.triangles,0,this.triangles.length),t.hullLength=this.hullLength,t.sequence=this.sequence!=null?this.sequence.copy():null,this.edges&&(t.edges=new Array(this.edges.length),$.arrayCopy(this.edges,0,t.edges,0,this.edges.length)),t.width=this.width,t.height=this.height,t}computeWorldVertices(t,e,s,r,i,o){this.sequence!=null&&this.sequence.apply(t,this),super.computeWorldVertices(t,e,s,r,i,o)}newLinkedMesh(){const t=new Xr(this.name,this.path);return t.region=this.region,t.color.setFromColor(this.color),t.timelineAttachment=this.timelineAttachment,t.setParentMesh(this.parentMesh?this.parentMesh:this),t}}class Gr extends tn{constructor(t){super(t),this.type=Rt.Path,this.lengths=[],this.closed=!1,this.constantSpeed=!1,this.color=new et(1,1,1,1)}copy(){const t=new Gr(this.name);return this.copyTo(t),t.lengths=new Array(this.lengths.length),$.arrayCopy(this.lengths,0,t.lengths,0,this.lengths.length),t.closed=closed,t.constantSpeed=this.constantSpeed,t.color.setFromColor(this.color),t}}class sl extends tn{constructor(t){super(t),this.type=Rt.Point,this.x=0,this.y=0,this.rotation=0,this.color=new et(.38,.94,0,1)}computeWorldPosition(t,e){const s=t.matrix;return e.x=this.x*s.a+this.y*s.c+t.worldX,e.y=this.x*s.b+this.y*s.d+t.worldY,e}computeWorldRotation(t){const e=t.matrix,s=P.cosDeg(this.rotation),r=P.sinDeg(this.rotation),i=s*e.a+r*e.c,o=s*e.b+r*e.d;return Math.atan2(o,i)*P.radDeg}copy(){const t=new sl(this.name);return t.x=this.x,t.y=this.y,t.rotation=this.rotation,t.color.setFromColor(this.color),t}}const $g=class extends hd{constructor(n,t){super(n),this.type=Rt.Region,this.x=0,this.y=0,this.scaleX=1,this.scaleY=1,this.rotation=0,this.width=0,this.height=0,this.color=new et(1,1,1,1),this.rendererObject=null,this.region=null,this.sequence=null,this.offset=$.newFloatArray(8),this.uvs=$.newFloatArray(8),this.tempColor=new et(1,1,1,1),this.path=t}updateRegion(){if(!this.region)throw new Error("Region not set.");const n=this.region,t=this.width/this.region.originalWidth*this.scaleX,e=this.height/this.region.originalHeight*this.scaleY,s=-this.width/2*this.scaleX+this.region.offsetX*t,r=-this.height/2*this.scaleY+this.region.offsetY*e,i=s+this.region.width*t,o=r+this.region.height*e,l=this.rotation*Math.PI/180,a=Math.cos(l),c=Math.sin(l),h=this.x,d=this.y,u=s*a+h,f=s*c,m=r*a+d,p=r*c,g=i*a+h,w=i*c,x=o*a+d,y=o*c,b=this.offset;b[0]=u-p,b[1]=m+f,b[2]=u-y,b[3]=x+f,b[4]=g-y,b[5]=x+w,b[6]=g-p,b[7]=m+w;const _=this.uvs;n.degrees==90?(_[2]=n.u,_[3]=n.v2,_[4]=n.u,_[5]=n.v,_[6]=n.u2,_[7]=n.v,_[0]=n.u2,_[1]=n.v2):(_[0]=n.u,_[1]=n.v2,_[2]=n.u,_[3]=n.v,_[4]=n.u2,_[5]=n.v,_[6]=n.u2,_[7]=n.v2)}computeWorldVertices(n,t,e,s){this.sequence!=null&&this.sequence.apply(n,this);const r=n.bone,i=this.offset,o=r.matrix,l=o.tx,a=o.ty,c=o.a,h=o.c,d=o.b,u=o.d;let f=0,m=0;f=i[0],m=i[1],t[e]=f*c+m*h+l,t[e+1]=f*d+m*u+a,e+=s,f=i[2],m=i[3],t[e]=f*c+m*h+l,t[e+1]=f*d+m*u+a,e+=s,f=i[4],m=i[5],t[e]=f*c+m*h+l,t[e+1]=f*d+m*u+a,e+=s,f=i[6],m=i[7],t[e]=f*c+m*h+l,t[e+1]=f*d+m*u+a}copy(){const n=new $g(this.name,this.path);return n.region=this.region,n.rendererObject=this.rendererObject,n.x=this.x,n.y=this.y,n.scaleX=this.scaleX,n.scaleY=this.scaleY,n.rotation=this.rotation,n.width=this.width,n.height=this.height,$.arrayCopy(this.uvs,0,n.uvs,0,8),$.arrayCopy(this.offset,0,n.offset,0,8),n.color.setFromColor(this.color),n.sequence=this.sequence!=null?this.sequence.copy():null,n}};let Ot=$g;Ot.X1=0;Ot.Y1=1;Ot.C1R=2;Ot.C1G=3;Ot.C1B=4;Ot.C1A=5;Ot.U1=6;Ot.V1=7;Ot.X2=8;Ot.Y2=9;Ot.C2R=10;Ot.C2G=11;Ot.C2B=12;Ot.C2A=13;Ot.U2=14;Ot.V2=15;Ot.X3=16;Ot.Y3=17;Ot.C3R=18;Ot.C3G=19;Ot.C3B=20;Ot.C3A=21;Ot.U3=22;Ot.V3=23;Ot.X4=24;Ot.Y4=25;Ot.C4R=26;Ot.C4G=27;Ot.C4B=28;Ot.C4A=29;Ot.U4=30;Ot.V4=31;const ao=class{constructor(n){this.id=ao.nextID(),this.start=0,this.digits=0,this.setupIndex=0,this.regions=new Array(n)}copy(){const n=new ao(this.regions.length);return $.arrayCopy(this.regions,0,n.regions,0,this.regions.length),n.start=this.start,n.digits=this.digits,n.setupIndex=this.setupIndex,n}apply(n,t){let e=n.sequenceIndex;e==-1&&(e=this.setupIndex),e>=this.regions.length&&(e=this.regions.length-1);const s=this.regions[e];t.region!=s&&(t.region=s)}getPath(n,t){let e=n;const s=(this.start+t).toString();for(let r=this.digits-s.length;r>0;r--)e+="0";return e+=s,e}static nextID(){return ao._nextID++}};let nl=ao;nl._nextID=0;var un=(n=>(n[n.hold=0]="hold",n[n.once=1]="once",n[n.loop=2]="loop",n[n.pingpong=3]="pingpong",n[n.onceReverse=4]="onceReverse",n[n.loopReverse=5]="loopReverse",n[n.pingpongReverse=6]="pingpongReverse",n))(un||{});const dd=[0,1,2,3,4,5,6];class rl{constructor(t,e,s){if(this.timelines=[],this.timelineIds=new eg,!t)throw new Error("name cannot be null.");this.name=t,this.setTimelines(e),this.duration=s}setTimelines(t){if(!t)throw new Error("timelines cannot be null.");this.timelines=t,this.timelineIds.clear();for(let e=0;e<t.length;e++)this.timelineIds.addAll(t[e].getPropertyIds())}hasTimeline(t){for(let e=0;e<t.length;e++)if(this.timelineIds.contains(t[e]))return!0;return!1}apply(t,e,s,r,i,o,l,a){if(!t)throw new Error("skeleton cannot be null.");r&&this.duration!=0&&(s%=this.duration,e>0&&(e%=this.duration));const c=this.timelines;for(let h=0,d=c.length;h<d;h++)c[h].apply(t,e,s,i,o,l,a)}}const zt={rotate:0,x:1,y:2,scaleX:3,scaleY:4,shearX:5,shearY:6,rgb:7,alpha:8,rgb2:9,attachment:10,deform:11,event:12,drawOrder:13,ikConstraint:14,transformConstraint:15,pathConstraintPosition:16,pathConstraintSpacing:17,pathConstraintMix:18,sequence:19};class be{constructor(t,e){this.propertyIds=e,this.frames=$.newFloatArray(t*this.getFrameEntries())}getPropertyIds(){return this.propertyIds}getFrameEntries(){return 1}getFrameCount(){return this.frames.length/this.getFrameEntries()}getDuration(){return this.frames[this.frames.length-this.getFrameEntries()]}static search1(t,e){const s=t.length;for(let r=1;r<s;r++)if(t[r]>e)return r-1;return s-1}static search(t,e,s){const r=t.length;for(let i=s;i<r;i+=s)if(t[i]>e)return i-s;return r-s}}class en extends be{constructor(t,e,s){super(t,s),this.curves=$.newFloatArray(t+e*18),this.curves[t-1]=1}setLinear(t){this.curves[t]=0}setStepped(t){this.curves[t]=1}shrink(t){const e=this.getFrameCount()+t*18;if(this.curves.length>e){const s=$.newFloatArray(e);$.arrayCopy(this.curves,0,s,0,e),this.curves=s}}setBezier(t,e,s,r,i,o,l,a,c,h,d){const u=this.curves;let f=this.getFrameCount()+t*18;s==0&&(u[e]=2+f);const m=(r-o*2+a)*.03,p=(i-l*2+c)*.03,g=((o-a)*3-r+h)*.006,w=((l-c)*3-i+d)*.006;let x=m*2+g,y=p*2+w,b=(o-r)*.3+m+g*.16666667,_=(l-i)*.3+p+w*.16666667,E=r+b,S=i+_;for(let T=f+18;f<T;f+=2)u[f]=E,u[f+1]=S,b+=x,_+=y,x+=g,y+=w,E+=b,S+=_}getBezierValue(t,e,s,r){const i=this.curves;if(i[r]>t){const c=this.frames[e],h=this.frames[e+s];return h+(t-c)/(i[r]-c)*(i[r+1]-h)}const o=r+18;for(r+=2;r<o;r+=2)if(i[r]>=t){const c=i[r-2],h=i[r-1];return h+(t-c)/(i[r]-c)*(i[r+1]-h)}e+=this.getFrameEntries();const l=i[o-2],a=i[o-1];return a+(t-l)/(this.frames[e]-l)*(this.frames[e+s]-a)}}class sn extends en{constructor(t,e,s){super(t,e,[s])}getFrameEntries(){return 2}setFrame(t,e,s){t<<=1,this.frames[t]=e,this.frames[t+1]=s}getCurveValue(t){const e=this.frames;let s=e.length-2;for(let i=2;i<=s;i+=2)if(e[i]>t){s=i-2;break}const r=this.curves[s>>1];switch(r){case 0:const i=e[s],o=e[s+1];return o+(t-i)/(e[s+2]-i)*(e[s+2+1]-o);case 1:return e[s+1]}return this.getBezierValue(t,s,1,r-2)}}class il extends en{constructor(t,e,s,r){super(t,e,[s,r])}getFrameEntries(){return 3}setFrame(t,e,s,r){t*=3,this.frames[t]=e,this.frames[t+1]=s,this.frames[t+2]=r}}class ha extends sn{constructor(t,e,s){super(t,e,`${zt.rotate}|${s}`),this.boneIndex=0,this.boneIndex=s}apply(t,e,s,r,i,o,l){const a=t.bones[this.boneIndex];if(!a.active)return;const c=this.frames;if(s<c[0]){switch(o){case k.setup:a.rotation=a.data.rotation;return;case k.first:a.rotation+=(a.data.rotation-a.rotation)*i}return}let h=this.getCurveValue(s);switch(o){case k.setup:a.rotation=a.data.rotation+h*i;break;case k.first:case k.replace:h+=a.data.rotation-a.rotation;case k.add:a.rotation+=h*i}}}class ud extends il{constructor(t,e,s){super(t,e,`${zt.x}|${s}`,`${zt.y}|${s}`),this.boneIndex=0,this.boneIndex=s}apply(t,e,s,r,i,o,l){const a=t.bones[this.boneIndex];if(!a.active)return;const c=this.frames;if(s<c[0]){switch(o){case k.setup:a.x=a.data.x,a.y=a.data.y;return;case k.first:a.x+=(a.data.x-a.x)*i,a.y+=(a.data.y-a.y)*i}return}let h=0,d=0;const u=be.search(c,s,3),f=this.curves[u/3];switch(f){case 0:const m=c[u];h=c[u+1],d=c[u+2];const p=(s-m)/(c[u+3]-m);h+=(c[u+3+1]-h)*p,d+=(c[u+3+2]-d)*p;break;case 1:h=c[u+1],d=c[u+2];break;default:h=this.getBezierValue(s,u,1,f-2),d=this.getBezierValue(s,u,2,f+18-2)}switch(o){case k.setup:a.x=a.data.x+h*i,a.y=a.data.y+d*i;break;case k.first:case k.replace:a.x+=(a.data.x+h-a.x)*i,a.y+=(a.data.y+d-a.y)*i;break;case k.add:a.x+=h*i,a.y+=d*i}}}class fd extends sn{constructor(t,e,s){super(t,e,`${zt.x}|${s}`),this.boneIndex=0,this.boneIndex=s}apply(t,e,s,r,i,o,l){const a=t.bones[this.boneIndex];if(!a.active)return;const c=this.frames;if(s<c[0]){switch(o){case k.setup:a.x=a.data.x;return;case k.first:a.x+=(a.data.x-a.x)*i}return}const h=this.getCurveValue(s);switch(o){case k.setup:a.x=a.data.x+h*i;break;case k.first:case k.replace:a.x+=(a.data.x+h-a.x)*i;break;case k.add:a.x+=h*i}}}class md extends sn{constructor(t,e,s){super(t,e,`${zt.y}|${s}`),this.boneIndex=0,this.boneIndex=s}apply(t,e,s,r,i,o,l){const a=t.bones[this.boneIndex];if(!a.active)return;const c=this.frames;if(s<c[0]){switch(o){case k.setup:a.y=a.data.y;return;case k.first:a.y+=(a.data.y-a.y)*i}return}const h=this.getCurveValue(s);switch(o){case k.setup:a.y=a.data.y+h*i;break;case k.first:case k.replace:a.y+=(a.data.y+h-a.y)*i;break;case k.add:a.y+=h*i}}}class pd extends il{constructor(t,e,s){super(t,e,`${zt.scaleX}|${s}`,`${zt.scaleY}|${s}`),this.boneIndex=0,this.boneIndex=s}apply(t,e,s,r,i,o,l){const a=t.bones[this.boneIndex];if(!a.active)return;const c=this.frames;if(s<c[0]){switch(o){case k.setup:a.scaleX=a.data.scaleX,a.scaleY=a.data.scaleY;return;case k.first:a.scaleX+=(a.data.scaleX-a.scaleX)*i,a.scaleY+=(a.data.scaleY-a.scaleY)*i}return}let h,d;const u=be.search(c,s,3),f=this.curves[u/3];switch(f){case 0:const m=c[u];h=c[u+1],d=c[u+2];const p=(s-m)/(c[u+3]-m);h+=(c[u+3+1]-h)*p,d+=(c[u+3+2]-d)*p;break;case 1:h=c[u+1],d=c[u+2];break;default:h=this.getBezierValue(s,u,1,f-2),d=this.getBezierValue(s,u,2,f+18-2)}if(h*=a.data.scaleX,d*=a.data.scaleY,i==1)o==k.add?(a.scaleX+=h-a.data.scaleX,a.scaleY+=d-a.data.scaleY):(a.scaleX=h,a.scaleY=d);else{let m=0,p=0;if(l==It.mixOut)switch(o){case k.setup:m=a.data.scaleX,p=a.data.scaleY,a.scaleX=m+(Math.abs(h)*P.signum(m)-m)*i,a.scaleY=p+(Math.abs(d)*P.signum(p)-p)*i;break;case k.first:case k.replace:m=a.scaleX,p=a.scaleY,a.scaleX=m+(Math.abs(h)*P.signum(m)-m)*i,a.scaleY=p+(Math.abs(d)*P.signum(p)-p)*i;break;case k.add:a.scaleX+=(h-a.data.scaleX)*i,a.scaleY+=(d-a.data.scaleY)*i}else switch(o){case k.setup:m=Math.abs(a.data.scaleX)*P.signum(h),p=Math.abs(a.data.scaleY)*P.signum(d),a.scaleX=m+(h-m)*i,a.scaleY=p+(d-p)*i;break;case k.first:case k.replace:m=Math.abs(a.scaleX)*P.signum(h),p=Math.abs(a.scaleY)*P.signum(d),a.scaleX=m+(h-m)*i,a.scaleY=p+(d-p)*i;break;case k.add:a.scaleX+=(h-a.data.scaleX)*i,a.scaleY+=(d-a.data.scaleY)*i}}}}class gd extends sn{constructor(t,e,s){super(t,e,`${zt.scaleX}|${s}`),this.boneIndex=0,this.boneIndex=s}apply(t,e,s,r,i,o,l){const a=t.bones[this.boneIndex];if(!a.active)return;const c=this.frames;if(s<c[0]){switch(o){case k.setup:a.scaleX=a.data.scaleX;return;case k.first:a.scaleX+=(a.data.scaleX-a.scaleX)*i}return}const h=this.getCurveValue(s)*a.data.scaleX;if(i==1)o==k.add?a.scaleX+=h-a.data.scaleX:a.scaleX=h;else{let d=0;if(l==It.mixOut)switch(o){case k.setup:d=a.data.scaleX,a.scaleX=d+(Math.abs(h)*P.signum(d)-d)*i;break;case k.first:case k.replace:d=a.scaleX,a.scaleX=d+(Math.abs(h)*P.signum(d)-d)*i;break;case k.add:a.scaleX+=(h-a.data.scaleX)*i}else switch(o){case k.setup:d=Math.abs(a.data.scaleX)*P.signum(h),a.scaleX=d+(h-d)*i;break;case k.first:case k.replace:d=Math.abs(a.scaleX)*P.signum(h),a.scaleX=d+(h-d)*i;break;case k.add:a.scaleX+=(h-a.data.scaleX)*i}}}}class xd extends sn{constructor(t,e,s){super(t,e,`${zt.scaleY}|${s}`),this.boneIndex=0,this.boneIndex=s}apply(t,e,s,r,i,o,l){const a=t.bones[this.boneIndex];if(!a.active)return;const c=this.frames;if(s<c[0]){switch(o){case k.setup:a.scaleY=a.data.scaleY;return;case k.first:a.scaleY+=(a.data.scaleY-a.scaleY)*i}return}const h=this.getCurveValue(s)*a.data.scaleY;if(i==1)o==k.add?a.scaleY+=h-a.data.scaleY:a.scaleY=h;else{let d=0;if(l==It.mixOut)switch(o){case k.setup:d=a.data.scaleY,a.scaleY=d+(Math.abs(h)*P.signum(d)-d)*i;break;case k.first:case k.replace:d=a.scaleY,a.scaleY=d+(Math.abs(h)*P.signum(d)-d)*i;break;case k.add:a.scaleY+=(h-a.data.scaleY)*i}else switch(o){case k.setup:d=Math.abs(a.data.scaleY)*P.signum(h),a.scaleY=d+(h-d)*i;break;case k.first:case k.replace:d=Math.abs(a.scaleY)*P.signum(h),a.scaleY=d+(h-d)*i;break;case k.add:a.scaleY+=(h-a.data.scaleY)*i}}}}class bd extends il{constructor(t,e,s){super(t,e,`${zt.shearX}|${s}`,`${zt.shearY}|${s}`),this.boneIndex=0,this.boneIndex=s}apply(t,e,s,r,i,o,l){const a=t.bones[this.boneIndex];if(!a.active)return;const c=this.frames;if(s<c[0]){switch(o){case k.setup:a.shearX=a.data.shearX,a.shearY=a.data.shearY;return;case k.first:a.shearX+=(a.data.shearX-a.shearX)*i,a.shearY+=(a.data.shearY-a.shearY)*i}return}let h=0,d=0;const u=be.search(c,s,3),f=this.curves[u/3];switch(f){case 0:const m=c[u];h=c[u+1],d=c[u+2];const p=(s-m)/(c[u+3]-m);h+=(c[u+3+1]-h)*p,d+=(c[u+3+2]-d)*p;break;case 1:h=c[u+1],d=c[u+2];break;default:h=this.getBezierValue(s,u,1,f-2),d=this.getBezierValue(s,u,2,f+18-2)}switch(o){case k.setup:a.shearX=a.data.shearX+h*i,a.shearY=a.data.shearY+d*i;break;case k.first:case k.replace:a.shearX+=(a.data.shearX+h-a.shearX)*i,a.shearY+=(a.data.shearY+d-a.shearY)*i;break;case k.add:a.shearX+=h*i,a.shearY+=d*i}}}class yd extends sn{constructor(t,e,s){super(t,e,`${zt.shearX}|${s}`),this.boneIndex=0,this.boneIndex=s}apply(t,e,s,r,i,o,l){const a=t.bones[this.boneIndex];if(!a.active)return;const c=this.frames;if(s<c[0]){switch(o){case k.setup:a.shearX=a.data.shearX;return;case k.first:a.shearX+=(a.data.shearX-a.shearX)*i}return}const h=this.getCurveValue(s);switch(o){case k.setup:a.shearX=a.data.shearX+h*i;break;case k.first:case k.replace:a.shearX+=(a.data.shearX+h-a.shearX)*i;break;case k.add:a.shearX+=h*i}}}class wd extends sn{constructor(t,e,s){super(t,e,`${zt.shearY}|${s}`),this.boneIndex=0,this.boneIndex=s}apply(t,e,s,r,i,o,l){const a=t.bones[this.boneIndex];if(!a.active)return;const c=this.frames;if(s<c[0]){switch(o){case k.setup:a.shearY=a.data.shearY;return;case k.first:a.shearY+=(a.data.shearY-a.shearY)*i}return}const h=this.getCurveValue(s);switch(o){case k.setup:a.shearY=a.data.shearY+h*i;break;case k.first:case k.replace:a.shearY+=(a.data.shearY+h-a.shearY)*i;break;case k.add:a.shearY+=h*i}}}class vd extends en{constructor(t,e,s){super(t,e,[`${zt.rgb}|${s}`,`${zt.alpha}|${s}`]),this.slotIndex=0,this.slotIndex=s}getFrameEntries(){return 5}setFrame(t,e,s,r,i,o){t*=5,this.frames[t]=e,this.frames[t+1]=s,this.frames[t+2]=r,this.frames[t+3]=i,this.frames[t+4]=o}apply(t,e,s,r,i,o,l){const a=t.slots[this.slotIndex];if(!a.bone.active)return;const c=this.frames,h=a.color;if(s<c[0]){const w=a.data.color;switch(o){case k.setup:h.setFromColor(w);return;case k.first:h.add((w.r-h.r)*i,(w.g-h.g)*i,(w.b-h.b)*i,(w.a-h.a)*i)}return}let d=0,u=0,f=0,m=0;const p=be.search(c,s,5),g=this.curves[p/5];switch(g){case 0:const w=c[p];d=c[p+1],u=c[p+2],f=c[p+3],m=c[p+4];const x=(s-w)/(c[p+5]-w);d+=(c[p+5+1]-d)*x,u+=(c[p+5+2]-u)*x,f+=(c[p+5+3]-f)*x,m+=(c[p+5+4]-m)*x;break;case 1:d=c[p+1],u=c[p+2],f=c[p+3],m=c[p+4];break;default:d=this.getBezierValue(s,p,1,g-2),u=this.getBezierValue(s,p,2,g+18-2),f=this.getBezierValue(s,p,3,g+18*2-2),m=this.getBezierValue(s,p,4,g+18*3-2)}i==1?h.set(d,u,f,m):(o==k.setup&&h.setFromColor(a.data.color),h.add((d-h.r)*i,(u-h.g)*i,(f-h.b)*i,(m-h.a)*i))}}class _d extends en{constructor(t,e,s){super(t,e,[`${zt.rgb}|${s}`]),this.slotIndex=0,this.slotIndex=s}getFrameEntries(){return 4}setFrame(t,e,s,r,i){t<<=2,this.frames[t]=e,this.frames[t+1]=s,this.frames[t+2]=r,this.frames[t+3]=i}apply(t,e,s,r,i,o,l){const a=t.slots[this.slotIndex];if(!a.bone.active)return;const c=this.frames,h=a.color;if(s<c[0]){const g=a.data.color;switch(o){case k.setup:h.r=g.r,h.g=g.g,h.b=g.b;return;case k.first:h.r+=(g.r-h.r)*i,h.g+=(g.g-h.g)*i,h.b+=(g.b-h.b)*i}return}let d=0,u=0,f=0;const m=be.search(c,s,4),p=this.curves[m>>2];switch(p){case 0:const g=c[m];d=c[m+1],u=c[m+2],f=c[m+3];const w=(s-g)/(c[m+4]-g);d+=(c[m+4+1]-d)*w,u+=(c[m+4+2]-u)*w,f+=(c[m+4+3]-f)*w;break;case 1:d=c[m+1],u=c[m+2],f=c[m+3];break;default:d=this.getBezierValue(s,m,1,p-2),u=this.getBezierValue(s,m,2,p+18-2),f=this.getBezierValue(s,m,3,p+18*2-2)}if(i==1)h.r=d,h.g=u,h.b=f;else{if(o==k.setup){const g=a.data.color;h.r=g.r,h.g=g.g,h.b=g.b}h.r+=(d-h.r)*i,h.g+=(u-h.g)*i,h.b+=(f-h.b)*i}}}class Ed extends sn{constructor(t,e,s){super(t,e,`${zt.alpha}|${s}`),this.slotIndex=0,this.slotIndex=s}apply(t,e,s,r,i,o,l){const a=t.slots[this.slotIndex];if(!a.bone.active)return;const c=a.color;if(s<this.frames[0]){const d=a.data.color;switch(o){case k.setup:c.a=d.a;return;case k.first:c.a+=(d.a-c.a)*i}return}const h=this.getCurveValue(s);i==1?c.a=h:(o==k.setup&&(c.a=a.data.color.a),c.a+=(h-c.a)*i)}}class Sd extends en{constructor(t,e,s){super(t,e,[`${zt.rgb}|${s}`,`${zt.alpha}|${s}`,`${zt.rgb2}|${s}`]),this.slotIndex=0,this.slotIndex=s}getFrameEntries(){return 8}setFrame(t,e,s,r,i,o,l,a,c){t<<=3,this.frames[t]=e,this.frames[t+1]=s,this.frames[t+2]=r,this.frames[t+3]=i,this.frames[t+4]=o,this.frames[t+5]=l,this.frames[t+6]=a,this.frames[t+7]=c}apply(t,e,s,r,i,o,l){const a=t.slots[this.slotIndex];if(!a.bone.active)return;const c=this.frames,h=a.color,d=a.darkColor;if(s<c[0]){const _=a.data.color,E=a.data.darkColor;switch(o){case k.setup:h.setFromColor(_),d.r=E.r,d.g=E.g,d.b=E.b;return;case k.first:h.add((_.r-h.r)*i,(_.g-h.g)*i,(_.b-h.b)*i,(_.a-h.a)*i),d.r+=(E.r-d.r)*i,d.g+=(E.g-d.g)*i,d.b+=(E.b-d.b)*i}return}let u=0,f=0,m=0,p=0,g=0,w=0,x=0;const y=be.search(c,s,8),b=this.curves[y>>3];switch(b){case 0:const _=c[y];u=c[y+1],f=c[y+2],m=c[y+3],p=c[y+4],g=c[y+5],w=c[y+6],x=c[y+7];const E=(s-_)/(c[y+8]-_);u+=(c[y+8+1]-u)*E,f+=(c[y+8+2]-f)*E,m+=(c[y+8+3]-m)*E,p+=(c[y+8+4]-p)*E,g+=(c[y+8+5]-g)*E,w+=(c[y+8+6]-w)*E,x+=(c[y+8+7]-x)*E;break;case 1:u=c[y+1],f=c[y+2],m=c[y+3],p=c[y+4],g=c[y+5],w=c[y+6],x=c[y+7];break;default:u=this.getBezierValue(s,y,1,b-2),f=this.getBezierValue(s,y,2,b+18-2),m=this.getBezierValue(s,y,3,b+18*2-2),p=this.getBezierValue(s,y,4,b+18*3-2),g=this.getBezierValue(s,y,5,b+18*4-2),w=this.getBezierValue(s,y,6,b+18*5-2),x=this.getBezierValue(s,y,7,b+18*6-2)}if(i==1)h.set(u,f,m,p),d.r=g,d.g=w,d.b=x;else{if(o==k.setup){h.setFromColor(a.data.color);const _=a.data.darkColor;d.r=_.r,d.g=_.g,d.b=_.b}h.add((u-h.r)*i,(f-h.g)*i,(m-h.b)*i,(p-h.a)*i),d.r+=(g-d.r)*i,d.g+=(w-d.g)*i,d.b+=(x-d.b)*i}}}class Td extends en{constructor(t,e,s){super(t,e,[`${zt.rgb}|${s}`,`${zt.rgb2}|${s}`]),this.slotIndex=0,this.slotIndex=s}getFrameEntries(){return 7}setFrame(t,e,s,r,i,o,l,a){t*=7,this.frames[t]=e,this.frames[t+1]=s,this.frames[t+2]=r,this.frames[t+3]=i,this.frames[t+4]=o,this.frames[t+5]=l,this.frames[t+6]=a}apply(t,e,s,r,i,o,l){const a=t.slots[this.slotIndex];if(!a.bone.active)return;const c=this.frames,h=a.color,d=a.darkColor;if(s<c[0]){const b=a.data.color,_=a.data.darkColor;switch(o){case k.setup:h.r=b.r,h.g=b.g,h.b=b.b,d.r=_.r,d.g=_.g,d.b=_.b;return;case k.first:h.r+=(b.r-h.r)*i,h.g+=(b.g-h.g)*i,h.b+=(b.b-h.b)*i,d.r+=(_.r-d.r)*i,d.g+=(_.g-d.g)*i,d.b+=(_.b-d.b)*i}return}let u=0,f=0,m=0,p=0,g=0,w=0;const x=be.search(c,s,7),y=this.curves[x/7];switch(y){case 0:const b=c[x];u=c[x+1],f=c[x+2],m=c[x+3],p=c[x+4],g=c[x+5],w=c[x+6];const _=(s-b)/(c[x+7]-b);u+=(c[x+7+1]-u)*_,f+=(c[x+7+2]-f)*_,m+=(c[x+7+3]-m)*_,p+=(c[x+7+4]-p)*_,g+=(c[x+7+5]-g)*_,w+=(c[x+7+6]-w)*_;break;case 1:u=c[x+1],f=c[x+2],m=c[x+3],p=c[x+4],g=c[x+5],w=c[x+6];break;default:u=this.getBezierValue(s,x,1,y-2),f=this.getBezierValue(s,x,2,y+18-2),m=this.getBezierValue(s,x,3,y+18*2-2),p=this.getBezierValue(s,x,4,y+18*3-2),g=this.getBezierValue(s,x,5,y+18*4-2),w=this.getBezierValue(s,x,6,y+18*5-2)}if(i==1)h.r=u,h.g=f,h.b=m,d.r=p,d.g=g,d.b=w;else{if(o==k.setup){const b=a.data.color,_=a.data.darkColor;h.r=b.r,h.g=b.g,h.b=b.b,d.r=_.r,d.g=_.g,d.b=_.b}h.r+=(u-h.r)*i,h.g+=(f-h.g)*i,h.b+=(m-h.b)*i,d.r+=(p-d.r)*i,d.g+=(g-d.g)*i,d.b+=(w-d.b)*i}}}class Br extends be{constructor(t,e){super(t,[`${zt.attachment}|${e}`]),this.slotIndex=0,this.slotIndex=e,this.attachmentNames=new Array(t)}getFrameCount(){return this.frames.length}setFrame(t,e,s){this.frames[t]=e,this.attachmentNames[t]=s}apply(t,e,s,r,i,o,l){const a=t.slots[this.slotIndex];if(a.bone.active){if(l==It.mixOut){o==k.setup&&this.setAttachment(t,a,a.data.attachmentName);return}if(s<this.frames[0]){(o==k.setup||o==k.first)&&this.setAttachment(t,a,a.data.attachmentName);return}this.setAttachment(t,a,this.attachmentNames[be.search1(this.frames,s)])}}setAttachment(t,e,s){e.setAttachment(s?t.getAttachment(this.slotIndex,s):null)}}class Ad extends en{constructor(t,e,s,r){super(t,e,[`${zt.deform}|${s}|${r.id}`]),this.slotIndex=0,this.slotIndex=s,this.attachment=r,this.vertices=new Array(t)}getFrameCount(){return this.frames.length}setFrame(t,e,s){this.frames[t]=e,this.vertices[t]=s}setBezier(t,e,s,r,i,o,l,a,c,h,d){const u=this.curves;let f=this.getFrameCount()+t*18;s==0&&(u[e]=2+f);const m=(r-o*2+a)*.03,p=c*.03-l*.06,g=((o-a)*3-r+h)*.006,w=(l-c+.33333333)*.018;let x=m*2+g,y=p*2+w,b=(o-r)*.3+m+g*.16666667,_=l*.3+p+w*.16666667,E=r+b,S=_;for(let T=f+18;f<T;f+=2)u[f]=E,u[f+1]=S,b+=x,_+=y,x+=g,y+=w,E+=b,S+=_}getCurvePercent(t,e){const s=this.curves;let r=s[e];switch(r){case 0:const a=this.frames[e];return(t-a)/(this.frames[e+this.getFrameEntries()]-a);case 1:return 0}if(r-=2,s[r]>t){const a=this.frames[e];return s[r+1]*(t-a)/(s[r]-a)}const i=r+18;for(r+=2;r<i;r+=2)if(s[r]>=t){const a=s[r-2],c=s[r-1];return c+(t-a)/(s[r]-a)*(s[r+1]-c)}const o=s[i-2],l=s[i-1];return l+(1-l)*(t-o)/(this.frames[e+this.getFrameEntries()]-o)}apply(t,e,s,r,i,o,l){const a=t.slots[this.slotIndex];if(!a.bone.active)return;const c=a.getAttachment();if(!c||!(c instanceof tn)||c.timelineAttachment!=this.attachment)return;const h=a.deform;h.length==0&&(o=k.setup);const d=this.vertices,u=d[0].length,f=this.frames;if(s<f[0]){switch(o){case k.setup:h.length=0;return;case k.first:if(i==1){h.length=0;return}h.length=u;const x=c;if(x.bones){i=1-i;for(let y=0;y<u;y++)h[y]*=i}else{const y=x.vertices;for(let b=0;b<u;b++)h[b]+=(y[b]-h[b])*i}}return}if(h.length=u,s>=f[f.length-1]){const x=d[f.length-1];if(i==1)if(o==k.add){const y=c;if(y.bones)for(let b=0;b<u;b++)h[b]+=x[b];else{const b=y.vertices;for(let _=0;_<u;_++)h[_]+=x[_]-b[_]}}else $.arrayCopy(x,0,h,0,u);else switch(o){case k.setup:{const b=c;if(b.bones)for(let _=0;_<u;_++)h[_]=x[_]*i;else{const _=b.vertices;for(let E=0;E<u;E++){const S=_[E];h[E]=S+(x[E]-S)*i}}break}case k.first:case k.replace:for(let b=0;b<u;b++)h[b]+=(x[b]-h[b])*i;break;case k.add:const y=c;if(y.bones)for(let b=0;b<u;b++)h[b]+=x[b]*i;else{const b=y.vertices;for(let _=0;_<u;_++)h[_]+=(x[_]-b[_])*i}}return}const m=be.search1(f,s),p=this.getCurvePercent(s,m),g=d[m],w=d[m+1];if(i==1)if(o==k.add){const x=c;if(x.bones)for(let y=0;y<u;y++){const b=g[y];h[y]+=b+(w[y]-b)*p}else{const y=x.vertices;for(let b=0;b<u;b++){const _=g[b];h[b]+=_+(w[b]-_)*p-y[b]}}}else for(let x=0;x<u;x++){const y=g[x];h[x]=y+(w[x]-y)*p}else switch(o){case k.setup:{const y=c;if(y.bones)for(let b=0;b<u;b++){const _=g[b];h[b]=(_+(w[b]-_)*p)*i}else{const b=y.vertices;for(let _=0;_<u;_++){const E=g[_],S=b[_];h[_]=S+(E+(w[_]-E)*p-S)*i}}break}case k.first:case k.replace:for(let y=0;y<u;y++){const b=g[y];h[y]+=(b+(w[y]-b)*p-h[y])*i}break;case k.add:const x=c;if(x.bones)for(let y=0;y<u;y++){const b=g[y];h[y]+=(b+(w[y]-b)*p)*i}else{const y=x.vertices;for(let b=0;b<u;b++){const _=g[b];h[b]+=(_+(w[b]-_)*p-y[b])*i}}}}}const Wg=class extends be{constructor(n){super(n,Wg.propertyIds),this.events=new Array(n)}getFrameCount(){return this.frames.length}setFrame(n,t){this.frames[n]=t.time,this.events[n]=t}apply(n,t,e,s,r,i,o){if(!s)return;const l=this.frames,a=this.frames.length;if(t>e)this.apply(n,t,Number.MAX_VALUE,s,r,i,o),t=-1;else if(t>=l[a-1])return;if(e<l[0])return;let c=0;if(t<l[0])c=0;else{c=be.search1(l,t)+1;const h=l[c];for(;c>0&&l[c-1]==h;)c--}for(;c<a&&e>=l[c];c++)s.push(this.events[c])}};let xa=Wg;xa.propertyIds=[`${zt.event}`];const zg=class extends be{constructor(n){super(n,zg.propertyIds),this.drawOrders=new Array(n)}getFrameCount(){return this.frames.length}setFrame(n,t,e){this.frames[n]=t,this.drawOrders[n]=e}apply(n,t,e,s,r,i,o){if(o==It.mixOut){i==k.setup&&$.arrayCopy(n.slots,0,n.drawOrder,0,n.slots.length);return}if(e<this.frames[0]){(i==k.setup||i==k.first)&&$.arrayCopy(n.slots,0,n.drawOrder,0,n.slots.length);return}const l=be.search1(this.frames,e),a=this.drawOrders[l];if(!a)$.arrayCopy(n.slots,0,n.drawOrder,0,n.slots.length);else{const c=n.drawOrder,h=n.slots;for(let d=0,u=a.length;d<u;d++)c[d]=h[a[d]]}}};let Or=zg;Or.propertyIds=[`${zt.drawOrder}`];class Cd extends en{constructor(t,e,s){super(t,e,[`${zt.ikConstraint}|${s}`]),this.ikConstraintIndex=0,this.ikConstraintIndex=s}getFrameEntries(){return 6}setFrame(t,e,s,r,i,o,l){t*=6,this.frames[t]=e,this.frames[t+1]=s,this.frames[t+2]=r,this.frames[t+3]=i,this.frames[t+4]=o?1:0,this.frames[t+5]=l?1:0}apply(t,e,s,r,i,o,l){const a=t.ikConstraints[this.ikConstraintIndex];if(!a.active)return;const c=this.frames;if(s<c[0]){switch(o){case k.setup:a.mix=a.data.mix,a.softness=a.data.softness,a.bendDirection=a.data.bendDirection,a.compress=a.data.compress,a.stretch=a.data.stretch;return;case k.first:a.mix+=(a.data.mix-a.mix)*i,a.softness+=(a.data.softness-a.softness)*i,a.bendDirection=a.data.bendDirection,a.compress=a.data.compress,a.stretch=a.data.stretch}return}let h=0,d=0;const u=be.search(c,s,6),f=this.curves[u/6];switch(f){case 0:const m=c[u];h=c[u+1],d=c[u+2];const p=(s-m)/(c[u+6]-m);h+=(c[u+6+1]-h)*p,d+=(c[u+6+2]-d)*p;break;case 1:h=c[u+1],d=c[u+2];break;default:h=this.getBezierValue(s,u,1,f-2),d=this.getBezierValue(s,u,2,f+18-2)}o==k.setup?(a.mix=a.data.mix+(h-a.data.mix)*i,a.softness=a.data.softness+(d-a.data.softness)*i,l==It.mixOut?(a.bendDirection=a.data.bendDirection,a.compress=a.data.compress,a.stretch=a.data.stretch):(a.bendDirection=c[u+3],a.compress=c[u+4]!=0,a.stretch=c[u+5]!=0)):(a.mix+=(h-a.mix)*i,a.softness+=(d-a.softness)*i,l==It.mixIn&&(a.bendDirection=c[u+3],a.compress=c[u+4]!=0,a.stretch=c[u+5]!=0))}}class kd extends en{constructor(t,e,s){super(t,e,[`${zt.transformConstraint}|${s}`]),this.transformConstraintIndex=0,this.transformConstraintIndex=s}getFrameEntries(){return 7}setFrame(t,e,s,r,i,o,l,a){const c=this.frames;t*=7,c[t]=e,c[t+1]=s,c[t+2]=r,c[t+3]=i,c[t+4]=o,c[t+5]=l,c[t+6]=a}apply(t,e,s,r,i,o,l){const a=t.transformConstraints[this.transformConstraintIndex];if(!a.active)return;const c=this.frames;if(s<c[0]){const x=a.data;switch(o){case k.setup:a.mixRotate=x.mixRotate,a.mixX=x.mixX,a.mixY=x.mixY,a.mixScaleX=x.mixScaleX,a.mixScaleY=x.mixScaleY,a.mixShearY=x.mixShearY;return;case k.first:a.mixRotate+=(x.mixRotate-a.mixRotate)*i,a.mixX+=(x.mixX-a.mixX)*i,a.mixY+=(x.mixY-a.mixY)*i,a.mixScaleX+=(x.mixScaleX-a.mixScaleX)*i,a.mixScaleY+=(x.mixScaleY-a.mixScaleY)*i,a.mixShearY+=(x.mixShearY-a.mixShearY)*i}return}let h,d,u,f,m,p;const g=be.search(c,s,7),w=this.curves[g/7];switch(w){case 0:const x=c[g];h=c[g+1],d=c[g+2],u=c[g+3],f=c[g+4],m=c[g+5],p=c[g+6];const y=(s-x)/(c[g+7]-x);h+=(c[g+7+1]-h)*y,d+=(c[g+7+2]-d)*y,u+=(c[g+7+3]-u)*y,f+=(c[g+7+4]-f)*y,m+=(c[g+7+5]-m)*y,p+=(c[g+7+6]-p)*y;break;case 1:h=c[g+1],d=c[g+2],u=c[g+3],f=c[g+4],m=c[g+5],p=c[g+6];break;default:h=this.getBezierValue(s,g,1,w-2),d=this.getBezierValue(s,g,2,w+18-2),u=this.getBezierValue(s,g,3,w+18*2-2),f=this.getBezierValue(s,g,4,w+18*3-2),m=this.getBezierValue(s,g,5,w+18*4-2),p=this.getBezierValue(s,g,6,w+18*5-2)}if(o==k.setup){const x=a.data;a.mixRotate=x.mixRotate+(h-x.mixRotate)*i,a.mixX=x.mixX+(d-x.mixX)*i,a.mixY=x.mixY+(u-x.mixY)*i,a.mixScaleX=x.mixScaleX+(f-x.mixScaleX)*i,a.mixScaleY=x.mixScaleY+(m-x.mixScaleY)*i,a.mixShearY=x.mixShearY+(p-x.mixShearY)*i}else a.mixRotate+=(h-a.mixRotate)*i,a.mixX+=(d-a.mixX)*i,a.mixY+=(u-a.mixY)*i,a.mixScaleX+=(f-a.mixScaleX)*i,a.mixScaleY+=(m-a.mixScaleY)*i,a.mixShearY+=(p-a.mixShearY)*i}}class Id extends sn{constructor(t,e,s){super(t,e,`${zt.pathConstraintPosition}|${s}`),this.pathConstraintIndex=0,this.pathConstraintIndex=s}apply(t,e,s,r,i,o,l){const a=t.pathConstraints[this.pathConstraintIndex];if(!a.active)return;const c=this.frames;if(s<c[0]){switch(o){case k.setup:a.position=a.data.position;return;case k.first:a.position+=(a.data.position-a.position)*i}return}const h=this.getCurveValue(s);o==k.setup?a.position=a.data.position+(h-a.data.position)*i:a.position+=(h-a.position)*i}}class Rd extends sn{constructor(t,e,s){super(t,e,`${zt.pathConstraintSpacing}|${s}`),this.pathConstraintIndex=0,this.pathConstraintIndex=s}apply(t,e,s,r,i,o,l){const a=t.pathConstraints[this.pathConstraintIndex];if(!a.active)return;const c=this.frames;if(s<c[0]){switch(o){case k.setup:a.spacing=a.data.spacing;return;case k.first:a.spacing+=(a.data.spacing-a.spacing)*i}return}const h=this.getCurveValue(s);o==k.setup?a.spacing=a.data.spacing+(h-a.data.spacing)*i:a.spacing+=(h-a.spacing)*i}}class Md extends en{constructor(t,e,s){super(t,e,[`${zt.pathConstraintMix}|${s}`]),this.pathConstraintIndex=0,this.pathConstraintIndex=s}getFrameEntries(){return 4}setFrame(t,e,s,r,i){const o=this.frames;t<<=2,o[t]=e,o[t+1]=s,o[t+2]=r,o[t+3]=i}apply(t,e,s,r,i,o,l){const a=t.pathConstraints[this.pathConstraintIndex];if(!a.active)return;const c=this.frames;if(s<c[0]){switch(o){case k.setup:a.mixRotate=a.data.mixRotate,a.mixX=a.data.mixX,a.mixY=a.data.mixY;return;case k.first:a.mixRotate+=(a.data.mixRotate-a.mixRotate)*i,a.mixX+=(a.data.mixX-a.mixX)*i,a.mixY+=(a.data.mixY-a.mixY)*i}return}let h,d,u;const f=be.search(c,s,4),m=this.curves[f>>2];switch(m){case 0:const p=c[f];h=c[f+1],d=c[f+2],u=c[f+3];const g=(s-p)/(c[f+4]-p);h+=(c[f+4+1]-h)*g,d+=(c[f+4+2]-d)*g,u+=(c[f+4+3]-u)*g;break;case 1:h=c[f+1],d=c[f+2],u=c[f+3];break;default:h=this.getBezierValue(s,f,1,m-2),d=this.getBezierValue(s,f,2,m+18-2),u=this.getBezierValue(s,f,3,m+18*2-2)}if(o==k.setup){const p=a.data;a.mixRotate=p.mixRotate+(h-p.mixRotate)*i,a.mixX=p.mixX+(d-p.mixX)*i,a.mixY=p.mixY+(u-p.mixY)*i}else a.mixRotate+=(h-a.mixRotate)*i,a.mixX+=(d-a.mixX)*i,a.mixY+=(u-a.mixY)*i}}const Qn=class extends be{constructor(n,t,e){super(n,[`${zt.sequence}|${t}|${e.sequence.id}`]),this.slotIndex=t,this.attachment=e}getFrameEntries(){return Qn.ENTRIES}getSlotIndex(){return this.slotIndex}getAttachment(){return this.attachment}setFrame(n,t,e,s,r){const i=this.frames;n*=Qn.ENTRIES,i[n]=t,i[n+Qn.MODE]=e|s<<4,i[n+Qn.DELAY]=r}apply(n,t,e,s,r,i,o){const l=n.slots[this.slotIndex];if(!l.bone.active)return;const a=l.attachment,c=this.attachment;if(a!=c&&(!(a instanceof tn)||a.timelineAttachment!=c))return;const h=this.frames;if(e<h[0]){(i==k.setup||i==k.first)&&(l.sequenceIndex=-1);return}const d=be.search(h,e,Qn.ENTRIES),u=h[d],f=h[d+Qn.MODE],m=h[d+Qn.DELAY];if(!this.attachment.sequence)return;let p=f>>4;const g=this.attachment.sequence.regions.length,w=dd[f&15];if(w!=un.hold)switch(p+=(e-u)/m+1e-5|0,w){case un.once:p=Math.min(g-1,p);break;case un.loop:p%=g;break;case un.pingpong:{const x=(g<<1)-2;p=x==0?0:p%x,p>=g&&(p=x-p);break}case un.onceReverse:p=Math.max(g-1-p,0);break;case un.loopReverse:p=g-1-p%g;break;case un.pingpongReverse:{const x=(g<<1)-2;p=x==0?0:(p+g-1)%x,p>=g&&(p=x-p)}}l.sequenceIndex=p}};let Ti=Qn;Ti.ENTRIES=3;Ti.MODE=1;Ti.DELAY=2;const hn=class{constructor(n){this.tracks=new Array,this.timeScale=1,this.unkeyedState=0,this.events=new Array,this.listeners=new Array,this.queue=new Hg(this),this.propertyIDs=new eg,this.animationsChanged=!1,this.trackEntryPool=new Ho(()=>new al),this.data=n}static emptyAnimation(){return hn._emptyAnimation}update(n){n*=this.timeScale;const t=this.tracks;for(let e=0,s=t.length;e<s;e++){const r=t[e];if(!r)continue;r.animationLast=r.nextAnimationLast,r.trackLast=r.nextTrackLast;let i=n*r.timeScale;if(r.delay>0){if(r.delay-=i,r.delay>0)continue;i=-r.delay,r.delay=0}let o=r.next;if(o){const l=r.trackLast-o.delay;if(l>=0){for(o.delay=0,o.trackTime+=r.timeScale==0?0:(l/r.timeScale+n)*o.timeScale,r.trackTime+=i,this.setCurrent(e,o,!0);o.mixingFrom;)o.mixTime+=n,o=o.mixingFrom;continue}}else if(r.trackLast>=r.trackEnd&&!r.mixingFrom){t[e]=null,this.queue.end(r),this.clearNext(r);continue}if(r.mixingFrom&&this.updateMixingFrom(r,n)){let l=r.mixingFrom;for(r.mixingFrom=null,l&&(l.mixingTo=null);l;)this.queue.end(l),l=l.mixingFrom}r.trackTime+=i}this.queue.drain()}updateMixingFrom(n,t){const e=n.mixingFrom;if(!e)return!0;const s=this.updateMixingFrom(e,t);return e.animationLast=e.nextAnimationLast,e.trackLast=e.nextTrackLast,n.mixTime>0&&n.mixTime>=n.mixDuration?((e.totalAlpha==0||n.mixDuration==0)&&(n.mixingFrom=e.mixingFrom,e.mixingFrom&&(e.mixingFrom.mixingTo=n),n.interruptAlpha=e.interruptAlpha,this.queue.end(e)),s):(e.trackTime+=t*e.timeScale,n.mixTime+=t,!1)}apply(n){if(!n)throw new Error("skeleton cannot be null.");this.animationsChanged&&this._animationsChanged();const t=this.events,e=this.tracks;let s=!1;for(let o=0,l=e.length;o<l;o++){const a=e[o];if(!a||a.delay>0)continue;s=!0;const c=o==0?k.first:a.mixBlend;let h=a.alpha;a.mixingFrom?h*=this.applyMixingFrom(a,n,c):a.trackTime>=a.trackEnd&&!a.next&&(h=0);const d=a.animationLast,u=a.getAnimationTime();let f=u,m=t;a.reverse&&(f=a.animation.duration-f,m=null);const p=a.animation.timelines,g=p.length;if(o==0&&h==1||c==k.add)for(let w=0;w<g;w++){const x=p[w];x instanceof Br?this.applyAttachmentTimeline(x,n,f,c,!0):x.apply(n,d,f,m,h,c,It.mixIn)}else{const w=a.timelineMode,x=a.shortestRotation,y=!x&&a.timelinesRotation.length!=g<<1;y&&(a.timelinesRotation.length=g<<1);for(let b=0;b<g;b++){const _=p[b],E=w[b]==Wl?c:k.setup;!x&&_ instanceof ha?this.applyRotateTimeline(_,n,f,h,E,a.timelinesRotation,b<<1,y):_ instanceof Br?this.applyAttachmentTimeline(_,n,f,c,!0):_.apply(n,d,f,m,h,E,It.mixIn)}}this.queueEvents(a,u),t.length=0,a.nextAnimationLast=u,a.nextTrackLast=a.trackTime}const r=this.unkeyedState+Ff,i=n.slots;for(let o=0,l=n.slots.length;o<l;o++){const a=i[o];if(a.attachmentState==r){const c=a.data.attachmentName;a.setAttachment(c?n.getAttachment(a.data.index,c):null)}}return this.unkeyedState+=2,this.queue.drain(),s}applyMixingFrom(n,t,e){const s=n.mixingFrom;s.mixingFrom&&this.applyMixingFrom(s,t,e);let r=0;n.mixDuration==0?(r=1,e==k.first&&(e=k.setup)):(r=n.mixTime/n.mixDuration,r>1&&(r=1),e!=k.first&&(e=s.mixBlend));const i=r<s.attachmentThreshold,o=r<s.drawOrderThreshold,l=s.animation.timelines,a=l.length,c=s.alpha*n.interruptAlpha,h=c*(1-r),d=s.animationLast,u=s.getAnimationTime();let f=u,m=null;if(s.reverse?f=s.animation.duration-f:r<s.eventThreshold&&(m=this.events),e==k.add)for(let p=0;p<a;p++)l[p].apply(t,d,f,m,h,e,It.mixOut);else{const p=s.timelineMode,g=s.timelineHoldMix,w=s.shortestRotation,x=!w&&s.timelinesRotation.length!=a<<1;x&&(s.timelinesRotation.length=a<<1),s.totalAlpha=0;for(let y=0;y<a;y++){const b=l[y];let _=It.mixOut,E,S=0;switch(p[y]){case Wl:if(!o&&b instanceof Or)continue;E=e,S=h;break;case Pf:E=k.setup,S=h;break;case Nf:E=e,S=c;break;case zl:E=k.setup,S=c;break;default:E=k.setup;const T=g[y];S=c*Math.max(0,1-T.mixTime/T.mixDuration);break}s.totalAlpha+=S,!w&&b instanceof ha?this.applyRotateTimeline(b,t,f,S,E,s.timelinesRotation,y<<1,x):b instanceof Br?this.applyAttachmentTimeline(b,t,f,E,i):(o&&b instanceof Or&&E==k.setup&&(_=It.mixIn),b.apply(t,d,f,m,S,E,_))}}return n.mixDuration>0&&this.queueEvents(s,u),this.events.length=0,s.nextAnimationLast=u,s.nextTrackLast=s.trackTime,r}applyAttachmentTimeline(n,t,e,s,r){const i=t.slots[n.slotIndex];i.bone.active&&(e<n.frames[0]?(s==k.setup||s==k.first)&&this.setAttachment(t,i,i.data.attachmentName,r):this.setAttachment(t,i,n.attachmentNames[be.search1(n.frames,e)],r),i.attachmentState<=this.unkeyedState&&(i.attachmentState=this.unkeyedState+Ff))}setAttachment(n,t,e,s){t.setAttachment(e?n.getAttachment(t.data.index,e):null),s&&(t.attachmentState=this.unkeyedState+uS)}applyRotateTimeline(n,t,e,s,r,i,o,l){if(l&&(i[o]=0),s==1){n.apply(t,0,e,null,1,r,It.mixIn);return}const a=t.bones[n.boneIndex];if(!a.active)return;const c=n.frames;let h=0,d=0;if(e<c[0])switch(r){case k.setup:a.rotation=a.data.rotation;default:return;case k.first:h=a.rotation,d=a.data.rotation}else h=r==k.setup?a.data.rotation:a.rotation,d=a.data.rotation+n.getCurveValue(e);let u=0,f=d-h;if(f-=(16384-(16384.499999999996-f/360|0))*360,f==0)u=i[o];else{let m=0,p=0;l?(m=0,p=f):(m=i[o],p=i[o+1]);const g=f>0;let w=m>=0;P.signum(p)!=P.signum(f)&&Math.abs(p)<=90&&(Math.abs(m)>180&&(m+=360*P.signum(m)),w=g),u=f+m-m%360,w!=g&&(u+=360*P.signum(m)),i[o]=u}i[o+1]=f,a.rotation=h+u*s}queueEvents(n,t){const e=n.animationStart,s=n.animationEnd,r=s-e,i=n.trackLast%r,o=this.events;let l=0;const a=o.length;for(;l<a;l++){const h=o[l];if(h.time<i)break;h.time>s||this.queue.event(n,h)}let c=!1;for(n.loop?c=r==0||i>n.trackTime%r:c=t>=s&&n.animationLast<s,c&&this.queue.complete(n);l<a;l++){const h=o[l];h.time<e||this.queue.event(n,h)}}clearTracks(){const n=this.queue.drainDisabled;this.queue.drainDisabled=!0;for(let t=0,e=this.tracks.length;t<e;t++)this.clearTrack(t);this.tracks.length=0,this.queue.drainDisabled=n,this.queue.drain()}clearTrack(n){if(n>=this.tracks.length)return;const t=this.tracks[n];if(!t)return;this.queue.end(t),this.clearNext(t);let e=t;for(;;){const s=e.mixingFrom;if(!s)break;this.queue.end(s),e.mixingFrom=null,e.mixingTo=null,e=s}this.tracks[t.trackIndex]=null,this.queue.drain()}setCurrent(n,t,e){const s=this.expandToIndex(n);this.tracks[n]=t,t.previous=null,s&&(e&&this.queue.interrupt(s),t.mixingFrom=s,s.mixingTo=t,t.mixTime=0,s.mixingFrom&&s.mixDuration>0&&(t.interruptAlpha*=Math.min(1,s.mixTime/s.mixDuration)),s.timelinesRotation.length=0),this.queue.start(t)}setAnimation(n,t,e=!1){const s=this.data.skeletonData.findAnimation(t);if(!s)throw new Error(`Animation not found: ${t}`);return this.setAnimationWith(n,s,e)}setAnimationWith(n,t,e=!1){if(!t)throw new Error("animation cannot be null.");let s=!0,r=this.expandToIndex(n);r&&(r.nextTrackLast==-1?(this.tracks[n]=r.mixingFrom,this.queue.interrupt(r),this.queue.end(r),this.clearNext(r),r=r.mixingFrom,s=!1):this.clearNext(r));const i=this.trackEntry(n,t,e,r);return this.setCurrent(n,i,s),this.queue.drain(),i}addAnimation(n,t,e=!1,s=0){const r=this.data.skeletonData.findAnimation(t);if(!r)throw new Error(`Animation not found: ${t}`);return this.addAnimationWith(n,r,e,s)}addAnimationWith(n,t,e=!1,s=0){if(!t)throw new Error("animation cannot be null.");let r=this.expandToIndex(n);if(r)for(;r.next;)r=r.next;const i=this.trackEntry(n,t,e,r);return r?(r.next=i,i.previous=r,s<=0&&(s+=r.getTrackComplete()-i.mixDuration)):(this.setCurrent(n,i,!0),this.queue.drain()),i.delay=s,i}setEmptyAnimation(n,t=0){const e=this.setAnimationWith(n,hn.emptyAnimation(),!1);return e.mixDuration=t,e.trackEnd=t,e}addEmptyAnimation(n,t=0,e=0){const s=this.addAnimationWith(n,hn.emptyAnimation(),!1,e);return e<=0&&(s.delay+=s.mixDuration-t),s.mixDuration=t,s.trackEnd=t,s}setEmptyAnimations(n=0){const t=this.queue.drainDisabled;this.queue.drainDisabled=!0;for(let e=0,s=this.tracks.length;e<s;e++){const r=this.tracks[e];r&&this.setEmptyAnimation(r.trackIndex,n)}this.queue.drainDisabled=t,this.queue.drain()}expandToIndex(n){return n<this.tracks.length?this.tracks[n]:($.ensureArrayCapacity(this.tracks,n+1,null),this.tracks.length=n+1,null)}trackEntry(n,t,e,s){const r=this.trackEntryPool.obtain();return r.reset(),r.trackIndex=n,r.animation=t,r.loop=e,r.holdPrevious=!1,r.reverse=!1,r.shortestRotation=!1,r.eventThreshold=0,r.attachmentThreshold=0,r.drawOrderThreshold=0,r.animationStart=0,r.animationEnd=t.duration,r.animationLast=-1,r.nextAnimationLast=-1,r.delay=0,r.trackTime=0,r.trackLast=-1,r.nextTrackLast=-1,r.trackEnd=Number.MAX_VALUE,r.timeScale=1,r.alpha=1,r.mixTime=0,r.mixDuration=s?this.data.getMix(s.animation,t):0,r.interruptAlpha=1,r.totalAlpha=0,r.mixBlend=k.replace,r}clearNext(n){let t=n.next;for(;t;)this.queue.dispose(t),t=t.next;n.next=null}_animationsChanged(){this.animationsChanged=!1,this.propertyIDs.clear();const n=this.tracks;for(let t=0,e=n.length;t<e;t++){let s=n[t];if(s){for(;s.mixingFrom;)s=s.mixingFrom;do(!s.mixingTo||s.mixBlend!=k.add)&&this.computeHold(s),s=s.mixingTo;while(s)}}}computeHold(n){const t=n.mixingTo,e=n.animation.timelines,s=n.animation.timelines.length,r=n.timelineMode;r.length=s;const i=n.timelineHoldMix;i.length=0;const o=this.propertyIDs;if(t&&t.holdPrevious){for(let l=0;l<s;l++)r[l]=o.addAll(e[l].getPropertyIds())?zl:Nf;return}t:for(let l=0;l<s;l++){const a=e[l],c=a.getPropertyIds();if(!o.addAll(c))r[l]=Wl;else if(!t||a instanceof Br||a instanceof Or||a instanceof xa||!t.animation.hasTimeline(c))r[l]=Pf;else{for(let h=t.mixingTo;h;h=h.mixingTo)if(!h.animation.hasTimeline(c)){if(n.mixDuration>0){r[l]=dS,i[l]=h;continue t}break}r[l]=zl}}}getCurrent(n){return n>=this.tracks.length?null:this.tracks[n]}addListener(n){if(!n)throw new Error("listener cannot be null.");this.listeners.push(n)}removeListener(n){const t=this.listeners.indexOf(n);t>=0&&this.listeners.splice(t,1)}clearListeners(){this.listeners.length=0}clearListenerNotifications(){this.queue.clear()}setAnimationByName(n,t,e){hn.deprecatedWarning1||(hn.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: AnimationState.setAnimationByName is deprecated, please use setAnimation from now on.")),this.setAnimation(n,t,e)}addAnimationByName(n,t,e,s){hn.deprecatedWarning2||(hn.deprecatedWarning2=!0,console.warn("Spine Deprecation Warning: AnimationState.addAnimationByName is deprecated, please use addAnimation from now on.")),this.addAnimation(n,t,e,s)}hasAnimation(n){return this.data.skeletonData.findAnimation(n)!==null}hasAnimationByName(n){return hn.deprecatedWarning3||(hn.deprecatedWarning3=!0,console.warn("Spine Deprecation Warning: AnimationState.hasAnimationByName is deprecated, please use hasAnimation from now on.")),this.hasAnimation(n)}};let Ai=hn;Ai._emptyAnimation=new rl("<empty>",[],0);Ai.deprecatedWarning1=!1;Ai.deprecatedWarning2=!1;Ai.deprecatedWarning3=!1;const An=class{constructor(){this.animation=null,this.previous=null,this.next=null,this.mixingFrom=null,this.mixingTo=null,this.listener=null,this.trackIndex=0,this.loop=!1,this.holdPrevious=!1,this.reverse=!1,this.shortestRotation=!1,this.eventThreshold=0,this.attachmentThreshold=0,this.drawOrderThreshold=0,this.animationStart=0,this.animationEnd=0,this.animationLast=0,this.nextAnimationLast=0,this.delay=0,this.trackTime=0,this.trackLast=0,this.nextTrackLast=0,this.trackEnd=0,this.timeScale=0,this.alpha=0,this.mixTime=0,this.mixDuration=0,this.interruptAlpha=0,this.totalAlpha=0,this.mixBlend=k.replace,this.timelineMode=new Array,this.timelineHoldMix=new Array,this.timelinesRotation=new Array}reset(){this.next=null,this.previous=null,this.mixingFrom=null,this.mixingTo=null,this.animation=null,this.listener=null,this.timelineMode.length=0,this.timelineHoldMix.length=0,this.timelinesRotation.length=0}getAnimationTime(){if(this.loop){const n=this.animationEnd-this.animationStart;return n==0?this.animationStart:this.trackTime%n+this.animationStart}return Math.min(this.trackTime+this.animationStart,this.animationEnd)}setAnimationLast(n){this.animationLast=n,this.nextAnimationLast=n}isComplete(){return this.trackTime>=this.animationEnd-this.animationStart}resetRotationDirections(){this.timelinesRotation.length=0}getTrackComplete(){const n=this.animationEnd-this.animationStart;if(n!=0){if(this.loop)return n*(1+(this.trackTime/n|0));if(this.trackTime<n)return n}return this.trackTime}get time(){return An.deprecatedWarning1||(An.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: TrackEntry.time is deprecated, please use trackTime from now on.")),this.trackTime}set time(n){An.deprecatedWarning1||(An.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: TrackEntry.time is deprecated, please use trackTime from now on.")),this.trackTime=n}get endTime(){return An.deprecatedWarning2||(An.deprecatedWarning2=!0,console.warn("Spine Deprecation Warning: TrackEntry.endTime is deprecated, please use trackEnd from now on.")),this.trackTime}set endTime(n){An.deprecatedWarning2||(An.deprecatedWarning2=!0,console.warn("Spine Deprecation Warning: TrackEntry.endTime is deprecated, please use trackEnd from now on.")),this.trackTime=n}loopsCount(){return Math.floor(this.trackTime/this.trackEnd)}};let al=An;al.deprecatedWarning1=!1;al.deprecatedWarning2=!1;class Hg{constructor(t){this.objects=[],this.drainDisabled=!1,this.animState=t}start(t){this.objects.push(as.start),this.objects.push(t),this.animState.animationsChanged=!0}interrupt(t){this.objects.push(as.interrupt),this.objects.push(t)}end(t){this.objects.push(as.end),this.objects.push(t),this.animState.animationsChanged=!0}dispose(t){this.objects.push(as.dispose),this.objects.push(t)}complete(t){this.objects.push(as.complete),this.objects.push(t)}event(t,e){this.objects.push(as.event),this.objects.push(t),this.objects.push(e)}drain(){if(this.drainDisabled)return;this.drainDisabled=!0;const t=this.objects,e=this.animState.listeners;for(let s=0;s<t.length;s+=2){const r=t[s],i=t[s+1];switch(r){case as.start:i.listener&&i.listener.start&&i.listener.start(i);for(let l=0;l<e.length;l++){const a=e[l];a.start&&a.start(i)}break;case as.interrupt:i.listener&&i.listener.interrupt&&i.listener.interrupt(i);for(let l=0;l<e.length;l++){const a=e[l];a.interrupt&&a.interrupt(i)}break;case as.end:i.listener&&i.listener.end&&i.listener.end(i);for(let l=0;l<e.length;l++){const a=e[l];a.end&&a.end(i)}case as.dispose:i.listener&&i.listener.dispose&&i.listener.dispose(i);for(let l=0;l<e.length;l++){const a=e[l];a.dispose&&a.dispose(i)}this.animState.trackEntryPool.free(i);break;case as.complete:i.listener&&i.listener.complete&&i.listener.complete(i);for(let l=0;l<e.length;l++){const a=e[l];a.complete&&a.complete(i)}break;case as.event:const o=t[s+++2];i.listener&&i.listener.event&&i.listener.event(i,o);for(let l=0;l<e.length;l++){const a=e[l];a.event&&a.event(i,o)}break}}this.clear(),this.drainDisabled=!1}clear(){this.objects.length=0}}var as=(n=>(n[n.start=0]="start",n[n.interrupt=1]="interrupt",n[n.end=2]="end",n[n.dispose=3]="dispose",n[n.complete=4]="complete",n[n.event=5]="event",n))(as||{});class hS{start(t){}interrupt(t){}end(t){}dispose(t){}complete(t){}event(t,e){}}const Wl=0,Pf=1,Nf=2,zl=3,dS=4,Ff=1,uS=2;class qg{constructor(t){if(this.animationToMixTime={},this.defaultMix=0,!t)throw new Error("skeletonData cannot be null.");this.skeletonData=t}setMix(t,e,s){const r=this.skeletonData.findAnimation(t);if(!r)throw new Error(`Animation not found: ${t}`);const i=this.skeletonData.findAnimation(e);if(!i)throw new Error(`Animation not found: ${e}`);this.setMixWith(r,i,s)}setMixWith(t,e,s){if(!t)throw new Error("from cannot be null.");if(!e)throw new Error("to cannot be null.");const r=`${t.name}.${e.name}`;this.animationToMixTime[r]=s}getMix(t,e){const s=`${t.name}.${e.name}`,r=this.animationToMixTime[s];return r===void 0?this.defaultMix:r}}class Pd{constructor(t){this.atlas=t}loadSequence(t,e,s){const r=s.regions;for(let i=0,o=r.length;i<o;i++){const l=s.getPath(e,i),a=this.atlas.findRegion(l);if(a==null)throw new Error(`Region not found in atlas: ${l} (sequence: ${t})`);r[i]=a,r[i].renderObject=r[i]}}newRegionAttachment(t,e,s,r){const i=new Ot(e,s);if(r!=null)this.loadSequence(e,s,r);else{const o=this.atlas.findRegion(s);if(!o)throw new Error(`Region not found in atlas: ${s} (region attachment: ${e})`);o.renderObject=o,i.region=o}return i}newMeshAttachment(t,e,s,r){const i=new Xr(e,s);if(r!=null)this.loadSequence(e,s,r);else{const o=this.atlas.findRegion(s);if(!o)throw new Error(`Region not found in atlas: ${s} (mesh attachment: ${e})`);o.renderObject=o,i.region=o}return i}newBoundingBoxAttachment(t,e){return new tl(e)}newPathAttachment(t,e){return new Gr(e)}newPointAttachment(t,e){return new sl(e)}newClippingAttachment(t,e){return new el(e)}}class lh{constructor(t,e,s){if(this.matrix=new Zt,this.parent=null,this.children=new Array,this.x=0,this.y=0,this.rotation=0,this.scaleX=0,this.scaleY=0,this.shearX=0,this.shearY=0,this.ax=0,this.ay=0,this.arotation=0,this.ascaleX=0,this.ascaleY=0,this.ashearX=0,this.ashearY=0,this.sorted=!1,this.active=!1,!t)throw new Error("data cannot be null.");if(!e)throw new Error("skeleton cannot be null.");this.data=t,this.skeleton=e,this.parent=s,this.setToSetupPose()}get worldX(){return this.matrix.tx}get worldY(){return this.matrix.ty}isActive(){return this.active}update(){this.updateWorldTransformWith(this.ax,this.ay,this.arotation,this.ascaleX,this.ascaleY,this.ashearX,this.ashearY)}updateWorldTransform(){this.updateWorldTransformWith(this.x,this.y,this.rotation,this.scaleX,this.scaleY,this.shearX,this.shearY)}updateWorldTransformWith(t,e,s,r,i,o,l){this.ax=t,this.ay=e,this.arotation=s,this.ascaleX=r,this.ascaleY=i,this.ashearX=o,this.ashearY=l;const a=this.parent,c=this.matrix,h=this.skeleton.scaleX,d=-this.skeleton.scaleY;if(!a){const g=this.skeleton,w=s+90+l;c.a=P.cosDeg(s+o)*r*h,c.c=P.cosDeg(w)*i*h,c.b=P.sinDeg(s+o)*r*d,c.d=P.sinDeg(w)*i*d,c.tx=t*h+g.x,c.ty=e*d+g.y;return}let u=a.matrix.a,f=a.matrix.c,m=a.matrix.b,p=a.matrix.d;switch(c.tx=u*t+f*e+a.matrix.tx,c.ty=m*t+p*e+a.matrix.ty,this.data.transformMode){case wt.Normal:{const g=s+90+l,w=P.cosDeg(s+o)*r,x=P.cosDeg(g)*i,y=P.sinDeg(s+o)*r,b=P.sinDeg(g)*i;c.a=u*w+f*y,c.c=u*x+f*b,c.b=m*w+p*y,c.d=m*x+p*b;return}case wt.OnlyTranslation:{const g=s+90+l;c.a=P.cosDeg(s+o)*r,c.c=P.cosDeg(g)*i,c.b=P.sinDeg(s+o)*r,c.d=P.sinDeg(g)*i;break}case wt.NoRotationOrReflection:{let g=u*u+m*m,w=0;g>1e-4?(g=Math.abs(u*p-f*m)/g,u/=h,m/=d,f=m*g,p=u*g,w=Math.atan2(m,u)*P.radDeg):(u=0,m=0,w=90-Math.atan2(p,f)*P.radDeg);const x=s+o-w,y=s+l-w+90,b=P.cosDeg(x)*r,_=P.cosDeg(y)*i,E=P.sinDeg(x)*r,S=P.sinDeg(y)*i;c.a=u*b-f*E,c.c=u*_-f*S,c.b=m*b+p*E,c.d=m*_+p*S;break}case wt.NoScale:case wt.NoScaleOrReflection:{const g=P.cosDeg(s),w=P.sinDeg(s);let x=(u*g+f*w)/h,y=(m*g+p*w)/d,b=Math.sqrt(x*x+y*y);b>1e-5&&(b=1/b),x*=b,y*=b,b=Math.sqrt(x*x+y*y),this.data.transformMode==wt.NoScale&&u*p-f*m<0!=(h<0!=d<0)&&(b=-b);const _=Math.PI/2+Math.atan2(y,x),E=Math.cos(_)*b,S=Math.sin(_)*b,T=P.cosDeg(o)*r,C=P.cosDeg(90+l)*i,A=P.sinDeg(o)*r,R=P.sinDeg(90+l)*i;c.a=x*T+E*A,c.c=x*C+E*R,c.b=y*T+S*A,c.d=y*C+S*R;break}}c.a*=h,c.c*=h,c.b*=d,c.d*=d}setToSetupPose(){const t=this.data;this.x=t.x,this.y=t.y,this.rotation=t.rotation,this.scaleX=t.scaleX,this.scaleY=t.scaleY,this.shearX=t.shearX,this.shearY=t.shearY}getWorldRotationX(){return Math.atan2(this.matrix.b,this.matrix.a)*P.radDeg}getWorldRotationY(){return Math.atan2(this.matrix.d,this.matrix.c)*P.radDeg}getWorldScaleX(){const t=this.matrix;return Math.sqrt(t.a*t.a+t.b*t.b)}getWorldScaleY(){const t=this.matrix;return Math.sqrt(t.c*t.c+t.d*t.d)}updateAppliedTransform(){const t=this.parent,e=this.matrix;if(!t){this.ax=e.tx-this.skeleton.x,this.ay=e.ty-this.skeleton.y,this.arotation=Math.atan2(e.b,e.a)*P.radDeg,this.ascaleX=Math.sqrt(e.a*e.a+e.b*e.b),this.ascaleY=Math.sqrt(e.c*e.c+e.d*e.d),this.ashearX=0,this.ashearY=Math.atan2(e.a*e.c+e.b*e.d,e.a*e.d-e.b*e.c)*P.radDeg;return}const s=t.matrix,r=1/(s.a*s.d-s.b*s.c),i=e.tx-s.tx,o=e.ty-s.ty;this.ax=i*s.d*r-o*s.c*r,this.ay=o*s.a*r-i*s.b*r;const l=r*s.d,a=r*s.a,c=r*s.c,h=r*s.b,d=l*e.a-c*e.b,u=l*e.c-c*e.d,f=a*e.b-h*e.a,m=a*e.d-h*e.c;if(this.ashearX=0,this.ascaleX=Math.sqrt(d*d+f*f),this.ascaleX>1e-4){const p=d*m-u*f;this.ascaleY=p/this.ascaleX,this.ashearY=Math.atan2(d*u+f*m,p)*P.radDeg,this.arotation=Math.atan2(f,d)*P.radDeg}else this.ascaleX=0,this.ascaleY=Math.sqrt(u*u+m*m),this.ashearY=0,this.arotation=90-Math.atan2(m,u)*P.radDeg}worldToLocal(t){const e=this.matrix,s=e.a,r=e.c,i=e.b,o=e.d,l=1/(s*o-r*i),a=t.x-e.tx,c=t.y-e.ty;return t.x=a*o*l-c*r*l,t.y=c*s*l-a*i*l,t}localToWorld(t){const e=this.matrix,s=t.x,r=t.y;return t.x=s*e.a+r*e.c+e.tx,t.y=s*e.b+r*e.d+e.ty,t}worldToLocalRotation(t){const e=P.sinDeg(t),s=P.cosDeg(t),r=this.matrix;return Math.atan2(r.a*e-r.b*s,r.d*s-r.c*e)*P.radDeg}localToWorldRotation(t){t-=this.rotation-this.shearX;const e=P.sinDeg(t),s=P.cosDeg(t),r=this.matrix;return Math.atan2(s*r.b+e*r.d,s*r.a+e*r.c)*P.radDeg}rotateWorld(t){const e=this.matrix,s=e.a,r=e.c,i=e.b,o=e.d,l=P.cosDeg(t),a=P.sinDeg(t);e.a=l*s-a*i,e.c=l*r-a*o,e.b=a*s+l*i,e.d=a*r+l*o}}class Nd{constructor(t,e,s){if(this.index=0,this.parent=null,this.length=0,this.x=0,this.y=0,this.rotation=0,this.scaleX=1,this.scaleY=1,this.shearX=0,this.shearY=0,this.transformMode=wt.Normal,this.skinRequired=!1,this.color=new et,t<0)throw new Error("index must be >= 0.");if(!e)throw new Error("name cannot be null.");this.index=t,this.name=e,this.parent=s}}class ol{constructor(t,e,s){this.name=t,this.order=e,this.skinRequired=s}}let Fd=class{constructor(t,e){if(this.intValue=0,this.floatValue=0,this.stringValue=null,this.time=0,this.volume=0,this.balance=0,!e)throw new Error("data cannot be null.");this.time=t,this.data=e}};class Dd{constructor(t){this.intValue=0,this.floatValue=0,this.stringValue=null,this.audioPath=null,this.volume=0,this.balance=0,this.name=t}}class Kg{constructor(t,e){if(this.bendDirection=0,this.compress=!1,this.stretch=!1,this.mix=1,this.softness=0,this.active=!1,!t)throw new Error("data cannot be null.");if(!e)throw new Error("skeleton cannot be null.");this.data=t,this.mix=t.mix,this.softness=t.softness,this.bendDirection=t.bendDirection,this.compress=t.compress,this.stretch=t.stretch,this.bones=new Array;for(let r=0;r<t.bones.length;r++){const i=e.findBone(t.bones[r].name);if(!i)throw new Error(`Couldn't find bone ${t.bones[r].name}`);this.bones.push(i)}const s=e.findBone(t.target.name);if(!s)throw new Error(`Couldn't find bone ${t.target.name}`);this.target=s}isActive(){return this.active}update(){if(this.mix==0)return;const t=this.target,e=this.bones;switch(e.length){case 1:this.apply1(e[0],t.worldX,t.worldY,this.compress,this.stretch,this.data.uniform,this.mix);break;case 2:this.apply2(e[0],e[1],t.worldX,t.worldY,this.bendDirection,this.stretch,this.data.uniform,this.softness,this.mix);break}}apply1(t,e,s,r,i,o,l){const a=t.parent.matrix;if(!a)throw new Error("IK bone must have parent.");const c=a.a;let h=a.c;const d=a.b;let u=a.d,f=-t.ashearX-t.arotation,m=0,p=0;const g=t.skeleton.scaleX,w=-t.skeleton.scaleY;switch(t.data.transformMode){case wt.OnlyTranslation:m=e-t.worldX,p=s-t.worldY,p=-p;break;case wt.NoRotationOrReflection:const b=Math.abs(c*u-h*d)/(c*c+d*d),_=c/g,E=d/w;h=-E*b*g,u=_*b*w,f+=Math.atan2(E,_)*P.radDeg;default:const S=e-a.tx,T=s-a.ty,C=c*u-h*d;m=(S*u-T*h)/C-t.ax,p=(T*c-S*d)/C-t.ay}f+=Math.atan2(p,m)*P.radDeg,t.ascaleX<0&&(f+=180),f>180?f-=360:f<-180&&(f+=360);let x=t.ascaleX,y=t.ascaleY;if(r||i){switch(t.data.transformMode){case wt.NoScale:case wt.NoScaleOrReflection:m=e-t.worldX,p=s-t.worldY}const b=t.data.length*x,_=Math.sqrt(m*m+p*p);if(r&&_<b||i&&_>b&&b>1e-4){const E=(_/b-1)*l+1;x*=E,o&&(y*=E)}}t.updateWorldTransformWith(t.ax,t.ay,t.arotation+f*l,x,y,t.ashearX,t.ashearY)}apply2(t,e,s,r,i,o,l,a,c){const h=t.ax,d=t.ay;let u=t.ascaleX,f=t.ascaleY,m=u,p=f,g=e.ascaleX;const w=t.matrix;let x=0,y=0,b=0;u<0?(u=-u,x=180,b=-1):(x=0,b=1),f<0&&(f=-f,b=-b),g<0?(g=-g,y=180):y=0;const _=e.ax;let E=0,S=0,T=0,C=w.a,A=w.c,R=w.b,M=w.d;const I=Math.abs(u-f)<=1e-4;!I||o?(E=0,S=C*_+w.tx,T=R*_+w.ty):(E=e.ay,S=C*_+A*E+w.tx,T=R*_+M*E+w.ty);const N=t.parent.matrix;if(!N)throw new Error("IK parent must itself have a parent.");C=N.a,A=N.c,R=N.b,M=N.d;const F=1/(C*M-A*R);let B=S-N.tx,Y=T-N.ty;const O=(B*M-Y*A)*F-h,V=(Y*C-B*R)*F-d,j=Math.sqrt(O*O+V*V);let X=e.data.length*g,L,U;if(j<1e-4){this.apply1(t,s,r,!1,o,!1,c),e.updateWorldTransformWith(_,E,0,e.ascaleX,e.ascaleY,e.ashearX,e.ashearY);return}B=s-N.tx,Y=r-N.ty;let q=(B*M-Y*A)*F-h,H=(Y*C-B*R)*F-d,J=q*q+H*H;if(a!=0){a*=u*(g+1)*.5;const K=Math.sqrt(J),Z=K-j-X*u+a;if(Z>0){let nt=Math.min(1,Z/(a*2))-1;nt=(Z-a*(1-nt*nt))/K,q-=nt*q,H-=nt*H,J=q*q+H*H}}t:if(I){X*=u;let K=(J-j*j-X*X)/(2*j*X);K<-1?(K=-1,U=Math.PI*i):K>1?(K=1,U=0,o&&(C=(Math.sqrt(J)/(j+X)-1)*c+1,m*=C,l&&(p*=C))):U=Math.acos(K)*i,C=j+X*K,A=X*Math.sin(U),L=Math.atan2(H*C-q*A,q*C+H*A)}else{C=u*X,A=f*X;const K=C*C,Z=A*A,nt=Math.atan2(H,q);R=Z*j*j+K*J-K*Z;const gt=-2*Z*j,rt=Z-K;if(M=gt*gt-4*rt*R,M>=0){let Jt=Math.sqrt(M);gt<0&&(Jt=-Jt),Jt=-(gt+Jt)*.5;const Ye=Jt/rt,Xn=R/Jt,Is=Math.abs(Ye)<Math.abs(Xn)?Ye:Xn;if(Is*Is<=J){Y=Math.sqrt(J-Is*Is)*i,L=nt-Math.atan2(Y,Is),U=Math.atan2(Y/f,(Is-j)/u);break t}}let bt=P.PI,Ct=j-C,jt=Ct*Ct,kt=0,ee=0,se=j+C,ie=se*se,Qt=0;R=-C*j/(K-Z),R>=-1&&R<=1&&(R=Math.acos(R),B=C*Math.cos(R)+j,Y=A*Math.sin(R),M=B*B+Y*Y,M<jt&&(bt=R,jt=M,Ct=B,kt=Y),M>ie&&(ee=R,ie=M,se=B,Qt=Y)),J<=(jt+ie)*.5?(L=nt-Math.atan2(kt*i,Ct),U=bt*i):(L=nt-Math.atan2(Qt*i,se),U=ee*i)}const Q=Math.atan2(E,_)*b;let W=t.arotation;L=(L-Q)*P.radDeg+x-W,L>180?L-=360:L<-180&&(L+=360),t.updateWorldTransformWith(h,d,W+L*c,m,p,0,0),W=e.arotation,U=((U+Q)*P.radDeg-e.ashearX)*b+y-W,U>180?U-=360:U<-180&&(U+=360),e.updateWorldTransformWith(_,E,W+U*c,e.ascaleX,e.ascaleY,e.ashearX,e.ashearY)}}class Bd extends ol{constructor(t){super(t,0,!1),this.bones=new Array,this._target=null,this.bendDirection=1,this.compress=!1,this.stretch=!1,this.uniform=!1,this.mix=1,this.softness=0}set target(t){this._target=t}get target(){if(this._target)return this._target;throw new Error("BoneData not set.")}}class Ld extends ol{constructor(t){super(t,0,!1),this.bones=new Array,this._target=null,this.positionMode=me.Fixed,this.spacingMode=Re.Fixed,this.rotateMode=_e.Chain,this.offsetRotation=0,this.position=0,this.spacing=0,this.mixRotate=0,this.mixX=0,this.mixY=0}set target(t){this._target=t}get target(){if(this._target)return this._target;throw new Error("SlotData not set.")}}var Re=(n=>(n[n.Length=0]="Length",n[n.Fixed=1]="Fixed",n[n.Percent=2]="Percent",n[n.Proportional=3]="Proportional",n))(Re||{});const Cn=class{constructor(n,t){if(this.position=0,this.spacing=0,this.mixRotate=0,this.mixX=0,this.mixY=0,this.spaces=new Array,this.positions=new Array,this.world=new Array,this.curves=new Array,this.lengths=new Array,this.segments=new Array,this.active=!1,!n)throw new Error("data cannot be null.");if(!t)throw new Error("skeleton cannot be null.");this.data=n,this.bones=new Array;for(let s=0,r=n.bones.length;s<r;s++){const i=t.findBone(n.bones[s].name);if(!i)throw new Error(`Couldn't find bone ${n.bones[s].name}.`);this.bones.push(i)}const e=t.findSlot(n.target.name);if(!e)throw new Error(`Couldn't find target bone ${n.target.name}`);this.target=e,this.position=n.position,this.spacing=n.spacing,this.mixRotate=n.mixRotate,this.mixX=n.mixX,this.mixY=n.mixY}isActive(){return this.active}update(){const n=this.target.getAttachment();if(!(n instanceof Gr))return;const t=this.mixRotate,e=this.mixX,s=this.mixY;if(t==0&&e==0&&s==0)return;const r=this.data,i=r.rotateMode==_e.Tangent,o=r.rotateMode==_e.ChainScale,l=this.bones,a=l.length,c=i?a:a+1,h=$.setArraySize(this.spaces,c),d=o?this.lengths=$.setArraySize(this.lengths,a):[],u=this.spacing;switch(r.spacingMode){case Re.Percent:if(o)for(let b=0,_=c-1;b<_;b++){const E=l[b],S=E.data.length;if(S<Cn.epsilon)d[b]=0;else{const T=S*E.matrix.a,C=S*E.matrix.b;d[b]=Math.sqrt(T*T+C*C)}}$.arrayFill(h,1,c,u);break;case Re.Proportional:let x=0;for(let b=0,_=c-1;b<_;){const E=l[b],S=E.data.length;if(S<Cn.epsilon)o&&(d[b]=0),h[++b]=u;else{const T=S*E.matrix.a,C=S*E.matrix.b,A=Math.sqrt(T*T+C*C);o&&(d[b]=A),h[++b]=A,x+=A}}if(x>0){x=c/x*u;for(let b=1;b<c;b++)h[b]*=x}break;default:const y=r.spacingMode==Re.Length;for(let b=0,_=c-1;b<_;){const E=l[b],S=E.data.length;if(S<Cn.epsilon)o&&(d[b]=0),h[++b]=u;else{const T=S*E.matrix.a,C=S*E.matrix.b,A=Math.sqrt(T*T+C*C);o&&(d[b]=A),h[++b]=(y?S+u:u)*A/S}}}const f=this.computeWorldPositions(n,c,i);let m=f[0],p=f[1],g=r.offsetRotation,w=!1;if(g==0)w=r.rotateMode==_e.Chain;else{w=!1;const x=this.target.bone.matrix;g*=x.a*x.d-x.b*x.c>0?P.degRad:-P.degRad}for(let x=0,y=3;x<a;x++,y+=3){const b=l[x],_=b.matrix;_.tx+=(m-_.tx)*e,_.ty+=(p-_.ty)*s;const E=f[y],S=f[y+1],T=E-m,C=S-p;if(o){const A=d[x];if(A!=0){const R=(Math.sqrt(T*T+C*C)/A-1)*t+1;_.a*=R,_.b*=R}}if(m=E,p=S,t>0){const A=_.a,R=_.c,M=_.b,I=_.d;let N=0,F=0,B=0;if(i?N=f[y-1]:h[x+1]==0?N=f[y+2]:N=Math.atan2(C,T),N-=Math.atan2(M,A),w){F=Math.cos(N),B=Math.sin(N);const Y=b.data.length;m+=(Y*(F*A-B*M)-T)*t,p+=(Y*(B*A+F*M)-C)*t}else N+=g;N>P.PI?N-=P.PI2:N<-P.PI&&(N+=P.PI2),N*=t,F=Math.cos(N),B=Math.sin(N),_.a=F*A-B*M,_.c=F*R-B*I,_.b=B*A+F*M,_.d=B*R+F*I}b.updateAppliedTransform()}}computeWorldPositions(n,t,e){const s=this.target;let r=this.position;const i=this.spaces,o=$.setArraySize(this.positions,t*3+2);let l=this.world;const a=n.closed;let c=n.worldVerticesLength,h=c/6,d=Cn.NONE;if(!n.constantSpeed){const Y=n.lengths;h-=a?1:2;const O=Y[h];this.data.positionMode==me.Percent&&(r*=O);let V;switch(this.data.spacingMode){case Re.Percent:V=O;break;case Re.Proportional:V=O/t;break;default:V=1}l=$.setArraySize(this.world,8);for(let j=0,X=0,L=0;j<t;j++,X+=3){const U=i[j]*V;r+=U;let q=r;if(a)q%=O,q<0&&(q+=O),L=0;else if(q<0){d!=Cn.BEFORE&&(d=Cn.BEFORE,n.computeWorldVertices(s,2,4,l,0,2)),this.addBeforePosition(q,l,0,o,X);continue}else if(q>O){d!=Cn.AFTER&&(d=Cn.AFTER,n.computeWorldVertices(s,c-6,4,l,0,2)),this.addAfterPosition(q-O,l,0,o,X);continue}for(;;L++){const H=Y[L];if(!(q>H)){if(L==0)q/=H;else{const J=Y[L-1];q=(q-J)/(H-J)}break}}L!=d&&(d=L,a&&L==h?(n.computeWorldVertices(s,c-4,4,l,0,2),n.computeWorldVertices(s,0,4,l,4,2)):n.computeWorldVertices(s,L*6+2,8,l,0,2)),this.addCurvePosition(q,l[0],l[1],l[2],l[3],l[4],l[5],l[6],l[7],o,X,e||j>0&&U==0)}return o}a?(c+=2,l=$.setArraySize(this.world,c),n.computeWorldVertices(s,2,c-4,l,0,2),n.computeWorldVertices(s,0,2,l,c-4,2),l[c-2]=l[0],l[c-1]=l[1]):(h--,c-=4,l=$.setArraySize(this.world,c),n.computeWorldVertices(s,2,c,l,0,2));const u=$.setArraySize(this.curves,h);let f=0,m=l[0],p=l[1],g=0,w=0,x=0,y=0,b=0,_=0,E=0,S=0,T=0,C=0,A=0,R=0,M=0,I=0;for(let Y=0,O=2;Y<h;Y++,O+=6)g=l[O],w=l[O+1],x=l[O+2],y=l[O+3],b=l[O+4],_=l[O+5],E=(m-g*2+x)*.1875,S=(p-w*2+y)*.1875,T=((g-x)*3-m+b)*.09375,C=((w-y)*3-p+_)*.09375,A=E*2+T,R=S*2+C,M=(g-m)*.75+E+T*.16666667,I=(w-p)*.75+S+C*.16666667,f+=Math.sqrt(M*M+I*I),M+=A,I+=R,A+=T,R+=C,f+=Math.sqrt(M*M+I*I),M+=A,I+=R,f+=Math.sqrt(M*M+I*I),M+=A+T,I+=R+C,f+=Math.sqrt(M*M+I*I),u[Y]=f,m=b,p=_;this.data.positionMode==me.Percent&&(r*=f);let N;switch(this.data.spacingMode){case Re.Percent:N=f;break;case Re.Proportional:N=f/t;break;default:N=1}const F=this.segments;let B=0;for(let Y=0,O=0,V=0,j=0;Y<t;Y++,O+=3){const X=i[Y]*N;r+=X;let L=r;if(a)L%=f,L<0&&(L+=f),V=0;else if(L<0){this.addBeforePosition(L,l,0,o,O);continue}else if(L>f){this.addAfterPosition(L-f,l,c-4,o,O);continue}for(;;V++){const U=u[V];if(!(L>U)){if(V==0)L/=U;else{const q=u[V-1];L=(L-q)/(U-q)}break}}if(V!=d){d=V;let U=V*6;for(m=l[U],p=l[U+1],g=l[U+2],w=l[U+3],x=l[U+4],y=l[U+5],b=l[U+6],_=l[U+7],E=(m-g*2+x)*.03,S=(p-w*2+y)*.03,T=((g-x)*3-m+b)*.006,C=((w-y)*3-p+_)*.006,A=E*2+T,R=S*2+C,M=(g-m)*.3+E+T*.16666667,I=(w-p)*.3+S+C*.16666667,B=Math.sqrt(M*M+I*I),F[0]=B,U=1;U<8;U++)M+=A,I+=R,A+=T,R+=C,B+=Math.sqrt(M*M+I*I),F[U]=B;M+=A,I+=R,B+=Math.sqrt(M*M+I*I),F[8]=B,M+=A+T,I+=R+C,B+=Math.sqrt(M*M+I*I),F[9]=B,j=0}for(L*=B;;j++){const U=F[j];if(!(L>U)){if(j==0)L/=U;else{const q=F[j-1];L=j+(L-q)/(U-q)}break}}this.addCurvePosition(L*.1,m,p,g,w,x,y,b,_,o,O,e||Y>0&&X==0)}return o}addBeforePosition(n,t,e,s,r){const i=t[e],o=t[e+1],l=t[e+2]-i,a=t[e+3]-o,c=Math.atan2(a,l);s[r]=i+n*Math.cos(c),s[r+1]=o+n*Math.sin(c),s[r+2]=c}addAfterPosition(n,t,e,s,r){const i=t[e+2],o=t[e+3],l=i-t[e],a=o-t[e+1],c=Math.atan2(a,l);s[r]=i+n*Math.cos(c),s[r+1]=o+n*Math.sin(c),s[r+2]=c}addCurvePosition(n,t,e,s,r,i,o,l,a,c,h,d){if(n==0||isNaN(n)){c[h]=t,c[h+1]=e,c[h+2]=Math.atan2(r-e,s-t);return}const u=n*n,f=u*n,m=1-n,p=m*m,g=p*m,w=m*n,x=w*3,y=m*x,b=x*n,_=t*g+s*y+i*b+l*f,E=e*g+r*y+o*b+a*f;c[h]=_,c[h+1]=E,d&&(n<.001?c[h+2]=Math.atan2(r-e,s-t):c[h+2]=Math.atan2(E-(e*p+r*w*2+o*u),_-(t*p+s*w*2+i*u)))}};let Ci=Cn;Ci.NONE=-1;Ci.BEFORE=-2;Ci.AFTER=-3;Ci.epsilon=1e-5;class Zg{constructor(t,e){if(this.darkColor=null,this.attachment=null,this.attachmentState=0,this.sequenceIndex=-1,this.deform=new Array,!t)throw new Error("data cannot be null.");if(!e)throw new Error("bone cannot be null.");this.data=t,this.bone=e,this.color=new et,this.darkColor=t.darkColor?new et:null,this.setToSetupPose(),this.blendMode=this.data.blendMode}getSkeleton(){return this.bone.skeleton}getAttachment(){return this.attachment}setAttachment(t){this.attachment!=t&&((!(t instanceof tn)||!(this.attachment instanceof tn)||t.timelineAttachment!=this.attachment.timelineAttachment)&&(this.deform.length=0),this.attachment=t,this.sequenceIndex=-1)}setToSetupPose(){this.color.setFromColor(this.data.color),this.darkColor&&this.darkColor.setFromColor(this.data.darkColor),this.data.attachmentName?(this.attachment=null,this.setAttachment(this.bone.skeleton.getAttachment(this.data.index,this.data.attachmentName))):this.attachment=null}}class Qg{constructor(t,e){if(this.mixRotate=0,this.mixX=0,this.mixY=0,this.mixScaleX=0,this.mixScaleY=0,this.mixShearY=0,this.temp=new oa,this.active=!1,!t)throw new Error("data cannot be null.");if(!e)throw new Error("skeleton cannot be null.");this.data=t,this.mixRotate=t.mixRotate,this.mixX=t.mixX,this.mixY=t.mixY,this.mixScaleX=t.mixScaleX,this.mixScaleY=t.mixScaleY,this.mixShearY=t.mixShearY,this.bones=new Array;for(let r=0;r<t.bones.length;r++){const i=e.findBone(t.bones[r].name);if(!i)throw new Error(`Couldn't find bone ${t.bones[r].name}.`);this.bones.push(i)}const s=e.findBone(t.target.name);if(!s)throw new Error(`Couldn't find target bone ${t.target.name}.`);this.target=s}isActive(){return this.active}update(){this.mixRotate==0&&this.mixX==0&&this.mixY==0&&this.mixScaleX==0&&this.mixScaleX==0&&this.mixShearY==0||(this.data.local?this.data.relative?this.applyRelativeLocal():this.applyAbsoluteLocal():this.data.relative?this.applyRelativeWorld():this.applyAbsoluteWorld())}applyAbsoluteWorld(){const t=this.mixRotate,e=this.mixX,s=this.mixY,r=this.mixScaleX,i=this.mixScaleY,o=this.mixShearY,l=e!=0||s!=0,a=this.target,c=a.matrix,h=c.a,d=c.c,u=c.b,f=c.d,m=h*f-d*u>0?P.degRad:-P.degRad,p=this.data.offsetRotation*m,g=this.data.offsetShearY*m,w=this.bones;for(let x=0,y=w.length;x<y;x++){const b=w[x],_=b.matrix;if(t!=0){const E=_.a,S=_.c,T=_.b,C=_.d;let A=Math.atan2(u,h)-Math.atan2(T,E)+p;A>P.PI?A-=P.PI2:A<-P.PI&&(A+=P.PI2),A*=t;const R=Math.cos(A),M=Math.sin(A);_.a=R*E-M*T,_.c=R*S-M*C,_.b=M*E+R*T,_.d=M*S+R*C}if(l){const E=this.temp;a.localToWorld(E.set(this.data.offsetX,this.data.offsetY)),_.tx+=(E.x-_.tx)*e,_.ty+=(E.y-_.ty)*s}if(r!=0){let E=Math.sqrt(_.a*_.a+_.b*_.b);E!=0&&(E=(E+(Math.sqrt(h*h+u*u)-E+this.data.offsetScaleX)*r)/E),_.a*=E,_.b*=E}if(i!=0){let E=Math.sqrt(_.c*_.c+_.d*_.d);E!=0&&(E=(E+(Math.sqrt(d*d+f*f)-E+this.data.offsetScaleY)*i)/E),_.c*=E,_.d*=E}if(o>0){const E=_.c,S=_.d,T=Math.atan2(S,E);let C=Math.atan2(f,d)-Math.atan2(u,h)-(T-Math.atan2(_.b,_.a));C>P.PI?C-=P.PI2:C<-P.PI&&(C+=P.PI2),C=T+(C+g)*o;const A=Math.sqrt(E*E+S*S);_.c=Math.cos(C)*A,_.d=Math.sin(C)*A}b.updateAppliedTransform()}}applyRelativeWorld(){const t=this.mixRotate,e=this.mixX,s=this.mixY,r=this.mixScaleX,i=this.mixScaleY,o=this.mixShearY,l=e!=0||s!=0,a=this.target,c=a.matrix,h=c.a,d=c.c,u=c.b,f=c.d,m=h*f-d*u>0?P.degRad:-P.degRad,p=this.data.offsetRotation*m,g=this.data.offsetShearY*m,w=this.bones;for(let x=0,y=w.length;x<y;x++){const b=w[x],_=b.matrix;if(t!=0){const E=_.a,S=_.c,T=_.b,C=_.d;let A=Math.atan2(u,h)+p;A>P.PI?A-=P.PI2:A<-P.PI&&(A+=P.PI2),A*=t;const R=Math.cos(A),M=Math.sin(A);_.a=R*E-M*T,_.c=R*S-M*C,_.b=M*E+R*T,_.d=M*S+R*C}if(l){const E=this.temp;a.localToWorld(E.set(this.data.offsetX,this.data.offsetY)),_.tx+=E.x*e,_.ty+=E.y*s}if(r!=0){const E=(Math.sqrt(h*h+u*u)-1+this.data.offsetScaleX)*r+1;_.a*=E,_.b*=E}if(i!=0){const E=(Math.sqrt(d*d+f*f)-1+this.data.offsetScaleY)*i+1;_.c*=E,_.d*=E}if(o>0){let E=Math.atan2(f,d)-Math.atan2(u,h);E>P.PI?E-=P.PI2:E<-P.PI&&(E+=P.PI2);const S=_.c,T=_.d;E=Math.atan2(T,S)+(E-P.PI/2+g)*o;const C=Math.sqrt(S*S+T*T);_.c=Math.cos(E)*C,_.d=Math.sin(E)*C}b.updateAppliedTransform()}}applyAbsoluteLocal(){const t=this.mixRotate,e=this.mixX,s=this.mixY,r=this.mixScaleX,i=this.mixScaleY,o=this.mixShearY,l=this.target,a=this.bones;for(let c=0,h=a.length;c<h;c++){const d=a[c];let u=d.arotation;if(t!=0){let x=l.arotation-u+this.data.offsetRotation;x-=(16384-(16384.499999999996-x/360|0))*360,u+=x*t}let f=d.ax,m=d.ay;f+=(l.ax-f+this.data.offsetX)*e,m+=(l.ay-m+this.data.offsetY)*s;let p=d.ascaleX,g=d.ascaleY;r!=0&&p!=0&&(p=(p+(l.ascaleX-p+this.data.offsetScaleX)*r)/p),i!=0&&g!=0&&(g=(g+(l.ascaleY-g+this.data.offsetScaleY)*i)/g);let w=d.ashearY;if(o!=0){let x=l.ashearY-w+this.data.offsetShearY;x-=(16384-(16384.499999999996-x/360|0))*360,w+=x*o}d.updateWorldTransformWith(f,m,u,p,g,d.ashearX,w)}}applyRelativeLocal(){const t=this.mixRotate,e=this.mixX,s=this.mixY,r=this.mixScaleX,i=this.mixScaleY,o=this.mixShearY,l=this.target,a=this.bones;for(let c=0,h=a.length;c<h;c++){const d=a[c],u=d.arotation+(l.arotation+this.data.offsetRotation)*t,f=d.ax+(l.ax+this.data.offsetX)*e,m=d.ay+(l.ay+this.data.offsetY)*s,p=d.ascaleX*((l.ascaleX-1+this.data.offsetScaleX)*r+1),g=d.ascaleY*((l.ascaleY-1+this.data.offsetScaleY)*i+1),w=d.ashearY+(l.ashearY+this.data.offsetShearY)*o;d.updateWorldTransformWith(f,m,u,p,g,d.ashearX,w)}}}const qi=class{constructor(n){if(this._updateCache=new Array,this.skin=null,this.scaleX=1,this.scaleY=1,this.x=0,this.y=0,!n)throw new Error("data cannot be null.");this.data=n,this.bones=new Array;for(let t=0;t<n.bones.length;t++){const e=n.bones[t];let s;if(!e.parent)s=new lh(e,this,null);else{const r=this.bones[e.parent.index];s=new lh(e,this,r),r.children.push(s)}this.bones.push(s)}this.slots=new Array,this.drawOrder=new Array;for(let t=0;t<n.slots.length;t++){const e=n.slots[t],s=this.bones[e.boneData.index],r=new Zg(e,s);this.slots.push(r),this.drawOrder.push(r)}this.ikConstraints=new Array;for(let t=0;t<n.ikConstraints.length;t++){const e=n.ikConstraints[t];this.ikConstraints.push(new Kg(e,this))}this.transformConstraints=new Array;for(let t=0;t<n.transformConstraints.length;t++){const e=n.transformConstraints[t];this.transformConstraints.push(new Qg(e,this))}this.pathConstraints=new Array;for(let t=0;t<n.pathConstraints.length;t++){const e=n.pathConstraints[t];this.pathConstraints.push(new Ci(e,this))}this.color=new et(1,1,1,1),this.updateCache()}updateCache(){const n=this._updateCache;n.length=0;const t=this.bones;for(let c=0,h=t.length;c<h;c++){const d=t[c];d.sorted=d.data.skinRequired,d.active=!d.sorted}if(this.skin){const c=this.skin.bones;for(let h=0,d=this.skin.bones.length;h<d;h++){let u=this.bones[c[h].index];do u.sorted=!1,u.active=!0,u=u.parent;while(u)}}const e=this.ikConstraints,s=this.transformConstraints,r=this.pathConstraints,i=e.length,o=s.length,l=r.length,a=i+o+l;t:for(let c=0;c<a;c++){for(let h=0;h<i;h++){const d=e[h];if(d.data.order==c){this.sortIkConstraint(d);continue t}}for(let h=0;h<o;h++){const d=s[h];if(d.data.order==c){this.sortTransformConstraint(d);continue t}}for(let h=0;h<l;h++){const d=r[h];if(d.data.order==c){this.sortPathConstraint(d);continue t}}}for(let c=0,h=t.length;c<h;c++)this.sortBone(t[c])}sortIkConstraint(n){if(n.active=n.target.isActive()&&(!n.data.skinRequired||this.skin&&$.contains(this.skin.constraints,n.data,!0)),!n.active)return;const t=n.target;this.sortBone(t);const e=n.bones,s=e[0];if(this.sortBone(s),e.length==1)this._updateCache.push(n),this.sortReset(s.children);else{const r=e[e.length-1];this.sortBone(r),this._updateCache.push(n),this.sortReset(s.children),r.sorted=!0}}sortPathConstraint(n){if(n.active=n.target.bone.isActive()&&(!n.data.skinRequired||this.skin&&$.contains(this.skin.constraints,n.data,!0)),!n.active)return;const t=n.target,e=t.data.index,s=t.bone;this.skin&&this.sortPathConstraintAttachment(this.skin,e,s),this.data.defaultSkin&&this.data.defaultSkin!=this.skin&&this.sortPathConstraintAttachment(this.data.defaultSkin,e,s);for(let l=0,a=this.data.skins.length;l<a;l++)this.sortPathConstraintAttachment(this.data.skins[l],e,s);const r=t.getAttachment();r instanceof Gr&&this.sortPathConstraintAttachmentWith(r,s);const i=n.bones,o=i.length;for(let l=0;l<o;l++)this.sortBone(i[l]);this._updateCache.push(n);for(let l=0;l<o;l++)this.sortReset(i[l].children);for(let l=0;l<o;l++)i[l].sorted=!0}sortTransformConstraint(n){if(n.active=n.target.isActive()&&(!n.data.skinRequired||this.skin&&$.contains(this.skin.constraints,n.data,!0)),!n.active)return;this.sortBone(n.target);const t=n.bones,e=t.length;if(n.data.local)for(let s=0;s<e;s++){const r=t[s];this.sortBone(r.parent),this.sortBone(r)}else for(let s=0;s<e;s++)this.sortBone(t[s]);this._updateCache.push(n);for(let s=0;s<e;s++)this.sortReset(t[s].children);for(let s=0;s<e;s++)t[s].sorted=!0}sortPathConstraintAttachment(n,t,e){const s=n.attachments[t];if(s)for(const r in s)this.sortPathConstraintAttachmentWith(s[r],e)}sortPathConstraintAttachmentWith(n,t){if(!(n instanceof Gr))return;const e=n.bones;if(!e)this.sortBone(t);else{const s=this.bones;for(let r=0,i=e.length;r<i;){let o=e[r++];for(o+=r;r<o;)this.sortBone(s[e[r++]])}}}sortBone(n){if(!n||n.sorted)return;const t=n.parent;t&&this.sortBone(t),n.sorted=!0,this._updateCache.push(n)}sortReset(n){for(let t=0,e=n.length;t<e;t++){const s=n[t];s.active&&(s.sorted&&this.sortReset(s.children),s.sorted=!1)}}updateWorldTransform(){const n=this.bones;for(let e=0,s=n.length;e<s;e++){const r=n[e];r.ax=r.x,r.ay=r.y,r.arotation=r.rotation,r.ascaleX=r.scaleX,r.ascaleY=r.scaleY,r.ashearX=r.shearX,r.ashearY=r.shearY}const t=this._updateCache;for(let e=0,s=t.length;e<s;e++)t[e].update()}updateWorldTransformWith(n){const t=this.getRootBone(),e=n.matrix.a,s=n.matrix.c,r=n.matrix.b,i=n.matrix.d;t.matrix.tx=e*this.x+s*this.y+n.worldX,t.matrix.ty=r*this.x+i*this.y+n.worldY;const o=t.rotation+90+t.shearY,l=P.cosDeg(t.rotation+t.shearX)*t.scaleX,a=P.cosDeg(o)*t.scaleY,c=P.sinDeg(t.rotation+t.shearX)*t.scaleX,h=P.sinDeg(o)*t.scaleY,d=this.scaleX,u=-this.scaleY;t.matrix.a=(e*l+s*c)*d,t.matrix.c=(e*a+s*h)*d,t.matrix.b=(r*l+i*c)*u,t.matrix.d=(r*a+i*h)*u;const f=this._updateCache;for(let m=0,p=f.length;m<p;m++){const g=f[m];g!=t&&g.update()}}setToSetupPose(){this.setBonesToSetupPose(),this.setSlotsToSetupPose()}setBonesToSetupPose(){const n=this.bones;for(let r=0,i=n.length;r<i;r++)n[r].setToSetupPose();const t=this.ikConstraints;for(let r=0,i=t.length;r<i;r++){const o=t[r];o.mix=o.data.mix,o.softness=o.data.softness,o.bendDirection=o.data.bendDirection,o.compress=o.data.compress,o.stretch=o.data.stretch}const e=this.transformConstraints;for(let r=0,i=e.length;r<i;r++){const o=e[r],l=o.data;o.mixRotate=l.mixRotate,o.mixX=l.mixX,o.mixY=l.mixY,o.mixScaleX=l.mixScaleX,o.mixScaleY=l.mixScaleY,o.mixShearY=l.mixShearY}const s=this.pathConstraints;for(let r=0,i=s.length;r<i;r++){const o=s[r],l=o.data;o.position=l.position,o.spacing=l.spacing,o.mixRotate=l.mixRotate,o.mixX=l.mixX,o.mixY=l.mixY}}setSlotsToSetupPose(){const n=this.slots;$.arrayCopy(n,0,this.drawOrder,0,n.length);for(let t=0,e=n.length;t<e;t++)n[t].setToSetupPose()}getRootBone(){return this.bones.length==0?null:this.bones[0]}findBone(n){if(!n)throw new Error("boneName cannot be null.");const t=this.bones;for(let e=0,s=t.length;e<s;e++){const r=t[e];if(r.data.name==n)return r}return null}findBoneIndex(n){if(!n)throw new Error("boneName cannot be null.");const t=this.bones;for(let e=0,s=t.length;e<s;e++)if(t[e].data.name==n)return e;return-1}findSlot(n){if(!n)throw new Error("slotName cannot be null.");const t=this.slots;for(let e=0,s=t.length;e<s;e++){const r=t[e];if(r.data.name==n)return r}return null}findSlotIndex(n){if(!n)throw new Error("slotName cannot be null.");const t=this.slots;for(let e=0,s=t.length;e<s;e++)if(t[e].data.name==n)return e;return-1}setSkinByName(n){const t=this.data.findSkin(n);if(!t)throw new Error(`Skin not found: ${n}`);this.setSkin(t)}setSkin(n){if(n!=this.skin){if(n)if(this.skin)n.attachAll(this,this.skin);else{const t=this.slots;for(let e=0,s=t.length;e<s;e++){const r=t[e],i=r.data.attachmentName;if(i){const o=n.getAttachment(e,i);o&&r.setAttachment(o)}}}this.skin=n,this.updateCache()}}getAttachmentByName(n,t){const e=this.data.findSlot(n);if(!e)throw new Error(`Can't find slot with name ${n}`);return this.getAttachment(e.index,t)}getAttachment(n,t){if(!t)throw new Error("attachmentName cannot be null.");if(this.skin){const e=this.skin.getAttachment(n,t);if(e)return e}return this.data.defaultSkin?this.data.defaultSkin.getAttachment(n,t):null}setAttachment(n,t){if(!n)throw new Error("slotName cannot be null.");const e=this.slots;for(let s=0,r=e.length;s<r;s++){const i=e[s];if(i.data.name==n){let o=null;if(t&&(o=this.getAttachment(s,t),!o))throw new Error(`Attachment not found: ${t}, for slot: ${n}`);i.setAttachment(o);return}}throw new Error(`Slot not found: ${n}`)}findIkConstraint(n){if(!n)throw new Error("constraintName cannot be null.");const t=this.ikConstraints;for(let e=0,s=t.length;e<s;e++){const r=t[e];if(r.data.name==n)return r}return null}findTransformConstraint(n){if(!n)throw new Error("constraintName cannot be null.");const t=this.transformConstraints;for(let e=0,s=t.length;e<s;e++){const r=t[e];if(r.data.name==n)return r}return null}findPathConstraint(n){if(!n)throw new Error("constraintName cannot be null.");const t=this.pathConstraints;for(let e=0,s=t.length;e<s;e++){const r=t[e];if(r.data.name==n)return r}return null}getBoundsRect(){const n=new oa,t=new oa;return this.getBounds(n,t),{x:n.x,y:n.y,width:t.x,height:t.y}}getBounds(n,t,e=new Array(2)){if(!n)throw new Error("offset cannot be null.");if(!t)throw new Error("size cannot be null.");const s=this.drawOrder;let r=Number.POSITIVE_INFINITY,i=Number.POSITIVE_INFINITY,o=Number.NEGATIVE_INFINITY,l=Number.NEGATIVE_INFINITY;for(let a=0,c=s.length;a<c;a++){const h=s[a];if(!h.bone.active)continue;let d=0,u=null;const f=h.getAttachment();if(f instanceof Ot)d=8,u=$.setArraySize(e,d,0),f.computeWorldVertices(h,u,0,2);else if(f instanceof Xr){const m=f;d=m.worldVerticesLength,u=$.setArraySize(e,d,0),m.computeWorldVertices(h,0,d,u,0,2)}if(u)for(let m=0,p=u.length;m<p;m+=2){const g=u[m],w=u[m+1];r=Math.min(r,g),i=Math.min(i,w),o=Math.max(o,g),l=Math.max(l,w)}}n.set(r,i),t.set(o-r,l-i)}get flipX(){return this.scaleX==-1}set flipX(n){qi.deprecatedWarning1||(qi.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: `Skeleton.flipX/flipY` was deprecated, please use scaleX/scaleY")),this.scaleX=n?1:-1}get flipY(){return this.scaleY==-1}set flipY(n){qi.deprecatedWarning1||(qi.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: `Skeleton.flipX/flipY` was deprecated, please use scaleX/scaleY")),this.scaleY=n?1:-1}};let Od=qi;Od.deprecatedWarning1=!1;class jd{constructor(){this.name=null,this.bones=new Array,this.slots=new Array,this.skins=new Array,this.defaultSkin=null,this.events=new Array,this.animations=new Array,this.ikConstraints=new Array,this.transformConstraints=new Array,this.pathConstraints=new Array,this.x=0,this.y=0,this.width=0,this.height=0,this.version=null,this.hash=null,this.fps=0,this.imagesPath=null,this.audioPath=null}findBone(t){if(!t)throw new Error("boneName cannot be null.");const e=this.bones;for(let s=0,r=e.length;s<r;s++){const i=e[s];if(i.name==t)return i}return null}findBoneIndex(t){if(!t)throw new Error("boneName cannot be null.");const e=this.bones;for(let s=0,r=e.length;s<r;s++)if(e[s].name==t)return s;return-1}findSlot(t){if(!t)throw new Error("slotName cannot be null.");const e=this.slots;for(let s=0,r=e.length;s<r;s++){const i=e[s];if(i.name==t)return i}return null}findSlotIndex(t){if(!t)throw new Error("slotName cannot be null.");const e=this.slots;for(let s=0,r=e.length;s<r;s++)if(e[s].name==t)return s;return-1}findSkin(t){if(!t)throw new Error("skinName cannot be null.");const e=this.skins;for(let s=0,r=e.length;s<r;s++){const i=e[s];if(i.name==t)return i}return null}findEvent(t){if(!t)throw new Error("eventDataName cannot be null.");const e=this.events;for(let s=0,r=e.length;s<r;s++){const i=e[s];if(i.name==t)return i}return null}findAnimation(t){if(!t)throw new Error("animationName cannot be null.");const e=this.animations;for(let s=0,r=e.length;s<r;s++){const i=e[s];if(i.name==t)return i}return null}findIkConstraint(t){if(!t)throw new Error("constraintName cannot be null.");const e=this.ikConstraints;for(let s=0,r=e.length;s<r;s++){const i=e[s];if(i.name==t)return i}return null}findTransformConstraint(t){if(!t)throw new Error("constraintName cannot be null.");const e=this.transformConstraints;for(let s=0,r=e.length;s<r;s++){const i=e[s];if(i.name==t)return i}return null}findPathConstraint(t){if(!t)throw new Error("constraintName cannot be null.");const e=this.pathConstraints;for(let s=0,r=e.length;s<r;s++){const i=e[s];if(i.name==t)return i}return null}findPathConstraintIndex(t){if(t==null)throw new Error("pathConstraintName cannot be null.");const e=this.pathConstraints;for(let s=0,r=e.length;s<r;s++)if(e[s].name==t)return s;return-1}}class Vd{constructor(t,e,s){if(this.index=0,this.color=new et(1,1,1,1),this.darkColor=null,this.attachmentName=null,this.blendMode=dt.NORMAL,t<0)throw new Error("index must be >= 0.");if(!e)throw new Error("name cannot be null.");if(!s)throw new Error("boneData cannot be null.");this.index=t,this.name=e,this.boneData=s}}class Ud extends ol{constructor(t){super(t,0,!1),this.bones=new Array,this._target=null,this.mixRotate=0,this.mixX=0,this.mixY=0,this.mixScaleX=0,this.mixScaleY=0,this.mixShearY=0,this.offsetRotation=0,this.offsetX=0,this.offsetY=0,this.offsetScaleX=0,this.offsetScaleY=0,this.offsetShearY=0,this.relative=!1,this.local=!1}set target(t){this._target=t}get target(){if(this._target)return this._target;throw new Error("BoneData not set.")}}class ch{constructor(t,e,s){this.slotIndex=t,this.name=e,this.attachment=s}}class Io{constructor(t){if(this.attachments=new Array,this.bones=Array(),this.constraints=new Array,!t)throw new Error("name cannot be null.");this.name=t}setAttachment(t,e,s){if(!s)throw new Error("attachment cannot be null.");const r=this.attachments;t>=r.length&&(r.length=t+1),r[t]||(r[t]={}),r[t][e]=s}addSkin(t){for(let s=0;s<t.bones.length;s++){const r=t.bones[s];let i=!1;for(let o=0;o<this.bones.length;o++)if(this.bones[o]==r){i=!0;break}i||this.bones.push(r)}for(let s=0;s<t.constraints.length;s++){const r=t.constraints[s];let i=!1;for(let o=0;o<this.constraints.length;o++)if(this.constraints[o]==r){i=!0;break}i||this.constraints.push(r)}const e=t.getAttachments();for(let s=0;s<e.length;s++){const r=e[s];this.setAttachment(r.slotIndex,r.name,r.attachment)}}copySkin(t){for(let s=0;s<t.bones.length;s++){const r=t.bones[s];let i=!1;for(let o=0;o<this.bones.length;o++)if(this.bones[o]==r){i=!0;break}i||this.bones.push(r)}for(let s=0;s<t.constraints.length;s++){const r=t.constraints[s];let i=!1;for(let o=0;o<this.constraints.length;o++)if(this.constraints[o]==r){i=!0;break}i||this.constraints.push(r)}const e=t.getAttachments();for(let s=0;s<e.length;s++){const r=e[s];r.attachment&&(r.attachment instanceof Xr?(r.attachment=r.attachment.newLinkedMesh(),this.setAttachment(r.slotIndex,r.name,r.attachment)):(r.attachment=r.attachment.copy(),this.setAttachment(r.slotIndex,r.name,r.attachment)))}}getAttachment(t,e){const s=this.attachments[t];return s?s[e]:null}removeAttachment(t,e){const s=this.attachments[t];s&&delete s[e]}getAttachments(){const t=new Array;for(let e=0;e<this.attachments.length;e++){const s=this.attachments[e];if(s)for(const r in s){const i=s[r];i&&t.push(new ch(e,r,i))}}return t}getAttachmentsForSlot(t,e){const s=this.attachments[t];if(s)for(const r in s){const i=s[r];i&&e.push(new ch(t,r,i))}}clear(){this.attachments.length=0,this.bones.length=0,this.constraints.length=0}attachAll(t,e){let s=0;for(let r=0;r<t.slots.length;r++){const i=t.slots[r],o=i.getAttachment();if(o&&s<e.attachments.length){const l=e.attachments[s];for(const a in l){const c=l[a];if(o==c){const h=this.getAttachment(s,a);h&&i.setAttachment(h);break}}}s++}}}class Xd{constructor(t){this.ver40=!1,this.scale=1,this.linkedMeshes=new Array,this.attachmentLoader=t}readSkeletonData(t){const e=this.scale,s=new jd;s.name="";const r=new To(t),i=r.readInt32(),o=r.readInt32();s.hash=o==0&&i==0?null:o.toString(16)+i.toString(16),s.version=r.readString();const l=s.version.substr(0,3);if(l!=="4.0"&&l!=="4.1"){const d=`Spine 4.1 loader cant load version ${s.version}. Please configure your pixi-spine bundle`;console.error(d)}this.ver40=l==="4.0",s.x=r.readFloat(),s.y=r.readFloat(),s.width=r.readFloat(),s.height=r.readFloat();const a=r.readBoolean();a&&(s.fps=r.readFloat(),s.imagesPath=r.readString(),s.audioPath=r.readString());let c=0;c=r.readInt(!0);for(let d=0;d<c;d++){const u=r.readString();if(!u)throw new Error("String in string table must not be null.");r.strings.push(u)}c=r.readInt(!0);for(let d=0;d<c;d++){const u=r.readString();if(!u)throw new Error("Bone name must not be null.");const f=d==0?null:s.bones[r.readInt(!0)],m=new Nd(d,u,f);m.rotation=r.readFloat(),m.x=r.readFloat()*e,m.y=r.readFloat()*e,m.scaleX=r.readFloat(),m.scaleY=r.readFloat(),m.shearX=r.readFloat(),m.shearY=r.readFloat(),m.length=r.readFloat()*e,m.transformMode=r.readInt(!0),m.skinRequired=r.readBoolean(),a&&et.rgba8888ToColor(m.color,r.readInt32()),s.bones.push(m)}c=r.readInt(!0);for(let d=0;d<c;d++){const u=r.readString();if(!u)throw new Error("Slot name must not be null.");const f=s.bones[r.readInt(!0)],m=new Vd(d,u,f);et.rgba8888ToColor(m.color,r.readInt32());const p=r.readInt32();p!=-1&&et.rgb888ToColor(m.darkColor=new et,p),m.attachmentName=r.readStringRef(),m.blendMode=r.readInt(!0),s.slots.push(m)}c=r.readInt(!0);for(let d=0,u;d<c;d++){const f=r.readString();if(!f)throw new Error("IK constraint data name must not be null.");const m=new Bd(f);m.order=r.readInt(!0),m.skinRequired=r.readBoolean(),u=r.readInt(!0);for(let p=0;p<u;p++)m.bones.push(s.bones[r.readInt(!0)]);m.target=s.bones[r.readInt(!0)],m.mix=r.readFloat(),m.softness=r.readFloat()*e,m.bendDirection=r.readByte(),m.compress=r.readBoolean(),m.stretch=r.readBoolean(),m.uniform=r.readBoolean(),s.ikConstraints.push(m)}c=r.readInt(!0);for(let d=0,u;d<c;d++){const f=r.readString();if(!f)throw new Error("Transform constraint data name must not be null.");const m=new Ud(f);m.order=r.readInt(!0),m.skinRequired=r.readBoolean(),u=r.readInt(!0);for(let p=0;p<u;p++)m.bones.push(s.bones[r.readInt(!0)]);m.target=s.bones[r.readInt(!0)],m.local=r.readBoolean(),m.relative=r.readBoolean(),m.offsetRotation=r.readFloat(),m.offsetX=r.readFloat()*e,m.offsetY=r.readFloat()*e,m.offsetScaleX=r.readFloat(),m.offsetScaleY=r.readFloat(),m.offsetShearY=r.readFloat(),m.mixRotate=r.readFloat(),m.mixX=r.readFloat(),m.mixY=r.readFloat(),m.mixScaleX=r.readFloat(),m.mixScaleY=r.readFloat(),m.mixShearY=r.readFloat(),s.transformConstraints.push(m)}c=r.readInt(!0);for(let d=0,u;d<c;d++){const f=r.readString();if(!f)throw new Error("Path constraint data name must not be null.");const m=new Ld(f);m.order=r.readInt(!0),m.skinRequired=r.readBoolean(),u=r.readInt(!0);for(let p=0;p<u;p++)m.bones.push(s.bones[r.readInt(!0)]);m.target=s.slots[r.readInt(!0)],m.positionMode=r.readInt(!0),m.spacingMode=r.readInt(!0),m.rotateMode=r.readInt(!0),m.offsetRotation=r.readFloat(),m.position=r.readFloat(),m.positionMode==me.Fixed&&(m.position*=e),m.spacing=r.readFloat(),(m.spacingMode==Re.Length||m.spacingMode==Re.Fixed)&&(m.spacing*=e),m.mixRotate=r.readFloat(),m.mixX=r.readFloat(),m.mixY=r.readFloat(),s.pathConstraints.push(m)}const h=this.readSkin(r,s,!0,a);h&&(s.defaultSkin=h,s.skins.push(h));{let d=s.skins.length;for($.setArraySize(s.skins,c=d+r.readInt(!0));d<c;d++){const u=this.readSkin(r,s,!1,a);if(!u)throw new Error("readSkin() should not have returned null.");s.skins[d]=u}}c=this.linkedMeshes.length;for(let d=0;d<c;d++){const u=this.linkedMeshes[d],f=u.skin?s.findSkin(u.skin):s.defaultSkin;if(!f)throw new Error("Not skin found for linked mesh.");if(!u.parent)throw new Error("Linked mesh parent must not be null");const m=f.getAttachment(u.slotIndex,u.parent);if(!m)throw new Error(`Parent mesh not found: ${u.parent}`);u.mesh.timelineAttachment=u.inheritTimeline?m:u.mesh,u.mesh.setParentMesh(m)}this.linkedMeshes.length=0,c=r.readInt(!0);for(let d=0;d<c;d++){const u=r.readStringRef();if(!u)throw new Error;const f=new Dd(u);f.intValue=r.readInt(!1),f.floatValue=r.readFloat(),f.stringValue=r.readString(),f.audioPath=r.readString(),f.audioPath&&(f.volume=r.readFloat(),f.balance=r.readFloat()),s.events.push(f)}c=r.readInt(!0);for(let d=0;d<c;d++){const u=r.readString();if(!u)throw new Error("Animatio name must not be null.");s.animations.push(this.readAnimation(r,u,s))}return s}readSkin(t,e,s,r){let i=null,o=0;if(s){if(o=t.readInt(!0),o==0)return null;i=new Io("default")}else{const l=t.readStringRef();if(!l)throw new Error("Skin name must not be null.");i=new Io(l),i.bones.length=t.readInt(!0);for(let a=0,c=i.bones.length;a<c;a++)i.bones[a]=e.bones[t.readInt(!0)];for(let a=0,c=t.readInt(!0);a<c;a++)i.constraints.push(e.ikConstraints[t.readInt(!0)]);for(let a=0,c=t.readInt(!0);a<c;a++)i.constraints.push(e.transformConstraints[t.readInt(!0)]);for(let a=0,c=t.readInt(!0);a<c;a++)i.constraints.push(e.pathConstraints[t.readInt(!0)]);o=t.readInt(!0)}for(let l=0;l<o;l++){const a=t.readInt(!0);for(let c=0,h=t.readInt(!0);c<h;c++){const d=t.readStringRef();if(!d)throw new Error("Attachment name must not be null");const u=this.readAttachment(t,e,i,a,d,r);u&&i.setAttachment(a,d,u)}}return i}readAttachment(t,e,s,r,i,o){const l=this.scale;let a=t.readStringRef();switch(a||(a=i),t.readByte()){case Rt.Region:{let c=t.readStringRef();const h=t.readFloat(),d=t.readFloat(),u=t.readFloat(),f=t.readFloat(),m=t.readFloat(),p=t.readFloat(),g=t.readFloat(),w=t.readInt32(),x=this.readSequence(t);c||(c=a);const y=this.attachmentLoader.newRegionAttachment(s,a,c,x);return y?(y.path=c,y.x=d*l,y.y=u*l,y.scaleX=f,y.scaleY=m,y.rotation=h,y.width=p*l,y.height=g*l,et.rgba8888ToColor(y.color,w),y.sequence=x,x==null&&y.updateRegion(),y):null}case Rt.BoundingBox:{const c=t.readInt(!0),h=this.readVertices(t,c),d=o?t.readInt32():0,u=this.attachmentLoader.newBoundingBoxAttachment(s,a);return u?(u.worldVerticesLength=c<<1,u.vertices=h.vertices,u.bones=h.bones,o&&et.rgba8888ToColor(u.color,d),u):null}case Rt.Mesh:{let c=t.readStringRef();const h=t.readInt32(),d=t.readInt(!0),u=this.readFloatArray(t,d<<1,1),f=this.readShortArray(t),m=this.readVertices(t,d),p=t.readInt(!0),g=this.readSequence(t);let w=[],x=0,y=0;o&&(w=this.readShortArray(t),x=t.readFloat(),y=t.readFloat()),c||(c=a);const b=this.attachmentLoader.newMeshAttachment(s,a,c,g);return b?(b.path=c,et.rgba8888ToColor(b.color,h),b.bones=m.bones,b.vertices=m.vertices,b.worldVerticesLength=d<<1,b.triangles=f,b.regionUVs=new Float32Array(u),b.hullLength=p<<1,b.sequence=g,o&&(b.edges=w,b.width=x*l,b.height=y*l),b):null}case Rt.LinkedMesh:{let c=t.readStringRef();const h=t.readInt32(),d=t.readStringRef(),u=t.readStringRef(),f=t.readBoolean(),m=this.readSequence(t);let p=0,g=0;o&&(p=t.readFloat(),g=t.readFloat()),c||(c=a);const w=this.attachmentLoader.newMeshAttachment(s,a,c,m);return w?(w.path=c,et.rgba8888ToColor(w.color,h),w.sequence=m,o&&(w.width=p*l,w.height=g*l),this.linkedMeshes.push(new fS(w,d,r,u,f)),w):null}case Rt.Path:{const c=t.readBoolean(),h=t.readBoolean(),d=t.readInt(!0),u=this.readVertices(t,d),f=$.newArray(d/3,0);for(let g=0,w=f.length;g<w;g++)f[g]=t.readFloat()*l;const m=o?t.readInt32():0,p=this.attachmentLoader.newPathAttachment(s,a);return p?(p.closed=c,p.constantSpeed=h,p.worldVerticesLength=d<<1,p.vertices=u.vertices,p.bones=u.bones,p.lengths=f,o&&et.rgba8888ToColor(p.color,m),p):null}case Rt.Point:{const c=t.readFloat(),h=t.readFloat(),d=t.readFloat(),u=o?t.readInt32():0,f=this.attachmentLoader.newPointAttachment(s,a);return f?(f.x=h*l,f.y=d*l,f.rotation=c,o&&et.rgba8888ToColor(f.color,u),f):null}case Rt.Clipping:{const c=t.readInt(!0),h=t.readInt(!0),d=this.readVertices(t,h),u=o?t.readInt32():0,f=this.attachmentLoader.newClippingAttachment(s,a);return f?(f.endSlot=e.slots[c],f.worldVerticesLength=h<<1,f.vertices=d.vertices,f.bones=d.bones,o&&et.rgba8888ToColor(f.color,u),f):null}}return null}readSequence(t){if(this.ver40||!t.readBoolean())return null;const e=new nl(t.readInt(!0));return e.start=t.readInt(!0),e.digits=t.readInt(!0),e.setupIndex=t.readInt(!0),e}readDeformTimelineType(t){return this.ver40?Df:t.readByte()}readVertices(t,e){const s=this.scale,r=e<<1,i=new mS;if(!t.readBoolean())return i.vertices=this.readFloatArray(t,r,s),i;const o=new Array,l=new Array;for(let a=0;a<e;a++){const c=t.readInt(!0);l.push(c);for(let h=0;h<c;h++)l.push(t.readInt(!0)),o.push(t.readFloat()*s),o.push(t.readFloat()*s),o.push(t.readFloat())}return i.vertices=$.toFloatArray(o),i.bones=l,i}readFloatArray(t,e,s){const r=new Array(e);if(s==1)for(let i=0;i<e;i++)r[i]=t.readFloat();else for(let i=0;i<e;i++)r[i]=t.readFloat()*s;return r}readShortArray(t){const e=t.readInt(!0),s=new Array(e);for(let r=0;r<e;r++)s[r]=t.readShort();return s}readAnimation(t,e,s){t.readInt(!0);const r=new Array,i=this.scale;for(let c=0,h=t.readInt(!0);c<h;c++){const d=t.readInt(!0);for(let u=0,f=t.readInt(!0);u<f;u++){const m=t.readByte(),p=t.readInt(!0),g=p-1;switch(m){case TS:{const w=new Br(p,d);for(let x=0;x<p;x++)w.setFrame(x,t.readFloat(),t.readStringRef());r.push(w);break}case AS:{const w=t.readInt(!0),x=new vd(p,w,d);let y=t.readFloat(),b=t.readUnsignedByte()/255,_=t.readUnsignedByte()/255,E=t.readUnsignedByte()/255,S=t.readUnsignedByte()/255;for(let T=0,C=0;x.setFrame(T,y,b,_,E,S),T!=g;T++){const A=t.readFloat(),R=t.readUnsignedByte()/255,M=t.readUnsignedByte()/255,I=t.readUnsignedByte()/255,N=t.readUnsignedByte()/255;switch(t.readByte()){case Us:x.setStepped(T);break;case Xs:Nt(t,x,C++,T,0,y,A,b,R,1),Nt(t,x,C++,T,1,y,A,_,M,1),Nt(t,x,C++,T,2,y,A,E,I,1),Nt(t,x,C++,T,3,y,A,S,N,1)}y=A,b=R,_=M,E=I,S=N}r.push(x);break}case CS:{const w=t.readInt(!0),x=new _d(p,w,d);let y=t.readFloat(),b=t.readUnsignedByte()/255,_=t.readUnsignedByte()/255,E=t.readUnsignedByte()/255;for(let S=0,T=0;x.setFrame(S,y,b,_,E),S!=g;S++){const C=t.readFloat(),A=t.readUnsignedByte()/255,R=t.readUnsignedByte()/255,M=t.readUnsignedByte()/255;switch(t.readByte()){case Us:x.setStepped(S);break;case Xs:Nt(t,x,T++,S,0,y,C,b,A,1),Nt(t,x,T++,S,1,y,C,_,R,1),Nt(t,x,T++,S,2,y,C,E,M,1)}y=C,b=A,_=R,E=M}r.push(x);break}case kS:{const w=t.readInt(!0),x=new Sd(p,w,d);let y=t.readFloat(),b=t.readUnsignedByte()/255,_=t.readUnsignedByte()/255,E=t.readUnsignedByte()/255,S=t.readUnsignedByte()/255,T=t.readUnsignedByte()/255,C=t.readUnsignedByte()/255,A=t.readUnsignedByte()/255;for(let R=0,M=0;x.setFrame(R,y,b,_,E,S,T,C,A),R!=g;R++){const I=t.readFloat(),N=t.readUnsignedByte()/255,F=t.readUnsignedByte()/255,B=t.readUnsignedByte()/255,Y=t.readUnsignedByte()/255,O=t.readUnsignedByte()/255,V=t.readUnsignedByte()/255,j=t.readUnsignedByte()/255;switch(t.readByte()){case Us:x.setStepped(R);break;case Xs:Nt(t,x,M++,R,0,y,I,b,N,1),Nt(t,x,M++,R,1,y,I,_,F,1),Nt(t,x,M++,R,2,y,I,E,B,1),Nt(t,x,M++,R,3,y,I,S,Y,1),Nt(t,x,M++,R,4,y,I,T,O,1),Nt(t,x,M++,R,5,y,I,C,V,1),Nt(t,x,M++,R,6,y,I,A,j,1)}y=I,b=N,_=F,E=B,S=Y,T=O,C=V,A=j}r.push(x);break}case IS:{const w=t.readInt(!0),x=new Td(p,w,d);let y=t.readFloat(),b=t.readUnsignedByte()/255,_=t.readUnsignedByte()/255,E=t.readUnsignedByte()/255,S=t.readUnsignedByte()/255,T=t.readUnsignedByte()/255,C=t.readUnsignedByte()/255;for(let A=0,R=0;x.setFrame(A,y,b,_,E,S,T,C),A!=g;A++){const M=t.readFloat(),I=t.readUnsignedByte()/255,N=t.readUnsignedByte()/255,F=t.readUnsignedByte()/255,B=t.readUnsignedByte()/255,Y=t.readUnsignedByte()/255,O=t.readUnsignedByte()/255;switch(t.readByte()){case Us:x.setStepped(A);break;case Xs:Nt(t,x,R++,A,0,y,M,b,I,1),Nt(t,x,R++,A,1,y,M,_,N,1),Nt(t,x,R++,A,2,y,M,E,F,1),Nt(t,x,R++,A,3,y,M,S,B,1),Nt(t,x,R++,A,4,y,M,T,Y,1),Nt(t,x,R++,A,5,y,M,C,O,1)}y=M,b=I,_=N,E=F,S=B,T=Y,C=O}r.push(x);break}case RS:{const w=new Ed(p,t.readInt(!0),d);let x=t.readFloat(),y=t.readUnsignedByte()/255;for(let b=0,_=0;w.setFrame(b,x,y),b!=g;b++){const E=t.readFloat(),S=t.readUnsignedByte()/255;switch(t.readByte()){case Us:w.setStepped(b);break;case Xs:Nt(t,w,_++,b,0,x,E,y,S,1)}x=E,y=S}r.push(w)}}}}for(let c=0,h=t.readInt(!0);c<h;c++){const d=t.readInt(!0);for(let u=0,f=t.readInt(!0);u<f;u++){const m=t.readByte(),p=t.readInt(!0),g=t.readInt(!0);switch(m){case pS:r.push(En(t,new ha(p,g,d),1));break;case gS:r.push(Hl(t,new ud(p,g,d),i));break;case xS:r.push(En(t,new fd(p,g,d),i));break;case bS:r.push(En(t,new md(p,g,d),i));break;case yS:r.push(Hl(t,new pd(p,g,d),1));break;case wS:r.push(En(t,new gd(p,g,d),1));break;case vS:r.push(En(t,new xd(p,g,d),1));break;case _S:r.push(Hl(t,new bd(p,g,d),1));break;case ES:r.push(En(t,new yd(p,g,d),1));break;case SS:r.push(En(t,new wd(p,g,d),1))}}}for(let c=0,h=t.readInt(!0);c<h;c++){const d=t.readInt(!0),u=t.readInt(!0),f=u-1,m=new Cd(u,t.readInt(!0),d);let p=t.readFloat(),g=t.readFloat(),w=t.readFloat()*i;for(let x=0,y=0;m.setFrame(x,p,g,w,t.readByte(),t.readBoolean(),t.readBoolean()),x!=f;x++){const b=t.readFloat(),_=t.readFloat(),E=t.readFloat()*i;switch(t.readByte()){case Us:m.setStepped(x);break;case Xs:Nt(t,m,y++,x,0,p,b,g,_,1),Nt(t,m,y++,x,1,p,b,w,E,i)}p=b,g=_,w=E}r.push(m)}for(let c=0,h=t.readInt(!0);c<h;c++){const d=t.readInt(!0),u=t.readInt(!0),f=u-1,m=new kd(u,t.readInt(!0),d);let p=t.readFloat(),g=t.readFloat(),w=t.readFloat(),x=t.readFloat(),y=t.readFloat(),b=t.readFloat(),_=t.readFloat();for(let E=0,S=0;m.setFrame(E,p,g,w,x,y,b,_),E!=f;E++){const T=t.readFloat(),C=t.readFloat(),A=t.readFloat(),R=t.readFloat(),M=t.readFloat(),I=t.readFloat(),N=t.readFloat();switch(t.readByte()){case Us:m.setStepped(E);break;case Xs:Nt(t,m,S++,E,0,p,T,g,C,1),Nt(t,m,S++,E,1,p,T,w,A,1),Nt(t,m,S++,E,2,p,T,x,R,1),Nt(t,m,S++,E,3,p,T,y,M,1),Nt(t,m,S++,E,4,p,T,b,I,1),Nt(t,m,S++,E,5,p,T,_,N,1)}p=T,g=C,w=A,x=R,y=M,b=I,_=N}r.push(m)}for(let c=0,h=t.readInt(!0);c<h;c++){const d=t.readInt(!0),u=s.pathConstraints[d];for(let f=0,m=t.readInt(!0);f<m;f++)switch(t.readByte()){case PS:r.push(En(t,new Id(t.readInt(!0),t.readInt(!0),d),u.positionMode==me.Fixed?i:1));break;case NS:r.push(En(t,new Rd(t.readInt(!0),t.readInt(!0),d),u.spacingMode==Re.Length||u.spacingMode==Re.Fixed?i:1));break;case FS:const p=new Md(t.readInt(!0),t.readInt(!0),d);let g=t.readFloat(),w=t.readFloat(),x=t.readFloat(),y=t.readFloat();for(let b=0,_=0,E=p.getFrameCount()-1;p.setFrame(b,g,w,x,y),b!=E;b++){const S=t.readFloat(),T=t.readFloat(),C=t.readFloat(),A=t.readFloat();switch(t.readByte()){case Us:p.setStepped(b);break;case Xs:Nt(t,p,_++,b,0,g,S,w,T,1),Nt(t,p,_++,b,1,g,S,x,C,1),Nt(t,p,_++,b,2,g,S,y,A,1)}g=S,w=T,x=C,y=A}r.push(p)}}for(let c=0,h=t.readInt(!0);c<h;c++){const d=s.skins[t.readInt(!0)];for(let u=0,f=t.readInt(!0);u<f;u++){const m=t.readInt(!0);for(let p=0,g=t.readInt(!0);p<g;p++){const w=t.readStringRef();if(!w)throw new Error("attachmentName must not be null.");const x=d.getAttachment(m,w),y=this.readDeformTimelineType(t),b=t.readInt(!0),_=b-1;switch(y){case Df:{const E=x,S=E.bones,T=E.vertices,C=S?T.length/3*2:T.length,A=t.readInt(!0),R=new Ad(b,A,m,E);let M=t.readFloat();for(let I=0,N=0;;I++){let F,B=t.readInt(!0);if(B==0)F=S?$.newFloatArray(C):T;else{F=$.newFloatArray(C);const O=t.readInt(!0);if(B+=O,i==1)for(let V=O;V<B;V++)F[V]=t.readFloat();else for(let V=O;V<B;V++)F[V]=t.readFloat()*i;if(!S)for(let V=0,j=F.length;V<j;V++)F[V]+=T[V]}if(R.setFrame(I,M,F),I==_)break;const Y=t.readFloat();switch(t.readByte()){case Us:R.setStepped(I);break;case Xs:Nt(t,R,N++,I,0,M,Y,0,1,1)}M=Y}r.push(R);break}case MS:{const E=new Ti(b,m,x);for(let S=0;S<b;S++){const T=t.readFloat(),C=t.readInt32();E.setFrame(S,T,dd[C&15],C>>4,t.readFloat())}r.push(E);break}}}}}const o=t.readInt(!0);if(o>0){const c=new Or(o),h=s.slots.length;for(let d=0;d<o;d++){const u=t.readFloat(),f=t.readInt(!0),m=$.newArray(h,0);for(let x=h-1;x>=0;x--)m[x]=-1;const p=$.newArray(h-f,0);let g=0,w=0;for(let x=0;x<f;x++){const y=t.readInt(!0);for(;g!=y;)p[w++]=g++;m[g+t.readInt(!0)]=g++}for(;g<h;)p[w++]=g++;for(let x=h-1;x>=0;x--)m[x]==-1&&(m[x]=p[--w]);c.setFrame(d,u,m)}r.push(c)}const l=t.readInt(!0);if(l>0){const c=new xa(l);for(let h=0;h<l;h++){const d=t.readFloat(),u=s.events[t.readInt(!0)],f=new Fd(d,u);f.intValue=t.readInt(!1),f.floatValue=t.readFloat(),f.stringValue=t.readBoolean()?t.readString():u.stringValue,f.data.audioPath&&(f.volume=t.readFloat(),f.balance=t.readFloat()),c.setFrame(h,f)}r.push(c)}let a=0;for(let c=0,h=r.length;c<h;c++)a=Math.max(a,r[c].getDuration());return new rl(e,r,a)}}Xd.BlendModeValues=[dt.NORMAL,dt.ADD,dt.MULTIPLY,dt.SCREEN];let fS=class{constructor(t,e,s,r,i){this.mesh=t,this.skin=e,this.slotIndex=s,this.parent=r,this.inheritTimeline=i}};class mS{constructor(t=null,e=null){this.bones=t,this.vertices=e}}function En(n,t,e){let s=n.readFloat(),r=n.readFloat()*e;for(let i=0,o=0,l=t.getFrameCount()-1;t.setFrame(i,s,r),i!=l;i++){const a=n.readFloat(),c=n.readFloat()*e;switch(n.readByte()){case Us:t.setStepped(i);break;case Xs:Nt(n,t,o++,i,0,s,a,r,c,e)}s=a,r=c}return t}function Hl(n,t,e){let s=n.readFloat(),r=n.readFloat()*e,i=n.readFloat()*e;for(let o=0,l=0,a=t.getFrameCount()-1;t.setFrame(o,s,r,i),o!=a;o++){const c=n.readFloat(),h=n.readFloat()*e,d=n.readFloat()*e;switch(n.readByte()){case Us:t.setStepped(o);break;case Xs:Nt(n,t,l++,o,0,s,c,r,h,e),Nt(n,t,l++,o,1,s,c,i,d,e)}s=c,r=h,i=d}return t}function Nt(n,t,e,s,r,i,o,l,a,c){t.setBezier(e,s,r,i,l,n.readFloat(),n.readFloat()*c,n.readFloat(),n.readFloat()*c,o,a)}const pS=0,gS=1,xS=2,bS=3,yS=4,wS=5,vS=6,_S=7,ES=8,SS=9,TS=0,AS=1,CS=2,kS=3,IS=4,RS=5,Df=0,MS=1,PS=0,NS=1,FS=2,Us=1,Xs=2;class DS extends jh{}class ll{constructor(t){this.scale=1,this.linkedMeshes=new Array,this.attachmentLoader=t}readSkeletonData(t){const e=this.scale,s=new jd,r=typeof t=="string"?JSON.parse(t):t,i=r.skeleton;if(i){s.hash=i.hash,s.version=i.spine;const o=s.version.substr(0,3);if(o!=="4.0"&&o!=="4.1"){const l=`Spine 4.1 loader cant load version ${i.spine}. Please configure your pixi-spine bundle`;console.error(l)}s.x=i.x,s.y=i.y,s.width=i.width,s.height=i.height,s.fps=i.fps,s.imagesPath=i.images}if(r.bones)for(let o=0;o<r.bones.length;o++){const l=r.bones[o];let a=null;const c=z(l,"parent",null);if(c!=null&&(a=s.findBone(c),a==null))throw new Error(`Parent bone not found: ${c}`);const h=new Nd(s.bones.length,l.name,a);h.length=z(l,"length",0)*e,h.x=z(l,"x",0)*e,h.y=z(l,"y",0)*e,h.rotation=z(l,"rotation",0),h.scaleX=z(l,"scaleX",1),h.scaleY=z(l,"scaleY",1),h.shearX=z(l,"shearX",0),h.shearY=z(l,"shearY",0),h.transformMode=$.enumValue(wt,z(l,"transform","Normal")),h.skinRequired=z(l,"skin",!1);const d=z(l,"color",null);d&&h.color.setFromString(d),s.bones.push(h)}if(r.slots)for(let o=0;o<r.slots.length;o++){const l=r.slots[o],a=s.findBone(l.bone);if(!a)throw new Error(`Couldn't find bone ${l.bone} for slot ${l.name}`);const c=new Vd(s.slots.length,l.name,a),h=z(l,"color",null);h&&c.color.setFromString(h);const d=z(l,"dark",null);d&&(c.darkColor=et.fromString(d)),c.attachmentName=z(l,"attachment",null),c.blendMode=ll.blendModeFromString(z(l,"blend","normal")),s.slots.push(c)}if(r.ik)for(let o=0;o<r.ik.length;o++){const l=r.ik[o],a=new Bd(l.name);a.order=z(l,"order",0),a.skinRequired=z(l,"skin",!1);for(let c=0;c<l.bones.length;c++){const h=l.bones[c],d=s.findBone(h);if(d==null)throw new Error(`IK bone not found: ${h}`);a.bones.push(d)}a.target=s.findBone(l.target),a.mix=z(l,"mix",1),a.softness=z(l,"softness",0)*e,a.bendDirection=z(l,"bendPositive",!0)?1:-1,a.compress=z(l,"compress",!1),a.stretch=z(l,"stretch",!1),a.uniform=z(l,"uniform",!1),s.ikConstraints.push(a)}if(r.transform)for(let o=0;o<r.transform.length;o++){const l=r.transform[o],a=new Ud(l.name);a.order=z(l,"order",0),a.skinRequired=z(l,"skin",!1);for(let d=0;d<l.bones.length;d++){const u=l.bones[d],f=s.findBone(u);if(!f)throw new Error(`Couldn't find bone ${u} for transform constraint ${l.name}.`);a.bones.push(f)}const c=l.target,h=s.findBone(c);if(!h)throw new Error(`Couldn't find target bone ${c} for transform constraint ${l.name}.`);a.target=h,a.local=z(l,"local",!1),a.relative=z(l,"relative",!1),a.offsetRotation=z(l,"rotation",0),a.offsetX=z(l,"x",0)*e,a.offsetY=z(l,"y",0)*e,a.offsetScaleX=z(l,"scaleX",0),a.offsetScaleY=z(l,"scaleY",0),a.offsetShearY=z(l,"shearY",0),a.mixRotate=z(l,"mixRotate",1),a.mixX=z(l,"mixX",1),a.mixY=z(l,"mixY",a.mixX),a.mixScaleX=z(l,"mixScaleX",1),a.mixScaleY=z(l,"mixScaleY",a.mixScaleX),a.mixShearY=z(l,"mixShearY",1),s.transformConstraints.push(a)}if(r.path)for(let o=0;o<r.path.length;o++){const l=r.path[o],a=new Ld(l.name);a.order=z(l,"order",0),a.skinRequired=z(l,"skin",!1);for(let d=0;d<l.bones.length;d++){const u=l.bones[d],f=s.findBone(u);if(!f)throw new Error(`Couldn't find bone ${u} for path constraint ${l.name}.`);a.bones.push(f)}const c=l.target,h=s.findSlot(c);if(!h)throw new Error(`Couldn't find target slot ${c} for path constraint ${l.name}.`);a.target=h,a.positionMode=$.enumValue(me,z(l,"positionMode","Percent")),a.spacingMode=$.enumValue(Re,z(l,"spacingMode","Length")),a.rotateMode=$.enumValue(_e,z(l,"rotateMode","Tangent")),a.offsetRotation=z(l,"rotation",0),a.position=z(l,"position",0),a.positionMode==me.Fixed&&(a.position*=e),a.spacing=z(l,"spacing",0),(a.spacingMode==Re.Length||a.spacingMode==Re.Fixed)&&(a.spacing*=e),a.mixRotate=z(l,"mixRotate",1),a.mixX=z(l,"mixX",1),a.mixY=z(l,"mixY",a.mixX),s.pathConstraints.push(a)}if(r.skins)for(let o=0;o<r.skins.length;o++){const l=r.skins[o],a=new Io(l.name);if(l.bones)for(let c=0;c<l.bones.length;c++){const h=l.bones[c],d=s.findBone(h);if(!d)throw new Error(`Couldn't find bone ${h} for skin ${l.name}.`);a.bones.push(d)}if(l.ik)for(let c=0;c<l.ik.length;c++){const h=l.ik[c],d=s.findIkConstraint(h);if(!d)throw new Error(`Couldn't find IK constraint ${h} for skin ${l.name}.`);a.constraints.push(d)}if(l.transform)for(let c=0;c<l.transform.length;c++){const h=l.transform[c],d=s.findTransformConstraint(h);if(!d)throw new Error(`Couldn't find transform constraint ${h} for skin ${l.name}.`);a.constraints.push(d)}if(l.path)for(let c=0;c<l.path.length;c++){const h=l.path[c],d=s.findPathConstraint(h);if(!d)throw new Error(`Couldn't find path constraint ${h} for skin ${l.name}.`);a.constraints.push(d)}for(const c in l.attachments){const h=s.findSlot(c);if(!h)throw new Error(`Couldn't find slot ${c} for skin ${l.name}.`);const d=l.attachments[c];for(const u in d){const f=this.readAttachment(d[u],a,h.index,u,s);f&&a.setAttachment(h.index,u,f)}}s.skins.push(a),a.name=="default"&&(s.defaultSkin=a)}for(let o=0,l=this.linkedMeshes.length;o<l;o++){const a=this.linkedMeshes[o],c=a.skin?s.findSkin(a.skin):s.defaultSkin;if(!c)throw new Error(`Skin not found: ${a.skin}`);const h=c.getAttachment(a.slotIndex,a.parent);if(!h)throw new Error(`Parent mesh not found: ${a.parent}`);a.mesh.timelineAttachment=a.inheritTimeline?h:a.mesh,a.mesh.setParentMesh(h)}if(this.linkedMeshes.length=0,r.events)for(const o in r.events){const l=r.events[o],a=new Dd(o);a.intValue=z(l,"int",0),a.floatValue=z(l,"float",0),a.stringValue=z(l,"string",""),a.audioPath=z(l,"audio",null),a.audioPath&&(a.volume=z(l,"volume",1),a.balance=z(l,"balance",0)),s.events.push(a)}if(r.animations)for(const o in r.animations){const l=r.animations[o];this.readAnimation(l,o,s)}return s}readAttachment(t,e,s,r,i){const o=this.scale;switch(r=z(t,"name",r),z(t,"type","region")){case"region":{const l=z(t,"path",r),a=this.readSequence(z(t,"sequence",null)),c=this.attachmentLoader.newRegionAttachment(e,r,l,a);if(!c)return null;c.path=l,c.x=z(t,"x",0)*o,c.y=z(t,"y",0)*o,c.scaleX=z(t,"scaleX",1),c.scaleY=z(t,"scaleY",1),c.rotation=z(t,"rotation",0),c.width=t.width*o,c.height=t.height*o,c.sequence=a;const h=z(t,"color",null);return h&&c.color.setFromString(h),c}case"boundingbox":{const l=this.attachmentLoader.newBoundingBoxAttachment(e,r);if(!l)return null;this.readVertices(t,l,t.vertexCount<<1);const a=z(t,"color",null);return a&&l.color.setFromString(a),l}case"mesh":case"linkedmesh":{const l=z(t,"path",r),a=this.readSequence(z(t,"sequence",null)),c=this.attachmentLoader.newMeshAttachment(e,r,l,a);if(!c)return null;c.path=l;const h=z(t,"color",null);h&&c.color.setFromString(h),c.width=z(t,"width",0)*o,c.height=z(t,"height",0)*o,c.sequence=a;const d=z(t,"parent",null);if(d)return this.linkedMeshes.push(new BS(c,z(t,"skin",null),s,d,z(t,"timelines",!0))),c;const u=t.uvs;return this.readVertices(t,c,u.length),c.triangles=t.triangles,c.regionUVs=new Float32Array(u),c.edges=z(t,"edges",null),c.hullLength=z(t,"hull",0)*2,c}case"path":{const l=this.attachmentLoader.newPathAttachment(e,r);if(!l)return null;l.closed=z(t,"closed",!1),l.constantSpeed=z(t,"constantSpeed",!0);const a=t.vertexCount;this.readVertices(t,l,a<<1);const c=$.newArray(a/3,0);for(let d=0;d<t.lengths.length;d++)c[d]=t.lengths[d]*o;l.lengths=c;const h=z(t,"color",null);return h&&l.color.setFromString(h),l}case"point":{const l=this.attachmentLoader.newPointAttachment(e,r);if(!l)return null;l.x=z(t,"x",0)*o,l.y=z(t,"y",0)*o,l.rotation=z(t,"rotation",0);const a=z(t,"color",null);return a&&l.color.setFromString(a),l}case"clipping":{const l=this.attachmentLoader.newClippingAttachment(e,r);if(!l)return null;const a=z(t,"end",null);if(a!=null){const d=i.findSlot(a);if(d==null)throw new Error(`Clipping end slot not found: ${a}`);l.endSlot=d}const c=t.vertexCount;this.readVertices(t,l,c<<1);const h=z(t,"color",null);return h&&l.color.setFromString(h),l}}return null}readSequence(t){if(t==null)return null;const e=new nl(z(t,"count",0));return e.start=z(t,"start",1),e.digits=z(t,"digits",0),e.setupIndex=z(t,"setup",0),e}readVertices(t,e,s){const r=this.scale;e.worldVerticesLength=s;const i=t.vertices;if(s==i.length){const a=$.toFloatArray(i);if(r!=1)for(let c=0,h=i.length;c<h;c++)a[c]*=r;e.vertices=a;return}const o=new Array,l=new Array;for(let a=0,c=i.length;a<c;){const h=i[a++];l.push(h);for(let d=a+h*4;a<d;a+=4)l.push(i[a]),o.push(i[a+1]*r),o.push(i[a+2]*r),o.push(i[a+3])}e.bones=l,e.vertices=$.toFloatArray(o)}readAnimation(t,e,s){const r=this.scale,i=new Array;if(t.slots)for(const l in t.slots){const a=t.slots[l],c=s.findSlot(l);if(!c)throw new Error(`Slot not found: ${l}`);const h=c.index;for(const d in a){const u=a[d];if(!u)continue;const f=u.length;if(d=="attachment"){const m=new Br(f,h);for(let p=0;p<f;p++){const g=u[p];m.setFrame(p,z(g,"time",0),z(g,"name",null))}i.push(m)}else if(d=="rgba"){const m=new vd(f,f<<2,h);let p=u[0],g=z(p,"time",0),w=et.fromString(p.color);for(let x=0,y=0;;x++){m.setFrame(x,g,w.r,w.g,w.b,w.a);const b=u[x+1];if(!b){m.shrink(y);break}const _=z(b,"time",0),E=et.fromString(b.color),S=p.curve;S&&(y=Bt(S,m,y,x,0,g,_,w.r,E.r,1),y=Bt(S,m,y,x,1,g,_,w.g,E.g,1),y=Bt(S,m,y,x,2,g,_,w.b,E.b,1),y=Bt(S,m,y,x,3,g,_,w.a,E.a,1)),g=_,w=E,p=b}i.push(m)}else if(d=="rgb"){const m=new _d(f,f*3,h);let p=u[0],g=z(p,"time",0),w=et.fromString(p.color);for(let x=0,y=0;;x++){m.setFrame(x,g,w.r,w.g,w.b);const b=u[x+1];if(!b){m.shrink(y);break}const _=z(b,"time",0),E=et.fromString(b.color),S=p.curve;S&&(y=Bt(S,m,y,x,0,g,_,w.r,E.r,1),y=Bt(S,m,y,x,1,g,_,w.g,E.g,1),y=Bt(S,m,y,x,2,g,_,w.b,E.b,1)),g=_,w=E,p=b}i.push(m)}else if(d=="alpha")i.push(nn(u,new Ed(f,f,h),0,1));else if(d=="rgba2"){const m=new Sd(f,f*7,h);let p=u[0],g=z(p,"time",0),w=et.fromString(p.light),x=et.fromString(p.dark);for(let y=0,b=0;;y++){m.setFrame(y,g,w.r,w.g,w.b,w.a,x.r,x.g,x.b);const _=u[y+1];if(!_){m.shrink(b);break}const E=z(_,"time",0),S=et.fromString(_.light),T=et.fromString(_.dark),C=p.curve;C&&(b=Bt(C,m,b,y,0,g,E,w.r,S.r,1),b=Bt(C,m,b,y,1,g,E,w.g,S.g,1),b=Bt(C,m,b,y,2,g,E,w.b,S.b,1),b=Bt(C,m,b,y,3,g,E,w.a,S.a,1),b=Bt(C,m,b,y,4,g,E,x.r,T.r,1),b=Bt(C,m,b,y,5,g,E,x.g,T.g,1),b=Bt(C,m,b,y,6,g,E,x.b,T.b,1)),g=E,w=S,x=T,p=_}i.push(m)}else if(d=="rgb2"){const m=new Td(f,f*6,h);let p=u[0],g=z(p,"time",0),w=et.fromString(p.light),x=et.fromString(p.dark);for(let y=0,b=0;;y++){m.setFrame(y,g,w.r,w.g,w.b,x.r,x.g,x.b);const _=u[y+1];if(!_){m.shrink(b);break}const E=z(_,"time",0),S=et.fromString(_.light),T=et.fromString(_.dark),C=p.curve;C&&(b=Bt(C,m,b,y,0,g,E,w.r,S.r,1),b=Bt(C,m,b,y,1,g,E,w.g,S.g,1),b=Bt(C,m,b,y,2,g,E,w.b,S.b,1),b=Bt(C,m,b,y,3,g,E,x.r,T.r,1),b=Bt(C,m,b,y,4,g,E,x.g,T.g,1),b=Bt(C,m,b,y,5,g,E,x.b,T.b,1)),g=E,w=S,x=T,p=_}i.push(m)}}}if(t.bones)for(const l in t.bones){const a=t.bones[l],c=s.findBone(l);if(!c)throw new Error(`Bone not found: ${l}`);const h=c.index;for(const d in a){const u=a[d],f=u.length;if(f!=0){if(d==="rotate")i.push(nn(u,new ha(f,f,h),0,1));else if(d==="translate"){const m=new ud(f,f<<1,h);i.push(ql(u,m,"x","y",0,r))}else if(d==="translatex"){const m=new fd(f,f,h);i.push(nn(u,m,0,r))}else if(d==="translatey"){const m=new md(f,f,h);i.push(nn(u,m,0,r))}else if(d==="scale"){const m=new pd(f,f<<1,h);i.push(ql(u,m,"x","y",1,1))}else if(d==="scalex"){const m=new gd(f,f,h);i.push(nn(u,m,1,1))}else if(d==="scaley"){const m=new xd(f,f,h);i.push(nn(u,m,1,1))}else if(d==="shear"){const m=new bd(f,f<<1,h);i.push(ql(u,m,"x","y",0,1))}else if(d==="shearx"){const m=new yd(f,f,h);i.push(nn(u,m,0,1))}else if(d==="sheary"){const m=new wd(f,f,h);i.push(nn(u,m,0,1))}}}}if(t.ik)for(const l in t.ik){const a=t.ik[l];let c=a[0];if(!c)continue;const h=s.findIkConstraint(l);if(!h)throw new Error(`IK Constraint not found: ${l}`);const d=s.ikConstraints.indexOf(h),u=new Cd(a.length,a.length<<1,d);let f=z(c,"time",0),m=z(c,"mix",1),p=z(c,"softness",0)*r;for(let g=0,w=0;;g++){u.setFrame(g,f,m,p,z(c,"bendPositive",!0)?1:-1,z(c,"compress",!1),z(c,"stretch",!1));const x=a[g+1];if(!x){u.shrink(w);break}const y=z(x,"time",0),b=z(x,"mix",1),_=z(x,"softness",0)*r,E=c.curve;E&&(w=Bt(E,u,w,g,0,f,y,m,b,1),w=Bt(E,u,w,g,1,f,y,p,_,r)),f=y,m=b,p=_,c=x}i.push(u)}if(t.transform)for(const l in t.transform){const a=t.transform[l];let c=a[0];if(!c)continue;const h=s.findTransformConstraint(l);if(!h)throw new Error(`Transform constraint not found: ${l}`);const d=s.transformConstraints.indexOf(h),u=new kd(a.length,a.length*6,d);let f=z(c,"time",0),m=z(c,"mixRotate",1),p=z(c,"mixX",1),g=z(c,"mixY",p),w=z(c,"mixScaleX",1),x=z(c,"mixScaleY",w);const y=z(c,"mixShearY",1);for(let b=0,_=0;;b++){u.setFrame(b,f,m,p,g,w,x,y);const E=a[b+1];if(!E){u.shrink(_);break}const S=z(E,"time",0),T=z(E,"mixRotate",1),C=z(E,"mixX",1),A=z(E,"mixY",C),R=z(E,"mixScaleX",1),M=z(E,"mixScaleY",R),I=z(E,"mixShearY",1),N=c.curve;N&&(_=Bt(N,u,_,b,0,f,S,m,T,1),_=Bt(N,u,_,b,1,f,S,p,C,1),_=Bt(N,u,_,b,2,f,S,g,A,1),_=Bt(N,u,_,b,3,f,S,w,R,1),_=Bt(N,u,_,b,4,f,S,x,M,1),_=Bt(N,u,_,b,5,f,S,y,I,1)),f=S,m=T,p=C,g=A,w=R,x=M,w=R,c=E}i.push(u)}if(t.path)for(const l in t.path){const a=t.path[l],c=s.findPathConstraint(l);if(!c)throw new Error(`Path constraint not found: ${l}`);const h=s.pathConstraints.indexOf(c);for(const d in a){const u=a[d];let f=u[0];if(!f)continue;const m=u.length;if(d==="position"){const p=new Id(m,m,h);i.push(nn(u,p,0,c.positionMode==me.Fixed?r:1))}else if(d==="spacing"){const p=new Rd(m,m,h);i.push(nn(u,p,0,c.spacingMode==Re.Length||c.spacingMode==Re.Fixed?r:1))}else if(d==="mix"){const p=new Md(m,m*3,h);let g=z(f,"time",0),w=z(f,"mixRotate",1),x=z(f,"mixX",1),y=z(f,"mixY",x);for(let b=0,_=0;;b++){p.setFrame(b,g,w,x,y);const E=u[b+1];if(!E){p.shrink(_);break}const S=z(E,"time",0),T=z(E,"mixRotate",1),C=z(E,"mixX",1),A=z(E,"mixY",C),R=f.curve;R&&(_=Bt(R,p,_,b,0,g,S,w,T,1),_=Bt(R,p,_,b,1,g,S,x,C,1),_=Bt(R,p,_,b,2,g,S,y,A,1)),g=S,w=T,x=C,y=A,f=E}i.push(p)}}}if(t.deform){t.attachments={};for(const l in t.deform){const a=t.deform[l],c=t.attachments[l]={};for(const h in a){const d=a[h],u=c[h]={};for(const f in d)u[f]={deform:d[f]}}}}if(t.attachments)for(const l in t.attachments){const a=t.attachments[l],c=s.findSkin(l);if(c!=null)for(const h in a){const d=a[h],u=s.findSlot(h);if(!u)throw new Error(`Slot not found: ${h}`);const f=u.index;for(const m in d){const p=d[m],g=c.getAttachment(f,m);for(const w in p){const x=p[w];let y=x[0];if(y){if(w=="deform"){const b=g.bones,_=g.vertices,E=b?_.length/3*2:_.length,S=new Ad(x.length,x.length,f,g);let T=z(y,"time",0);for(let C=0,A=0;;C++){let R;const M=z(y,"vertices",null);if(!M)R=b?$.newFloatArray(E):_;else{R=$.newFloatArray(E);const B=z(y,"offset",0);if($.arrayCopy(M,0,R,B,M.length),r!=1)for(let Y=B,O=Y+M.length;Y<O;Y++)R[Y]*=r;if(!b)for(let Y=0;Y<E;Y++)R[Y]+=_[Y]}S.setFrame(C,T,R);const I=x[C+1];if(!I){S.shrink(A);break}const N=z(I,"time",0),F=y.curve;F&&(A=Bt(F,S,A,C,0,T,N,0,1,1)),T=N,y=I}i.push(S)}else if(w=="sequence"){const b=new Ti(x.length,f,g);let _=0;for(let E=0;E<x.length;E++){const S=z(y,"delay",_),T=z(y,"time",0),C=un[z(y,"mode","hold")],A=z(y,"index",0);b.setFrame(E,T,C,A,S),_=S,y=x[E+1]}i.push(b)}}}}}}if(t.drawOrder){const l=new Or(t.drawOrder.length),a=s.slots.length;let c=0;for(let h=0;h<t.drawOrder.length;h++,c++){const d=t.drawOrder[h];let u=null;const f=z(d,"offsets",null);if(f){u=$.newArray(a,-1);const m=$.newArray(a-f.length,0);let p=0,g=0;for(let w=0;w<f.length;w++){const x=f[w],y=s.findSlot(x.slot);if(!y)throw new Error(`Slot not found: ${y}`);const b=y.index;for(;p!=b;)m[g++]=p++;u[p+x.offset]=p++}for(;p<a;)m[g++]=p++;for(let w=a-1;w>=0;w--)u[w]==-1&&(u[w]=m[--g])}l.setFrame(c,z(d,"time",0),u)}i.push(l)}if(t.events){const l=new xa(t.events.length);let a=0;for(let c=0;c<t.events.length;c++,a++){const h=t.events[c],d=s.findEvent(h.name);if(!d)throw new Error(`Event not found: ${h.name}`);const u=new Fd($.toSinglePrecision(z(h,"time",0)),d);u.intValue=z(h,"int",d.intValue),u.floatValue=z(h,"float",d.floatValue),u.stringValue=z(h,"string",d.stringValue),u.data.audioPath&&(u.volume=z(h,"volume",1),u.balance=z(h,"balance",0)),l.setFrame(a,u)}i.push(l)}let o=0;for(let l=0,a=i.length;l<a;l++)o=Math.max(o,i[l].getDuration());if(isNaN(o))throw new Error("Error while parsing animation, duration is NaN");s.animations.push(new rl(e,i,o))}static blendModeFromString(t){if(t=t.toLowerCase(),t=="normal")return dt.NORMAL;if(t=="additive")return dt.ADD;if(t=="multiply")return dt.MULTIPLY;if(t=="screen")return dt.SCREEN;throw new Error(`Unknown blend mode: ${t}`)}}class BS{constructor(t,e,s,r,i){this.mesh=t,this.skin=e,this.slotIndex=s,this.parent=r,this.inheritTimeline=i}}function nn(n,t,e,s){let r=n[0],i=z(r,"time",0),o=z(r,"value",e)*s,l=0;for(let a=0;;a++){t.setFrame(a,i,o);const c=n[a+1];if(!c)return t.shrink(l),t;const h=z(c,"time",0),d=z(c,"value",e)*s;r.curve&&(l=Bt(r.curve,t,l,a,0,i,h,o,d,s)),i=h,o=d,r=c}}function ql(n,t,e,s,r,i){let o=n[0],l=z(o,"time",0),a=z(o,e,r)*i,c=z(o,s,r)*i,h=0;for(let d=0;;d++){t.setFrame(d,l,a,c);const u=n[d+1];if(!u)return t.shrink(h),t;const f=z(u,"time",0),m=z(u,e,r)*i,p=z(u,s,r)*i,g=o.curve;g&&(h=Bt(g,t,h,d,0,l,f,a,m,i),h=Bt(g,t,h,d,1,l,f,c,p,i)),l=f,a=m,c=p,o=u}}function Bt(n,t,e,s,r,i,o,l,a,c){if(n=="stepped")return t.setStepped(s),e;const h=r<<2,d=n[h],u=n[h+1]*c,f=n[h+2],m=n[h+3]*c;return t.setBezier(e,s,r,i,l,d,u,f,m,o,a),e+1}function z(n,t,e){return n[t]!==void 0?n[t]:e}let LS=class extends _i{createSkeleton(t){this.skeleton=new Od(t),this.skeleton.updateWorldTransform(),this.stateData=new qg(t),this.state=new Ai(this.stateData)}};const OS=Object.freeze(Object.defineProperty({__proto__:null,AlphaTimeline:Ed,Animation:rl,AnimationState:Ai,AnimationStateAdapter:hS,AnimationStateData:qg,AtlasAttachmentLoader:Pd,Attachment:hd,AttachmentTimeline:Br,Bone:lh,BoneData:Nd,BoundingBoxAttachment:tl,ClippingAttachment:el,ConstraintData:ol,CurveTimeline:en,CurveTimeline1:sn,CurveTimeline2:il,DeformTimeline:Ad,DrawOrderTimeline:Or,Event:Fd,EventData:Dd,EventQueue:Hg,EventTimeline:xa,EventType:as,IkConstraint:Kg,IkConstraintData:Bd,IkConstraintTimeline:Cd,MeshAttachment:Xr,PathAttachment:Gr,PathConstraint:Ci,PathConstraintData:Ld,PathConstraintMixTimeline:Md,PathConstraintPositionTimeline:Id,PathConstraintSpacingTimeline:Rd,PointAttachment:sl,RGB2Timeline:Td,RGBA2Timeline:Sd,RGBATimeline:vd,RGBTimeline:_d,RegionAttachment:Ot,RotateTimeline:ha,ScaleTimeline:pd,ScaleXTimeline:gd,ScaleYTimeline:xd,Sequence:nl,SequenceMode:un,SequenceModeValues:dd,SequenceTimeline:Ti,ShearTimeline:bd,ShearXTimeline:yd,ShearYTimeline:wd,Skeleton:Od,SkeletonBinary:Xd,SkeletonBounds:DS,SkeletonData:jd,SkeletonJson:ll,Skin:Io,SkinEntry:ch,Slot:Zg,SlotData:Vd,SpacingMode:Re,Spine:LS,Timeline:be,TrackEntry:al,TransformConstraint:Qg,TransformConstraintData:Ud,TransformConstraintTimeline:kd,TranslateTimeline:ud,TranslateXTimeline:fd,TranslateYTimeline:md,VertexAttachment:tn},Symbol.toStringTag,{value:"Module"}));var ks=(n=>(n[n.UNKNOWN=0]="UNKNOWN",n[n.VER37=37]="VER37",n[n.VER38=38]="VER38",n[n.VER40=40]="VER40",n[n.VER41=41]="VER41",n))(ks||{});function Ro(n){const t=n.substr(0,3),e=Math.floor(Number(t)*10+.001);return t==="3.7"?37:t==="3.8"?38:t==="4.0"?40:t==="4.1"?41:e<37?37:0}class jS{constructor(){this.scale=1}readSkeletonData(t,e){let s=null,r=this.readVersionOldFormat(e),i=Ro(r);if(i===ks.VER38&&(s=new Te(new Hh(t))),r=this.readVersionNewFormat(e),i=Ro(r),(i===ks.VER40||i===ks.VER41)&&(s=new Xd(new Pd(t))),!s){const o=`Unsupported version of spine model ${r}, please update pixi-spine`;console.error(o)}return s.scale=this.scale,s.readSkeletonData(e)}readVersionOldFormat(t){const e=new To(t);let s;try{e.readString(),s=e.readString()}catch{s=""}return s||""}readVersionNewFormat(t){const e=new To(t);e.readInt32(),e.readInt32();let s;try{s=e.readString()}catch{s=""}return s||""}}class VS{constructor(){this.scale=1}readSkeletonData(t,e){const s=e.skeleton.spine,r=Ro(s);let i=null;if(r===ks.VER37&&(i=new Gg(new Mg(t))),r===ks.VER38&&(i=new bg(new Hh(t))),(r===ks.VER40||r===ks.VER41)&&(i=new ll(new Pd(t))),!i){const o=`Unsupported version of spine model ${s}, please update pixi-spine`;console.error(o)}return i.scale=this.scale,i.readSkeletonData(e)}}class US extends qE{createBinaryParser(){return new jS}createJsonParser(){return new VS}parseData(t,e,s){return{spineData:t.readSkeletonData(e,s),spineAtlas:e}}}class XS extends _i{createSkeleton(t){const e=Ro(t.version);let s=null;if(e===ks.VER37&&(s=cS),e===ks.VER38&&(s=nS),(e===ks.VER40||e===ks.VER41)&&(s=OS),!s){const r=`Cant detect version of spine model ${t.version}`;console.error(r)}this.skeleton=new s.Skeleton(t),this.skeleton.updateWorldTransform(),this.stateData=new s.AnimationStateData(t),this.state=new s.AnimationState(this.stateData)}}new US().installLoader();const cl=D.forwardRef(({path:n,width:t,height:e,defaultSkin:s,scale:r={x:1,y:1},animation:i="animation",coors:o={x:2,y:2},loop:l=!0,onComplete:a,refChild:c})=>{const[h,d]=D.useState(),[u,f]=D.useState(s);D.useEffect(()=>{if(!h)return m(h),()=>{h&&h.destroy(!0)}},[h,u]),D.useEffect(()=>{s!==u&&(h&&h.destroy(!0),d(void 0),f(s))},[s,h]);const m=async p=>{p=new Ip({width:t,height:e,backgroundAlpha:0,autoStart:!1,eventMode:"passive",autoDensity:!0,resolution:2,eventFeatures:{move:!1,globalMove:!1,click:!1,wheel:!1},clearBeforeRender:!0,antialias:!0});const g=await Gi.load(n);if(!(g!=null&&g.spineData))return;d(p);const w=new XS(g.spineData);if(w.x=p.screen.width/((o==null?void 0:o.x)||2),w.y=p.screen.height/((o==null?void 0:o.y)||2),u&&w.skeleton.setSkinByName(u),w.scale.set(r.x||1,r.y||1),p.stage.interactive=!0,w.state.hasAnimation(i)&&(w.state.setAnimation(0,i,l),p.stage.on("pointerdown",()=>{w.state.tracks.length?w.state.clearTracks():w.state.setAnimation(0,i,l)})),w.state.addListener({complete:function(){a()}}),p.stage.addChild(w),p.start(),c.current&&c.current.childNodes.length<2)try{const x=c.current;c.current.lastChild&&x.removeChild(c.current.lastChild),x.appendChild(p.view)}catch(x){console.error("error",n,x)}};return v.jsx("div",{ref:c})});function GS({currentCostumeId:n}){const t=D.useRef(),[e,s]=D.useState("");return D.useEffect(()=>{n===Ze.DEFAULT?s(xe.DEFAULT):n===Ze.LEVEL1?s(xe.LEVEL1):n===Ze.LEVEL2?s(xe.LEVEL2):s(xe.LEVEL3)},[n]),v.jsx("div",{ref:t,id:"123",children:e!==""&&v.jsx(cl,{path:tt("/img/sasaAnim/sasadance.json"),width:280,height:150,id:"sasa",defaultSkin:e,animation:"dancing",coors:{x:2.4,y:1.1},scale:{x:.08,y:.08},onComplete:()=>{},loop:!0,refChild:t})})}function YS(n){var i,o;const{theme:t,url:e}=n,s=qt(),{user:r}=ft(l=>l.user);return D.useEffect(()=>{const l=document.body,a=window.innerWidth<=1280,c=()=>{var f,m,p,g;const u=document.querySelectorAll('[data-testid="SideNav_AccountSwitcher_Button"]');if(u&&(u==null?void 0:u.length)>0){h.disconnect();const w=document.querySelector(".gif-on-avatar");w&&w.remove();const x=document.createElement("div");a&&(x.style.display="none"),x.className="gif-on-avatar",x.style.position="absolute",x.style.left="-20px",x.style.bottom="50px",Mr(x).render(v.jsx(GS,{currentCostumeId:(r==null?void 0:r.id)!==void 0&&((f=r==null?void 0:r.currentCharacter)==null?void 0:f.currentCostumeId)!==void 0?(m=r==null?void 0:r.currentCharacter)==null?void 0:m.currentCostumeId:0})),(g=(p=u[0])==null?void 0:p.parentElement)==null||g.appendChild(x)}},h=new MutationObserver(c),d={attributes:!0,childList:!0,subtree:!0};h.observe(l,d)},[(i=r==null?void 0:r.currentCharacter)==null?void 0:i.currentCostumeId,r==null?void 0:r.id,t,r.ref,e,r==null?void 0:r.socialUsername,r]),D.useEffect(()=>{const l=document.body,a=()=>{const d=document.querySelectorAll('[data-testid="HoverCard"]');if(d){const u=d[0];if(u){const f=u.querySelectorAll('[data-testid="UserCell"]');if(f&&f.length>0)for(let m=1;m<f.length;m++)f[m].addEventListener("click",function(){chrome.storage.local.clear(),chrome.storage.session.clear(),localStorage.clear(),s(Ki(!1))})}}},c=new MutationObserver(a),h={attributes:!0,childList:!0,subtree:!0};c.observe(l,h)},[(o=r==null?void 0:r.currentCharacter)==null?void 0:o.currentCostumeId,r==null?void 0:r.id,t,r.ref,e,s]),null}const Jg=()=>{const[n,t]=D.useState(""),[e,s]=D.useState("");return setInterval(function(){document.location.href!=n&&t(document.location.href)},1e3),D.useEffect(()=>{const r=document.body,i=()=>{const c=document.documentElement.style.getPropertyValue("color-scheme");s(c),localStorage.setItem(Et.SAX_THEME,c),chrome.storage.local.set({[Et.SAX_THEME]:c})},o=new MutationObserver(i),l={attributes:!0,childList:!0,subtree:!0};o.observe(r,l)},[n]),{url:n,theme:e}},$S=n=>{const{confirmReferralCode:t,getDataInput:e}=n,{saxTheme:s,styles:r}=ft(c=>c.displaySasa),[i,o]=D.useState("");D.useEffect(()=>{e(i)},[i]);const l=c=>o(c.target.value),a=i==="";return v.jsxs("div",{className:"enter-code-referral",children:[v.jsx("h1",{style:r.textStyle,children:G("import_code")}),v.jsxs("p",{style:{color:s==="dark"?"#fff":"#000",textAlign:"center",marginBottom:"20px"},children:[G("you_need_a_code"),v.jsx(mn,{href:V0,style:{textDecoration:"underline",color:"rgb(29, 155, 240)"},children:G("twitter_profile")})]}),v.jsxs(U0,{isInvalid:a,children:[v.jsx("div",{className:"wra-input",children:v.jsx(Jl,{type:"text",onChange:l,style:r.inputStyle})}),a&&v.jsxs(X0,{children:[" ",G("code_is_required")]})]}),v.jsx(St,{onClick:t,style:{background:s==="dark"?"#faad14":"#1890FF",color:s==="dark"?"#000":"#fff"},children:G("confirm")})]})},WS=n=>{const{onclick:t,className:e}=n,{saxTheme:s}=ft(r=>r.displaySasa);return v.jsx("button",{className:`${e}`,onClick:t&&t,style:{borderColor:s==="dark"?"rgba(255, 255, 255, 0.2)":"rgb(209, 217, 221)",background:s==="dark"?"#1c1f25":"#fff"},children:v.jsx(lt,{src:tt("/icon-128.png"),alt:"home"})})};function zS(n){var _;const{token:t}=ns(),{onClose:e,theme:s,changeSkin:r,currentCostumeId:i}=n,o=qt(),{inventory:l}=ft(E=>E.inventory),[a,c]=D.useState(i),[h,d]=D.useState(i),[u,f]=D.useState(!1),m=async E=>{try{if(E||E===0){f(!0);const S=await mh({itemType:2,itemId:E,quantity:1},t);(S==null?void 0:S.status)===200?(e(),o(qs(t)),o(Ks(t)),f(!1),o(Lt(!0)),o($t("success")),o(Wt("Success!")),r(E===Ze.DEFAULT?xe.DEFAULT:E===Ze.LEVEL1?xe.LEVEL1:E===Ze.LEVEL2?xe.LEVEL2:xe.LEVEL3)):(e(),f(!1),o(Lt(!0)),o($t("error")),o(Wt("Error!")))}}catch{f(!1)}};D.useEffect(()=>{t&&o(qs(t))},[t,o]);const p=E=>{d(E),c(E)},g={color:s==="dark"?"#fff":"#000"},w={color:"#fff",backgroundColor:"#e66e00"},x={backgroundColor:s==="light"?"#fff":"#13161B"},y={borderColor:s==="light"?"#d9d6d6":"rgba(255, 255, 255, 0.10)"},b={border:s==="light"?"1px solid rgba(92, 92, 92, 0.1)":"1px solid rgba(255, 255, 255, 0.1)",background:s==="light"?"#eff1f1":"rgba(19, 22, 27, 0.5)",boxShadow:s==="light"?"0px 4px 10px 0px rgba(172, 172, 172, 0.25),2px 4px 4px 0px #727272 inset":"0px 4px 10px 0px rgba(0, 0, 0, 0.25),2px 4px 4px 0px #000 inset"};return v.jsxs(v.Fragment,{children:[v.jsx("div",{className:"overlay",onClick:e,onKeyDown:()=>{},role:"button",tabIndex:0}),v.jsxs("div",{className:"wear-popup",style:{...x,...y},children:[v.jsxs("div",{className:"popup-header",style:y,children:[v.jsxs("div",{className:"h-title",children:[v.jsx(lt,{src:tt("/icons/santa.png"),alt:"upgrade"}),v.jsx("p",{style:g,children:G("skin")})]}),v.jsx("div",{className:"close-popup",children:v.jsx(lt,{src:tt(s==="dark"?"/icons/menu/close-dark.png":"/icons/menu/close.png"),alt:"close",onClick:e})})]}),v.jsxs("div",{className:"popup-content",style:g,children:[v.jsx("div",{className:"item-img",style:y,children:v.jsx(lt,{src:a===Ze.DEFAULT?tt("/img/skin/0.png"):a===Ze.LEVEL1?tt("/img/skin/1.png"):a===Ze.LEVEL2?tt("/img/skin/2.png"):tt("/img/skin/3.png"),alt:"item"})}),v.jsxs("div",{className:"tools",children:[v.jsx("div",{className:"list-skin",children:(_=l==null?void 0:l.data)==null?void 0:_.filter(E=>E.type===Yt.SKIN).map((E,S)=>{var T,C;return v.jsx(v.Fragment,{children:v.jsxs("div",{onClick:()=>{p(E==null?void 0:E.itemId)},className:`skin-item ${h===E.itemId?"active":""}`,style:b,onKeyDown:()=>{},role:"button",tabIndex:0,children:[v.jsx(lt,{src:(T=E==null?void 0:E.item)!=null&&T.imageUrl?(C=E==null?void 0:E.item)==null?void 0:C.imageUrl:tt("/img/snowflakes.png"),className:"image",alt:"skin"}),v.jsx(lt,{src:tt("/img/check.png"),alt:"check",className:"check"})]},S)})})}),v.jsx(St,{className:"btn",style:w,onClick:()=>{m(a)},isLoading:u,children:G("save_change")})]})]})]})]})}function Gd(n){const{onClose:t,onConfirm:e,isLoading:s,theme:r,title:i}=n,{styles:o}=ft(l=>l.displaySasa);return D.useEffect(()=>{function l(a){a.key==="Enter"&&e()}return document.addEventListener("keydown",l),()=>{document.removeEventListener("keydown",l)}},[e]),v.jsxs(v.Fragment,{children:[v.jsx("div",{className:"overlay overlay-lv2",onClick:t,onKeyDown:()=>{},role:"button",tabIndex:0}),v.jsxs("div",{className:"custom-popup",style:{...o.bgStyle,...o.borderStyle},children:[v.jsxs("div",{className:"popup-header",style:o.borderStyle,children:[v.jsx("div",{className:"h-title",children:v.jsx("p",{style:o.textStyle,children:i})}),v.jsx("div",{className:"close-popup",children:v.jsx(lt,{src:tt(r==="dark"?"/icons/menu/close-dark.png":"/icons/menu/close.png"),alt:"close",onClick:t})})]}),v.jsx("div",{className:"popup-content",style:o.textStyle}),v.jsxs("div",{className:"footer",children:[v.jsx(St,{isLoading:s,style:{background:"#e66e00",color:"#fff"},onClick:()=>{e()},children:G("confirm")}),v.jsx(St,{style:o.btnStyle,onClick:t,children:G("cancel")})]})]})]})}function t0(n){var _,E,S;const t=qt(),[e,s]=D.useState(!1),{onClose:r,theme:i,max:o,image:l,token:a}=n,[c,h]=D.useState(o<1?0:1),[d,u]=D.useState(!1),{user:f}=ft(T=>T.user),m=async()=>{try{u(!0);const T=await mh({itemType:0,itemId:1,quantity:c},a);(T==null?void 0:T.status)===200?(r(),t(qs(a)),t(Ks(a)),u(!1),s(!1),t(Lt(!0)),t($t("success")),t(Wt(`${G("successfully")}`))):(r(),u(!1),t(Lt(!0)),t($t("error")),t(Wt(`${G("error_try_again")}`)),s(!1))}catch{r(),u(!1),t(Lt(!0)),t($t("error")),t(Wt(`${G("error_try_again")}`)),s(!1)}},p={color:i==="dark"?"#fff":"#000"},g={color:"#fff",backgroundColor:"#e66e00"},w={backgroundColor:i==="light"?"#fff":"#13161B"},x={borderColor:i==="light"?"#d9d6d6":"rgba(255, 255, 255, 0.10)"},y={backgroundColor:"#e66e00",color:"#fff"},b={backgroundColor:i==="light"?"#d9d6d6":"#000",color:i==="light"?"#000":"#fff"};return v.jsxs(v.Fragment,{children:[v.jsx("div",{className:"overlay",onClick:r,onKeyDown:()=>{},role:"button",tabIndex:0}),v.jsxs("div",{className:"custom-popup",style:{...w,...x},children:[v.jsxs("div",{className:"popup-header",style:x,children:[v.jsxs("div",{className:"h-title",children:[v.jsx(lt,{src:tt(i==="dark"?"/icons/upgrade-dark.png":"/icons/upgrade.png"),alt:"upgrade"}),v.jsx("p",{style:p,children:G("upgrade")})]}),v.jsx("div",{className:"close-popup",children:v.jsx(lt,{src:tt(i==="dark"?"/icons/menu/close-dark.png":"/icons/menu/close.png"),alt:"close",onClick:r})})]}),v.jsxs("div",{className:"popup-content",style:p,children:[v.jsx("div",{className:"item-img",style:x,children:v.jsx(lt,{src:l,alt:"item"})}),v.jsxs("div",{className:"tools",children:[v.jsx("p",{style:{fontSize:"14px",color:i==="dark"?"#fff":"#000",lineHeight:"22px"},children:G("using_snowflake")}),((_=f==null?void 0:f.currentCharacter)==null?void 0:_.currentLevel)>=Bi&&((E=f==null?void 0:f.currentCharacter)==null?void 0:E.currentExp)>=((S=f==null?void 0:f.currentCharacter)==null?void 0:S.maxExp)?v.jsxs(v.Fragment,{children:[v.jsx("p",{className:"text-center text-sm text-[#FAAD14] ",children:G("reached_max_level")}),v.jsx(St,{className:"btn disabled",style:g,onClick:()=>{},children:G("upgrade")})]}):v.jsxs("div",{className:"flex flex-col gap-2 mt-2",children:[v.jsxs("div",{className:"quantity",children:[v.jsx(lt,{src:tt("/icons/snowflakes.png"),alt:"item"}),v.jsxs(vh,{className:"input-quantity",defaultValue:o<1?0:1,onChange:T=>{h(Number(T)>o?o:Number(T))},min:0,max:o,value:c,children:[v.jsx(lt,{src:tt(i==="dark"?"/icons/menu/minus-dark.png":"/icons/menu/minus.png"),alt:"item",onClick:()=>{c>0&&h(c-1)}}),v.jsx(_h,{style:b}),v.jsx(lt,{src:tt(i==="dark"?"/icons/menu/plus-dark.png":"/icons/menu/plus.png"),alt:"item",onClick:()=>{c<o&&h(c+1)}})]}),v.jsx("div",{className:"max",style:y,onClick:()=>{h(o)},onKeyDown:()=>{},role:"button",tabIndex:0,children:G("max")})]}),v.jsx(St,{className:`btn ${(c<1||c>o)&&"disabled"}`,style:g,onClick:()=>{o>0&&c<=o&&c>0&&s(!0)},children:G("upgrade")})]})]})]})]}),e&&v.jsx(Gd,{onClose:()=>{s(!1)},theme:i,title:G("do_your_want_upgrade"),onConfirm:m,isLoading:d})]})}function e0(n){const t=qt(),{onClose:e}=n,{saxTheme:s,styles:r}=ft(a=>a.displaySasa),i={borderColor:s==="light"?"#d9d6d6":"rgba(255, 255, 255, 0.10)"},o=()=>{e(),t(tc(2)),t(G0(2))},l=()=>{e(),o()};return v.jsxs(v.Fragment,{children:[v.jsx("div",{className:"overlay",onClick:e,onKeyDown:()=>{},role:"button",tabIndex:0}),v.jsxs("div",{className:"custom-popup",style:{...r.bgStyle,...r.borderStyle},children:[v.jsxs("div",{className:"popup-header",style:i,children:[v.jsx("div",{className:"h-title",children:v.jsx("p",{style:r.textStyle,children:G("notice")})}),v.jsx("div",{className:"close-popup",children:v.jsx(lt,{src:tt(s==="dark"?"/icons/menu/close-dark.png":"/icons/menu/close.png"),alt:"close",onClick:e})})]}),v.jsx("div",{className:"popup-content",style:r.textStyle,children:v.jsxs("div",{className:"tools",children:[v.jsx("p",{style:{color:s==="dark"?"#fff":"#000",textAlign:"center",marginBottom:"20px"},children:G("you_need_to_complete_binding_quests_to_continue")}),v.jsx(St,{className:"btn ",style:r.btnStyle,onClick:l,children:G("go_to_binding_quests")})]})})]})]})}function HS(n){const{onClose:t,theme:e}=n,{user:s}=ft(o=>o.user),{styles:r}=ft(o=>o.displaySasa),i={backgroundColor:e==="light"?"#fff":"#13161B"};return v.jsxs(v.Fragment,{children:[v.jsx("div",{className:"overlay",onClick:t,onKeyDown:()=>{},role:"button",tabIndex:0}),v.jsx("div",{className:"custom-popup",style:{...i,...r.borderStyle},children:v.jsx("div",{className:"popup-content",style:r.textStyle,children:v.jsxs("div",{className:"tools",children:[v.jsx(lt,{src:tt("/img/fireworks.png"),alt:"close",onClick:t}),v.jsx("p",{style:{color:e==="dark"?"#fff":"#000",textAlign:"center",margin:"20px 0",fontWeight:700,fontSize:"20px"},children:G("golden_bag_open_title")}),v.jsxs("p",{style:{color:e==="dark"?"#fff":"#000",textAlign:"center",marginBottom:"20px"},children:[v.jsx("span",{className:`${e==="dark"?"text-[#FAAD14]":"text-[#1890ff]"}`,children:Y0(s==null?void 0:s.walletAddress)+" "}),G("has_won_a_free_mint_whitelist_slot")]}),v.jsxs("div",{className:"tooltip",children:[v.jsxs("div",{className:"title",children:[" ",G("coming_soon")]}),v.jsx(St,{className:"mint-vip-pass mint-vip-pass-disable text-[#00000080]",children:G("mint_now")})]})]})})})]})}function Yd({message:n,className:t}){const{styles:e,saxTheme:s}=ft(r=>r.displaySasa);return v.jsxs("div",{className:"custom-tooltip",children:[v.jsx("div",{className:"tooltip-hover",children:v.jsx(lt,{className:"img-note",src:tt(s==="dark"?"/icons/menu/note-orange.png":"/icons/menu/note.png"),alt:"home"})}),v.jsx("div",{style:e.cardStyle,className:`tooltip-content ${t||""}`,children:n})]})}const Bf=[{currentLevel:1,gold:113,goldBag:0,skin1:125,skin2:136,skin3:151},{currentLevel:2,gold:142,goldBag:0,skin1:156,skin2:170,skin3:189},{currentLevel:3,gold:177,goldBag:0,skin1:195,skin2:212,skin3:236},{currentLevel:4,gold:221,goldBag:1,skin1:243,skin2:265,skin3:295},{currentLevel:5,gold:277,goldBag:1,skin1:304,skin2:332,skin3:369},{currentLevel:6,gold:346,goldBag:1,skin1:380,skin2:415,skin3:461},{currentLevel:7,gold:432,goldBag:2,skin1:475,skin2:519,skin3:576},{currentLevel:8,gold:540,goldBag:2,skin1:594,skin2:648,skin3:720},{currentLevel:9,gold:675,goldBag:2,skin1:743,skin2:810,skin3:900},{currentLevel:10,gold:726,goldBag:2,skin1:799,skin2:871,skin3:968},{currentLevel:11,gold:781,goldBag:3,skin1:859,skin2:937,skin3:1041},{currentLevel:12,gold:839,goldBag:3,skin1:923,skin2:1007,skin3:1119},{currentLevel:13,gold:903,goldBag:4,skin1:993,skin2:1083,skin3:1203},{currentLevel:14,gold:970,goldBag:4,skin1:1068,skin2:1165,skin3:1294},{currentLevel:15,gold:1044,goldBag:5,skin1:1148,skin2:1252,skin3:1391},{currentLevel:16,gold:1122,goldBag:5,skin1:1234,skin2:1346,skin3:1496},{currentLevel:17,gold:1207,goldBag:6,skin1:1327,skin2:1448,skin3:1609},{currentLevel:18,gold:1297,goldBag:6,skin1:1427,skin2:1557,skin3:1730},{currentLevel:19,gold:1395,goldBag:7,skin1:1535,skin2:1674,skin3:1860},{currentLevel:20,gold:1500,goldBag:8,skin1:1650,skin2:1800,skin3:2e3}];function Lf({lvData:n,saxTheme:t,hasNameGift:e}){return v.jsxs("div",{children:[v.jsxs("div",{className:"gold",children:[e&&G("gold")," +"," ",v.jsx("span",{style:{color:t==="dark"?"#e66e00":"#1890FF"},children:n==null?void 0:n.gold})," ",v.jsx(lt,{className:"img-gold",width:6,height:6,src:tt("/icons/coin.png"),alt:"coin"})," ",G("daily_2")," ",v.jsx("br",{})]}),v.jsxs("div",{className:"gold",children:[e&&G("golden_bag")," +"," ",v.jsx("span",{style:{color:t==="dark"?"#e66e00":"#1890FF"},children:n==null?void 0:n.goldBag})," ",v.jsx(lt,{className:"img-gold",width:6,height:6,src:tt("/img/gold-bag.png"),alt:"coin"})," ",G("daily_2")," ",v.jsx("br",{})]}),v.jsxs("div",{className:"gold",children:[e&&G("spring_skin")," +"," ",v.jsx("span",{style:{color:t==="dark"?"#e66e00":"#1890FF"},children:n==null?void 0:n.skin1})," ",v.jsx(lt,{className:"img-gold",width:6,height:6,src:tt("/icons/coin.png"),alt:"coin"})," ",G("daily_2")," ",v.jsx("br",{})]}),v.jsxs("div",{className:"gold",children:[e&&G("summer_skin")," +"," ",v.jsx("span",{style:{color:t==="dark"?"#e66e00":"#1890FF"},children:n==null?void 0:n.skin2})," ",v.jsx(lt,{className:"img-gold",width:6,height:6,src:tt("/icons/coin.png"),alt:"coin"})," ",G("daily_2")," ",v.jsx("br",{})]}),v.jsxs("div",{className:"gold",children:[e&&G("autumn_skin")," +"," ",v.jsx("span",{style:{color:t==="dark"?"#e66e00":"#1890FF"},children:n==null?void 0:n.skin3})," ",v.jsx(lt,{className:"img-gold",width:6,height:6,src:tt("/icons/coin.png"),alt:"coin"})," ",G("daily_2")," ",v.jsx("br",{})]})]})}const s0=()=>{const{saxTheme:n}=ft(e=>e.displaySasa),t=()=>{window.open("https://saworld.io/","_blank")};return v.jsxs("div",{className:"footer",children:[v.jsx(lt,{src:tt("/img/banner-explore-SA.png")}),v.jsx(St,{className:"btn-explore",style:{background:n==="dark"?"#1890FF":"#faad14",color:n==="dark"?"#000":"#fff"},onClick:t,children:G("explore_sa")})]})};function qS({isFetchInventory:n}){var Y,O,V,j,X,L,U,q,H,J,Q,W,K,Z,nt,gt;const{token:t}=ns(),{saxTheme:e,styles:s,emailOTP:r}=ft(rt=>rt.displaySasa),{user:i}=ft(rt=>rt.user),{inventory:o}=ft(rt=>rt.inventory),{isNoti:l,notiMessage:a,notiStatus:c}=ft(rt=>rt.isNoti),[h,d]=D.useState(void 0),u=qt(),[f,m]=D.useState(!1),[p,g]=D.useState(!1),[w,x]=D.useState(!1),[y,b]=D.useState(!1),[_,E]=D.useState(""),[S,T]=D.useState(!1),C=D.useRef(),[A,R]=D.useState({gold:0,goldBag:0,skin1:0,skin2:0,skin3:0}),[M,I]=D.useState({gold:0,goldBag:0,skin1:0,skin2:0,skin3:0});D.useEffect(()=>{T(window.innerWidth<=1280)},[]),D.useEffect(()=>{const rt=Bf.find(Ct=>{var jt;return(Ct==null?void 0:Ct.currentLevel)===((jt=i==null?void 0:i.currentCharacter)==null?void 0:jt.currentLevel)}),bt=Bf.find(Ct=>{var jt;return(Ct==null?void 0:Ct.currentLevel)===((jt=i==null?void 0:i.currentCharacter)==null?void 0:jt.currentLevel)+1});rt&&R({gold:rt.gold,goldBag:rt.goldBag,skin1:rt.skin1,skin2:rt.skin2,skin3:rt.skin3}),bt&&I({gold:bt.gold,goldBag:bt.goldBag,skin1:bt.skin1,skin2:bt.skin2,skin3:bt.skin3})},[(Y=i==null?void 0:i.currentCharacter)==null?void 0:Y.currentLevel]),D.useEffect(()=>{t&&n&&(u(qs(t)),u(Do({accessToken:t,type:Yt.FRAGMENT})))},[t,n,u]),D.useEffect(()=>{var rt,bt,Ct;i&&(i==null?void 0:i.id)!==void 0&&(i!=null&&i.currentCharacter)&&(((rt=i==null?void 0:i.currentCharacter)==null?void 0:rt.currentCostumeId)===Ze.DEFAULT?E(xe.DEFAULT):((bt=i==null?void 0:i.currentCharacter)==null?void 0:bt.currentCostumeId)===Ze.LEVEL1?E(xe.LEVEL1):((Ct=i==null?void 0:i.currentCharacter)==null?void 0:Ct.currentCostumeId)===Ze.LEVEL2?E(xe.LEVEL2):E(xe.LEVEL3))},[i]);const N=()=>{var rt,bt,Ct;((rt=i==null?void 0:i.currentCharacter)==null?void 0:rt.currentLevel)<=Bi&&((bt=i==null?void 0:i.currentCharacter)==null?void 0:bt.currentExp)<=((Ct=i==null?void 0:i.currentCharacter)==null?void 0:Ct.maxExp)&&m(!0)},F=rt=>{navigator.clipboard!==void 0&&(navigator.clipboard.writeText(`${rt}`),d(rt),setTimeout(()=>{d(void 0)},1e3))},B=()=>{chrome.storage.local.clear(),chrome.storage.session.clear(),localStorage.removeItem(Et.QUEST_PROGRESS),u(Ki(!1)),u(W0(!1)),u(za(!1))};return v.jsxs("div",{className:"home",children:[v.jsxs("div",{className:"home-top",children:[v.jsxs("div",{className:"my-pet",children:[v.jsx("div",{className:"pet-image",style:s.borderStyle,children:v.jsx("div",{ref:C,children:_!==""&&v.jsx(cl,{path:tt("/img/sasaAnim/sasadance.json"),width:200,height:180,id:"sasa",defaultSkin:_,animation:"idle",coors:{x:3.3,y:1.2},scale:{x:.12,y:.12},onComplete:()=>{},loop:!0,refChild:C})})}),(i==null?void 0:i.id)!==void 0&&v.jsxs("div",{className:"pet-info",children:[i!=null&&i.saCode?v.jsxs("p",{style:s.textStyle,className:"linked-citizen",children:[G("citizen_link"),": ",i==null?void 0:i.saCode," ",v.jsxs("div",{className:"copy-wrapper",children:[v.jsx(lt,{src:e==="light"?tt("/icons/copy-black.png"):tt("/icons/copy.png"),alt:"copy",className:"icon-copy",onClick:()=>F(i==null?void 0:i.saCode)}),v.jsx("div",{className:`copy-tooltip ${h===(i==null?void 0:i.saCode)&&"tooltip-show"}`,children:"copied"})]})]}):v.jsxs(xi,{className:"text-binding",children:[v.jsx(dn,{onClick:()=>x(!0),children:"Bind to SA Account to explore more >> "}),v.jsxs("div",{className:"current-level",children:["Lv ",(O=i==null?void 0:i.currentCharacter)==null?void 0:O.currentLevel]})]}),v.jsxs("div",{className:"level",children:[v.jsx(xm,{className:`progress [&>div]:${e==="dark"?"bg-[#e66e00]":"bg-[#1890ff]"}`,value:((V=i==null?void 0:i.currentCharacter)==null?void 0:V.currentExp)/((j=i==null?void 0:i.currentCharacter)==null?void 0:j.maxExp)*100||0,style:{background:e==="dark"?"rgb(57, 56, 56)":"rgb(157 157 157)"}}),v.jsxs("div",{className:"level-header",children:[v.jsx("div",{className:"remaining-to-up",style:s.textStyle,children:i&&(i!=null&&i.currentCharacter)&&((X=i==null?void 0:i.currentCharacter)==null?void 0:X.currentLevel)>=Bi&&((L=i==null?void 0:i.currentCharacter)==null?void 0:L.currentExp)>=((U=i==null?void 0:i.currentCharacter)==null?void 0:U.maxExp)?"Max level":v.jsxs(v.Fragment,{children:[(i&&(i!=null&&i.currentCharacter)&&((q=i==null?void 0:i.currentCharacter)!=null&&q.maxExp)?((H=i==null?void 0:i.currentCharacter)==null?void 0:H.maxExp)-((J=i==null?void 0:i.currentCharacter)!=null&&J.currentExp?(Q=i==null?void 0:i.currentCharacter)==null?void 0:Q.currentExp:0):0).toLocaleString("en-US")+" ",v.jsx(lt,{className:"snowflakes",src:tt("/icons/snowflakes.png"),alt:"snowflakes"}),G("snowflakes_to_level_up")]})}),v.jsxs("div",{className:`current-lv theme-${e}`,children:[v.jsxs("div",{className:"gold",children:[v.jsx("span",{className:"first",children:G("gold")}),"+",v.jsxs("span",{className:"reward",children:[A==null?void 0:A.gold,v.jsx(lt,{className:"img-gold",width:6,height:6,src:tt("/icons/coin.png"),alt:"coin"})]}),G("daily_2"),v.jsx("div",{className:"why-lv-up",style:{color:"#e66e00"},children:v.jsx(Yd,{lv:!0,className:"tooltip-level-des",message:v.jsxs("div",{className:"lv-tooltip",children:[v.jsxs("div",{children:[v.jsx("p",{style:{color:"#7F7F7F",textAlign:"center",fontWeight:700},children:"Current LV"}),v.jsx(Lf,{lvData:A,saxTheme:e,hasNameGift:!0})]}),((W=i==null?void 0:i.currentCharacter)==null?void 0:W.currentLevel)<Bi&&v.jsxs(v.Fragment,{children:[v.jsx(Lb,{style:{margin:"auto",display:"block",transform:"rotate(90deg)"},w:6,h:6,color:e==="dark"?"#ffffff80":"#000"}),v.jsxs("div",{children:[v.jsxs("p",{style:{color:"#7F7F7F",textAlign:"center",fontWeight:700},children:[G("next")," LV (Lv ",((K=i==null?void 0:i.currentCharacter)==null?void 0:K.currentLevel)+1,")"," "]}),v.jsx(Lf,{lvData:M,saxTheme:e,hasNameGift:!S})]})]})]})})})]}),v.jsxs("div",{className:"gold",children:[v.jsx("span",{className:"first",children:G("golden_bag")}),"+",v.jsxs("span",{className:"reward",children:[A==null?void 0:A.goldBag,v.jsx(lt,{className:"img-gold",width:6,height:6,src:tt("/img/gold-bag.png"),alt:"coin"})," "]}),G("daily_2")]}),v.jsxs("div",{className:"gold",children:[v.jsx("span",{className:"first",children:"Bonus"}),"+",v.jsxs("span",{className:"reward",children:[A[_===xe.LEVEL1?"skin1":_===xe.LEVEL2?"skin2":_===xe.LEVEL3?"skin3":"skin1"],v.jsx(lt,{className:"img-gold",width:6,height:6,src:tt("/img/gold-bag.png"),alt:"coin"})," "]}),G("daily_2"),v.jsxs("span",{style:{fontSize:12,color:"#52C41A",fontWeight:700},children:[_===xe.LEVEL1?G("spring_skin").replace(":",""):_===xe.LEVEL2?G("summer_skin").replace(":",""):_===xe.LEVEL3?G("autumn_skin").replace(":",""):"Default Skin"," "]})]})]})]}),v.jsxs("div",{className:`action theme-${e}`,children:[v.jsxs(St,{style:s.textStyle,className:"btn-skin",onClick:()=>{g(!0)},children:[v.jsx(lt,{src:tt("/icons/santa.png"),alt:"santa"}),G("skin")]}),v.jsxs(St,{onClick:N,className:`${i!=null&&i.currentCharacter&&i.currentCharacter.currentLevel<=Bi&&i.currentCharacter.currentExp<=i.currentCharacter.maxExp?"":"btn-disable"} btn-upgrade`,children:[v.jsx(lt,{src:tt(e==="dark"?"/icons/upgrade-dark.png":"/icons/upgrade-light.png"),alt:"upgrade"}),G("upgrade")]})]})]})]})]}),v.jsxs("div",{children:[(i==null?void 0:i.email)!==""||r!==""?v.jsxs("div",{className:"verified-box",style:{background:e==="dark"?"#272727":"#EFF3F4",color:e==="dark"?"#fff":"#000"},children:[v.jsx("span",{className:"email",children:$0((i==null?void 0:i.email)||r)}),v.jsxs("div",{className:"text-des",children:[v.jsx("span",{children:"Verified"}),v.jsx(lt,{src:tt("/img/check.png")})]})]}):v.jsx(St,{className:"btn-verify",onClick:()=>u(ea(!0)),children:"Verify email"}),v.jsxs(St,{className:"btn-logOut",onClick:B,children:[v.jsx(lt,{src:tt("/img/ic-logout.png")}),"Log out"]})]})]}),v.jsx(s0,{}),f&&v.jsx(t0,{onClose:()=>{m(!1)},theme:e,max:o!=null&&o.data&&((Z=o==null?void 0:o.data)==null?void 0:Z.filter(rt=>rt.type===0).length)>0?(nt=o==null?void 0:o.data)==null?void 0:nt.filter(rt=>rt.type===0)[0].quantity:0,image:tt("/img/sasa.png"),token:t}),p&&v.jsx(zS,{onClose:()=>{g(!1)},theme:e,image:tt("/img/snowflakes.png"),changeSkin:rt=>E(rt),currentCostumeId:(gt=i==null?void 0:i.currentCharacter)==null?void 0:gt.currentCostumeId}),l&&v.jsx(jn,{onClose:()=>{u(Lt(!1))},message:a,status:c}),w&&v.jsx(e0,{onClose:()=>x(!1)}),y&&v.jsx(HS,{theme:e,onClose:()=>b(!1)})]})}var Fn=(n=>(n[n.NEW_BIE=0]="NEW_BIE",n[n.DAILY=1]="DAILY",n[n.HUNTING=100]="HUNTING",n))(Fn||{}),Ys=(n=>(n[n.FOLLOW=0]="FOLLOW",n[n.LIKE=1]="LIKE",n[n.RE_POST=2]="RE_POST",n[n.REPLY=3]="REPLY",n))(Ys||{});const Rr={HASHTAG:"#Airdrop",TOKEN:"$SAE",SAWORLD:"@SAWorld_io",REPLY:"#Airdrop 6M $SAE is live on @SAWorld_io"};function KS(n){var T,C,A,R,M,I,N,F,B,Y,O,V,j,X;const{token:t}=ns(),e=qt(),{isChangeQuest:s}=ft(L=>L.listQuests),{saxTheme:r}=ft(L=>L.displaySasa),{item:i,completeQuestDaily:o}=n,[l,a]=D.useState(!1),[c,h]=D.useState(!1),[d,u]=D.useState(!1),[f,m]=D.useState(""),[p,g]=D.useState("");D.useEffect(()=>{const L=JSON.parse(localStorage.getItem(Et.QUEST_PROGRESS));if(L){const U=L==null?void 0:L.find(q=>q.questConfigId===(i==null?void 0:i.questConfigId));u(!!(U&&(U!=null&&U.completed)))}},[i==null?void 0:i.questConfigId,i==null?void 0:i.questMode,s]);const w=async L=>{var U,q,H,J;if((U=L==null?void 0:L.quest)!=null&&U.targetUrl){if((L==null?void 0:L.socialMode)===Ys.FOLLOW||(L==null?void 0:L.socialMode)===Ys.REPLY||(L==null?void 0:L.socialMode)===Ys.LIKE||(L==null?void 0:L.socialMode)===Ys.RE_POST){const Q=JSON.parse(localStorage.getItem(Et.QUEST_PROGRESS));if(Q===null||Q!==null&&((q=Q==null?void 0:Q.filter(W=>(W==null?void 0:W.questConfigId)===(L==null?void 0:L.questConfigId)))==null?void 0:q.length)===0){const W={questConfigId:L==null?void 0:L.questConfigId,targetUrl:(H=L==null?void 0:L.quest)==null?void 0:H.targetUrl,questMode:L==null?void 0:L.questMode,socialMode:L==null?void 0:L.socialMode,completed:!1,endAt:new Date().setUTCHours(23,59,59,999)},K=Q!==null?[...Q,W]:[W];localStorage.setItem(Et.QUEST_PROGRESS,JSON.stringify(K))}}window.open((J=L==null?void 0:L.quest)==null?void 0:J.targetUrl)}},x=async(L,U)=>{var q;try{if(h(!0),L){const H=await z0(L,t);if((H==null?void 0:H.status)===200){h(!1),a(!0),m("Claim Successfully!"),g("success");const J=(q=JSON.parse(localStorage.getItem(Et.QUEST_PROGRESS)))==null?void 0:q.filter(Q=>(Q==null?void 0:Q.questConfigId)!==U);localStorage.setItem(Et.QUEST_PROGRESS,JSON.stringify(J)),setTimeout(()=>{e(Ks(t)),e(Qf(t)),e(qs(t))},1e3),U===7&&localStorage.removeItem(Et.QUEST_PROGRESS)}else h(!1),a(!0),m(G("claim_quest_error")),g("error")}}catch{h(!1),a(!0),m(G("claim_quest_error")),g("error")}},y={borderColor:r==="dark"?"rgba(255, 255, 255, 0.2)":"rgb(209, 217, 221)",backgroundColor:r==="dark"?"#0d0e12":"#F7F9F9",cursor:"pointer"},b={color:r==="dark"?"#fff":"#000",fontSize:"14px",fontWeight:"500"},_={backgroundColor:"#1d9bf0"},E={backgroundColor:"#e66e00"},S={color:"#fff"};return v.jsxs(v.Fragment,{children:[i&&v.jsxs("div",{className:"card-container",children:[v.jsx("div",{className:"quest-card",style:y,onClick:()=>{w(i)},onKeyDown:()=>{},role:"button",tabIndex:0,children:v.jsxs("div",{className:"card-header",children:[v.jsxs("div",{className:"reward",children:[v.jsx(lt,{src:(C=(T=i==null?void 0:i.reward)==null?void 0:T.item)!=null&&C.imageUrl?(R=(A=i==null?void 0:i.reward)==null?void 0:A.item)==null?void 0:R.imageUrl:tt(((I=(M=i==null?void 0:i.reward)==null?void 0:M.item)==null?void 0:I.name)==="Gold"?"/icons/coin.png":((F=(N=i==null?void 0:i.reward)==null?void 0:N.item)==null?void 0:F.name)==="Gold Bag"?"/icons/coin-bag.png":"/icons/coin.png"),alt:"copy"}),v.jsxs("p",{style:b,children:["x",(B=i==null?void 0:i.reward)==null?void 0:B.quantity]})]}),(Y=i==null?void 0:i.quest)!=null&&Y.targetUrl?v.jsx("div",{style:{fontSize:"14px",fontWeight:"500",color:"rgb(29, 155, 240)",textAlign:"center"},className:"underline quest-name",children:v.jsxs("span",{className:" item-quest-name",children:[" ",(O=i==null?void 0:i.quest)!=null&&O.name?(V=i==null?void 0:i.quest)==null?void 0:V.name:"Quest name"]})}):v.jsx("p",{className:"quest-name",style:{fontSize:"14px",fontWeight:"500",color:r==="dark"?"#fff":"#000",textAlign:"center"},children:v.jsxs("span",{className:" item-quest-name",children:[" ",(j=i==null?void 0:i.quest)!=null&&j.name?(X=i==null?void 0:i.quest)==null?void 0:X.name:"Quest name"]})})]})}),(i==null?void 0:i.questConfigId)!==99&&((i==null?void 0:i.maxClaimTimes)===(i==null?void 0:i.currentClaimTimes)||p==="success"?v.jsx(St,{className:"claim-btn completed",style:{color:r==="dark"?"#fff":"#00000080",backgroundColor:r==="dark"?"transparent":"#fff"},onClick:()=>{},children:v.jsx("span",{style:{color:r==="dark"?"#fff":"#00000080"},children:G("completed")})}):(i==null?void 0:i.questConfigId)===7?v.jsx(St,{style:E,className:`claim-btn  ${o?"can-claim":"opacity-50 cursor-not-allowed"}
              `,isLoading:c,onClick:()=>{o&&x(i==null?void 0:i.id,i==null?void 0:i.questConfigId)},children:v.jsx("span",{style:S,children:G("claim")})}):d?v.jsx(St,{style:E,className:"claim-btn can-claim",isLoading:c,onClick:()=>{x(i==null?void 0:i.id,i==null?void 0:i.questConfigId)},children:v.jsx("span",{style:S,children:G("claim")})}):v.jsx(St,{style:_,className:"claim-btn can-claim",isLoading:c,onClick:()=>{w(i)},children:v.jsx("span",{style:S,children:"Go"})}))]}),l&&v.jsx(jn,{onClose:()=>{a(!1)},message:f,status:p})]})}function Of(n){var s;const{data:t}=n,e=r=>r==null?void 0:r.sort(function(o,l){const a=o.questConfigId===7,c=l.questConfigId===7,h=o.questConfigId===99,d=l.questConfigId===99;return h&&!d?1:!h&&d?-1:a&&!c?1:!a&&c?-1:0});return v.jsx("div",{className:"list-quest",children:t&&((s=e(t))==null?void 0:s.map(r=>{var i,o;return v.jsx(KS,{item:r,completeQuestDaily:t&&((i=t==null?void 0:t.filter(l=>l.questMode===Fn.DAILY&&(l==null?void 0:l.questConfigId)!==7&&l.currentClaimTimes===l.maxClaimTimes))==null?void 0:i.length)===((o=t==null?void 0:t.filter(l=>l.questMode===Fn.DAILY&&(l==null?void 0:l.questConfigId)!==7))==null?void 0:o.length)},r==null?void 0:r.id)}))})}const ZS=n=>{const t={method:"GET",url:"/api/v1/request",headers:{Authorization:`Bearer ${n}`}};return Vn(t)},QS=(n,t)=>{const e={method:"POST",url:"/api/v1/request/binding",data:n,headers:{Authorization:`Bearer ${t}`}};return Vn(e)},JS=n=>{const t={method:"POST",url:"/api/v1/request/cancel",headers:{Authorization:`Bearer ${n}`}};return Vn(t)},tT=n=>{const t={method:"GET",url:"/api/v1/request/progress",headers:{Authorization:`Bearer ${n}`}};return Vn(t)},eT=n=>{const t={method:"GET",url:"/api/v1/request/check-wallet",headers:{Authorization:`Bearer ${n}`}};return Vn(t)},sT=n=>{const t={method:"GET",url:"/api/v1/user-quest/claim-last-fragment",headers:{Authorization:`Bearer ${n}`}};return Vn(t)};function nT(n){const{onClose:t,theme:e}=n,{styles:s}=ft(i=>i.displaySasa),r=()=>{t(),window.open(Ha)};return v.jsxs(v.Fragment,{children:[v.jsx("div",{className:"overlay",onClick:t,onKeyDown:()=>{},role:"button",tabIndex:0}),v.jsxs("div",{className:"custom-popup",style:{...s.bgStyle,...s.borderStyle},children:[v.jsxs("div",{className:"popup-header",style:s.borderStyle,children:[v.jsx("div",{className:"h-title",children:v.jsx("p",{style:s.textStyle,children:G("notification")})}),v.jsx("div",{className:"close-popup",children:v.jsx(lt,{src:tt(e==="dark"?"/icons/menu/close-dark.png":"/icons/menu/close.png"),alt:"close",onClick:t})})]}),v.jsx("div",{className:"popup-content",style:s.textStyle,children:v.jsxs("div",{className:"tools",children:[v.jsx("p",{style:{color:e==="dark"?"#ffffff80":"#00000080",textAlign:"center",marginBottom:"30px"},children:G("send_request_to_SA_world")}),v.jsx(St,{className:"mint-vip-pass mint-vip-pass-active",onClick:r,children:"Go to SAWorld"}),v.jsx(mn,{className:"how-to-get-code",href:ec,target:"_blank",style:{color:"#faad14",textAlign:"center",marginTop:"10px",fontSize:"12px"},children:G("how_to_bind_SA_account")})]})})]})]})}function rT(n){const{token:t,isBindingWallet:e}=n,[s,r]=D.useState(""),[i,o]=D.useState(""),[l,a]=D.useState(""),{isOpen:c,onOpen:h,onClose:d}=ur(),[u,f]=D.useState(!1),[m,p]=D.useState(""),g=qt(),[w,x]=D.useState(!1),[y,b]=D.useState(!1),[_,E]=D.useState(!1),[S,T]=D.useState(!1),[C,A]=D.useState(!1),[R,M]=D.useState(!1),[I,N]=D.useState(!1),[F,B]=D.useState(!1),[Y,O]=D.useState(!1),[V,j]=D.useState(0);D.useEffect(()=>{a(localStorage.getItem("sax_theme"))},[i]),D.useEffect(()=>{t&&(L(),q())},[t,e]),setInterval(function(){document.location.href!=s&&r(document.location.href)},1e3),D.useEffect(()=>{const kt=document.body,ee=()=>{const Jt=document.documentElement.style.getPropertyValue("color-scheme");o(Jt)},se=new MutationObserver(ee),ie={attributes:!0,childList:!0,subtree:!0};se.observe(kt,ie)},[s]);const X=async()=>{try{if(m){T(!0);const kt=await QS({citizenCode:m.toString()},t);(kt==null?void 0:kt.status)===200?(b(!0),T(!1),g(Lt(!0)),g($t("success")),g(Wt("Success!")),O(!0),d(),p("")):(T(!1),b(!1),g(Lt(!0)),g($t("error")),g(Wt(`${G("this_citizen_code")}`)),d(),p(""))}}catch{T(!1),b(!1),g(Lt(!0)),g($t("error")),g(Wt(`${G("this_citizen_code")}`)),d(),p("")}},L=async()=>{var kt,ee,se,ie;try{const Qt=await ZS(t);(Qt==null?void 0:Qt.status)===200&&(((ee=(kt=Qt==null?void 0:Qt.data)==null?void 0:kt.data)==null?void 0:ee.status)===0?(b(!0),x(!1)):((ie=(se=Qt==null?void 0:Qt.data)==null?void 0:se.data)==null?void 0:ie.status)===1&&(b(!1),x(!0)))}catch{}},U=async()=>{try{A(!0);const kt=await JS(t);(kt==null?void 0:kt.status)===200?(x(!1),b(!1),g(Lt(!0)),g($t("success")),g(Wt("Success!")),A(!1),M(!1)):(g(Lt(!0)),g($t("error")),g(Wt(`${G("error_try_again")}`)),A(!1))}catch{g(Lt(!0)),g($t("error")),g(Wt(`${G("error_try_again")}`)),A(!1)}},q=async()=>{var kt,ee,se,ie,Qt,Jt,Ye,Xn,Is,ba,ya,ct,Vt,ae;try{const Mt=await tT(t);(Mt==null?void 0:Mt.status)===200&&(((ee=(kt=Mt==null?void 0:Mt.data)==null?void 0:kt.data)==null?void 0:ee.bindingWallet)===!0?E(!0):E(!1),((ie=(se=Mt==null?void 0:Mt.data)==null?void 0:se.data)==null?void 0:ie.bindingAccount)===!0&&x(!0),((Jt=(Qt=Mt==null?void 0:Mt.data)==null?void 0:Qt.data)==null?void 0:Jt.canClaim)===!0?(N(!0),j(2)):N(!1),((Xn=(Ye=Mt==null?void 0:Mt.data)==null?void 0:Ye.data)==null?void 0:Xn.claim)===!0?B(!0):B(!1),(((ba=(Is=Mt==null?void 0:Mt.data)==null?void 0:Is.data)==null?void 0:ba.bindingWallet)===!0||((ct=(ya=Mt==null?void 0:Mt.data)==null?void 0:ya.data)==null?void 0:ct.bindingAccount)===!0)&&((ae=(Vt=Mt==null?void 0:Mt.data)==null?void 0:Vt.data)==null?void 0:ae.canClaim)===!1&&j(1))}catch{}},H=async()=>{try{if(t){const kt=await sT(t);(kt==null?void 0:kt.status)===200?(B(!0),g(Lt(!0)),g($t("success")),g(Wt("Success!")),g(qs(t)),g(Do({accessToken:t,type:Yt.FRAGMENT}))):(g(Lt(!0)),g($t("error")),g(Wt(`${G("error_try_again")}`)))}}catch{g(Lt(!0)),g($t("error")),g(Wt(`${G("error_try_again")}`))}},J={borderColor:l==="dark"?"rgba(255, 255, 255, 0.2)":"rgb(209, 217, 221)",backgroundColor:l==="dark"?"#0d0e12":"#F7F9F9"},Q={color:l==="dark"?"#fff":"#000",fontSize:"14px",fontWeight:"500"},W={borderColor:l==="dark"?"rgba(255, 255, 255, 0.2)":"rgb(209, 217, 221)",backgroundColor:l==="dark"?"#0d0e12":"#F7F9F9"},K={backgroundColor:l==="light"?"#fff":"#13161B"},Z={borderColor:l==="dark"?"rgba(255, 255, 255, 0.2)":"rgb(209, 217, 221)",color:l==="dark"?"#fff":"#000"},nt={backgroundColor:l==="light"?"#d9d6d6":"#000",color:l==="light"?"#000":"#fff",borderColor:l==="dark"?"rgba(255, 255, 255, 0.2)":"rgb(209, 217, 221)"},gt={color:"#ff6060"},rt=()=>{h()},bt={color:"#fff",backgroundColor:"#e66e00"},Ct={borderColor:"#e66e00",backgroundColor:"#e66e00"},jt={color:"#fff"};return v.jsxs(v.Fragment,{children:[v.jsxs("div",{className:"list-quest",children:[v.jsx("div",{className:"card-container",children:v.jsx("div",{className:"quest-card",style:J,onKeyDown:()=>{},role:"button",tabIndex:0,children:v.jsxs("div",{className:"card-header",children:[v.jsx("p",{style:{color:l==="dark"?"#fff":"#000",fontSize:"14px",fontWeight:"500",width:"calc(100% - 104px)"},children:G("bind_sa_acocunt")}),w?v.jsx(v.Fragment,{children:v.jsx(St,{style:{color:l==="dark"?"#fff":"#00000080",backgroundColor:l==="dark"?"transparent":"#fff"},className:"claim-btn completed",children:G("completed")})}):y===!0&&w===!1?v.jsxs(v.Fragment,{children:[v.jsx(St,{className:"claim-btn waiting-binding",onClick:()=>{rt()},children:G("waiting")}),v.jsx("div",{style:gt,className:"cancel-binding",onClick:()=>{M(!0)},onKeyDown:()=>{},role:"button",tabIndex:0,children:G("cancel_binding")})]}):v.jsx(St,{className:"claim-btn",style:Ct,onClick:()=>{rt()},children:v.jsxs("span",{style:jt,children:[" ",G("bind_now")]})})]})})}),v.jsx("div",{className:"card-container",children:v.jsx("div",{className:"quest-card",style:J,onKeyDown:()=>{},role:"button",tabIndex:0,children:v.jsxs("div",{className:"card-header",children:[v.jsx("p",{style:{color:l==="dark"?"#fff":"#000",fontSize:"14px",fontWeight:"500",width:"calc(100% - 104px)"},children:G("add_wallet_airdrop")}),_?v.jsx(St,{style:{color:l==="dark"?"#fff":"#00000080",backgroundColor:l==="dark"?"transparent":"#fff"},className:"claim-btn completed",children:G("completed")}):v.jsx(v.Fragment,{children:v.jsx(St,{onClick:()=>{f(!!w)},style:Ct,className:`claim-btn ${w?"":"disabled"}`,children:v.jsxs("span",{style:jt,children:[" ",G("do_now")]})})})]})})})]}),v.jsxs("div",{className:"big-quest",style:W,children:[v.jsxs("div",{className:"title",style:Q,children:[G("reward"),v.jsx("span",{children:`(${V}/2)`})]}),v.jsx("div",{className:"description",style:Q,children:G("complete_quest")}),v.jsx(lt,{src:tt("/img/store/skin-2.png"),alt:"copy"}),F?v.jsx(v.Fragment,{children:v.jsx(St,{style:Ct,className:"claim-big-quest disabled text-white",onClick:()=>{},children:G("claimed")})}):v.jsx(v.Fragment,{children:v.jsx(St,{style:bt,className:`claim-big-quest ${I||"disabled"}`,onClick:()=>{I&&H()},children:v.jsxs("span",{style:jt,children:[" ",G("claim_now")]})})})]}),c&&v.jsxs(v.Fragment,{children:[v.jsx("div",{className:"overlay",onClick:d,onKeyDown:()=>{},role:"button",tabIndex:0}),v.jsxs("div",{className:"popup-buy pop-binding",style:{...K,...Z},children:[v.jsxs("div",{className:"popup-header",style:Z,children:[v.jsx("div",{className:"h-title",children:v.jsxs("p",{style:Q,children:[" ",G("binding")]})}),v.jsx("div",{className:"close-popup",children:v.jsx(lt,{src:tt(i==="dark"?"/icons/menu/close-dark.png":"/icons/menu/close.png"),alt:"close",onClick:d})})]}),v.jsx("div",{className:"popup-content",children:v.jsx("input",{type:"number",className:"input-quantity",style:nt,placeholder:G("enter_code"),onChange:kt=>{p(kt.target.value)},value:m.toString()})}),v.jsxs("div",{className:"footer",children:[v.jsx("div",{className:"button-buy",children:v.jsx(St,{style:bt,onClick:()=>{X()},isLoading:S,children:G("confirm")})}),v.jsxs("div",{className:"sign-up",style:{color:l==="dark"?"#faad14":"#1890FF"},children:[G("do_not_have_an_account"),v.jsx(mn,{href:H0,target:"_blank",style:{color:l==="dark"?"#faad14":"#1890FF"},children:G("sign_up")})]}),v.jsx(mn,{className:"how-to-get-code",href:ec,target:"_blank",style:Q,children:G("how_to_get_code")})]})]})]}),u&&v.jsxs(v.Fragment,{children:[v.jsx("div",{className:"overlay",onClick:()=>{f(!1)},onKeyDown:()=>{},role:"button",tabIndex:0}),v.jsxs("div",{className:"popup-buy pop-binding",style:{...K,...Z},children:[v.jsxs("div",{className:"popup-header",style:Z,children:[v.jsx("div",{className:"h-title",children:v.jsxs("p",{style:Q,children:[" ",G("connect_wallet_sa_account")," "]})}),v.jsx("div",{className:"close-popup",children:v.jsx(lt,{src:tt(i==="dark"?"/icons/menu/close-dark.png":"/icons/menu/close.png"),alt:"close",onClick:()=>{f(!1)}})})]}),v.jsx("div",{className:"popup-content"}),v.jsxs("div",{className:"footer",children:[v.jsx("div",{className:"button-buy",children:v.jsx(mn,{href:q0,target:"_blank",style:Q,children:v.jsx(St,{style:bt,isLoading:S,children:G("connect_now")})})}),v.jsx(mn,{className:"how-to-get-code",href:ec,target:"_blank",style:Q,children:G("how_to_connect_sa_account")})]})]})]}),R&&v.jsx(Gd,{onClose:()=>{M(!1)},theme:l,onConfirm:()=>{U()},title:`${G("do_you_want_binding")}`,isLoading:C}),Y&&v.jsx(nT,{onClose:()=>{O(!1)},theme:l})]})}const iT=[{id:"65b9f2e2c7280f011bbbe601",questId:"65b1449842192a4f54106070",questType:1,questMode:Fn.HUNTING,questConfigId:99,quest:{id:"65b1449842192a4f54106070",type:1,mode:1,name:`${G("hunt_this_bag")}`,targetUrl:ph,tag:1,status:0},currentPoint:0,maxPoint:1,currentClaimTimes:0,maxClaimTimes:1,canClaim:!1,reward:{itemId:2,quantity:1,type:1,item:{type:1,itemId:2,name:"Gold Bag",describe:`${G("bag_drops")}`,imageUrl:"https://assets.saworld.io/assets/x-sasa/icon/icon-coin-bag-2.png",usable:!0}}}];function aT({index:n}){var x,y;const t=qt(),{listQuests:e}=ft(b=>b.listQuests),{isNoti:s,notiMessage:r,notiStatus:i}=ft(b=>b.isNoti),{saxTheme:o}=ft(b=>b.displaySasa),{token:l}=ns(),[a,c]=D.useState(0),[h,d]=D.useState(!1),{user:u}=ft(b=>b.user);D.useEffect(()=>{n&&c(n)},[n]),D.useEffect(()=>{l&&t(Qf(l))},[l,t]),D.useEffect(()=>{const b=setInterval(function(){u!=null&&u.saCode&&(u==null?void 0:u.saCode)!==""&&((u==null?void 0:u.walletAddress)===null||(u==null?void 0:u.walletAddress)==="")&&f()},3e3);return()=>clearInterval(b)},[l,u]);const f=async()=>{try{if(l){const b=await eT(l);(b==null?void 0:b.status)!==200&&d(!0)}}catch{d(!0)}},m={borderColor:o==="dark"?"rgba(255, 255, 255, 0.2)":"rgb(209, 217, 221)",color:"#fff",backgroundColor:o==="light"?"#F7F9F9":"#0d0e12"},p={borderColor:"#e66e00",color:"#fff",backgroundColor:"#e66e00"},g={color:o==="dark"?"#868688":"#000"},w={color:"#fff"};return v.jsxs("div",{className:"quest",children:[v.jsxs(Jf,{className:"quest-tab",index:a,onChange:b=>c(b),children:[v.jsxs(tm,{children:[v.jsx(rr,{style:a===0?p:m,children:v.jsx("span",{style:a===0?w:g,children:G("newbie_quest")})}),v.jsx(rr,{style:a===1?p:m,children:v.jsx("span",{style:a===1?w:g,children:G("daily_quest")})}),v.jsx(rr,{style:a===2?p:m,children:v.jsx("span",{style:a===2?w:g,children:G("binding_quests")})})]}),v.jsx("div",{className:"list-items",children:v.jsxs(em,{scrollBehavior:"smooth",children:[v.jsx(kn,{children:v.jsx(Of,{data:(e==null?void 0:e.data)&&((x=e==null?void 0:e.data)==null?void 0:x.filter(b=>b.questMode===Fn.NEW_BIE))})}),v.jsx(kn,{children:v.jsx(Of,{data:(e==null?void 0:e.data)&&((y=e==null?void 0:e.data)==null?void 0:y.filter(b=>b.questMode===Fn.DAILY))&&[...e.data.filter(b=>b.questMode===Fn.DAILY),...iT]})}),v.jsx(kn,{children:v.jsx(rT,{token:l,isBindingWallet:h})})]})})]}),s&&v.jsx(jn,{onClose:()=>{t(Lt(!1))},message:r,status:i})]})}function n0(){const{saxTheme:n}=ft(t=>t.displaySasa);return v.jsx("div",{className:"loading",children:v.jsx(K0,{style:{color:n==="dark"?"#fff":"#000"}})})}function oT(n){var m,p,g,w,x,y,b;const{onClose:t,item:e,theme:s}=n,{token:r}=ns(),i=qt(),[o,l]=D.useState(1),[a,c]=D.useState(!1),{styles:h}=ft(_=>_.displaySasa);D.useEffect(()=>{r&&i(Ks(r))},[r,i]);const d=async()=>{var _,E,S,T,C;try{c(!0);let A;(e==null?void 0:e.itemType)===Yt.ASG_PACKAGE?(_=e==null?void 0:e.item)!=null&&_.itemId&&(A=await Z0(Number((E=e==null?void 0:e.item)==null?void 0:E.itemId),r)):(e==null?void 0:e.itemType)===Yt.GEM_PACKAGE?(S=e==null?void 0:e.item)!=null&&S.itemId&&(A=await Q0({id:e==null?void 0:e.id,quantity:o},r)):e!=null&&e.id&&(A=await J0({id:e==null?void 0:e.id,quantity:o},r)),(A==null?void 0:A.status)===200?(t(),i(Ks(r)),i(sm(r)),i(qs(r)),i(Do({accessToken:r,type:Yt.FRAGMENT})),c(!1),i(Lt(!0)),i($t("success")),i(Wt("Success!"))):(t(),i(Lt(!0)),i($t("error")),i(Wt("An error occurred, please try again later!")))}catch(A){t(),i(Lt(!0)),i($t("error")),i(Wt(G((C=(T=A==null?void 0:A.response)==null?void 0:T.data)==null?void 0:C.message))),c(!1)}},u={backgroundColor:s==="light"?"rgb(239, 241, 241)":"rgba(255 255 255 / 0.05)"},f={color:"#fff",backgroundColor:"#e66e00"};return v.jsxs(v.Fragment,{children:[v.jsx("div",{className:"overlay",onClick:t,onKeyDown:()=>{},role:"button",tabIndex:0}),v.jsxs("div",{className:"popup-buy",style:{...h.bgStyle,...h.borderStyle},children:[v.jsxs("div",{className:"popup-header",style:h.borderStyle,children:[v.jsx("div",{className:"h-title",children:v.jsx("p",{style:h.textStyle,children:"Buy"})}),v.jsx("div",{className:"close-popup",children:v.jsx(lt,{src:tt(s==="dark"?"/icons/menu/close-dark.png":"/icons/menu/close.png"),alt:"close",onClick:t})})]}),v.jsxs("div",{className:"popup-content",children:[v.jsxs("div",{className:"item-img",style:u,children:[v.jsx(lt,{src:(m=e==null?void 0:e.item)!=null&&m.imageUrl?(p=e==null?void 0:e.item)==null?void 0:p.imageUrl:tt("/img/store/snowflakes.png"),alt:"item",style:{height:(e==null?void 0:e.itemType)===Yt.GEM_PACKAGE?"4rem":"5rem"}}),(((g=e==null?void 0:e.item)==null?void 0:g.itemId)===1&&((w=e==null?void 0:e.item)==null?void 0:w.type)===Yt.EXP||(e==null?void 0:e.itemType)===Yt.GEM_PACKAGE||(e==null?void 0:e.itemType)===Yt.ASG_PACKAGE)&&v.jsxs("p",{className:"absolute left-[65%] top-[12%] bg-white text-black text-xs px-2 py-0.5 rounded font-semibold",children:["x",(x=Zi(e!=null&&e.quantity?e==null?void 0:e.quantity:0))==null?void 0:x.toLocaleString("en-US")]})]}),v.jsxs("div",{className:"item-right",children:[v.jsx("div",{className:"item-name",style:h.textStyle,children:(y=e==null?void 0:e.item)==null?void 0:y.name}),v.jsxs("div",{className:"item-price",children:[v.jsx("p",{style:h.textStyle,children:"Price"}),v.jsxs("div",{children:[v.jsx(lt,{src:tt((e==null?void 0:e.itemType)===Yt.ASG_PACKAGE?"/icons/balances/usdt.png":"/icons/coin.png"),alt:"item"}),v.jsx("p",{style:h.textStyle,children:(b=e==null?void 0:e.gold)==null?void 0:b.toLocaleString("en-US")})]})]}),v.jsxs("div",{className:"limit",children:[v.jsxs("p",{style:h.textStyle,children:[" ",G("limit")]}),v.jsx("p",{style:h.textStyle,children:e.limit.toLocaleString("en-US")})]}),(e==null?void 0:e.itemType)!==Yt.ASG_PACKAGE&&v.jsx("div",{className:"quantity",children:v.jsxs(vh,{className:"input-quantity",defaultValue:1,onChange:_=>{l(Number(_)<(e==null?void 0:e.limit)?Number(_):e==null?void 0:e.limit)},min:1,max:e.limit,value:o,children:[v.jsx(lt,{src:tt(s==="dark"?"/icons/menu/minus-dark.png":"/icons/menu/minus.png"),alt:"item",onClick:()=>{o>0&&l(o-1)}}),v.jsx(_h,{style:h.inputStyle}),v.jsx(lt,{src:tt(s==="dark"?"/icons/menu/plus-dark.png":"/icons/menu/plus.png"),alt:"item",onClick:()=>{o<e.limit&&l(o+1)}})]})})]})]}),v.jsxs("div",{className:"footer",children:[v.jsx("div",{className:"quantity"}),v.jsx("div",{className:"button-buy",children:v.jsxs(St,{style:f,onClick:()=>{d()},isLoading:a,children:[G("buy_for"),v.jsx(lt,{src:tt((e==null?void 0:e.itemType)===Yt.ASG_PACKAGE?"/icons/balances/usdt.png":"/icons/coin.png"),alt:"item"}),o?o*(e==null?void 0:e.gold):e==null?void 0:e.gold]})})]})]})]})}function lT({shopItems:n,loading:t}){const{token:e}=ns(),[s,r]=D.useState(),{isOpen:i,onOpen:o,onClose:l}=ur(),a=qt(),{isNoti:c,notiMessage:h,notiStatus:d}=ft(_=>_.isNoti),{listPackage:u,listPackageGem:f}=ft(_=>_.store),{saxTheme:m,styles:p}=ft(_=>_.displaySasa),[g,w]=D.useState([]),[x,y]=D.useState([]);D.useEffect(()=>{if(u&&(u==null?void 0:u.length)>0){const _=u==null?void 0:u.map(E=>({id:E==null?void 0:E.id,itemId:100,gold:E==null?void 0:E.fromAmount,itemType:Yt.ASG_PACKAGE,limit:9999,status:0,quantity:E==null?void 0:E.toAmount,item:{type:100,itemId:E==null?void 0:E.packageId,name:"ASG package",describe:"",imageUrl:E.image_url,usable:!1}}));w(_)}},[u]),D.useEffect(()=>{if(f&&(f==null?void 0:f.length)>0){const _=f==null?void 0:f.map(E=>({id:E==null?void 0:E.id,itemId:100,gold:E==null?void 0:E.price,itemType:Yt.GEM_PACKAGE,limit:E.limit,status:0,quantity:E.amount,item:{type:Yt.GEM_PACKAGE,itemId:E==null?void 0:E.id,name:E==null?void 0:E.name,describe:E==null?void 0:E.description,imageUrl:E.image,usable:!1}}));y(_)}},[f]);const b=_=>{o(),r(_)};return v.jsx(v.Fragment,{children:t?v.jsx(n0,{}):v.jsxs(v.Fragment,{children:[v.jsx("div",{className:"list-store",children:[...g,...x,...n].map((_,E)=>{var S,T,C,A,R,M,I,N;return v.jsxs(St,{className:`store-card ${m==="dark"?"border-yellow":"border-blue"}`,style:p.cardStyle,onClick:()=>b(_),children:[v.jsx(lt,{className:"item-img",src:(S=_==null?void 0:_.item)!=null&&S.imageUrl?(T=_==null?void 0:_.item)==null?void 0:T.imageUrl:tt("/img/store/snowflakes.png"),alt:"item",style:{height:(_==null?void 0:_.itemType)===Yt.GEM_PACKAGE?"4rem":"5rem"}}),(((C=_==null?void 0:_.item)==null?void 0:C.itemId)===1&&((A=_==null?void 0:_.item)==null?void 0:A.type)===Yt.EXP||(_==null?void 0:_.itemType)===Yt.GEM_PACKAGE||(_==null?void 0:_.itemType)===Yt.ASG_PACKAGE)&&v.jsxs("p",{className:"absolute left-[65%] top-[12%] bg-white text-black text-xs px-2 py-0.5 rounded",children:["x",(R=Zi(_!=null&&_.quantity?_==null?void 0:_.quantity:0))==null?void 0:R.toLocaleString("en-US")]}),v.jsxs("div",{className:"price",children:[v.jsx(lt,{src:tt((_==null?void 0:_.itemType)===Yt.ASG_PACKAGE?"/icons/balances/usdt.png":"/icons/coin.png"),alt:"price"}),v.jsxs("p",{style:p.textStyle,children:["x",(M=_==null?void 0:_.gold)==null?void 0:M.toLocaleString("en-US")]})]}),v.jsx("div",{className:"tooltip",children:v.jsx(Yd,{message:(I=_==null?void 0:_.item)!=null&&I.describe?(N=_==null?void 0:_.item)==null?void 0:N.describe.replace("/n",`
`):"no describe"})})]},E)})}),i&&v.jsx(oT,{token:e,onClose:l,item:s,theme:m}),c&&v.jsx(jn,{onClose:()=>{a(Lt(!1))},message:h,status:d})]})})}function cT(){const{token:n}=ns(),t=qt(),{isAuthenticated:e}=ft(c=>c.auth),{referral:s}=ft(c=>c.referral),[r,i]=D.useState(""),{saxTheme:o,styles:l}=ft(c=>c.displaySasa);D.useEffect(()=>{e&&n&&t(tx(n))},[e,t,n]);const a=c=>{navigator.clipboard!==void 0&&(navigator.clipboard.writeText(`${c}`),i(c),setTimeout(()=>{i(void 0)},1e3))};return v.jsxs("div",{className:"referral",children:[v.jsx(lt,{src:tt("/img/bg-referral.png"),alt:"bg-referral",className:"bg-referral"}),v.jsxs("div",{className:"layout-referral",children:[v.jsxs("div",{className:"referral-code item",style:l.cardStyle,children:[v.jsx("p",{className:"title",style:l.textStyle,children:G("referral_code")}),v.jsxs("div",{className:"code",children:[v.jsx("p",{style:l.textStyle,children:s.code}),v.jsxs("div",{className:"copy-wrapper",children:[v.jsx(lt,{src:o==="light"?tt("/icons/copy-black.png"):tt("/icons/copy.png"),alt:"copy",className:"icon-copy",onClick:()=>a(s.code)}),v.jsx("div",{className:`copy-tooltip ${r===s.code&&"tooltip-show"}`,style:l.cardContrast,children:G("copied")})]})]})]}),v.jsxs("div",{className:"referred-citizen item",style:l.cardStyle,children:[v.jsx("p",{className:"title",style:l.textStyle,children:G("reffered_citizens")}),v.jsxs("div",{className:"amount",children:[v.jsx("span",{className:"amount-referred",style:l.textStyle,children:s.countUserRef}),v.jsxs("span",{children:[" ",G("citizens")]})]})]})]}),v.jsx(s0,{})]})}const hT=n=>{const{saxTheme:t}=ft(r=>r.displaySasa),{onClose:e,isOpen:s}=n;return v.jsxs(gh,{className:"tab-transfer modal-deposit",isOpen:s,onClose:e,children:[v.jsxs(xh,{children:[v.jsx("div",{className:"h-title"}),v.jsx("div",{className:"close-popup",children:v.jsx(lt,{src:tt(t==="dark"?"/icons/menu/close-dark.png":"/icons/menu/close.png"),alt:"close",onClick:e})})]}),v.jsx(bh,{className:`custom-modal modal-transaction-success theme-${t}`,children:v.jsx(nm,{isDeposit:!0,isPopup:!0})})]})},dT=n=>{const{onClose:t,isOpen:e,callback:s}=n,{saxTheme:r}=ft(o=>o.displaySasa),{isImportPassword:i}=ft(o=>o.popup);return D.useEffect(()=>{i&&e&&(t(),s&&s())},[i,t,s,e]),v.jsxs(gh,{className:"tab-transfer modal-password-empty",isOpen:e,onClose:t,children:[v.jsxs(xh,{children:[v.jsx("div",{className:"h-title"}),v.jsx("div",{className:"close-popup",children:v.jsx(lt,{src:tt(r==="dark"?"/icons/menu/close-dark.png":"/icons/menu/close.png"),alt:"close",onClick:t})})]}),v.jsx(bh,{className:`custom-modal form-control-password modal-transaction-success theme-${r}`,children:v.jsx(rm,{isExtension:!0})})]})};function uT(n){var c,h,d,u,f;const{onClose:t,item:e,theme:s,action:r,isDisabled:i}=n,{styles:o}=ft(m=>m.displaySasa),l={backgroundColor:s==="light"?"rgb(239, 241, 241)":"rgba(255 255 255 / 0.05)"},a={color:"#fff",backgroundColor:"#e66e00"};return v.jsxs(v.Fragment,{children:[v.jsx("div",{className:"overlay",onClick:t,onKeyDown:()=>{},role:"button",tabIndex:0}),v.jsxs("div",{className:"popup-buy",style:{...o.bgStyle,...o.borderStyle},children:[v.jsxs("div",{className:"popup-header",style:o.borderStyle,children:[v.jsx("div",{className:"h-title",children:v.jsx("p",{style:o.textStyle,children:"Use"})}),v.jsx("div",{className:"close-popup",children:v.jsx(lt,{src:tt(s==="dark"?"/icons/menu/close-dark.png":"/icons/menu/close.png"),alt:"close",onClick:t})})]}),v.jsxs("div",{className:"popup-content",children:[v.jsx("div",{className:"item-img",style:l,children:v.jsx(lt,{src:(c=e==null?void 0:e.item)!=null&&c.imageUrl?(h=e==null?void 0:e.item)==null?void 0:h.imageUrl:tt("/img/store/snowflakes.png"),alt:"item"})}),v.jsxs("div",{className:"item-right inven",children:[v.jsx("div",{className:"item-name",style:o.textStyle,children:(d=e==null?void 0:e.item)!=null&&d.name?(u=e==null?void 0:e.item)==null?void 0:u.name:"default name"}),(e==null?void 0:e.type)===((f=Yt)==null?void 0:f.GIFTBOX)&&v.jsx("p",{className:"text-xs text-[#faad14] mb-2",children:G("open_lucky_box")}),v.jsx("div",{className:"button-buy",children:v.jsx(St,{onClick:r,style:a,className:`${i&&(e==null?void 0:e.type)!==Yt.EXP&&"disabled"}`,children:G("use_this")})})]})]})]})]})}const fT=n=>{var a,c,h,d,u,f,m,p,g,w,x,y,b,_;const{onClose:t,item:e,theme:s}=n,r={color:s==="dark"?"#fff":"#000"},i={backgroundColor:s==="light"?"#fff":"#13161B"},o={backgroundColor:s==="light"?"rgb(239, 241, 241)":"rgba(255 255 255 / 0.05)"},l={borderColor:s==="dark"?"rgba(255, 255, 255, 0.2)":"rgb(209, 217, 221)",color:s==="dark"?"#fff":"#000"};return v.jsxs(v.Fragment,{children:[v.jsx("div",{className:"overlay",onClick:t,onKeyDown:()=>{},role:"button",tabIndex:0}),v.jsxs("div",{className:"popup-buy popup-show-reward",style:{...i,...l},children:[v.jsxs("div",{className:"popup-header",style:l,children:[v.jsx("div",{className:"h-title",children:v.jsx("p",{style:r,children:G("notice")})}),v.jsx("div",{className:"close-popup",children:v.jsx(lt,{src:tt(s==="dark"?"/icons/menu/close-dark.png":"/icons/menu/close.png"),alt:"close",onClick:t})})]}),v.jsxs("div",{className:"popup-content",children:[v.jsxs("div",{className:"flex gap-6",children:[v.jsxs("div",{className:"item-img",style:o,children:[v.jsx(lt,{src:(e==null?void 0:e.goldImageUrl)||((a=e==null?void 0:e.result)==null?void 0:a.imageUrl)||((h=(c=e==null?void 0:e.result)==null?void 0:c.item)==null?void 0:h.imageUrl)||((u=(d=e==null?void 0:e.inventory)==null?void 0:d.item)==null?void 0:u.imageUrl)||tt("/img/default.png"),alt:"item"}),v.jsxs("span",{className:"reward",style:r,children:["x",(e==null?void 0:e.goldReward)||((f=e==null?void 0:e.result)==null?void 0:f.quantity)||((m=e==null?void 0:e.inventory)==null?void 0:m.quantity)||""]})]}),(e==null?void 0:e.chestReward)>0&&v.jsxs("div",{className:"item-img",style:o,children:[v.jsx(lt,{src:(e==null?void 0:e.chestImageUrl)||tt("/img/key.png"),alt:"item"}),v.jsxs("span",{className:"reward",style:r,children:["x",e==null?void 0:e.chestReward]})]})]}),v.jsx("div",{className:"item-right",children:v.jsxs("div",{className:"item-name",style:r,children:[G("congratulations_on_unlocking_the_gift_of")+" ",v.jsxs("span",{style:{color:"#faad14"},children:[(e==null?void 0:e.goldReward)||((p=e==null?void 0:e.result)==null?void 0:p.quantity)||((g=e==null?void 0:e.inventory)==null?void 0:g.quantity)||""," "]}),e!=null&&e.goldImageUrl||e!=null&&e.goldReward?"Gold":((w=e==null?void 0:e.result)==null?void 0:w.name)||((y=(x=e==null?void 0:e.result)==null?void 0:x.item)==null?void 0:y.name)||((_=(b=e==null?void 0:e.inventory)==null?void 0:b.item)==null?void 0:_.name)||""," ",(e==null?void 0:e.chestReward)!==void 0&&(e==null?void 0:e.chestReward)>0&&v.jsxs(v.Fragment,{children:[v.jsxs("span",{children:[" ",G("and")]}),v.jsx("span",{style:{color:"#faad14"},children:" "+(e==null?void 0:e.chestReward)+" "}),v.jsx("span",{children:(e==null?void 0:e.chestReward)>1?G("keys"):G("key")})]}),"."]})})]})]})]})};var In=(n=>(n.AP="AP",n.ASG="ASG",n.GOLD="GOLD",n.SAE="SAE",n.USDT="USDT",n))(In||{});function mT(n){var f,m,p,g,w,x;const{token:t}=ns(),{onClose:e,balance:s,openNotiWhiteList:r}=n,i=qt(),{saxTheme:o,styles:l}=ft(y=>y.displaySasa),{user:a}=ft(y=>y.user),[c,h]=D.useState(!1),d={color:"#fff",backgroundColor:"#e66e00"},u=async()=>{var y,b,_,E,S,T;if(h(!0),a&&(a!=null&&a.saCode)&&(a==null?void 0:a.saCode)!==null)if(a&&(a!=null&&a.paymentBalancesInfo)&&((y=a==null?void 0:a.paymentBalancesInfo)==null?void 0:y.length)>0&&((_=(b=a==null?void 0:a.paymentBalancesInfo)==null?void 0:b.find(C=>C.symbol===In.AP))!=null&&_.amount)&&Number((S=(E=a==null?void 0:a.paymentBalancesInfo)==null?void 0:E.find(C=>C.symbol===In.AP))==null?void 0:S.amount)<=0)i(Lt(!0)),i($t("error")),i(Wt("You don't have AP to claim")),h(!1);else try{const C=await ex(t);((T=C==null?void 0:C.data)==null?void 0:T.statusCode)===200?(i(Ks(t)),h(!1),i(Lt(!0)),i($t("success")),i(Wt("Success!")),e()):(h(!1),i(Lt(!0)),i($t("error")),i(Wt("An error occurred, please try again later!")))}catch{i(Lt(!0)),i($t("error")),i(Wt("An error occurred, please try again later!")),h(!1),e()}else e(),r()};return v.jsxs(v.Fragment,{children:[v.jsx("div",{className:"overlay",onClick:e,onKeyDown:()=>{},role:"button",tabIndex:0}),v.jsxs("div",{className:"custom-popup",style:{...l.bgStyle,...l.borderStyle},children:[v.jsxs("div",{className:"popup-header",style:l.borderStyle,children:[v.jsx("div",{className:"h-title",children:v.jsx("p",{style:l.textStyle,children:G("use_this")})}),v.jsx("div",{className:"close-popup",children:v.jsx(lt,{src:tt(o==="dark"?"/icons/menu/close-dark.png":"/icons/menu/close.png"),alt:"close",onClick:e})})]}),v.jsxs("div",{className:"popup-content",style:l.textStyle,children:[v.jsx("div",{className:"item-img",style:l.borderStyle,children:v.jsx(lt,{src:tt(s===ke.AP?"/icons/balances/ap.png":s===ke.ASG?"/icons/balances/asg.png":""),alt:"item"})}),v.jsxs("div",{className:"tools detail-balance",children:[v.jsx("p",{style:l.titleStyle,children:s===ke.AP?"AP":s===ke.ASG?"ASG":""}),s===ke.AP?v.jsxs(v.Fragment,{children:[v.jsxs("div",{style:{display:"inline",margin:"20px 0 20px 0"},children:[v.jsx("span",{style:l.desStyle,children:G("des_ap_1")}),v.jsx(mn,{href:Ha,target:"_blank",style:{color:"#1890ff",textDecoration:"underline",fontSize:"12px",cursor:"pointer"},children:G("sa_world")})]}),v.jsx(St,{className:`btn mt-2 ${a&&(a!=null&&a.paymentBalancesInfo)&&((f=a==null?void 0:a.paymentBalancesInfo)==null?void 0:f.length)>0&&((m=a==null?void 0:a.paymentBalancesInfo)!=null&&m.find(y=>y.symbol===In.AP))&&((g=(p=a==null?void 0:a.paymentBalancesInfo)==null?void 0:p.find(y=>y.symbol===In.AP))==null?void 0:g.amount)!==void 0&&Number((x=(w=a==null?void 0:a.paymentBalancesInfo)==null?void 0:w.find(y=>y.symbol===In.AP))==null?void 0:x.amount)>0?"":"btn-claim-disabled"}`,style:d,isLoading:c,onClick:u,children:"Claim AP"})]}):s===ke.ASG?v.jsxs(v.Fragment,{children:[v.jsxs("div",{style:{display:"inline",marginTop:"20px"},children:[v.jsx("span",{style:l.desStyle,children:G("des_asg_1")}),v.jsx(mn,{href:Ha,target:"_blank",style:{color:"#1890ff",textDecoration:"underline",fontSize:"14px",cursor:"pointer"},children:G("sa_world")}),v.jsx("span",{style:l.desStyle,children:"."})]}),v.jsxs("div",{style:{display:"inline"},children:[v.jsx("span",{style:l.desStyle,children:G("des_asg_2")}),v.jsx(mn,{href:Ha,target:"_blank",style:{color:"#1890ff",textDecoration:"underline",fontSize:"14px",cursor:"pointer"},children:G("sa_world")}),v.jsx("span",{style:l.desStyle,children:G("des_asg_3")})]}),v.jsx(St,{className:"btn mt-2 disabled",style:d,onClick:()=>{},children:G("des_asg_4")})]}):""]})]})]})]})}const pT=n=>{const t=qt(),{isOpen:e,onClose:s}=n,{saxTheme:r,styles:i}=ft(l=>l.displaySasa),o=()=>{s(),t(yh(!0))};return v.jsxs(gh,{classOverlay:"",className:"chakra-modal__content-container modal-select-type-transfer modal-confirm-withdraw-sasa",isOpen:e,onClose:s,children:[v.jsxs(xh,{children:[v.jsx("div",{className:"h-title",children:v.jsx("p",{style:i.textStyle,children:G("notice")})}),v.jsx("div",{className:"close-popup",children:v.jsx(lt,{src:tt(r==="dark"?"/icons/menu/close-dark.png":"/icons/menu/close.png"),alt:"close",onClick:s})})]}),v.jsxs(bh,{className:`custom-modal theme-${r}`,children:[v.jsx("p",{className:"des",style:i.textStyle,children:G("please_select_a_feature_to_use")}),v.jsxs("div",{className:"group-btn",children:[v.jsx(St,{onClick:o,className:"btn-submit-form submit",style:{background:r==="dark"?"#faad14":"#1890FF",color:r==="dark"?"#000":"#fff",display:"flex"},children:G("deposit")}),v.jsxs("div",{className:"tooltip",children:[v.jsxs("div",{className:"title",children:[" ",G("coming_soon")]}),v.jsx(St,{className:"border border-gray bg-[#00000080] text-white w-[100px] font-medium opacity-50 cursor-not-allowed hover:bg-[#00000080]",disabled:!0,style:{borderRadius:"0.625rem"},children:G("des_asg_4")})]})]})]})]})};function r0(){var w,x,y,b,_,E,S,T,C;const n=qt(),{user:t,balancesInGame:e}=ft(A=>A.user),{saxTheme:s,styles:r}=ft(A=>A.displaySasa),[i,o]=D.useState(!1),[l,a]=D.useState(""),[c,h]=D.useState(!1),{isOpen:d,onOpen:u,onClose:f}=ur(),m=()=>{o(!0),a(ke.AP)},p=()=>{u(),n(sx(ke.ASG))},g=A=>{var R,M;return v.jsx("div",{className:"tooltip",children:v.jsxs("div",{className:"coins",style:r.balanceStyle,children:[v.jsx("div",{className:"title",children:v.jsx("span",{children:(A==null?void 0:A.amount.toLocaleString("en-US"))||0})}),v.jsx(lt,{src:tt(`/icons/balances/${(R=A==null?void 0:A.symbol)==null?void 0:R.toLowerCase()}.png`),alt:"ap",style:{cursor:"pointer"}}),v.jsx("div",{className:"credit",style:r.textStyle,children:v.jsx("span",{children:(M=Zi(A!=null&&A.amount?A==null?void 0:A.amount:0))==null?void 0:M.toLocaleString("en-US")})}),(A==null?void 0:A.symbol)===ke.AP||(A==null?void 0:A.symbol)===ke.ASG?v.jsx(lt,{className:"img-transfer",src:tt("/icons/arrows-right-left.png"),alt:"transfer",onClick:()=>{(A==null?void 0:A.symbol)===ke.AP&&m(),(A==null?void 0:A.symbol)===ke.ASG&&p()}}):null]})},A.symbol)};return v.jsxs("div",{className:"wrapper-balance",children:[v.jsxs("div",{className:`balance flex-wrap theme-${s}`,children:[t&&(t==null?void 0:t.paymentBalancesInfo)&&((w=t==null?void 0:t.paymentBalancesInfo)==null?void 0:w.length)>0&&((y=(x=t==null?void 0:t.paymentBalancesInfo)==null?void 0:x.filter(A=>A.symbol===In.GOLD))==null?void 0:y.map(A=>im.Children.toArray(v.jsxs("div",{className:"tooltip",children:[v.jsx("div",{className:"title",children:v.jsx("span",{children:(A==null?void 0:A.amount)&&(A==null?void 0:A.amount.toLocaleString("en-US"))||0})}),v.jsxs("div",{className:"coins",style:r.balanceStyle,children:[v.jsx(lt,{src:tt("/icons/coin.png"),alt:"coin"}),v.jsx("div",{className:"credit",style:r.textStyle,children:v.jsx("span",{children:Zi(A!=null&&A.amount?A==null?void 0:A.amount:0)})})]})]})))),t&&(t==null?void 0:t.paymentBalancesInfo)&&((b=t==null?void 0:t.paymentBalancesInfo)==null?void 0:b.length)>0&&((E=(_=t==null?void 0:t.paymentBalancesInfo)==null?void 0:_.filter(A=>A.symbol===ke.AP))==null?void 0:E.map(A=>g(A))),v.jsxs("div",{className:"tooltip",children:[v.jsx("div",{className:"title",children:v.jsx("span",{children:e&&(e!=null&&e.gem)?Number((e==null?void 0:e.gem)||0).toLocaleString("en-US"):0})}),v.jsxs("div",{className:"coins",style:r.balanceStyle,children:[v.jsx(lt,{src:tt("/icons/balances/gem.png"),alt:"snowflakes"}),v.jsx("div",{className:"credit",style:r.textStyle,children:v.jsx("span",{children:e&&(e!=null&&e.gem)?Zi(e==null?void 0:e.gem).toLocaleString("en-US"):0})})]})]})]}),v.jsx("div",{className:`balance flex-wrap theme-${s}`,children:t&&(t==null?void 0:t.paymentBalancesInfo)&&((S=t==null?void 0:t.paymentBalancesInfo)==null?void 0:S.length)>0&&((C=(T=t==null?void 0:t.paymentBalancesInfo)==null?void 0:T.filter(A=>A.symbol!==In.AP&&A.symbol!==In.GOLD))==null?void 0:C.map(A=>g(A)))}),i&&v.jsx(mT,{openNotiWhiteList:()=>h(!0),theme:s,onClose:()=>o(!1),balance:l}),c&&v.jsx(e0,{onClose:()=>h(!1)}),d&&v.jsx(pT,{isOpen:d,onClose:f})]})}const vs=n=>{const{children:t,textClose:e,onClosePage:s,className:r,isWalletTab:i,isHideIconBack:o,isHideBalance:l,isHideBorderHeader:a,isWalletContent:c,classNameWrapper:h,style:d}=n,{saxTheme:u,styles:f}=ft(m=>m.displaySasa);return v.jsx(nx,{children:v.jsxs("div",{className:`wrapper-wallet ${h&&h}`,style:d,children:[!i&&v.jsxs("div",{className:`header ${c?"header-in-wallet":""}`,style:a?{border:"none"}:f.borderStyle,children:[v.jsx(xi,{className:"left",onClick:s&&s,children:!o&&v.jsxs(v.Fragment,{children:[v.jsx(rx,{color:u==="dark"?"#fff":"#000",fontSize:28,className:"icon-back"}),v.jsx("h1",{className:"text-close",style:f==null?void 0:f.textStyle,children:e})]})}),!l&&v.jsx("div",{className:"right",children:v.jsx(r0,{})})]}),v.jsx("div",{className:`content ${r}`,children:t})]})})};function gT(){var I,N,F,B,Y,O,V,j,X;const{token:n}=ns(),[t,e]=D.useState(!1),[s,r]=D.useState(!1),i=qt(),{inventory:o}=ft(L=>L.inventory),{styles:l,saxTheme:a}=ft(L=>L.displaySasa),{isOpen:c,onOpen:h,onClose:d}=ur(),[u,f]=D.useState(""),[m,p]=D.useState(""),[g,w]=D.useState(!1),[x,y]=D.useState(),[b,_]=D.useState({}),[E,S]=D.useState(!1),[T,C]=D.useState(!1);D.useEffect(()=>{n&&i(qs(n))},[n,i]);const A=async(L,U)=>{var q,H;try{w(!0);const J=await mh({itemType:L,itemId:U,quantity:1},n);(J==null?void 0:J.status)===200?(d(),e(!1),r(!0),f("Success!"),p("success"),w(!1),i(qs(n)),i(Ks(n)),_(JSON.parse(J.data.data)),((x==null?void 0:x.type)===1||(x==null?void 0:x.type)===3)&&S(!0)):(d(),e(!1),r(!0),f(G("error_try_again")),p("error"),w(!1))}catch(J){w(!1),r(!0),f(G((H=(q=J==null?void 0:J.response)==null?void 0:q.data)==null?void 0:H.message)),p("error"),e(!1)}},R=L=>{h(),y(L)},M=()=>{i(qa(!1))};return v.jsx(vs,{isWalletContent:!0,isHideBorderHeader:!0,isHideBalance:!0,onClosePage:M,className:"sasa-popup extension-x",textClose:"Back",children:v.jsxs("div",{className:"bag-list",children:[v.jsx("div",{className:"list",children:(N=(I=o==null?void 0:o.data)==null?void 0:I.filter(L=>L.type!==Yt.WHITELIST&&L.type!==Yt.FRAGMENT))==null?void 0:N.map((L,U)=>{var q,H,J,Q;return v.jsx(v.Fragment,{children:v.jsxs("div",{className:`bag-card ${a==="dark"?"border-yellow":"border-blue"}`,style:l.cardStyle,onClick:()=>{R(L)},onKeyDown:()=>{},role:"button",tabIndex:0,children:[v.jsx(lt,{src:(q=L==null?void 0:L.item)!=null&&q.imageUrl?(H=L==null?void 0:L.item)==null?void 0:H.imageUrl:tt("/img/store/snowflakes.png"),alt:"item"}),v.jsx("p",{style:l.textStyle,children:L==null?void 0:L.quantity.toLocaleString("en-US")}),v.jsx("div",{className:"tooltip",children:v.jsx(Yd,{message:(J=L==null?void 0:L.item)!=null&&J.describe?(Q=L==null?void 0:L.item)==null?void 0:Q.describe:"no describe"})})]},U)})})}),c&&v.jsx(uT,{onClose:d,item:x,theme:a,action:()=>{var L,U,q,H,J;(x==null?void 0:x.type)===Yt.EXP?C(!0):((x==null?void 0:x.type)!==((L=Yt)==null?void 0:L.GIFTBOX)&&((U=x==null?void 0:x.item)!=null&&U.usable)||(x==null?void 0:x.type)===((q=Yt)==null?void 0:q.GIFTBOX)&&((J=(H=o==null?void 0:o.data)==null?void 0:H.filter(Q=>(Q==null?void 0:Q.type)===Yt.CHEST))==null?void 0:J.length)>0)&&(e(!0),d())},isDisabled:((F=x==null?void 0:x.item)==null?void 0:F.usable)===!1||(x==null?void 0:x.type)===((B=Yt)==null?void 0:B.GIFTBOX)&&((O=(Y=o==null?void 0:o.data)==null?void 0:Y.filter(L=>(L==null?void 0:L.type)===Yt.CHEST))==null?void 0:O.length)<=0}),t&&v.jsx(Gd,{onClose:()=>{e(!1)},theme:a,onConfirm:()=>{A(x==null?void 0:x.type,x==null?void 0:x.itemId)},title:`Do you want to use ${(V=x==null?void 0:x.item)==null?void 0:V.name}?`,isLoading:g}),E&&v.jsx(fT,{theme:a,item:b,onClose:()=>S(!1)}),T&&v.jsx(t0,{onClose:()=>{C(!1)},theme:a,max:o!=null&&o.data&&((j=o==null?void 0:o.data)==null?void 0:j.filter(L=>L.type===0).length)>0?(X=o==null?void 0:o.data)==null?void 0:X.filter(L=>L.type===0)[0].quantity:0,image:tt("/img/sasa.png"),token:n}),s&&v.jsx(jn,{onClose:()=>{r(!1)},message:u,status:m})]})})}const xT=()=>v.jsx(ix,{}),i0=()=>{const n=qt(),t=()=>{n(Qi(!1))};return v.jsx(vs,{isHideBalance:!0,isWalletContent:!0,isHideBorderHeader:!0,onClosePage:t,className:"sasa-popup extension-x",textClose:"Back",children:v.jsx(xT,{})})},a0=()=>{const n=qt(),t=()=>{n(gr())};return v.jsx(vs,{onClosePage:t,className:"tab-transfer no-header",textClose:G("back"),isHideBalance:!0,isHideBorderHeader:!0,isWalletContent:!0,children:v.jsx(ax,{})})},o0=()=>{const n=qt(),t=()=>{n(gr())};return v.jsx(vs,{onClosePage:t,className:"tab-transfer",textClose:G("back"),isHideBalance:!0,isHideBorderHeader:!0,isWalletContent:!0,children:v.jsx(nm,{isExtensionTabTransfer:!0,isExtension:!0,isPopup:!0})})},$d=()=>{const n=qt(),{isResetPassword:t}=ft(s=>s.displaySasa),e=()=>{n(lx(!1)),t||n(gr())};return v.jsx(vs,{onClosePage:e,className:"tab-transfer no-header",textClose:G("back"),isHideBalance:!0,isHideBorderHeader:!0,isWalletContent:!0,children:v.jsx(ox,{})})},l0=()=>{const n=qt(),t=()=>{n(gr())};return v.jsx(vs,{onClosePage:t,className:"tab-transfer no-header",textClose:G("back"),isHideBalance:!0,isHideBorderHeader:!0,isWalletContent:!0,children:v.jsx(cx,{})})},c0=()=>{const n=qt(),t=()=>{n(gr())};return v.jsx(vs,{onClosePage:t,className:"tab-transfer no-header",textClose:G("back"),isHideBalance:!0,isHideBorderHeader:!0,isWalletContent:!0,children:v.jsx(hx,{})})},Wd=()=>{const{isResetPassword:n,isDisplayChangePassword:t}=ft(r=>r.displaySasa),e=qt(),s=()=>{e(gr())};return n&&!t?v.jsx(vs,{onClosePage:s,className:"sasa-popup extension-x",textClose:G("back"),isWalletTab:!1,isHideBalance:!0,isHideIconBack:!1,isHideBorderHeader:!0,children:v.jsx(dx,{isExtension:!0,password:""})}):t?v.jsx($d,{}):v.jsx(vs,{isWalletTab:!1,onClosePage:()=>{e(Qi(!1))},className:"sasa-popup extension-x",textClose:"",isHideBorderHeader:!0,isHideBalance:!0,children:v.jsx(rm,{isExtension:!0})})},h0=()=>{const n=qt(),t=()=>{n(gr())};return v.jsx(vs,{onClosePage:t,className:"tab-transfer no-header",textClose:G("back"),isHideBalance:!0,isHideBorderHeader:!0,isWalletContent:!0,children:v.jsx(ux,{})})},bT=Symbol(),zd=Symbol(),Di="a",ta="w";let yT=(n,t)=>new Proxy(n,t);const hh=Object.getPrototypeOf,dh=new WeakMap,d0=n=>n&&(dh.has(n)?dh.get(n):hh(n)===Object.prototype||hh(n)===Array.prototype),Mo=n=>typeof n=="object"&&n!==null,wT=n=>{if(Array.isArray(n))return Array.from(n);const t=Object.getOwnPropertyDescriptors(n);return Object.values(t).forEach(e=>{e.configurable=!0}),Object.create(hh(n),t)},Hd=n=>n[zd]||n,u0=(n,t,e,s)=>{if(!d0(n))return n;let r=s&&s.get(n);if(!r){const a=Hd(n);r=(c=>Object.values(Object.getOwnPropertyDescriptors(c)).some(h=>!h.configurable&&!h.writable))(a)?[a,wT(a)]:[a],s==null||s.set(n,r)}const[i,o]=r;let l=e&&e.get(i);return l&&l[1].f===!!o||(l=((a,c)=>{const h={f:c};let d=!1;const u=(m,p)=>{if(!d){let g=h[Di].get(a);if(g||(g={},h[Di].set(a,g)),m===ta)g[ta]=!0;else{let w=g[m];w||(w=new Set,g[m]=w),w.add(p)}}},f={get:(m,p)=>p===zd?a:(u("k",p),u0(Reflect.get(m,p),h[Di],h.c,h.t)),has:(m,p)=>p===bT?(d=!0,h[Di].delete(a),!0):(u("h",p),Reflect.has(m,p)),getOwnPropertyDescriptor:(m,p)=>(u("o",p),Reflect.getOwnPropertyDescriptor(m,p)),ownKeys:m=>(u(ta),Reflect.ownKeys(m))};return c&&(f.set=f.deleteProperty=()=>!1),[f,h]})(i,!!o),l[1].p=yT(o||i,l[0]),e&&e.set(i,l)),l[1][Di]=t,l[1].c=e,l[1].t=s,l[1].p},f0=(n,t,e,s,r=Object.is)=>{if(r(n,t))return!1;if(!Mo(n)||!Mo(t))return!0;const i=e.get(Hd(n));if(!i)return!0;if(s){const l=s.get(n);if(l&&l.n===t)return l.g;s.set(n,{n:t,g:!1})}let o=null;try{for(const l of i.h||[])if(o=Reflect.has(n,l)!==Reflect.has(t,l),o)return o;if(i[ta]===!0){if(o=((l,a)=>{const c=Reflect.ownKeys(l),h=Reflect.ownKeys(a);return c.length!==h.length||c.some((d,u)=>d!==h[u])})(n,t),o)return o}else for(const l of i.o||[])if(o=!!Reflect.getOwnPropertyDescriptor(n,l)!=!!Reflect.getOwnPropertyDescriptor(t,l),o)return o;for(const l of i.k||[])if(o=f0(n[l],t[l],e,s,r),o)return o;return o===null&&(o=!0),o}finally{s&&s.set(n,{n:t,g:o})}},vT=n=>d0(n)&&n[zd]||null,jf=(n,t=!0)=>{dh.set(n,t)},_T=(n,t,e)=>{const s=[],r=new WeakSet,i=(o,l)=>{if(r.has(o))return;Mo(o)&&r.add(o);const a=Mo(o)&&t.get(Hd(o));if(a){var c,h;if((c=a.h)==null||c.forEach(u=>{const f=`:has(${String(u)})`;s.push(l?[...l,f]:[f])}),a[ta]===!0){const u=":ownKeys";s.push(l?[...l,u]:[u])}else{var d;(d=a.o)==null||d.forEach(u=>{const f=`:hasOwn(${String(u)})`;s.push(l?[...l,f]:[f])})}(h=a.k)==null||h.forEach(u=>{e&&!("value"in(Object.getOwnPropertyDescriptor(o,u)||{}))||i(o[u],l?[...l,u]:[u])})}else l&&s.push(l)};return i(n),s};var Po={BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const Kl=n=>typeof n=="object"&&n!==null,sr=new WeakMap,Ya=new WeakSet,ET=(n=Object.is,t=(c,h)=>new Proxy(c,h),e=c=>Kl(c)&&!Ya.has(c)&&(Array.isArray(c)||!(Symbol.iterator in c))&&!(c instanceof WeakMap)&&!(c instanceof WeakSet)&&!(c instanceof Error)&&!(c instanceof Number)&&!(c instanceof Date)&&!(c instanceof String)&&!(c instanceof RegExp)&&!(c instanceof ArrayBuffer),s=c=>{switch(c.status){case"fulfilled":return c.value;case"rejected":throw c.reason;default:throw c}},r=new WeakMap,i=(c,h,d=s)=>{const u=r.get(c);if((u==null?void 0:u[0])===h)return u[1];const f=Array.isArray(c)?[]:Object.create(Object.getPrototypeOf(c));return jf(f,!0),r.set(c,[h,f]),Reflect.ownKeys(c).forEach(m=>{if(Object.getOwnPropertyDescriptor(f,m))return;const p=Reflect.get(c,m),{enumerable:g}=Reflect.getOwnPropertyDescriptor(c,m),w={value:p,enumerable:g,configurable:!0};if(Ya.has(p))jf(p,!1);else if(p instanceof Promise)delete w.value,w.get=()=>d(p);else if(sr.has(p)){const[x,y]=sr.get(p);w.value=i(x,y(),d)}Object.defineProperty(f,m,w)}),Object.preventExtensions(f)},o=new WeakMap,l=[1,1],a=c=>{if(!Kl(c))throw new Error("object required");const h=o.get(c);if(h)return h;let d=l[0];const u=new Set,f=(C,A=++l[0])=>{d!==A&&(d=A,u.forEach(R=>R(C,A)))};let m=l[1];const p=(C=++l[1])=>(m!==C&&!u.size&&(m=C,w.forEach(([A])=>{const R=A[1](C);R>d&&(d=R)})),d),g=C=>(A,R)=>{const M=[...A];M[1]=[C,...M[1]],f(M,R)},w=new Map,x=(C,A)=>{if((Po?"production":void 0)!=="production"&&w.has(C))throw new Error("prop listener already exists");if(u.size){const R=A[3](g(C));w.set(C,[A,R])}else w.set(C,[A])},y=C=>{var A;const R=w.get(C);R&&(w.delete(C),(A=R[1])==null||A.call(R))},b=C=>(u.add(C),u.size===1&&w.forEach(([R,M],I)=>{if((Po?"production":void 0)!=="production"&&M)throw new Error("remove already exists");const N=R[3](g(I));w.set(I,[R,N])}),()=>{u.delete(C),u.size===0&&w.forEach(([R,M],I)=>{M&&(M(),w.set(I,[R]))})}),_=Array.isArray(c)?[]:Object.create(Object.getPrototypeOf(c)),S=t(_,{deleteProperty(C,A){const R=Reflect.get(C,A);y(A);const M=Reflect.deleteProperty(C,A);return M&&f(["delete",[A],R]),M},set(C,A,R,M){const I=Reflect.has(C,A),N=Reflect.get(C,A,M);if(I&&(n(N,R)||o.has(R)&&n(N,o.get(R))))return!0;y(A),Kl(R)&&(R=vT(R)||R);let F=R;if(R instanceof Promise)R.then(B=>{R.status="fulfilled",R.value=B,f(["resolve",[A],B])}).catch(B=>{R.status="rejected",R.reason=B,f(["reject",[A],B])});else{!sr.has(R)&&e(R)&&(F=a(R));const B=!Ya.has(F)&&sr.get(F);B&&x(A,B)}return Reflect.set(C,A,F,M),f(["set",[A],R,N]),!0}});o.set(c,S);const T=[_,p,i,b];return sr.set(S,T),Reflect.ownKeys(c).forEach(C=>{const A=Object.getOwnPropertyDescriptor(c,C);"value"in A&&(S[C]=c[C],delete A.value,delete A.writable),Object.defineProperty(_,C,A)}),S})=>[a,sr,Ya,n,t,e,s,r,i,o,l],[ST]=ET();function TT(n={}){return ST(n)}function AT(n,t,e){const s=sr.get(n);(Po?"production":void 0)!=="production"&&!s&&console.warn("Please use proxy object");let r;const i=[],o=s[3];let l=!1;const c=o(h=>{if(i.push(h),e){t(i.splice(0));return}r||(r=Promise.resolve().then(()=>{r=void 0,l&&t(i.splice(0))}))});return l=!0,()=>{l=!1,c()}}function Vf(n,t){const e=sr.get(n);(Po?"production":void 0)!=="production"&&!e&&console.warn("Please use proxy object");const[s,r,i]=e;return i(s,r(),t)}var m0={exports:{}},p0={};/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yi=D;function CT(n,t){return n===t&&(n!==0||1/n===1/t)||n!==n&&t!==t}var kT=typeof Object.is=="function"?Object.is:CT,IT=yi.useState,RT=yi.useEffect,MT=yi.useLayoutEffect,PT=yi.useDebugValue;function NT(n,t){var e=t(),s=IT({inst:{value:e,getSnapshot:t}}),r=s[0].inst,i=s[1];return MT(function(){r.value=e,r.getSnapshot=t,Zl(r)&&i({inst:r})},[n,e,t]),RT(function(){return Zl(r)&&i({inst:r}),n(function(){Zl(r)&&i({inst:r})})},[n]),PT(e),e}function Zl(n){var t=n.getSnapshot;n=n.value;try{var e=t();return!kT(n,e)}catch{return!0}}function FT(n,t){return t()}var DT=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?FT:NT;p0.useSyncExternalStore=yi.useSyncExternalStore!==void 0?yi.useSyncExternalStore:DT;m0.exports=p0;var BT=m0.exports;const LT=fa(BT);var OT={BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{use:Uf}=im,{useSyncExternalStore:jT}=LT,VT=(n,t)=>{const e=D.useRef();D.useEffect(()=>{e.current=_T(n,t,!0)}),D.useDebugValue(e.current)},UT=new WeakMap;function XT(n,t){const e=t==null?void 0:t.sync,s=D.useRef(),r=D.useRef();let i=!0;const o=jT(D.useCallback(c=>{const h=AT(n,c,e);return c(),h},[n,e]),()=>{const c=Vf(n,Uf);try{if(!i&&s.current&&r.current&&!f0(s.current,c,r.current,new WeakMap))return s.current}catch{}return c},()=>Vf(n,Uf));i=!1;const l=new WeakMap;D.useEffect(()=>{s.current=o,r.current=l}),(OT?"production":void 0)!=="production"&&VT(o,l);const a=D.useMemo(()=>new WeakMap,[]);return u0(o,l,a,UT)}const uh=TT({isMenu:!1,isGame:!1,isPlay:!1,lite:!0}),ms=n=>{try{Object.assign(uh,n),typeof chrome<"u"&&chrome.runtime?chrome.runtime.sendMessage({type:"set-state",payload:n}):console.error("chrome.runtime is not available")}catch{}},ki=()=>{const n=XT(uh);return D.useEffect(()=>{const t=e=>{try{Object.assign(uh,Object.entries(e).reduce((s,[r,{newValue:i}])=>(s[r]=i,s),{}))}catch(s){console.error("Error updating state from storage changes:",s)}};try{typeof chrome<"u"&&chrome.storage&&window.location.href.includes("https://twitter.com/")&&chrome.storage.onChanged.addListener(t)}catch(e){console.error("Error adding storage change listener:",e)}return()=>{try{typeof chrome<"u"&&chrome.storage&&window.location.href.includes("https://twitter.com/")&&chrome.storage.onChanged.removeListener(t)}catch(e){console.error("Error removing storage change listener:",e)}}},[]),n};function GT(){const{games:n}=ft(s=>s.games),t=ki(),e=()=>{n&&(ms({isMenu:t.isMenu}),ms({isGame:!t.isGame}),ms({isPlay:!0}))};return v.jsx("div",{className:"flex items-center justify-center ",children:!t.isGame&&v.jsx("div",{className:"game-list flex ",children:v.jsx(lt,{onClick:e,src:tt("/icons/play-now.gif"),alt:"GIF Button",style:{width:"120px",height:"40px",cursor:"pointer",marginBottom:"20px"}})})})}const YT=()=>{const n=D.useRef();return ki().isGame?v.jsx(v.Fragment,{}):v.jsxs("div",{children:[v.jsx("div",{ref:n,className:"game-tab",children:v.jsx(cl,{path:tt("/img/game-loading/loading.json"),width:400,height:400,id:"game-loading",defaultSkin:"default",animation:"loading",coors:{x:2.1,y:2},scale:{x:.4,y:.4},onComplete:()=>{},loop:!0,refChild:n})}),v.jsx(GT,{})]})},$T=()=>{const{isDisplayPasswordEmpty:n,isDisplayDepositTab:t,isDisplaySwapTab:e,isDisplayWithdrawTab:s,isDisplayChangePassword:r,isDisplayExportWallet:i,isDisplayExportWalletSuccess:o}=ft(c=>c.displaySasa),{isInitialized:l,maintain:a}=ft(c=>c.maintain);return v.jsx("div",{className:"",children:l&&!Ie?v.jsx(Jn,{}):v.jsx(v.Fragment,{children:n?v.jsxs(v.Fragment,{children:[t&&v.jsx(a0,{}),e&&v.jsx(h0,{}),s&&v.jsx(o0,{}),r&&v.jsx($d,{}),i&&v.jsx(l0,{}),o&&v.jsx(c0,{}),!(t||e||s||r||o||i)&&v.jsx(i0,{})]}):v.jsx(Wd,{})})})},WT=()=>{const n=qt(),{isInitialized:t,maintain:e}=ft(N=>N.maintain),{store:s,loading:r}=ft(N=>N.store),{tabActive:i,tabQuestActive:o}=ft(N=>N.displaySasa),l=ki(),{isDisplayDepositTab:a,isDisplayWithdrawTab:c,isDisplayChangePassword:h,isDisplayExportWallet:d,isDisplayExportWalletSuccess:u,isDisplayPasswordEmpty:f,styles:m,saxTheme:p,isDisplaySwapTab:g,isDisplayMyWallet:w,isDisplayMyBag:x}=ft(N=>N.displaySasa),[y,b]=D.useState(!1),{isOpen:_,onClose:E}=ur(),{isOpen:S,onOpen:T,onClose:C}=ur(),A=N=>{n(tc(N)),n(gr()),N===0?(b(!0),!l.isGame&&l.isMenu&&(l.isPlay?ms({isGame:!0}):ms({isGame:!1}),ms({isMenu:l.isMenu}))):(b(!1),ms({isGame:!1}),ms({isMenu:l.isMenu}))},R=()=>{n(qa(!1)),n(Qi(!0))},M=()=>{n(Qi(!1)),n(qa(!0))},I=()=>{n(Qi(!1)),n(qa(!1)),n(tc(1))};return v.jsxs(v.Fragment,{children:[v.jsxs(Jf,{className:`main-tab theme-${p}`,index:i,onChange:N=>A(N),children:[v.jsxs("div",{className:"header-tab",style:m.borderStyle,children:[v.jsxs("div",{className:"left",children:[v.jsxs(xi,{className:"logo",onClick:I,children:[v.jsx(xi,{className:"sasa",children:v.jsx(lt,{src:tt("/img/sasa-768px.png"),alt:"",className:""})}),v.jsx("h1",{style:m.textStyle,children:"XSasa"})]}),v.jsxs("div",{className:"group-btn",children:[v.jsxs(St,{onClick:R,children:[v.jsx(lt,{src:tt(p==="dark"?"/icons/wallet-light.png":"/icons/wallet-dark.png"),alt:"",className:""}),v.jsx("span",{style:m.textStyle,children:"My Wallet"})]}),v.jsxs(St,{onClick:M,children:[v.jsx(lt,{src:tt(p==="dark"?"/icons/my-bag-light.png":"/icons/my-bag-dark.png"),alt:"",className:""}),v.jsx("span",{style:m.textStyle,children:"My Bag"})]})]})]}),v.jsx("div",{className:"right",children:v.jsx(r0,{})})]}),v.jsxs("div",{children:[w&&v.jsx($T,{}),x&&v.jsx(v.Fragment,{children:t&&!Ie?v.jsx(Jn,{}):v.jsx(gT,{})}),!(w||x)&&v.jsxs("div",{children:[v.jsxs(tm,{className:"navigation",children:[v.jsx(rr,{style:i===0?m.tabActiveStyle:m.tabStyle,children:v.jsxs("div",{className:"wrapper-btn",children:[v.jsx(lt,{alt:"game",src:tt(i!==0&&p==="light"?"/icons/joystick-dark.png":"/icons/joystick.png")}),v.jsx("span",{children:"Game"}),v.jsx(lt,{alt:"game",src:tt("/icons/noto-fire.png")})]})}),v.jsx(rr,{style:i===1?m.tabActiveStyle:m.tabStyle,children:v.jsxs("div",{className:"wrapper-btn",children:[v.jsx(lt,{alt:"account",src:tt(i!==1&&p==="light"?"/icons/home-dark.png":"/icons/home.png")}),v.jsx("span",{children:"Account"})]})}),v.jsx(rr,{style:i===2?m.tabActiveStyle:m.tabStyle,children:v.jsxs("div",{className:"wrapper-btn",children:[v.jsx(lt,{alt:"quest",src:tt(i!==2&&p==="light"?"/icons/quest-dark.png":"/icons/quest.png")}),v.jsx("span",{children:G("quest")})]})}),v.jsx(rr,{style:i===3?m.tabActiveStyle:m.tabStyle,children:v.jsxs("div",{className:"wrapper-btn",children:[v.jsx(lt,{alt:"store",src:tt(i!==3&&p==="light"?"/icons/store-dark.png":"/icons/store.png")}),v.jsx("span",{children:G("store")})]})}),v.jsx(rr,{style:i===4?m.tabActiveStyle:m.tabStyle,children:v.jsxs("div",{className:"wrapper-btn",children:[v.jsx(lt,{alt:"referral",src:tt(i!==4&&p==="light"?"/icons/referral-dark.png":"/icons/referral.png")}),v.jsx("span",{children:G("referrals")})]})})]}),v.jsxs(em,{className:"main-tab-panel",children:[v.jsx(kn,{className:"tab-panel-home tab-game",children:t&&!Ie?v.jsx(Jn,{}):v.jsx(YT,{})}),v.jsx(kn,{className:"tab-panel-home",children:t&&!Ie?v.jsx(Jn,{}):v.jsx(qS,{isFetchInventory:y})}),v.jsx(kn,{className:"tab-panel-quest",children:t&&!Ie?v.jsx(Jn,{}):v.jsx(aT,{index:o})}),v.jsx(kn,{className:"tab-panel-store",children:t&&!Ie?v.jsx(Jn,{}):v.jsx(lT,{shopItems:s==null?void 0:s.data,loading:r})}),v.jsx(kn,{className:"tab-panel-referrals",children:v.jsx(cT,{})}),v.jsx(kn,{className:"tab-panel-referrals",children:t&&!Ie?v.jsx(Jn,{}):v.jsx(v.Fragment,{children:f?v.jsxs(v.Fragment,{children:[a&&v.jsx(a0,{}),g&&v.jsx(h0,{}),c&&v.jsx(o0,{}),h&&v.jsx($d,{}),d&&v.jsx(l0,{}),u&&v.jsx(c0,{}),!(a||g||c||h||u||d)&&v.jsx(i0,{})]}):v.jsx(Wd,{})})})]})]})]})]}),v.jsx(hT,{isOpen:S,onClose:C}),v.jsx(dT,{isOpen:_,onClose:E,callback:T})]})},g0=n=>{const{isDeposit:t}=n,e=qt(),s=fx(),{token:r}=ns(),{msgDepositInj:i}=mx(),{handleGetBalance:o}=px(),{isExtension:l}=D.useContext(gx),{isOpen:a,onOpen:c,onClose:h}=ur(),{isOpen:d,onOpen:u,onClose:f}=ur(),{isNoti:m,notiMessage:p,notiStatus:g}=ft(Z=>Z.isNoti),{saxTheme:w,styles:x,isDisplayPasswordEmpty:y,activeCurrency:b}=ft(Z=>Z.displaySasa),{balance:_,injAddress:E}=ft(Z=>Z.balance),[S,T]=D.useState(!0),[C,A]=D.useState(!1),[R,M]=D.useState(""),[I,N]=D.useState(b),[F,B]=D.useState(!1),[Y,O]=D.useState(""),[V,j]=D.useState(""),X={[ke.INJ]:_==null?void 0:_.inj,[ke.ASG]:_==null?void 0:_.asg,[ke.USDT]:_==null?void 0:_.usdt},L=X[I]||"",[U,q]=D.useState("");D.useEffect(()=>{if(H(),!R||R==="0.0"||!I||!C){T(!0);return}else{T(!1);return}},[R,I,C]);const H=async()=>{var Z,nt,gt;try{const rt=(gt=(nt=(Z=xx)==null?void 0:Z.amount)==null?void 0:nt.find(bt=>bt.denom===wa.INJ))==null?void 0:gt.amount;j(bx(Number(rt)*3,6))}catch{}},J=Z=>{Z||M(""),Ex(Z.replaceAll(",",""))&&(Number(Z.replaceAll(",",""))<=Number(L.replaceAll(",",""))?M(Z):M(L.replaceAll(",","")))},Q=Z=>{N(Z),M(""),A(!1)},W=async()=>{try{B(!0);let Z;if(I===ke.INJ)if(Number(R)+Number(V)>Number(_==null?void 0:_.inj)){const nt=`${G("insufficient_funds_for_gas")}`;l?(e(Lt(!0)),e($t("error")),e(Wt(nt))):(s({title:nt,status:"error"}),B(!1)),h()}else Z=await i({toAddress:va,amountTrans:R,denom:wa.INJ,decimals:hl.INJ,memo:U});else if(Number(V)>Number(_.inj)){const nt=`${G("insufficient_funds_for_gas")}`;s(l?{title:nt,status:"error"}:{title:`${G("insufficient_funds_for_gas")}`,status:"error"}),h(),B(!1)}else I===ke.ASG?Z=await i({toAddress:va,amountTrans:R,denom:wa.ASG,decimals:hl.ASG,memo:U}):I===ke.USDT&&(Z=await i({toAddress:va,amountTrans:R,denom:wa.USDT,decimals:hl.USDT,memo:U}));if(Z)if(Z!=null&&Z.code){B(!1);const nt=(Z==null?void 0:Z.rawLog)||"Error";l?(e(Lt(!0)),e($t("error")),e(Wt(nt))):s({title:nt,status:"error"}),h()}else B(!1),O(JSON.stringify(Z==null?void 0:Z.txHash)),M(""),q(""),A(!1),setTimeout(()=>{o(),e(Ks(r))},2e3),u(),h();else{h();const nt=`${G("create_transaction_again")}`;B(!1),l?(e(Lt(!0)),e($t("error")),e(Wt(nt))):s({title:nt,status:"error"})}}catch(Z){l?(e(Lt(!0)),e($t("error")),e(Wt(Z==null?void 0:Z.toString()))):s({title:Z.toString(),status:"error"}),h(),B(!1)}},K=()=>{e(am(!1)),e(yh(!1))};return v.jsx(v.Fragment,{children:y?v.jsxs(v.Fragment,{children:[v.jsxs("div",{className:`deposit-withdraw-to-pool theme-${w} `,children:[v.jsx("h1",{className:"title",children:`${t?"Deposit":"Withdraw"} to SASA Wallet`}),v.jsx("p",{className:"sub-title",children:G("transfer_your_assets")}),v.jsxs("div",{className:"group-address",children:[v.jsxs("div",{className:`from-address ${t?"deposit":""}`,children:[v.jsx("div",{className:"name",children:G("my_wallet")}),v.jsx("div",{className:"address",children:E})]}),v.jsx("div",{className:`from-address ${t?"deposit":""}`,children:v.jsx("div",{className:"name",children:G("sasa_account")})}),v.jsx("div",{className:"group-arrow",children:v.jsx(lt,{src:w==="dark"?tt("/icons/arrow-dark.png"):tt("/icons/arrow-light.png"),alt:""})})]}),v.jsxs("div",{className:"form",children:[v.jsxs("div",{className:"first-form",children:[v.jsxs("div",{className:"amount",children:[v.jsxs("div",{className:"label",children:[v.jsx("h3",{children:G("amount")}),v.jsxs("p",{children:[G("available")," ",X[I]||"0.0"," ",I]})]}),v.jsx("div",{className:"confirm-value",children:v.jsx(Jl,{type:"text",className:"amount",placeholder:"0.00",onChange:Z=>J(Z.target.value),value:R,style:x==null?void 0:x.inputStyle,onBlur:()=>{(R==="0"||Number(R)===0)&&T(!0)}})})]}),v.jsx("div",{className:"currency",children:v.jsx(yx,{getValue:Q,isDeposit:t})})]}),v.jsx("div",{className:"first-form",children:v.jsxs("div",{className:"amount",children:[v.jsx("div",{className:"label",children:v.jsx("h3",{children:G("memo")})}),v.jsx("div",{className:"confirm-value",children:v.jsx(Jl,{type:"text",className:"amount",placeholder:G("enter_memo"),onChange:Z=>q(Z.target.value),value:U,style:x==null?void 0:x.inputStyle})})]})}),v.jsx("div",{className:"note",children:v.jsx(wx,{className:`theme-${w}`,isChecked:C,onChange:Z=>A(Z.target.checked),children:G("confirm_all_information_is_exactly")})}),v.jsxs("div",{className:"group-btn",children:[v.jsx(St,{className:`btn-submit-form cancel theme-${w}`,onClick:K,style:{background:w==="dark"?"#0D0E12":"#F0F0F0",color:w==="dark"?"#fff":"#000",display:"flex",...w==="dark"?x.borderStyle:{border:"none"}},children:G("cancel")}),v.jsx(St,{onClick:c,spinner:null,className:"btn-submit-form submit",style:{background:w==="dark"?"#faad14":"#1890FF",color:w==="dark"?"#000":"#fff",display:"flex"},isLoading:S,loadingText:"Deposit",children:G("deposit")})]})]})]}),v.jsx(vx,{address:va,totalAmount:R,fee:V,currency:I,onConfirm:W,isOpen:a,loading:F,onClose:h}),v.jsx(_x,{isOpen:d,hash:Y,onClose:f}),m&&v.jsx(jn,{onClose:()=>{e(Lt(!1))},message:p,status:g})]}):v.jsx(Wd,{})})},zT=()=>{const n=qt(),t=()=>{n(yh(!1))};return v.jsx(vs,{onClosePage:t,className:"tab-transfer",textClose:G("home"),classNameWrapper:"wallet-wrapper-fh",children:v.jsx("div",{className:"transfer-sasa-wallet",children:v.jsx(g0,{isDeposit:!0})})})},HT=()=>{const n=qt(),t=()=>{n(am(!1))};return v.jsx(vs,{onClosePage:t,className:"tab-transfer",textClose:G("home"),children:v.jsx("div",{className:"transfer-sasa-wallet",children:v.jsx(g0,{})})})},qT=(n,t)=>{const e={method:"POST",url:"/api/v1/auth/otp-binding",data:t,headers:{Authorization:`Bearer ${n}`}};return Vn(e)},KT=(n,t)=>{const e={method:"POST",url:"/api/v1/auth/get-time-resend-otp",data:t,headers:{Authorization:`Bearer ${n}`}};return Vn(e)},ZT=(n,t)=>{const e={method:"POST",url:"/api/v1/auth/input-otp-binding",data:t,headers:{Authorization:`Bearer ${n}`}};return Vn(e)},QT=({timeResendOtp:n,setShowFormOTP:t,handleSendOTP:e})=>{const{token:s}=ns(),{saxTheme:r}=ft(b=>b.displaySasa),{isNoti:i,notiMessage:o,notiStatus:l}=ft(b=>b.isNoti),[a,c]=D.useState(!1),[h,d]=D.useState(!1),[u,f]=D.useState(n||300),[m,p]=D.useState(""),[g,w]=D.useState(""),x=qt();D.useEffect(()=>{chrome.storage.session.get(["emailOTP"],b=>{b!=null&&b.emailOTP&&(t(!0),w(b==null?void 0:b.emailOTP))})},[]),D.useEffect(()=>{const b=setInterval(()=>{u<=0||f(u-1)},1e3);return()=>clearInterval(b)});const y=async()=>{var b,_;if(a){t(!1),x(ea(!1)),chrome.storage.session.set({emailOTP:""});return}d(!0),x(Lt(!0));try{(await ZT(s,{email:g,otp:m})).data.statusCode===200?(x($t("success")),x(Wt(G("successfully"))),x(Ks(s)),x(Sx(g)),chrome.storage.session.set({emailOTP:""}),c(!0)):(x($t("error")),x(Wt(G("error"))))}catch(E){x($t("error")),x(Wt(G(((_=(b=E==null?void 0:E.response)==null?void 0:b.data)==null?void 0:_.message)||"error")))}d(!1)};return v.jsxs("div",{className:`container send-otp theme-${r}`,style:{textAlign:"center"},children:[v.jsx(lt,{src:a?tt("/img/success-img.png"):tt("/img/otp.png"),alt:"verify_email"}),v.jsxs("div",{className:"form-verify-email",children:[a?v.jsxs("div",{className:"box-title-success",style:{color:r==="dark"?"#fff":"#000"},children:[v.jsx("div",{className:"title-success",children:G("verified")}),v.jsx("p",{className:"des",children:G("congratulation_verified_success")})]}):v.jsxs(v.Fragment,{children:[v.jsxs("div",{className:"box-title",style:{color:r==="dark"?"#fff":"#000"},children:[v.jsx("div",{className:"title",children:G("verify_your_email")}),v.jsxs("p",{className:"des",children:[G("enter_otp_text"),v.jsxs("span",{style:{textDecoration:"underline",color:"#1890FF"},children:[" ",g]})]})]}),v.jsxs(gm,{otp:!0,onChange:b=>p(b),children:[v.jsx(Oi,{className:"first"}),v.jsx(Oi,{}),v.jsx(Oi,{}),v.jsx(Oi,{className:"last"})]}),v.jsxs(xi,{className:`text-resend ${u>0?"disable":""}`,onClick:()=>u>0?{}:e({email:g}),children:[G("resend_code")," ",u>0&&v.jsxs("span",{style:{width:"35px",display:"inline-flex"},children:["(",u,"s)"]})]})]}),v.jsx(St,{loadingText:"Submitting",mt:4,style:{background:r==="dark"?"#faad14":"#1890FF",color:r==="dark"?"#000":"#fff",margin:"auto",display:"flex",marginTop:16},isLoading:h,type:"submit",disabled:!0,onClick:()=>m.length!==4?{}:y(),className:`btn-submit-form ${m.length<4?"disable":""}`,children:a?"Back to xSasa":"Verify"}),!a&&v.jsx(xi,{className:"text-change-email",onClick:()=>t(!1),children:G("change_email")})]}),i&&v.jsx(jn,{onClose:()=>{x(Lt(!1))},message:o,status:l})]})},JT=()=>{const n=qt(),{saxTheme:t}=ft(f=>f.displaySasa),{user:e}=ft(f=>f.user),{isNoti:s,notiMessage:r,notiStatus:i}=ft(f=>f.isNoti),[o,l]=D.useState(!1),[a,c]=D.useState(0),{token:h}=ns();D.useEffect(()=>{chrome.storage.session.get(["emailOTP"],f=>{f!=null&&f.emailOTP&&l(!0)})},[]);const d=async f=>{var m,p,g,w;chrome.storage.session.set({emailOTP:f==null?void 0:f.email});try{const x=await qT(h,{email:f==null?void 0:f.email}),y=await KT(h,{email:f==null?void 0:f.email,purpose:"BINDING"});c(Math.floor(Number(y.data||0)-Date.now()/1e3)),((m=x.data)==null?void 0:m.message)==="Success"?(l(!0),n(Lt(!0)),n($t("success")),n(Wt(G("successfully")))):(n($t("error")),n(Wt(G("error_try_again"))))}catch(x){if(((p=x==null?void 0:x.response.data)==null?void 0:p.message)==="ALREADY_SEND_OTP"){n(Lt(!0)),n($t("success")),n(Wt(G("successfully"))),l(!0);return}else((g=x==null?void 0:x.response.data)==null?void 0:g.message)==="EMAIL_ALREADY_EXIST"&&chrome.storage.session.set({emailOTP:""});n(Lt(!0)),n($t("error")),n(Wt(G(((w=x==null?void 0:x.response.data)==null?void 0:w.message)||"error_try_again")))}},u=()=>{if(chrome.storage.session.set({emailOTP:""}),e.email!==""){n(ea(!1));return}if(o){l(!1);return}n(ea(!1))};return v.jsxs(vs,{onClosePage:u,textClose:"Back",isHideBorderHeader:!0,classNameWrapper:"verify-email",style:{background:t==="dark"?"#000":"#fff"},children:[o?v.jsx(QT,{timeResendOtp:a,setShowFormOTP:l,handleSendOTP:d}):v.jsxs("div",{className:`container theme-${t}`,style:{textAlign:"center"},children:[v.jsx(lt,{src:tt("/img/email-box.png"),alt:"verify_email"}),v.jsx(Tx,{initialValues:{email:""},validate:f=>{var g;const m={},p=(g=f==null?void 0:f.email)==null?void 0:g.match(/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}$/i);return f.email||(m.email=`${G("required")}`),f.email?p||(m.email=`${G("enter_email_error")}`):m.email=`${G("required")}`,m},onSubmit:d,children:({isSubmitting:f,touched:m,handleChange:p,handleBlur:g,setFieldTouched:w,isValid:x,values:y})=>v.jsxs(Ax,{className:"form-verify-email",children:[v.jsx(Cx,{name:"email",children:({field:b,form:_})=>v.jsx(kx,{form:_,label:G("enter_email"),field:b,name:"email",touched:m,onChangeBlur:g,onChangeInput:p,setFieldTouched:w,isOpenIcon:!1,isShowStep:!1,values:y,typeIp:"text"})}),v.jsx(St,{loadingText:"Submitting",mt:4,style:{background:t==="dark"?"#faad14":"#1890FF",color:t==="dark"?"#000":"#fff",margin:"auto",display:"flex",marginTop:16},isLoading:f,type:"submit",className:`btn-submit-form ${f||!x?"disable":""}`,children:G("send_OTP")})]})})]}),s&&v.jsx(jn,{onClose:()=>{n(Lt(!1))},message:r,status:i})]})};function tA(){Ix(),Rx(),Mx(),Px();const n=ki(),{token:t}=ns(),{url:e}=Jg(),s=qt(),[r,i]=D.useState({menu:n.isMenu,isOpenNoti:!1}),{isInitialized:o,maintain:l}=ft(U=>U.maintain),{user:a,error:c}=ft(U=>U.user),{games:h}=ft(U=>U.games),{saxTheme:d,styles:u,isDisplayTransferDeposit:f,isDisplayTransferWithdraw:m,isDisplayVerifyEmail:p,isLoginExt:g,isInitLoginExt:w}=ft(U=>U.displaySasa),[x,y]=D.useState(""),[b,_]=D.useState(""),[E,S]=D.useState(""),[T,C]=D.useState(!1),A=D.useRef(null),R=D.useRef(null),[M,I]=D.useState(!1),{tabActive:N}=ft(U=>U.displaySasa);D.useEffect(()=>{if(o&&Ie&&g&&w){const U=document.body,q=()=>{var Q;if(e!==""&&e.includes("/i/flow/login")){const W=document.querySelector('[data-testid="google_sign_in_container"]');if(W){H.disconnect(),W==null||W.getElementsByTagName("iframe")[0].addEventListener("click",()=>{V()});const K=document.querySelector('[data-testid="apple_sign_in_button"]');K&&K.addEventListener("click",()=>{V()});const Z=(Q=W==null?void 0:W.parentElement)==null?void 0:Q.parentElement;Z&&Z.addEventListener("click",()=>{I(!M)})}}},H=new MutationObserver(q),J={attributes:!0,childList:!0,subtree:!0};H.observe(U,J)}},[e,o,l.ALL]),D.useEffect(()=>{if(o&&Ie&&g&&w){const U=document.body,q=()=>{if(e!==""&&e.includes("/i/flow/login")){const Q=document.querySelectorAll('[data-testid="LoginForm_Login_Button"]');Q&&(Q==null?void 0:Q.length)>0&&(H.disconnect(),Q[0].addEventListener("click",()=>{V()}))}},H=new MutationObserver(q),J={attributes:!0,childList:!0,subtree:!0};H.observe(U,J)}},[e,o,l.ALL,M,Ki,g,s,w]),D.useEffect(()=>{const U=localStorage.getItem("isMenuOpen");i(q=>({...q,menu:U==="true"})),ms({isMenu:U==="true"})},[]),D.useEffect(()=>{i(U=>({...U,menu:n.isMenu}))},[n]);const F=()=>{i(U=>({...U,menu:!U.menu})),!r.menu&&N===0&&t?n.isPlay?ms({isGame:!0}):ms({isGame:!1}):ms({isGame:!1}),localStorage.setItem("isMenuOpen","true"),ms({isMenu:!r.menu})};D.useEffect(()=>{c.toLowerCase()==="error"&&V()},[c]),D.useEffect(()=>{g&&t&&w&&(B(),s(Ks(t)),s(sm(t)),s(om(t)))},[g,t,w]);const B=async()=>{try{s(qs(t)),s(Do({accessToken:t,type:Yt.FRAGMENT}))}catch{}};D.useEffect(()=>{o&&Ie&&Y()},[o,l]),D.useEffect(()=>{o&&Ie&&O()},[h,l]);const Y=async()=>{try{s(Nx()),s(Fx())}catch{}},O=async()=>{var U;try{h&&(h==null?void 0:h.length)>0&&(h!=null&&h.find(q=>q.name==="Harvest Heist"))&&s(Dx((U=h==null?void 0:h.find(q=>q.name==="Harvest Heist"))==null?void 0:U.id))}catch{}};D.useEffect(()=>{t?(s(Ki(!0)),s(Jd(!0)),s(za(!0))):(s(Jd(!0)),s(za(!1)))},[t,s]);const V=()=>{s(za(!1)),chrome.storage.local.clear(),chrome.storage.session.clear(),localStorage.removeItem(Et.QUEST_PROGRESS),s(Ki(!1))},j=U=>{y(U)},X=async()=>{var U,q,H,J;try{if(x&&t)try{const Q=await Bx(t,{code:x});i(W=>({...W,isOpenNoti:!0})),_(((q=(U=Q==null?void 0:Q.data)==null?void 0:U.data)==null?void 0:q.message)||"Success"),S("success"),C(!0)}catch(Q){i(W=>({...W,isOpenNoti:!0})),_(G((J=(H=Q==null?void 0:Q.response)==null?void 0:H.data)==null?void 0:J.message)||"Error"),S("error")}}catch{}};D.useEffect(()=>{chrome.storage.session.get(["emailOTP"],U=>{U!=null&&U.emailOTP&&s(ea((U==null?void 0:U.emailOTP)!==""))})},[]),D.useEffect(()=>(A!==null&&A.current&&A.current.addEventListener("load",L),()=>{var U;return(U=A==null?void 0:A.current)==null?void 0:U.removeEventListener("load",L)}));const L=()=>{R!=null&&R.current&&(R==null||R.current.classList.add("hidden"))};return e.startsWith(ph)&&v.jsxs("div",{className:`menu ${r.menu?"open-menu-wrapper":"close-menu-wrapper"}`,style:u.bgStyle,children:[r.isOpenNoti&&v.jsx(jn,{onClose:()=>{i(U=>({...U,isOpenNoti:!1}))},message:b,status:E}),v.jsx(WS,{className:"open-menu-btn",onclick:F}),v.jsx("div",{className:"menu-content open-menu",style:{borderColor:d==="dark"?"rgba(255, 255, 255, 0.2)":"rgb(209, 217, 221)"},children:w?v.jsxs(v.Fragment,{children:[o&&!Ie&&v.jsx(Jn,{}),o&&Ie&&(g?v.jsx(v.Fragment,{children:v.jsxs("div",{className:"login",children:[a!=null&&a.userId&&!a.ref&&!T?v.jsx($S,{getDataInput:j,confirmReferralCode:X}):v.jsxs(v.Fragment,{children:[f&&v.jsx(zT,{}),m&&v.jsx(HT,{}),!(f||m)&&v.jsx(WT,{})]}),p&&v.jsx(JT,{})]})}):v.jsxs("div",{className:"logout",children:[v.jsx(lt,{className:"exten-logo",src:tt("/img/sa.png"),alt:"home"}),v.jsx(St,{style:{background:d==="dark"?"#faad14":"#1890FF",color:d==="dark"?"#000":"#fff"},onClick:Im,children:G("login")})]}))]}):v.jsx(n0,{})}),o&&Ie&&v.jsx(YS,{theme:d,url:e})]})}const eA=({level:n,currentCostumeId:t})=>{const e=D.useRef(),[s,r]=D.useState("");return D.useEffect(()=>{t===Ze.DEFAULT?r(xe.DEFAULT):t===Ze.LEVEL1?r(xe.LEVEL1):t===Ze.LEVEL2?r(xe.LEVEL2):r(xe.LEVEL3)},[t]),v.jsxs(v.Fragment,{children:[v.jsx("div",{ref:e,id:"12312312312dsfsdf",style:{pointerEvents:"none"},children:s!==""&&v.jsx(cl,{path:tt("/img/sasaAnim/sasadance.json"),width:280,height:150,id:"sasa",defaultSkin:s,animation:"idle",coors:{x:2.4,y:1.1},scale:{x:.08,y:.08},onComplete:()=>{},loop:!0,refChild:e})}),v.jsxs(dn,{style:{fontSize:"14px",textAlign:"center"},children:["Lv: ",n]})]})},Xf=({isAuth:n,userReward:t})=>{const e={width:"70px",height:"auto"};return v.jsx(v.Fragment,{children:n?t&&(t==null?void 0:t.freeTimes)>0&&((t==null?void 0:t.lastTimeClaim)===0||((t==null?void 0:t.lastTimeClaim)+lm)*1e3<=new Date().getTime())&&v.jsx(lt,{className:"gold",src:tt("/img/gif/bag.gif"),alt:"sasa",style:e}):v.jsx(lt,{className:"gold",src:tt("/img/gif/bag.gif"),alt:"sasa",style:e})})};function Gf(){const n={width:"150px",height:"auto"};return v.jsx(v.Fragment,{children:v.jsx(lt,{className:"gold",src:tt("/img/gif/bag-open.gif"),alt:"sasa",style:n})})}const sA=({isAuth:n,userReward:t,fetchData:e})=>{const{token:s}=ns(),[r,i]=D.useState(!1),[o,l]=D.useState(),[a,c]=D.useState(!1),[h,d]=D.useState(!0),[u,f]=D.useState(""),m=async()=>{var p;if(s)try{c(!0);const w=new URL(window.location.href).pathname.split("/").pop(),x=await Lx(s,w||"");x.data.statusCode===200&&(c(!1),i(!0),e(),l((p=x==null?void 0:x.data)==null?void 0:p.data),d(!0),f("success"))}catch{return d(!0),f("error"),c(!1),null}finally{c(!1)}};return v.jsx(v.Fragment,{children:n?t&&(t==null?void 0:t.freeTimes)>0&&((t==null?void 0:t.lastTimeClaim)===0||((t==null?void 0:t.lastTimeClaim)+lm)*1e3<=new Date().getTime())&&v.jsxs(v.Fragment,{children:[v.jsx(Gf,{}),r?v.jsxs(v.Fragment,{children:[v.jsx(dn,{fontWeight:700,style:{fontSize:"20px",marginTop:"8px",marginBottom:"8px"},children:G("golden_bag_open_title")}),v.jsxs(dn,{style:{fontSize:"12px",marginBottom:"8px"},children:[G("golden_bag_open_content_1")," ",o!==void 0&&v.jsxs("span",{style:{color:"#faad14"},children:[(o==null?void 0:o.goldReward)>0?`${o==null?void 0:o.goldReward} ${(o==null?void 0:o.goldReward)>1?"Golds":"Gold"}`:"",(o==null?void 0:o.chestReward)>0?` and ${o==null?void 0:o.chestReward} ${(o==null?void 0:o.chestReward)>1?"Keys":"Key"}`:""]}),G("golden_bag_open_content_2")]})]}):v.jsxs(v.Fragment,{children:[v.jsx(dn,{fontWeight:700,style:{fontSize:"20px",marginTop:"8px",marginBottom:"8px"},children:G("open_treasure")}),v.jsxs(dn,{style:{fontSize:"12px",marginBottom:"8px"},children:[G("golden_bag_des_1"),' "',v.jsx("span",{style:{color:"#faad14"},children:Rr.HASHTAG}),v.jsx("span",{style:{color:"#faad14"},children:G("golden_bag_des_2")}),v.jsx("span",{style:{color:"#faad14"},children:Rr.TOKEN}),v.jsx("span",{style:{color:"#faad14"},children:G("golden_bag_des_3")}),v.jsx("span",{style:{color:"#faad14"},children:Rr.SAWORLD}),'" ',G("golden_bag_des_4")]}),v.jsx(St,{onClick:m,style:{backgroundColor:"#faad14",color:"#000"},isLoading:a,borderRadius:"20px",padding:"6px 8px",border:"none",fontWeight:600,fontFamily:"'Sora', sans-serif",cursor:"pointer",children:G("golden_bag_button")}),h&&u==="error"&&v.jsx(dn,{style:{fontSize:"14px",marginBottom:"8px",color:"red",textAlign:"center"},children:G("golden_bag_des")})]})]}):v.jsxs(v.Fragment,{children:[v.jsx(Gf,{}),v.jsx(dn,{fontWeight:700,style:{fontSize:"20px",marginTop:"8px",marginBottom:"8px"},children:G("open_treasure")}),v.jsxs(dn,{style:{fontSize:"12px",marginBottom:"8px"},children:[G("golden_bag_des_1"),' "',v.jsx("span",{style:{color:"#faad14"},children:Rr.HASHTAG}),v.jsx("span",{style:{color:"#faad14"},children:G("golden_bag_des_2")}),v.jsx("span",{style:{color:"#faad14"},children:Rr.TOKEN}),v.jsx("span",{style:{color:"#faad14"},children:G("golden_bag_des_3")}),v.jsx("span",{style:{color:"#faad14"},children:Rr.SAWORLD}),'" ',G("golden_bag_des_4")]}),v.jsx(St,{onClick:Im,background:"white",textColor:"black",borderRadius:"20px",padding:"6px 8px",border:"none",fontWeight:600,style:{backgroundColor:"#faad14",color:"#000"},cursor:"pointer",children:G("login")})]})})},nA=async(n,t)=>{let e=n;if(n){let s;try{s=Ox(n)}catch{return}const r=s==null?void 0:s.exp;if(r&&Date.now()>=r*1e3){const i=t;if(i)try{await jx(i).then(o=>{var a;const l=(a=o==null?void 0:o.data)==null?void 0:a.accessToken;l&&(chrome.storage.local.set({sax_access_token:l}),localStorage.setItem(Et.ACCESS_TOKEN,l),e=l)})}catch(o){throw chrome.storage.local.remove(Et.ACCESS_TOKEN),chrome.storage.local.remove(Et.REFRESH_TOKEN),o}else return}else localStorage.setItem(Et.ACCESS_TOKEN,n),e=n}return e},rA=({...n})=>{const[t,e]=D.useState({click:!1,showHide:!0,playStatus:!1}),s=D.useRef(null);return D.useEffect(()=>{const r=o=>{if(o.origin===sc&&o.data==="LOADING_COMPLETE"){e({...t,playStatus:!0});let l="",a="";chrome.storage.local.get([Et.ACCESS_TOKEN],async function(c){l=c.sax_access_token}),chrome.storage.local.get([Et.REFRESH_TOKEN],async function(c){a=c.sax_refresh_token}),setTimeout(()=>{s.current&&i(l,a).then(c=>{s.current.contentWindow.postMessage(`${c}`,sc)}),e({...t,click:!0})},2e3)}},i=(o,l)=>new Promise((a,c)=>{try{(async()=>{try{return await nA(o,l)}catch{}})().then(d=>{a(d)})}catch(h){c(h)}});return window.addEventListener("message",r),()=>{window.removeEventListener("message",r)}},[]),v.jsx("div",{style:{maxWidth:"566px",display:"flex",flexDirection:"column",alignContent:"center",justifyContent:"center"},children:v.jsxs("div",{style:{height:"fit-content",position:"relative",maxWidth:"566px",backgroundColor:"#0000"},children:[v.jsx("iframe",{id:"iframeGame",ref:s,className:"iframe-game",src:n.iframeURL,name:"gameFrame",frameBorder:"0",scrolling:"no",allowFullScreen:!0,allow:"clipboard-read; clipboard-write",style:{overflow:"hidden",margin:"auto",width:n!=null&&n.width?n.width:"100%",minHeight:n!=null&&n.height?n.height:"22rem",maxHeight:n!=null&&n.height?"75dvh":"22rem",borderRadius:"10px",aspectRatio:`${n.data.ratio}`},title:n.data.name,children:"BROWSER_NOT_SUPPORT"}),t.playStatus&&v.jsx("div",{style:t.click?{display:"none"}:{display:"flex",position:"absolute",top:0,left:0,justifyContent:"center",alignItems:"end",width:"100%",minHeight:n!=null&&n.height?n.height:"22rem",maxHeight:n!=null&&n.height?"75dvh":"22rem",borderRadius:"10px",aspectRatio:`${n.data.ratio}`}})]})})};var qd={};qd.match=hA;qd.parse=x0;var iA=/(?:(only|not)?\s*([^\s\(\)]+)(?:\s*and)?\s*)?(.+)?/i,aA=/\(\s*([^\s\:\)]+)\s*(?:\:\s*([^\s\)]+))?\s*\)/,oA=/^(?:(min|max)-)?(.+)/,lA=/(em|rem|px|cm|mm|in|pt|pc)?$/,cA=/(dpi|dpcm|dppx)?$/;function hA(n,t){return x0(n).some(function(e){var s=e.inverse,r=e.type==="all"||t.type===e.type;if(r&&s||!(r||s))return!1;var i=e.expressions.every(function(o){var l=o.feature,a=o.modifier,c=o.value,h=t[l];if(!h)return!1;switch(l){case"orientation":case"scan":return h.toLowerCase()===c.toLowerCase();case"width":case"height":case"device-width":case"device-height":c=Wf(c),h=Wf(h);break;case"resolution":c=$f(c),h=$f(h);break;case"aspect-ratio":case"device-aspect-ratio":case"device-pixel-ratio":c=Yf(c),h=Yf(h);break;case"grid":case"color":case"color-index":case"monochrome":c=parseInt(c,10)||1,h=parseInt(h,10)||0;break}switch(a){case"min":return h>=c;case"max":return h<=c;default:return h===c}});return i&&!s||!i&&s})}function x0(n){return n.split(",").map(function(t){t=t.trim();var e=t.match(iA),s=e[1],r=e[2],i=e[3]||"",o={};return o.inverse=!!s&&s.toLowerCase()==="not",o.type=r?r.toLowerCase():"all",i=i.match(/\([^\)]+\)/g)||[],o.expressions=i.map(function(l){var a=l.match(aA),c=a[1].toLowerCase().match(oA);return{modifier:c[1],feature:c[2],value:a[2]}}),o})}function Yf(n){var t=Number(n),e;return t||(e=n.match(/^(\d+)\s*\/\s*(\d+)$/),t=e[1]/e[2]),t}function $f(n){var t=parseFloat(n),e=String(n).match(cA)[1];switch(e){case"dpcm":return t/2.54;case"dppx":return t*96;default:return t}}function Wf(n){var t=parseFloat(n),e=String(n).match(lA)[1];switch(e){case"em":return t*16;case"rem":return t*16;case"cm":return t*96/2.54;case"mm":return t*96/2.54/10;case"in":return t*96;case"pt":return t*72;case"pc":return t*72/12;default:return t}}var dA=qd.match,zf=typeof window<"u"?window.matchMedia:null;function uA(n,t,e){var s=this,r;zf&&!e&&(r=zf.call(window,n)),r?(this.matches=r.matches,this.media=r.media,r.addListener(l)):(this.matches=dA(n,t),this.media=n),this.addListener=i,this.removeListener=o,this.dispose=a;function i(c){r&&r.addListener(c)}function o(c){r&&r.removeListener(c)}function l(c){s.matches=c.matches,s.media=c.media}function a(){r&&r.removeListener(l)}}function fA(n,t,e){return new uA(n,t,e)}var mA=fA;const pA=fa(mA);var gA=/[A-Z]/g,xA=/^ms-/,Ql={};function bA(n){return"-"+n.toLowerCase()}function b0(n){if(Ql.hasOwnProperty(n))return Ql[n];var t=n.replace(gA,bA);return Ql[n]=xA.test(t)?"-"+t:t}function yA(n,t){if(n===t)return!0;if(!n||!t)return!1;const e=Object.keys(n),s=Object.keys(t),r=e.length;if(s.length!==r)return!1;for(let i=0;i<r;i++){const o=e[i];if(n[o]!==t[o]||!Object.prototype.hasOwnProperty.call(t,o))return!1}return!0}const qe=Ht.oneOfType([Ht.string,Ht.number]),Kd={all:Ht.bool,grid:Ht.bool,aural:Ht.bool,braille:Ht.bool,handheld:Ht.bool,print:Ht.bool,projection:Ht.bool,screen:Ht.bool,tty:Ht.bool,tv:Ht.bool,embossed:Ht.bool},y0={orientation:Ht.oneOf(["portrait","landscape"]),scan:Ht.oneOf(["progressive","interlace"]),aspectRatio:Ht.string,deviceAspectRatio:Ht.string,height:qe,deviceHeight:qe,width:qe,deviceWidth:qe,color:Ht.bool,colorIndex:Ht.bool,monochrome:Ht.bool,resolution:qe,type:Object.keys(Kd)},{type:bk,...wA}=y0,w0={minAspectRatio:Ht.string,maxAspectRatio:Ht.string,minDeviceAspectRatio:Ht.string,maxDeviceAspectRatio:Ht.string,minHeight:qe,maxHeight:qe,minDeviceHeight:qe,maxDeviceHeight:qe,minWidth:qe,maxWidth:qe,minDeviceWidth:qe,maxDeviceWidth:qe,minColor:Ht.number,maxColor:Ht.number,minColorIndex:Ht.number,maxColorIndex:Ht.number,minMonochrome:Ht.number,maxMonochrome:Ht.number,minResolution:qe,maxResolution:qe,...wA},vA={...Kd,...w0};var _A={all:vA,types:Kd,matchers:y0,features:w0};const EA=n=>`not ${n}`,SA=(n,t)=>{const e=b0(n);return typeof t=="number"&&(t=`${t}px`),t===!0?e:t===!1?EA(e):`(${e}: ${t})`},TA=n=>n.join(" and "),AA=n=>{const t=[];return Object.keys(_A.all).forEach(e=>{const s=n[e];s!=null&&t.push(SA(e,s))}),TA(t)},CA=D.createContext(void 0),kA=n=>n.query||AA(n),Hf=n=>n?Object.keys(n).reduce((e,s)=>(e[b0(s)]=n[s],e),{}):void 0,v0=()=>{const n=D.useRef(!1);return D.useEffect(()=>{n.current=!0},[]),n.current},IA=n=>{const t=D.useContext(CA),e=()=>Hf(n)||Hf(t),[s,r]=D.useState(e);return D.useEffect(()=>{const i=e();yA(s,i)||r(i)},[n,t]),s},RA=n=>{const t=()=>kA(n),[e,s]=D.useState(t);return D.useEffect(()=>{const r=t();e!==r&&s(r)},[n]),e},MA=(n,t)=>{const e=()=>pA(n,t||{},!!t),[s,r]=D.useState(e),i=v0();return D.useEffect(()=>{if(i){const o=e();return r(o),()=>{o&&o.dispose()}}},[n,t]),s},PA=n=>{const[t,e]=D.useState(n.matches);return D.useEffect(()=>{const s=r=>{e(r.matches)};return n.addListener(s),e(n.matches),()=>{n.removeListener(s)}},[n]),t},NA=(n,t,e)=>{const s=IA(t),r=RA(n);if(!r)throw new Error("Invalid or missing MediaQuery!");const i=MA(r,s),o=PA(i),l=v0();return D.useEffect(()=>{l&&e&&e(o)},[o]),D.useEffect(()=>()=>{i&&i.dispose()},[]),o},FA=({content:n})=>{const t=ki();return v.jsx("div",{className:`accordion-item ${t.isGame?"open":""}`,style:{display:"flex",justifyItems:"center",alignItems:"center"},children:v.jsx("div",{className:"accordion-content",style:t.isGame?{display:"block",opacity:1,transition:"opacity 0.5s ease-in-out",height:"auto"}:{display:"none",opacity:0,transition:"opacity 0.5s ease-in-out",height:0},children:n})})},DA=({data:n,fetchUserInfoBalance:t})=>{const e=ki(),s=NA({query:"(max-width: 1280px)"}),r=[{image:tt("/icons/right-light.png"),content:v.jsx(rA,{width:s?"355px":"450px",height:"64dvh",iframeURL:sc+n.url,data:n})}];return v.jsx("div",{className:"accordion",style:e.isGame?{position:"fixed",top:192,right:20,zIndex:9999999999}:{position:"fixed",top:150,right:20,zIndex:1},children:v.jsx(FA,{image:r[0].image,content:r[0].content,fetchUserInfoBalance:t})})};function BA(){var _,E,S,T,C,A,R;const{url:n}=Jg(),{token:t}=ns(),e=qt(),{isInitialized:s,maintain:r}=ft(M=>M.maintain),{user:i,userReward:o}=ft(M=>M.user),{games:l}=ft(M=>M.games),{isAuthenticated:a}=ft(M=>M.auth),{isChangeQuest:c}=ft(M=>M.listQuests),[h,d]=D.useState([]),[u,f]=D.useState(void 0),[m,p]=D.useState(!1),[g,w]=D.useState(!1);let x=!1;D.useEffect(()=>{s&&Ie&&e(Vx())},[e,s,r]),D.useEffect(()=>{x||(async()=>{try{!x&&l&&(l==null?void 0:l.length)>0&&(x=!0,l.length>0&&(Ie?Ie:!r.PLAY)&&l.map(I=>{I.name.trim()==="Harvest Heist"&&f(I)}),d(l))}catch(I){console.error("Error fetching data:",I)}})()},[l,r]),D.useEffect(()=>{if(s&&Ie){const M=document.body,I=()=>{var Y,O,V,j,X,L,U,q;const B=document.querySelectorAll('[data-testid="Tweet-User-Avatar"]');if(B&&(B==null?void 0:B.length)>0&&(N.disconnect(),n!=="")){if(n.includes("/home")||n.includes("/explore")){const H=Math.floor(Math.random()*((B==null?void 0:B.length)>5?5:B==null?void 0:B.length));document.querySelector(".reward-box")&&document.querySelector(".reward-box").remove();const J=(V=(O=(Y=B[H===0?0:H-1])==null?void 0:Y.getElementsByTagName("div")[2])==null?void 0:O.dataset)==null?void 0:V.testid,Q=(U=(L=(X=(j=B[H===0?0:H-1])==null?void 0:j.parentElement)==null?void 0:X.parentElement)==null?void 0:L.getElementsByTagName("time")[0])==null?void 0:U.dateTime;if(localStorage.setItem(Et.GOLDEN_BAG,J+","+Q),Q){const W=document.createElement("div");W.className="reward-box",W.style.position="absolute",W.style.top="40px",W.style.left="-17px",W.style.zIndex="1000000",Mr(W).render(v.jsx(Xf,{isAuth:a,userReward:o})),B[H===0?0:H-1].appendChild(W)}J!==localStorage.getItem(Et.GOLDEN_BAG).split(",")[0]&&document.querySelector(".reward-box").remove(),window.addEventListener("scroll",function(){var Z,nt,gt,rt,bt,Ct;const W=document.querySelector(`[data-testid=${localStorage.getItem(Et.GOLDEN_BAG).split(",")[0]}]`),K=(Ct=(bt=(rt=(gt=(nt=(Z=W==null?void 0:W.parentElement)==null?void 0:Z.parentElement)==null?void 0:nt.parentElement)==null?void 0:gt.parentElement)==null?void 0:rt.parentElement)==null?void 0:bt.getElementsByTagName("time")[0])==null?void 0:Ct.dateTime;if(K&&document.querySelector(".reward-box")===null&&localStorage.getItem(Et.GOLDEN_BAG).split(",")[1]===K){const jt=document.createElement("div");jt.className="reward-box",jt.style.position="absolute",jt.style.top="40px",jt.style.left="-17px",jt.style.zIndex="1000000",Mr(jt).render(v.jsx(Xf,{isAuth:a,userReward:o})),W.appendChild(jt)}})}else if(n.includes("/status/")&&document.querySelector(`[data-testid=${localStorage.getItem(Et.GOLDEN_BAG).split(",")[0]}]`)!==null){const J=document.querySelectorAll('[data-testid="tweet"]');if(J[0].classList.add("r-eqz5dr"),J&&((q=J[0].getElementsByTagName("time")[0])==null?void 0:q.dateTime)===localStorage.getItem(Et.GOLDEN_BAG).split(",")[1]){const Q=document.createElement("div");Q.className="open-reward-box",Q.style.display="flex",Q.style.flexDirection="column",Q.style.justifyContent="center",Q.style.alignItems="center",Q.style.fontFamily="'Sora', sans-serif",Mr(Q).render(v.jsx(sA,{isAuth:a,userReward:o,fetchData:()=>{y(),b()}})),J[0].append(Q),localStorage.removeItem("user")}}}},N=new MutationObserver(I),F={attributes:!0,childList:!0,subtree:!0};if(N.observe(M,F),n.startsWith(Ux)){const B=new URLSearchParams(document.location.search),Y=B.get("accessToken"),O=B.get("refreshToken");Y&&O&&(chrome.storage.local.set({[Et.ACCESS_TOKEN]:Y}),chrome.storage.local.set({sax_refresh_token:O}),window.location.replace(ph))}}},[n,i==null?void 0:i.id,(_=i==null?void 0:i.currentCharacter)==null?void 0:_.currentLevel,(E=i==null?void 0:i.currentCharacter)==null?void 0:E.currentCostumeId]),D.useEffect(()=>{var M;if(localStorage.getItem(Et.QUEST_PROGRESS)&&JSON.parse(localStorage.getItem(Et.QUEST_PROGRESS))){const I=(M=JSON.parse(localStorage.getItem(Et.QUEST_PROGRESS)))==null?void 0:M.filter(N=>N.questMode!==Fn.DAILY||N.questMode===Fn.DAILY&&N.endAt>new Date().getTime());localStorage.setItem(Et.QUEST_PROGRESS,JSON.stringify(I))}},[]),D.useEffect(()=>{var I;const M=document.body;if(localStorage.getItem(Et.QUEST_PROGRESS)&&JSON.parse(localStorage.getItem(Et.QUEST_PROGRESS))&&((I=JSON.parse(localStorage.getItem(Et.QUEST_PROGRESS)))==null?void 0:I.find(N=>N.targetUrl.toString()===n.toString()))!==void 0){const N=Y=>{var V;const O=(V=JSON.parse(localStorage.getItem(Et.QUEST_PROGRESS)))==null?void 0:V.find(j=>j.targetUrl.toString()===n.toString());if((O==null?void 0:O.socialMode)===Ys.REPLY){for(const X of Y)(X.type==="childList"||X.type==="attributes")&&p(!m);const j=document.querySelectorAll('[data-testid="tweetButtonInline"]');(j==null?void 0:j.length)>0&&F.disconnect()}else(O==null?void 0:O.socialMode)===Ys.RE_POST&&g&&document.querySelector('[data-testid="Dropdown"]')!==null&&(F.disconnect(),document.querySelector('[data-testid="retweetConfirm"]').addEventListener("click",()=>{e(Hr(!c))}),document.querySelector('[data-testid="unretweetConfirm"]').addEventListener("click",()=>{e(Hr(!c))}))},F=new MutationObserver(N),B={attributes:!0,childList:!0,subtree:!0};F.observe(M,B)}},[n,e,g,c,m]),D.useEffect(()=>{const M=document.body,I=B=>{var Y,O,V,j,X,L,U,q,H,J;if(localStorage.getItem(Et.QUEST_PROGRESS)&&JSON.parse(localStorage.getItem(Et.QUEST_PROGRESS))&&((Y=JSON.parse(localStorage.getItem(Et.QUEST_PROGRESS)))==null?void 0:Y.find(Q=>Q.targetUrl.toString()===n.toString()))!==void 0){const Q=(O=JSON.parse(localStorage.getItem(Et.QUEST_PROGRESS)))==null?void 0:O.find(W=>W.targetUrl.toString()===n.toString());if((Q==null?void 0:Q.socialMode)===Ys.FOLLOW){const W=document.querySelector('[data-testid="userActions"]');if(W){N.disconnect();const K=W.parentElement.querySelector('[data-testid="placementTracking"]');for(const Z of B)(Z.type==="childList"||Z.type==="attributes")&&p(!m);if((K==null?void 0:K.getElementsByTagName("span")[0].textContent)==="Following"){const Z=(V=JSON.parse(localStorage.getItem(Et.QUEST_PROGRESS)))==null?void 0:V.map(nt=>nt.targetUrl.toString()===n.toString()?{...nt,completed:!0}:nt);localStorage.setItem(Et.QUEST_PROGRESS,JSON.stringify(Z)),e(Hr(!c))}else if((K==null?void 0:K.getElementsByTagName("span")[0].textContent)==="Follow"){const Z=(j=JSON.parse(localStorage.getItem(Et.QUEST_PROGRESS)))==null?void 0:j.map(nt=>nt.targetUrl.toString()===n.toString()?{...nt,completed:!1}:nt);localStorage.setItem(Et.QUEST_PROGRESS,JSON.stringify(Z)),e(Hr(!c))}}}else{const W=document.querySelectorAll('[data-testid="Tweet-User-Avatar"]');if(W&&(W==null?void 0:W.length)>0&&(N.disconnect(),n!=="")){const K=document.querySelectorAll('[data-testid="tweet"]');if(K){K[0].addEventListener("click",()=>{p(!m)});let Z;if((Q==null?void 0:Q.socialMode)===Ys.LIKE)K[0].querySelector('[data-testid="unlike"]')?Z=!0:Z=!1;else if((Q==null?void 0:Q.socialMode)===Ys.RE_POST){const nt=K[0].querySelector('[data-testid="retweet"]');nt&&nt.ariaExpanded==="true"&&w(!0),K[0].querySelector('[data-testid="unretweet"]')?Z=!0:Z=!1}else if((Q==null?void 0:Q.socialMode)===Ys.REPLY){for(let nt=0;nt<K.length;nt++)if(((U=(L=(X=K[nt].querySelector('[data-testid="User-Name"]'))==null?void 0:X.getElementsByTagName("a")[1])==null?void 0:L.getElementsByTagName("span")[0])==null?void 0:U.textContent)===`@${i==null?void 0:i.socialUsername}`){const rt=(q=K[nt].querySelector('[data-testid="tweetText"]'))==null?void 0:q.getElementsByTagName("span");let bt="";for(let Ct=0;Ct<rt.length;Ct++)bt+=rt[Ct].textContent;if(bt.includes(Rr.REPLY)){Z=!0;break}else{Z=!1;break}}}if(Z){const nt=(H=JSON.parse(localStorage.getItem(Et.QUEST_PROGRESS)))==null?void 0:H.map(gt=>gt.targetUrl.toString()===n.toString()?{...gt,completed:!0}:gt);localStorage.setItem(Et.QUEST_PROGRESS,JSON.stringify(nt)),e(Hr(!c))}else{const nt=(J=JSON.parse(localStorage.getItem(Et.QUEST_PROGRESS)))==null?void 0:J.map(gt=>gt.targetUrl.toString()===n.toString()?{...gt,completed:!1}:gt);localStorage.setItem(Et.QUEST_PROGRESS,JSON.stringify(nt)),e(Hr(!c))}}}}}},N=new MutationObserver(I),F={attributes:!0,childList:!0,subtree:!0};N.observe(M,F)},[n,i==null?void 0:i.id,m,c,g,e,i==null?void 0:i.socialUsername]),D.useEffect(()=>{const M=document.body,I=()=>{var Y,O,V;const B=document.querySelector('[data-testid="editProfileButton"]');if(B!==null&&(i==null?void 0:i.id)!==void 0&&((Y=i==null?void 0:i.currentCharacter)!=null&&Y.currentLevel)){N.disconnect();const j=document.querySelector(".sasa-profile");j&&j.remove();const X=document.createElement("div");X.className="sasa-profile",X.style.position="absolute",X.style.left="-280px",X.style.top="-100px",Mr(X).render(v.jsx(eA,{level:(O=i==null?void 0:i.currentCharacter)==null?void 0:O.currentLevel,currentCostumeId:(V=i==null?void 0:i.currentCharacter)==null?void 0:V.currentCostumeId})),B.appendChild(X)}},N=new MutationObserver(I),F={attributes:!0,childList:!0,subtree:!0};N.observe(M,F)},[n,i==null?void 0:i.id,(S=i==null?void 0:i.currentCharacter)==null?void 0:S.currentLevel,(T=i==null?void 0:i.currentCharacter)==null?void 0:T.currentCostumeId]),D.useEffect(()=>{const M=document.body,I=()=>{const B=document.querySelectorAll('[data-testid="Tweet-User-Avatar"]'),Y=document.querySelectorAll('[data-testid="tweet"]'),O=document.querySelectorAll('div[role="dialog"]'),V=document.querySelector("#react-root");if(h.length>0&&u&&O&&O.length===0&&B)try{const j=document.createElement("div");j.className="play-game-box",j.style.zIndex="1000000",j.style.order="1",Mr(j).render(v.jsx(DA,{data:u,fetchUserInfoBalance:y})),Y&&Y.length>0&&V&&!V.querySelector(".play-game-box")&&V.appendChild(j)}catch(j){console.error("error",j)}},N=new MutationObserver(I),F={attributes:!0,childList:!0,subtree:!0};N.observe(M,F)},[h,n,i==null?void 0:i.id,(C=i==null?void 0:i.currentCharacter)==null?void 0:C.currentLevel,(A=i==null?void 0:i.currentCharacter)==null?void 0:A.currentCostumeId,(R=document.querySelectorAll('[data-testid="tweet"]'))==null?void 0:R.length,u]);const y=()=>{s&&Ie&&t&&(e(Ks(t)),e(om(t)))},b=()=>{t&&e(qs(t))};return null}const Un=document.createElement("div");Un.id="chrome-extension-boilerplate-react-vite-content-view-root";Un.style.position="fixed";Un.style.top="0px";Un.style.right="0px";Un.style.bottom="0px";Un.style.zIndex="10000";document.body.append(Un);const wi=document.createElement("div");wi.id="shadow-root";wi.style.height="100%";const Zd=Un.attachShadow({mode:"open"});Zd.appendChild(wi);const _0=document.createElement("style");_0.innerHTML=Ob;Zd.appendChild(_0);Ly(wi,Zd);Mr(wi).render(v.jsx(Xx,{children:v.jsx(Uy,{rootId:Un.id,children:v.jsxs(Vy,{shadowRootId:wi.id,children:[v.jsx(Gx,{children:v.jsx(tA,{})}),v.jsx(BA,{})]})})}));
